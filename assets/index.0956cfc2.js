var n0=Object.defineProperty;var r0=(n,e,t)=>e in n?n0(n,e,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[e]=t;var tt=(n,e,t)=>(r0(n,typeof e!="symbol"?e+"":e,t),t);function s0(n,e){for(var t=0;t<e.length;t++){const r=e[t];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in n)){const o=Object.getOwnPropertyDescriptor(r,s);o&&Object.defineProperty(n,s,o.get?o:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(n,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const o of s)if(o.type==="childList")for(const i of o.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&r(i)}).observe(document,{childList:!0,subtree:!0});function t(s){const o={};return s.integrity&&(o.integrity=s.integrity),s.referrerpolicy&&(o.referrerPolicy=s.referrerpolicy),s.crossorigin==="use-credentials"?o.credentials="include":s.crossorigin==="anonymous"?o.credentials="omit":o.credentials="same-origin",o}function r(s){if(s.ep)return;s.ep=!0;const o=t(s);fetch(s.href,o)}})();var Pr=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function o0(n){var e=n.default;if(typeof e=="function"){var t=function(){return e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var i0={};(function(){var n;function e(v){var S=0;return function(){return S<v.length?{done:!1,value:v[S++]}:{done:!0}}}var t=typeof Object.defineProperties=="function"?Object.defineProperty:function(v,S,k){return v==Array.prototype||v==Object.prototype||(v[S]=k.value),v};function r(v){v=[typeof globalThis=="object"&&globalThis,v,typeof window=="object"&&window,typeof self=="object"&&self,typeof Pr=="object"&&Pr];for(var S=0;S<v.length;++S){var k=v[S];if(k&&k.Math==Math)return k}throw Error("Cannot find global object")}var s=r(this);function o(v,S){if(S)e:{var k=s;v=v.split(".");for(var W=0;W<v.length-1;W++){var ee=v[W];if(!(ee in k))break e;k=k[ee]}v=v[v.length-1],W=k[v],S=S(W),S!=W&&S!=null&&t(k,v,{configurable:!0,writable:!0,value:S})}}o("Symbol",function(v){function S(he){if(this instanceof S)throw new TypeError("Symbol is not a constructor");return new k(W+(he||"")+"_"+ee++,he)}function k(he,se){this.g=he,t(this,"description",{configurable:!0,writable:!0,value:se})}if(v)return v;k.prototype.toString=function(){return this.g};var W="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",ee=0;return S}),o("Symbol.iterator",function(v){if(v)return v;v=Symbol("Symbol.iterator");for(var S="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),k=0;k<S.length;k++){var W=s[S[k]];typeof W=="function"&&typeof W.prototype[v]!="function"&&t(W.prototype,v,{configurable:!0,writable:!0,value:function(){return i(e(this))}})}return v});function i(v){return v={next:v},v[Symbol.iterator]=function(){return this},v}function a(v){var S=typeof Symbol<"u"&&Symbol.iterator&&v[Symbol.iterator];return S?S.call(v):{next:e(v)}}function u(v){if(!(v instanceof Array)){v=a(v);for(var S,k=[];!(S=v.next()).done;)k.push(S.value);v=k}return v}var c=typeof Object.create=="function"?Object.create:function(v){function S(){}return S.prototype=v,new S},l;if(typeof Object.setPrototypeOf=="function")l=Object.setPrototypeOf;else{var h;e:{var d={a:!0},m={};try{m.__proto__=d,h=m.a;break e}catch{}h=!1}l=h?function(v,S){if(v.__proto__=S,v.__proto__!==S)throw new TypeError(v+" is not extensible");return v}:null}var g=l;function C(v,S){if(v.prototype=c(S.prototype),v.prototype.constructor=v,g)g(v,S);else for(var k in S)if(k!="prototype")if(Object.defineProperties){var W=Object.getOwnPropertyDescriptor(S,k);W&&Object.defineProperty(v,k,W)}else v[k]=S[k];v.ea=S.prototype}function $(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.s=this.m=0,this.j=null}function T(v){if(v.l)throw new TypeError("Generator is already running");v.l=!0}$.prototype.o=function(v){this.h=v};function A(v,S){v.j={U:S,V:!0},v.g=v.m||v.s}$.prototype.return=function(v){this.j={return:v},this.g=this.s};function P(v,S,k){return v.g=k,{value:S}}function B(v){this.g=new $,this.h=v}function H(v,S){T(v.g);var k=v.g.i;return k?x(v,"return"in k?k.return:function(W){return{value:W,done:!0}},S,v.g.return):(v.g.return(S),re(v))}function x(v,S,k,W){try{var ee=S.call(v.g.i,k);if(!(ee instanceof Object))throw new TypeError("Iterator result "+ee+" is not an object");if(!ee.done)return v.g.l=!1,ee;var he=ee.value}catch(se){return v.g.i=null,A(v.g,se),re(v)}return v.g.i=null,W.call(v.g,he),re(v)}function re(v){for(;v.g.g;)try{var S=v.h(v.g);if(S)return v.g.l=!1,{value:S.value,done:!1}}catch(k){v.g.h=void 0,A(v.g,k)}if(v.g.l=!1,v.g.j){if(S=v.g.j,v.g.j=null,S.V)throw S.U;return{value:S.return,done:!0}}return{value:void 0,done:!0}}function oe(v){this.next=function(S){return T(v.g),v.g.i?S=x(v,v.g.i.next,S,v.g.o):(v.g.o(S),S=re(v)),S},this.throw=function(S){return T(v.g),v.g.i?S=x(v,v.g.i.throw,S,v.g.o):(A(v.g,S),S=re(v)),S},this.return=function(S){return H(v,S)},this[Symbol.iterator]=function(){return this}}function ie(v,S){return S=new oe(new B(S)),g&&v.prototype&&g(S,v.prototype),S}function le(v,S){v instanceof String&&(v+="");var k=0,W=!1,ee={next:function(){if(!W&&k<v.length){var he=k++;return{value:S(he,v[he]),done:!1}}return W=!0,{done:!0,value:void 0}}};return ee[Symbol.iterator]=function(){return ee},ee}var $e=typeof Object.assign=="function"?Object.assign:function(v,S){for(var k=1;k<arguments.length;k++){var W=arguments[k];if(W)for(var ee in W)Object.prototype.hasOwnProperty.call(W,ee)&&(v[ee]=W[ee])}return v};o("Object.assign",function(v){return v||$e}),o("Promise",function(v){function S(se){this.h=0,this.i=void 0,this.g=[],this.o=!1;var de=this.j();try{se(de.resolve,de.reject)}catch(ve){de.reject(ve)}}function k(){this.g=null}function W(se){return se instanceof S?se:new S(function(de){de(se)})}if(v)return v;k.prototype.h=function(se){if(this.g==null){this.g=[];var de=this;this.i(function(){de.l()})}this.g.push(se)};var ee=s.setTimeout;k.prototype.i=function(se){ee(se,0)},k.prototype.l=function(){for(;this.g&&this.g.length;){var se=this.g;this.g=[];for(var de=0;de<se.length;++de){var ve=se[de];se[de]=null;try{ve()}catch(Re){this.j(Re)}}}this.g=null},k.prototype.j=function(se){this.i(function(){throw se})},S.prototype.j=function(){function se(Re){return function(je){ve||(ve=!0,Re.call(de,je))}}var de=this,ve=!1;return{resolve:se(this.C),reject:se(this.l)}},S.prototype.C=function(se){if(se===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(se instanceof S)this.F(se);else{e:switch(typeof se){case"object":var de=se!=null;break e;case"function":de=!0;break e;default:de=!1}de?this.u(se):this.m(se)}},S.prototype.u=function(se){var de=void 0;try{de=se.then}catch(ve){this.l(ve);return}typeof de=="function"?this.G(de,se):this.m(se)},S.prototype.l=function(se){this.s(2,se)},S.prototype.m=function(se){this.s(1,se)},S.prototype.s=function(se,de){if(this.h!=0)throw Error("Cannot settle("+se+", "+de+"): Promise already settled in state"+this.h);this.h=se,this.i=de,this.h===2&&this.D(),this.A()},S.prototype.D=function(){var se=this;ee(function(){if(se.B()){var de=s.console;typeof de<"u"&&de.error(se.i)}},1)},S.prototype.B=function(){if(this.o)return!1;var se=s.CustomEvent,de=s.Event,ve=s.dispatchEvent;return typeof ve>"u"?!0:(typeof se=="function"?se=new se("unhandledrejection",{cancelable:!0}):typeof de=="function"?se=new de("unhandledrejection",{cancelable:!0}):(se=s.document.createEvent("CustomEvent"),se.initCustomEvent("unhandledrejection",!1,!0,se)),se.promise=this,se.reason=this.i,ve(se))},S.prototype.A=function(){if(this.g!=null){for(var se=0;se<this.g.length;++se)he.h(this.g[se]);this.g=null}};var he=new k;return S.prototype.F=function(se){var de=this.j();se.J(de.resolve,de.reject)},S.prototype.G=function(se,de){var ve=this.j();try{se.call(de,ve.resolve,ve.reject)}catch(Re){ve.reject(Re)}},S.prototype.then=function(se,de){function ve(Ke,He){return typeof Ke=="function"?function(Oe){try{Re(Ke(Oe))}catch(y){je(y)}}:He}var Re,je,et=new S(function(Ke,He){Re=Ke,je=He});return this.J(ve(se,Re),ve(de,je)),et},S.prototype.catch=function(se){return this.then(void 0,se)},S.prototype.J=function(se,de){function ve(){switch(Re.h){case 1:se(Re.i);break;case 2:de(Re.i);break;default:throw Error("Unexpected state: "+Re.h)}}var Re=this;this.g==null?he.h(ve):this.g.push(ve),this.o=!0},S.resolve=W,S.reject=function(se){return new S(function(de,ve){ve(se)})},S.race=function(se){return new S(function(de,ve){for(var Re=a(se),je=Re.next();!je.done;je=Re.next())W(je.value).J(de,ve)})},S.all=function(se){var de=a(se),ve=de.next();return ve.done?W([]):new S(function(Re,je){function et(Oe){return function(y){Ke[Oe]=y,He--,He==0&&Re(Ke)}}var Ke=[],He=0;do Ke.push(void 0),He++,W(ve.value).J(et(Ke.length-1),je),ve=de.next();while(!ve.done)})},S}),o("Object.is",function(v){return v||function(S,k){return S===k?S!==0||1/S===1/k:S!==S&&k!==k}}),o("Array.prototype.includes",function(v){return v||function(S,k){var W=this;W instanceof String&&(W=String(W));var ee=W.length;for(k=k||0,0>k&&(k=Math.max(k+ee,0));k<ee;k++){var he=W[k];if(he===S||Object.is(he,S))return!0}return!1}}),o("String.prototype.includes",function(v){return v||function(S,k){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(S instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(S,k||0)!==-1}}),o("Array.prototype.keys",function(v){return v||function(){return le(this,function(S){return S})}});var Ie=this||self;function Ae(v,S){v=v.split(".");var k=Ie;v[0]in k||typeof k.execScript>"u"||k.execScript("var "+v[0]);for(var W;v.length&&(W=v.shift());)v.length||S===void 0?k[W]&&k[W]!==Object.prototype[W]?k=k[W]:k=k[W]={}:k[W]=S}function Ge(v,S){return S=String.fromCharCode.apply(null,S),v==null?S:v+S}var Ye,at=typeof TextDecoder<"u",ut,lt=typeof TextEncoder<"u";function Dt(v){if(lt)v=(ut||(ut=new TextEncoder)).encode(v);else{var S=void 0;S=S===void 0?!1:S;for(var k=0,W=new Uint8Array(3*v.length),ee=0;ee<v.length;ee++){var he=v.charCodeAt(ee);if(128>he)W[k++]=he;else{if(2048>he)W[k++]=he>>6|192;else{if(55296<=he&&57343>=he){if(56319>=he&&ee<v.length){var se=v.charCodeAt(++ee);if(56320<=se&&57343>=se){he=1024*(he-55296)+se-56320+65536,W[k++]=he>>18|240,W[k++]=he>>12&63|128,W[k++]=he>>6&63|128,W[k++]=he&63|128;continue}else ee--}if(S)throw Error("Found an unpaired surrogate");he=65533}W[k++]=he>>12|224,W[k++]=he>>6&63|128}W[k++]=he&63|128}}v=W.subarray(0,k)}return v}var an={},gt=null;function vr(v,S){S===void 0&&(S=0),Cr(),S=an[S];for(var k=Array(Math.floor(v.length/3)),W=S[64]||"",ee=0,he=0;ee<v.length-2;ee+=3){var se=v[ee],de=v[ee+1],ve=v[ee+2],Re=S[se>>2];se=S[(se&3)<<4|de>>4],de=S[(de&15)<<2|ve>>6],ve=S[ve&63],k[he++]=Re+se+de+ve}switch(Re=0,ve=W,v.length-ee){case 2:Re=v[ee+1],ve=S[(Re&15)<<2]||W;case 1:v=v[ee],k[he]=S[v>>2]+S[(v&3)<<4|Re>>4]+ve+W}return k.join("")}function dn(v){var S=v.length,k=3*S/4;k%3?k=Math.floor(k):"=.".indexOf(v[S-1])!=-1&&(k="=.".indexOf(v[S-2])!=-1?k-2:k-1);var W=new Uint8Array(k),ee=0;return wr(v,function(he){W[ee++]=he}),W.subarray(0,ee)}function wr(v,S){function k(ve){for(;W<v.length;){var Re=v.charAt(W++),je=gt[Re];if(je!=null)return je;if(!/^[\s\xa0]*$/.test(Re))throw Error("Unknown base64 encoding at char: "+Re)}return ve}Cr();for(var W=0;;){var ee=k(-1),he=k(0),se=k(64),de=k(64);if(de===64&&ee===-1)break;S(ee<<2|he>>4),se!=64&&(S(he<<4&240|se>>2),de!=64&&S(se<<6&192|de))}}function Cr(){if(!gt){gt={};for(var v="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),S=["+/=","+/","-_=","-_.","-_"],k=0;5>k;k++){var W=v.concat(S[k].split(""));an[k]=W;for(var ee=0;ee<W.length;ee++){var he=W[ee];gt[he]===void 0&&(gt[he]=ee)}}}}var En=typeof Uint8Array.prototype.slice=="function",os;function Tr(v,S,k){return S===k?os||(os=new Uint8Array(0)):En?v.slice(S,k):new Uint8Array(v.subarray(S,k))}var Vt=0,Rn=0;function kt(v,S){S=S===void 0?{}:S,S=S.v===void 0?!1:S.v,this.h=null,this.g=this.j=this.l=0,this.m=!1,this.v=S,v&&Ur(this,v)}function Ur(v,S){S=S.constructor===Uint8Array?S:S.constructor===ArrayBuffer?new Uint8Array(S):S.constructor===Array?new Uint8Array(S):S.constructor===String?dn(S):S instanceof Uint8Array?new Uint8Array(S.buffer,S.byteOffset,S.byteLength):new Uint8Array(0),v.h=S,v.l=0,v.j=v.h.length,v.g=v.l}kt.prototype.reset=function(){this.g=this.l};function Jt(v){for(var S=128,k=0,W=0,ee=0;4>ee&&128<=S;ee++)S=v.h[v.g++],k|=(S&127)<<7*ee;if(128<=S&&(S=v.h[v.g++],k|=(S&127)<<28,W|=(S&127)>>4),128<=S)for(ee=0;5>ee&&128<=S;ee++)S=v.h[v.g++],W|=(S&127)<<7*ee+3;if(128>S)return v=k>>>0,S=W>>>0,(W=S&2147483648)&&(v=~v+1>>>0,S=~S>>>0,v==0&&(S=S+1>>>0)),v=4294967296*S+(v>>>0),W?-v:v;v.m=!0}kt.prototype.i=function(){var v=this.h,S=v[this.g],k=S&127;return 128>S?(this.g+=1,k):(S=v[this.g+1],k|=(S&127)<<7,128>S?(this.g+=2,k):(S=v[this.g+2],k|=(S&127)<<14,128>S?(this.g+=3,k):(S=v[this.g+3],k|=(S&127)<<21,128>S?(this.g+=4,k):(S=v[this.g+4],k|=(S&15)<<28,128>S?(this.g+=5,k>>>0):(this.g+=5,128<=v[this.g++]&&128<=v[this.g++]&&128<=v[this.g++]&&128<=v[this.g++]&&this.g++,k)))))},kt.prototype.o=function(){var v=this.h[this.g],S=this.h[this.g+1],k=this.h[this.g+2],W=this.h[this.g+3];return this.g+=4,k=(v<<0|S<<8|k<<16|W<<24)>>>0,v=2*(k>>31)+1,S=k>>>23&255,k&=8388607,S==255?k?NaN:1/0*v:S==0?v*Math.pow(2,-149)*k:v*Math.pow(2,S-150)*(k+Math.pow(2,23))};var tr=[];function en(){this.g=new Uint8Array(64),this.h=0}en.prototype.push=function(v){if(!(this.h+1<this.g.length)){var S=this.g;this.g=new Uint8Array(Math.ceil(1+2*this.g.length)),this.g.set(S)}this.g[this.h++]=v},en.prototype.length=function(){return this.h},en.prototype.end=function(){var v=this.g,S=this.h;return this.h=0,Tr(v,0,S)};function Fe(v,S){for(;127<S;)v.push(S&127|128),S>>>=7;v.push(S)}function Ft(v){var S={},k=S.N===void 0?!1:S.N;this.o={v:S.v===void 0?!1:S.v},this.N=k,S=this.o,tr.length?(k=tr.pop(),S&&(k.v=S.v),v&&Ur(k,v),v=k):v=new kt(v,S),this.g=v,this.m=this.g.g,this.h=this.i=this.l=-1,this.j=!1}Ft.prototype.reset=function(){this.g.reset(),this.h=this.l=-1};function pn(v){var S=v.g;if((S=S.g==S.j)||(S=v.j)||(S=v.g,S=S.m||0>S.g||S.g>S.j),S)return!1;v.m=v.g.g,S=v.g.i();var k=S&7;return k!=0&&k!=5&&k!=1&&k!=2&&k!=3&&k!=4?(v.j=!0,!1):(v.i=S,v.l=S>>>3,v.h=k,!0)}function Vn(v){switch(v.h){case 0:if(v.h!=0)Vn(v);else{for(v=v.g;v.h[v.g]&128;)v.g++;v.g++}break;case 1:v.h!=1?Vn(v):(v=v.g,v.g+=8);break;case 2:if(v.h!=2)Vn(v);else{var S=v.g.i();v=v.g,v.g+=S}break;case 5:v.h!=5?Vn(v):(v=v.g,v.g+=4);break;case 3:S=v.l;do{if(!pn(v)){v.j=!0;break}if(v.h==4){v.l!=S&&(v.j=!0);break}Vn(v)}while(1);break;default:v.j=!0}}function ks(v,S,k){var W=v.g.j,ee=v.g.i(),he=v.g.g+ee;if(v.g.j=he,k(S,v),k=he-v.g.g,k!==0)throw Error("Message parsing ended unexpectedly. Expected to read "+ee+" bytes, instead read "+(ee-k)+" bytes, either the data ended unexpectedly or the message misreported its own length");return v.g.g=he,v.g.j=W,S}function Ut(v){return v.g.o()}function Wr(v){var S=v.g.i();v=v.g;var k=v.g;v.g+=S,v=v.h;var W;if(at)(W=Ye)||(W=Ye=new TextDecoder("utf-8",{fatal:!1})),W=W.decode(v.subarray(k,k+S));else{S=k+S;for(var ee=[],he=null,se,de,ve;k<S;)se=v[k++],128>se?ee.push(se):224>se?k>=S?ee.push(65533):(de=v[k++],194>se||(de&192)!==128?(k--,ee.push(65533)):ee.push((se&31)<<6|de&63)):240>se?k>=S-1?ee.push(65533):(de=v[k++],(de&192)!==128||se===224&&160>de||se===237&&160<=de||((W=v[k++])&192)!==128?(k--,ee.push(65533)):ee.push((se&15)<<12|(de&63)<<6|W&63)):244>=se?k>=S-2?ee.push(65533):(de=v[k++],(de&192)!==128||(se<<28)+(de-144)>>30!==0||((W=v[k++])&192)!==128||((ve=v[k++])&192)!==128?(k--,ee.push(65533)):(se=(se&7)<<18|(de&63)<<12|(W&63)<<6|ve&63,se-=65536,ee.push((se>>10&1023)+55296,(se&1023)+56320))):ee.push(65533),8192<=ee.length&&(he=Ge(he,ee),ee.length=0);W=Ge(he,ee)}return W}function $r(v,S,k){var W=v.g.i();for(W=v.g.g+W;v.g.g<W;)k.push(S.call(v.g))}function kn(v,S){v.h==2?$r(v,kt.prototype.o,S):S.push(Ut(v))}function un(){this.h=[],this.i=0,this.g=new en}function Ht(v,S){S.length!==0&&(v.h.push(S),v.i+=S.length)}function is(v){var S=v.i+v.g.length();if(S===0)return new Uint8Array(0);S=new Uint8Array(S);for(var k=v.h,W=k.length,ee=0,he=0;he<W;he++){var se=k[he];se.length!==0&&(S.set(se,ee),ee+=se.length)}return k=v.g,W=k.h,W!==0&&(S.set(k.g.subarray(0,W),ee),k.h=0),v.h=[S],S}function qt(v,S,k){if(k!=null){Fe(v.g,8*S+5),v=v.g;var W=k;W=(k=0>W?1:0)?-W:W,W===0?0<1/W?Vt=Rn=0:(Rn=0,Vt=2147483648):isNaN(W)?(Rn=0,Vt=2147483647):34028234663852886e22<W?(Rn=0,Vt=(k<<31|2139095040)>>>0):11754943508222875e-54>W?(W=Math.round(W/Math.pow(2,-149)),Rn=0,Vt=(k<<31|W)>>>0):(S=Math.floor(Math.log(W)/Math.LN2),W*=Math.pow(2,-S),W=Math.round(8388608*W),16777216<=W&&++S,Rn=0,Vt=(k<<31|S+127<<23|W&8388607)>>>0),k=Vt,v.push(k>>>0&255),v.push(k>>>8&255),v.push(k>>>16&255),v.push(k>>>24&255)}}var zr=typeof Uint8Array=="function";function Is(v,S,k){if(v!=null)return typeof v=="object"?zr&&v instanceof Uint8Array?k(v):Qs(v,S,k):S(v)}function Qs(v,S,k){if(Array.isArray(v)){for(var W=Array(v.length),ee=0;ee<v.length;ee++)W[ee]=Is(v[ee],S,k);return Array.isArray(v)&&v.W&&Wt(W),W}W={};for(ee in v)W[ee]=Is(v[ee],S,k);return W}function Sr(v){return typeof v=="number"?isFinite(v)?v:String(v):v}var Gr={W:{value:!0,configurable:!0}};function Wt(v){return Array.isArray(v)&&!Object.isFrozen(v)&&Object.defineProperties(v,Gr),v}var Et;function st(v,S,k){var W=Et;Et=null,v||(v=W),W=this.constructor.ca,v||(v=W?[W]:[]),this.j=W?0:-1,this.m=this.g=null,this.h=v;e:{if(W=this.h.length,v=W-1,W&&(W=this.h[v],!(W===null||typeof W!="object"||Array.isArray(W)||zr&&W instanceof Uint8Array))){this.l=v-this.j,this.i=W;break e}S!==void 0&&-1<S?(this.l=Math.max(S,v+1-this.j),this.i=null):this.l=Number.MAX_VALUE}if(k)for(S=0;S<k.length;S++)v=k[S],v<this.l?(v+=this.j,(W=this.h[v])?Wt(W):this.h[v]=ht):(Nr(this),(W=this.i[v])?Wt(W):this.i[v]=ht)}var ht=Object.freeze(Wt([]));function Nr(v){var S=v.l+v.j;v.h[S]||(v.i=v.h[S]={})}function dt(v,S,k){return S===-1?null:(k===void 0?0:k)||S>=v.l?v.i?v.i[S]:void 0:v.h[S+v.j]}function jr(v,S){var k=k===void 0?!1:k,W=dt(v,S,k);return W==null&&(W=ht),W===ht&&(W=Wt([]),Qe(v,S,W,k)),W}function _s(v){var S=jr(v,3);if(v.m||(v.m={}),!v.m[3]){for(var k=0;k<S.length;k++)S[k]=+S[k];v.m[3]=!0}return S}function cn(v,S,k){return v=dt(v,S),v==null?k:v}function zt(v,S,k){return v=dt(v,S),v=v==null?v:+v,v==null?k===void 0?0:k:v}function Qe(v,S,k,W){(W===void 0?0:W)||S>=v.l?(Nr(v),v.i[S]=k):v.h[S+v.j]=k}function Vo(v,S,k){if(k===-1)return null;if(v.g||(v.g={}),!v.g[k]){var W=dt(v,k,!1);W&&(v.g[k]=new S(W))}return v.g[k]}function Hr(v,S){v.g||(v.g={});var k=v.g[1];if(!k){var W=jr(v,1);k=[];for(var ee=0;ee<W.length;ee++)k[ee]=new S(W[ee]);v.g[1]=k}return k}function nr(v,S,k){var W=W===void 0?!1:W;v.g||(v.g={});var ee=k&&rr(k);v.g[S]=k,Qe(v,S,ee,W)}function as(v,S,k,W){var ee=Hr(v,k);S=S||new k,v=jr(v,1),W!=null?(ee.splice(W,0,S),v.splice(W,0,rr(S))):(ee.push(S),v.push(rr(S)))}st.prototype.toJSON=function(){var v=rr(this);return Qs(v,Sr,vr)};function rr(v,S){if(v.g)for(var k in v.g){var W=v.g[k];if(Array.isArray(W))for(var ee=0;ee<W.length;ee++)W[ee]&&rr(W[ee]);else W&&rr(W)}return v.h}st.prototype.toString=function(){return rr(this).toString()};function Rs(v,S){if(v=v.o){Ht(S,S.g.end());for(var k=0;k<v.length;k++)Ht(S,v[k])}}function mn(v,S){if(S.h==4)return!1;var k=S.m;return Vn(S),S.N||(S=Tr(S.g.h,k,S.g.g),(k=v.o)?k.push(S):v.o=[S]),!0}function sr(v){st.call(this,v,-1,Wo)}C(sr,st),sr.prototype.getRows=function(){return dt(this,1)},sr.prototype.getCols=function(){return dt(this,2)},sr.prototype.getPackedDataList=function(){return _s(this)},sr.prototype.getLayout=function(){return cn(this,4,0)};function Uo(v,S){for(;pn(S);)switch(S.i){case 8:var k=S.g.i();Qe(v,1,k);break;case 16:k=S.g.i(),Qe(v,2,k);break;case 29:case 26:kn(S,v.getPackedDataList());break;case 32:k=Jt(S.g),Qe(v,4,k);break;default:if(!mn(v,S))return v}return v}var Wo=[3];function Gt(v,S){var k=void 0;return new(k||(k=Promise))(function(W,ee){function he(ve){try{de(S.next(ve))}catch(Re){ee(Re)}}function se(ve){try{de(S.throw(ve))}catch(Re){ee(Re)}}function de(ve){ve.done?W(ve.value):new k(function(Re){Re(ve.value)}).then(he,se)}de((S=S.apply(v,void 0)).next())})}function ln(v){st.call(this,v)}C(ln,st);function Zs(v,S){for(;pn(S);)switch(S.i){case 8:var k=S.g.i();Qe(v,1,k);break;case 21:k=Ut(S),Qe(v,2,k);break;case 26:k=Wr(S),Qe(v,3,k);break;case 34:k=Wr(S),Qe(v,4,k);break;default:if(!mn(v,S))return v}return v}function qr(v){st.call(this,v,-1,As)}C(qr,st),qr.prototype.addClassification=function(v,S){return as(this,v,ln,S),this};var As=[1];function Un(v){st.call(this,v)}C(Un,st);function zo(v,S){for(;pn(S);)switch(S.i){case 13:var k=Ut(S);Qe(v,1,k);break;case 21:k=Ut(S),Qe(v,2,k);break;case 29:k=Ut(S),Qe(v,3,k);break;case 37:k=Ut(S),Qe(v,4,k);break;case 45:k=Ut(S),Qe(v,5,k);break;default:if(!mn(v,S))return v}return v}function Go(v){st.call(this,v,-1,jo)}C(Go,st);function Js(v){e:{var S=new Go;for(v=new Ft(v);pn(v);)switch(v.i){case 10:var k=ks(v,new Un,zo);as(S,k,Un,void 0);break;default:if(!mn(S,v))break e}}return S}var jo=[1];function or(v){st.call(this,v)}C(or,st);function ir(v){st.call(this,v,-1,qo)}C(ir,st),ir.prototype.getVertexType=function(){return cn(this,1,0)},ir.prototype.getPrimitiveType=function(){return cn(this,2,0)},ir.prototype.getVertexBufferList=function(){return _s(this)},ir.prototype.getIndexBufferList=function(){return jr(this,4)};function Ho(v,S){for(;pn(S);)switch(S.i){case 8:var k=Jt(S.g);Qe(v,1,k);break;case 16:k=Jt(S.g),Qe(v,2,k);break;case 29:case 26:kn(S,v.getVertexBufferList());break;case 32:case 34:k=S;var W=v.getIndexBufferList();k.h==2?$r(k,kt.prototype.i,W):W.push(k.g.i());break;default:if(!mn(v,S))return v}return v}var qo=[3,4];function us(v){st.call(this,v)}C(us,st),us.prototype.getMesh=function(){return Vo(this,ir,1)},us.prototype.getPoseTransformMatrix=function(){return Vo(this,sr,2)};function Xo(v){e:{var S=new us;for(v=new Ft(v);pn(v);)switch(v.i){case 10:var k=ks(v,new ir,Ho);nr(S,1,k);break;case 18:k=ks(v,new sr,Uo),nr(S,2,k);break;default:if(!mn(S,v))break e}}return S}function cs(v,S,k){if(k=v.createShader(k===0?v.VERTEX_SHADER:v.FRAGMENT_SHADER),v.shaderSource(k,S),v.compileShader(k),!v.getShaderParameter(k,v.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+v.getShaderInfoLog(k));return k}function eo(v){return Hr(v,ln).map(function(S){return{index:cn(S,1,0),Y:zt(S,2),label:dt(S,3)!=null?cn(S,3,""):void 0,displayName:dt(S,4)!=null?cn(S,4,""):void 0}})}function to(v){return{x:zt(v,1),y:zt(v,2),z:zt(v,3),visibility:dt(v,4)!=null?zt(v,4):void 0}}function Xr(v,S){this.h=v,this.g=S,this.l=0}function Er(v,S,k){return hn(v,S),typeof v.g.canvas.transferToImageBitmap=="function"?Promise.resolve(v.g.canvas.transferToImageBitmap()):k?Promise.resolve(v.g.canvas):typeof createImageBitmap=="function"?createImageBitmap(v.g.canvas):(v.i===void 0&&(v.i=document.createElement("canvas")),new Promise(function(W){v.i.height=v.g.canvas.height,v.i.width=v.g.canvas.width,v.i.getContext("2d",{}).drawImage(v.g.canvas,0,0,v.g.canvas.width,v.g.canvas.height),W(v.i)}))}function hn(v,S){var k=v.g;if(v.m===void 0){var W=cs(k,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),ee=cs(k,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),he=k.createProgram();if(k.attachShader(he,W),k.attachShader(he,ee),k.linkProgram(he),!k.getProgramParameter(he,k.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+k.getProgramInfoLog(he));W=v.m=he,k.useProgram(W),ee=k.getUniformLocation(W,"sampler0"),v.j={I:k.getAttribLocation(W,"aVertex"),H:k.getAttribLocation(W,"aTex"),da:ee},v.s=k.createBuffer(),k.bindBuffer(k.ARRAY_BUFFER,v.s),k.enableVertexAttribArray(v.j.I),k.vertexAttribPointer(v.j.I,2,k.FLOAT,!1,0,0),k.bufferData(k.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),k.STATIC_DRAW),k.bindBuffer(k.ARRAY_BUFFER,null),v.o=k.createBuffer(),k.bindBuffer(k.ARRAY_BUFFER,v.o),k.enableVertexAttribArray(v.j.H),k.vertexAttribPointer(v.j.H,2,k.FLOAT,!1,0,0),k.bufferData(k.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),k.STATIC_DRAW),k.bindBuffer(k.ARRAY_BUFFER,null),k.uniform1i(ee,0)}W=v.j,k.useProgram(v.m),k.canvas.width=S.width,k.canvas.height=S.height,k.viewport(0,0,S.width,S.height),k.activeTexture(k.TEXTURE0),v.h.bindTexture2d(S.glName),k.enableVertexAttribArray(W.I),k.bindBuffer(k.ARRAY_BUFFER,v.s),k.vertexAttribPointer(W.I,2,k.FLOAT,!1,0,0),k.enableVertexAttribArray(W.H),k.bindBuffer(k.ARRAY_BUFFER,v.o),k.vertexAttribPointer(W.H,2,k.FLOAT,!1,0,0),k.bindFramebuffer(k.DRAW_FRAMEBUFFER?k.DRAW_FRAMEBUFFER:k.FRAMEBUFFER,null),k.clearColor(0,0,0,0),k.clear(k.COLOR_BUFFER_BIT),k.colorMask(!0,!0,!0,!0),k.drawArrays(k.TRIANGLE_FAN,0,4),k.disableVertexAttribArray(W.I),k.disableVertexAttribArray(W.H),k.bindBuffer(k.ARRAY_BUFFER,null),v.h.bindTexture2d(0)}function Ko(v){this.g=v}var tn=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function kr(v,S){return S+v}function Kr(v,S){window[v]=S}function gn(v){var S=document.createElement("script");return S.setAttribute("src",v),S.setAttribute("crossorigin","anonymous"),new Promise(function(k){S.addEventListener("load",function(){k()},!1),S.addEventListener("error",function(){k()},!1),document.body.appendChild(S)})}function Yo(){return Gt(this,function v(){return ie(v,function(S){switch(S.g){case 1:return S.m=2,P(S,WebAssembly.instantiate(tn),4);case 4:S.g=3,S.m=0;break;case 2:return S.m=0,S.j=null,S.return(!1);case 3:return S.return(!0)}})})}function Wn(v){if(this.g=v,this.listeners={},this.j={},this.F={},this.m={},this.s={},this.G=this.o=this.R=!0,this.C=Promise.resolve(),this.P="",this.B={},this.locateFile=v&&v.locateFile||kr,typeof window=="object")var S=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else if(typeof location<"u")S=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/";else throw Error("solutions can only be loaded on a web page or in a web worker");if(this.S=S,v.options){S=a(Object.keys(v.options));for(var k=S.next();!k.done;k=S.next()){k=k.value;var W=v.options[k].default;W!==void 0&&(this.j[k]=typeof W=="function"?W():W)}}}n=Wn.prototype,n.close=function(){return this.i&&this.i.delete(),Promise.resolve()};function no(v,S){return v.g.files===void 0?[]:typeof v.g.files=="function"?v.g.files(S):v.g.files}function Yr(v){return Gt(v,function S(){var k=this,W,ee,he,se,de,ve,Re,je,et,Ke,He;return ie(S,function(Oe){switch(Oe.g){case 1:return W=k,k.R?(ee=no(k,k.j),P(Oe,Yo(),2)):Oe.return();case 2:if(he=Oe.h,typeof window=="object")return Kr("createMediapipeSolutionsWasm",{locateFile:k.locateFile}),Kr("createMediapipeSolutionsPackedAssets",{locateFile:k.locateFile}),ve=ee.filter(function(y){return y.data!==void 0}),Re=ee.filter(function(y){return y.data===void 0}),je=Promise.all(ve.map(function(y){var E=Qr(W,y.url);if(y.path!==void 0){var R=y.path;E=E.then(function(D){return W.overrideFile(R,D),Promise.resolve(D)})}return E})),et=Promise.all(Re.map(function(y){return y.simd===void 0||y.simd&&he||!y.simd&&!he?gn(W.locateFile(y.url,W.S)):Promise.resolve()})).then(function(){return Gt(W,function y(){var E,R,D=this;return ie(y,function(U){if(U.g==1)return E=window.createMediapipeSolutionsWasm,R=window.createMediapipeSolutionsPackedAssets,P(U,E(R),2);D.h=U.h,U.g=0})})}),Ke=function(){return Gt(W,function y(){var E=this;return ie(y,function(R){return E.g.graph&&E.g.graph.url?R=P(R,Qr(E,E.g.graph.url),0):(R.g=0,R=void 0),R})})}(),P(Oe,Promise.all([et,je,Ke]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return se=ee.filter(function(y){return y.simd===void 0||y.simd&&he||!y.simd&&!he}).map(function(y){return W.locateFile(y.url,W.S)}),importScripts.apply(null,u(se)),P(Oe,createMediapipeSolutionsWasm(Module),6);case 6:k.h=Oe.h,k.l=new OffscreenCanvas(1,1),k.h.canvas=k.l,de=k.h.GL.createContext(k.l,{antialias:!1,alpha:!1,ba:typeof WebGL2RenderingContext<"u"?2:1}),k.h.GL.makeContextCurrent(de),Oe.g=4;break;case 7:if(k.l=document.createElement("canvas"),He=k.l.getContext("webgl2",{}),!He&&(He=k.l.getContext("webgl",{}),!He))return alert("Failed to create WebGL canvas context when passing video frame."),Oe.return();k.D=He,k.h.canvas=k.l,k.h.createContext(k.l,!0,!0,{});case 4:k.i=new k.h.SolutionWasm,k.R=!1,Oe.g=0}})})}function Qo(v){return Gt(v,function S(){var k=this,W,ee,he,se,de,ve,Re,je;return ie(S,function(et){if(et.g==1){if(k.g.graph&&k.g.graph.url&&k.P===k.g.graph.url)return et.return();if(k.o=!0,!k.g.graph||!k.g.graph.url){et.g=2;return}return k.P=k.g.graph.url,P(et,Qr(k,k.g.graph.url),3)}for(et.g!=2&&(W=et.h,k.i.loadGraph(W)),ee=a(Object.keys(k.B)),he=ee.next();!he.done;he=ee.next())se=he.value,k.i.overrideFile(se,k.B[se]);if(k.B={},k.g.listeners)for(de=a(k.g.listeners),ve=de.next();!ve.done;ve=de.next())Re=ve.value,ls(k,Re);je=k.j,k.j={},k.setOptions(je),et.g=0})})}n.reset=function(){return Gt(this,function v(){var S=this;return ie(v,function(k){S.i&&(S.i.reset(),S.m={},S.s={}),k.g=0})})},n.setOptions=function(v,S){var k=this;if(S=S||this.g.options){for(var W=[],ee=[],he={},se=a(Object.keys(v)),de=se.next();!de.done;he={K:he.K,L:he.L},de=se.next()){var ve=de.value;ve in this.j&&this.j[ve]===v[ve]||(this.j[ve]=v[ve],de=S[ve],de!==void 0&&(de.onChange&&(he.K=de.onChange,he.L=v[ve],W.push(function(Re){return function(){return Gt(k,function je(){var et,Ke=this;return ie(je,function(He){if(He.g==1)return P(He,Re.K(Re.L),2);et=He.h,et===!0&&(Ke.o=!0),He.g=0})})}}(he))),de.graphOptionXref&&(ve={valueNumber:de.type===1?v[ve]:0,valueBoolean:de.type===0?v[ve]:!1,valueString:de.type===2?v[ve]:""},de=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),de.graphOptionXref),ve),ee.push(de))))}(W.length!==0||ee.length!==0)&&(this.o=!0,this.A=(this.A===void 0?[]:this.A).concat(ee),this.u=(this.u===void 0?[]:this.u).concat(W))}};function Ri(v){return Gt(v,function S(){var k=this,W,ee,he,se,de,ve,Re;return ie(S,function(je){switch(je.g){case 1:if(!k.o)return je.return();if(!k.u){je.g=2;break}W=a(k.u),ee=W.next();case 3:if(ee.done){je.g=5;break}return he=ee.value,P(je,he(),4);case 4:ee=W.next(),je.g=3;break;case 5:k.u=void 0;case 2:if(k.A){for(se=new k.h.GraphOptionChangeRequestList,de=a(k.A),ve=de.next();!ve.done;ve=de.next())Re=ve.value,se.push_back(Re);k.i.changeOptions(se),se.delete(),k.A=void 0}k.o=!1,je.g=0}})})}n.initialize=function(){return Gt(this,function v(){var S=this;return ie(v,function(k){return k.g==1?P(k,Yr(S),2):k.g!=3?P(k,Qo(S),3):P(k,Ri(S),0)})})};function Qr(v,S){return Gt(v,function k(){var W=this,ee,he;return ie(k,function(se){return S in W.F?se.return(W.F[S]):(ee=W.locateFile(S,""),he=fetch(ee).then(function(de){return de.arrayBuffer()}),W.F[S]=he,se.return(he))})})}n.overrideFile=function(v,S){this.i?this.i.overrideFile(v,S):this.B[v]=S},n.clearOverriddenFiles=function(){this.B={},this.i&&this.i.clearOverriddenFiles()},n.send=function(v,S){return Gt(this,function k(){var W=this,ee,he,se,de,ve,Re,je,et,Ke;return ie(k,function(He){switch(He.g){case 1:return W.g.inputs?(ee=1e3*(S==null?performance.now():S),P(He,W.C,2)):He.return();case 2:return P(He,W.initialize(),3);case 3:for(he=new W.h.PacketDataList,se=a(Object.keys(v)),de=se.next();!de.done;de=se.next())if(ve=de.value,Re=W.g.inputs[ve]){e:{var Oe=W,y=v[ve];switch(Re.type){case"video":var E=Oe.m[Re.stream];if(E||(E=new Xr(Oe.h,Oe.D),Oe.m[Re.stream]=E),Oe=E,Oe.l===0&&(Oe.l=Oe.h.createTexture()),typeof HTMLVideoElement<"u"&&y instanceof HTMLVideoElement){var R=y.videoWidth;E=y.videoHeight}else typeof HTMLImageElement<"u"&&y instanceof HTMLImageElement?(R=y.naturalWidth,E=y.naturalHeight):(R=y.width,E=y.height);E={glName:Oe.l,width:R,height:E},R=Oe.g,R.canvas.width=E.width,R.canvas.height=E.height,R.activeTexture(R.TEXTURE0),Oe.h.bindTexture2d(Oe.l),R.texImage2D(R.TEXTURE_2D,0,R.RGBA,R.RGBA,R.UNSIGNED_BYTE,y),Oe.h.bindTexture2d(0),Oe=E;break e;case"detections":for(E=Oe.m[Re.stream],E||(E=new Ko(Oe.h),Oe.m[Re.stream]=E),Oe=E,Oe.data||(Oe.data=new Oe.g.DetectionListData),Oe.data.reset(y.length),E=0;E<y.length;++E){R=y[E];var D=Oe.data,U=D.setBoundingBox,V=E,G=R.T,K=new or;Qe(K,1,G.Z),Qe(K,2,G.$),Qe(K,3,G.height),Qe(K,4,G.width),Qe(K,5,G.rotation),Qe(K,6,G.X);var te=G=new un;qt(te,1,dt(K,1)),qt(te,2,dt(K,2)),qt(te,3,dt(K,3)),qt(te,4,dt(K,4)),qt(te,5,dt(K,5));var fe=dt(K,6);if(fe!=null&&fe!=null){Fe(te.g,48);var ge=te.g,we=fe;fe=0>we,we=Math.abs(we);var Te=we>>>0;for(we=Math.floor((we-Te)/4294967296),we>>>=0,fe&&(we=~we>>>0,Te=(~Te>>>0)+1,4294967295<Te&&(Te=0,we++,4294967295<we&&(we=0))),Vt=Te,Rn=we,fe=Vt,Te=Rn;0<Te||127<fe;)ge.push(fe&127|128),fe=(fe>>>7|Te<<25)>>>0,Te>>>=7;ge.push(fe)}if(Rs(K,te),G=is(G),U.call(D,V,G),R.O)for(D=0;D<R.O.length;++D)K=R.O[D],te=!!K.visibility,U=Oe.data,V=U.addNormalizedLandmark,G=E,K=Object.assign(Object.assign({},K),{visibility:te?K.visibility:0}),te=new Un,Qe(te,1,K.x),Qe(te,2,K.y),Qe(te,3,K.z),K.visibility&&Qe(te,4,K.visibility),ge=K=new un,qt(ge,1,dt(te,1)),qt(ge,2,dt(te,2)),qt(ge,3,dt(te,3)),qt(ge,4,dt(te,4)),qt(ge,5,dt(te,5)),Rs(te,ge),K=is(K),V.call(U,G,K);if(R.M)for(D=0;D<R.M.length;++D){if(U=Oe.data,V=U.addClassification,G=E,K=R.M[D],te=new ln,Qe(te,2,K.Y),K.index&&Qe(te,1,K.index),K.label&&Qe(te,3,K.label),K.displayName&&Qe(te,4,K.displayName),ge=K=new un,Te=dt(te,1),Te!=null&&Te!=null)if(Fe(ge.g,8),fe=ge.g,0<=Te)Fe(fe,Te);else{for(we=0;9>we;we++)fe.push(Te&127|128),Te>>=7;fe.push(1)}qt(ge,2,dt(te,2)),fe=dt(te,3),fe!=null&&(fe=Dt(fe),Fe(ge.g,26),Fe(ge.g,fe.length),Ht(ge,ge.g.end()),Ht(ge,fe)),fe=dt(te,4),fe!=null&&(fe=Dt(fe),Fe(ge.g,34),Fe(ge.g,fe.length),Ht(ge,ge.g.end()),Ht(ge,fe)),Rs(te,ge),K=is(K),V.call(U,G,K)}}Oe=Oe.data;break e;default:Oe={}}}switch(je=Oe,et=Re.stream,Re.type){case"video":he.pushTexture2d(Object.assign(Object.assign({},je),{stream:et,timestamp:ee}));break;case"detections":Ke=je,Ke.stream=et,Ke.timestamp=ee,he.pushDetectionList(Ke);break;default:throw Error("Unknown input config type: '"+Re.type+"'")}}return W.i.send(he),P(He,W.C,4);case 4:he.delete(),He.g=0}})})};function yn(v,S,k){return Gt(v,function W(){var ee,he,se,de,ve,Re,je=this,et,Ke,He,Oe,y,E,R,D;return ie(W,function(U){switch(U.g){case 1:if(!k)return U.return(S);for(ee={},he=0,se=a(Object.keys(k)),de=se.next();!de.done;de=se.next())ve=de.value,Re=k[ve],typeof Re!="string"&&Re.type==="texture"&&S[Re.stream]!==void 0&&++he;1<he&&(je.G=!1),et=a(Object.keys(k)),de=et.next();case 2:if(de.done){U.g=4;break}if(Ke=de.value,He=k[Ke],typeof He=="string")return R=ee,D=Ke,P(U,ro(je,Ke,S[He]),14);if(Oe=S[He.stream],He.type==="detection_list"){if(Oe){for(var V=Oe.getRectList(),G=Oe.getLandmarksList(),K=Oe.getClassificationsList(),te=[],fe=0;fe<V.size();++fe){var ge=V.get(fe);e:{var we=new or;for(ge=new Ft(ge);pn(ge);)switch(ge.i){case 13:var Te=Ut(ge);Qe(we,1,Te);break;case 21:Te=Ut(ge),Qe(we,2,Te);break;case 29:Te=Ut(ge),Qe(we,3,Te);break;case 37:Te=Ut(ge),Qe(we,4,Te);break;case 45:Te=Ut(ge),Qe(we,5,Te);break;case 48:Te=Jt(ge.g),Qe(we,6,Te);break;default:if(!mn(we,ge))break e}}we={Z:zt(we,1),$:zt(we,2),height:zt(we,3),width:zt(we,4),rotation:zt(we,5,0),X:cn(we,6,0)},ge=Hr(Js(G.get(fe)),Un).map(to);var Ee=K.get(fe);e:for(Te=new qr,Ee=new Ft(Ee);pn(Ee);)switch(Ee.i){case 10:Te.addClassification(ks(Ee,new ln,Zs));break;default:if(!mn(Te,Ee))break e}we={T:we,O:ge,M:eo(Te)},te.push(we)}V=te}else V=[];ee[Ke]=V,U.g=7;break}if(He.type==="proto_list"){if(Oe){for(V=Array(Oe.size()),G=0;G<Oe.size();G++)V[G]=Oe.get(G);Oe.delete()}else V=[];ee[Ke]=V,U.g=7;break}if(Oe===void 0){U.g=3;break}if(He.type==="float_list"){ee[Ke]=Oe,U.g=7;break}if(He.type==="proto"){ee[Ke]=Oe,U.g=7;break}if(He.type!=="texture")throw Error("Unknown output config type: '"+He.type+"'");return y=je.s[Ke],y||(y=new Xr(je.h,je.D),je.s[Ke]=y),P(U,Er(y,Oe,je.G),13);case 13:E=U.h,ee[Ke]=E;case 7:He.transform&&ee[Ke]&&(ee[Ke]=He.transform(ee[Ke])),U.g=3;break;case 14:R[D]=U.h;case 3:de=et.next(),U.g=2;break;case 4:return U.return(ee)}})})}function ro(v,S,k){return Gt(v,function W(){var ee=this,he;return ie(W,function(se){return typeof k=="number"||k instanceof Uint8Array||k instanceof ee.h.Uint8BlobList?se.return(k):k instanceof ee.h.Texture2dDataOut?(he=ee.s[S],he||(he=new Xr(ee.h,ee.D),ee.s[S]=he),se.return(Er(he,k,ee.G))):se.return(void 0)})})}function ls(v,S){for(var k=S.name||"$",W=[].concat(u(S.wants)),ee=new v.h.StringList,he=a(S.wants),se=he.next();!se.done;se=he.next())ee.push_back(se.value);he=v.h.PacketListener.implement({onResults:function(de){for(var ve={},Re=0;Re<S.wants.length;++Re)ve[W[Re]]=de.get(Re);var je=v.listeners[k];je&&(v.C=yn(v,ve,S.outs).then(function(et){et=je(et);for(var Ke=0;Ke<S.wants.length;++Ke){var He=ve[W[Ke]];typeof He=="object"&&He.hasOwnProperty&&He.hasOwnProperty("delete")&&He.delete()}et&&(v.C=et)}))}}),v.i.attachMultiListener(ee,he),ee.delete()}n.onResults=function(v,S){this.listeners[S||"$"]=v},Ae("Solution",Wn),Ae("OptionType",{BOOL:0,NUMBER:1,aa:2,0:"BOOL",1:"NUMBER",2:"STRING"});function Ai(v){v=Xo(v);var S=v.getMesh();if(!S)return v;var k=new Float32Array(S.getVertexBufferList());S.getVertexBufferList=function(){return k};var W=new Uint32Array(S.getIndexBufferList());return S.getIndexBufferList=function(){return W},v}var so={files:[{url:"face_mesh_solution_packed_assets_loader.js"},{simd:!0,url:"face_mesh_solution_simd_wasm_bin.js"},{simd:!1,url:"face_mesh_solution_wasm_bin.js"}],graph:{url:"face_mesh.binarypb"},listeners:[{wants:["multi_face_geometry","image_transformed","multi_face_landmarks"],outs:{image:"image_transformed",multiFaceGeometry:{type:"proto_list",stream:"multi_face_geometry",transform:function(v){return v.map(Ai)}},multiFaceLandmarks:{type:"proto_list",stream:"multi_face_landmarks",transform:function(v){return v.map(function(S){return Hr(Js(S),Un).map(to)})}}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:"iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document},enableFaceGeometry:{type:0,graphOptionXref:{calculatorName:"EnableFaceGeometryConstant",calculatorType:"ConstantSidePacketCalculator",fieldName:"bool_value"}},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},maxNumFaces:{type:1,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorNumFaces",fieldName:"int_value"}},refineLandmarks:{type:0,graphOptionXref:{calculatorType:"ConstantSidePacketCalculator",calculatorName:"ConstantSidePacketCalculatorRefineLandmarks",fieldName:"bool_value"}},minDetectionConfidence:{type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"facelandmarkfrontgpu__facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}},minTrackingConfidence:{type:1,graphOptionXref:{calculatorType:"ThresholdingCalculator",calculatorName:"facelandmarkfrontgpu__facelandmarkgpu__ThresholdingCalculator",fieldName:"threshold"}},cameraNear:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"near"}},cameraFar:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"far"}},cameraVerticalFovDegrees:{type:1,graphOptionXref:{calculatorType:"FaceGeometryEnvGeneratorCalculator",fieldName:"vertical_fov_degrees"}}}},zn=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],Gn=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],hs=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],oo=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],Os=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],Ds=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],Zr=[].concat(u(zn),u(Gn),u(hs),u(oo),u(Os),u(Ds));function io(v){v=v||{},v=Object.assign(Object.assign({},so),v),this.g=new Wn(v)}n=io.prototype,n.close=function(){return this.g.close(),Promise.resolve()},n.onResults=function(v){this.g.onResults(v)},n.initialize=function(){return Gt(this,function v(){var S=this;return ie(v,function(k){return P(k,S.g.initialize(),0)})})},n.reset=function(){this.g.reset()},n.send=function(v){return Gt(this,function S(){var k=this;return ie(S,function(W){return P(W,k.g.send(v),0)})})},n.setOptions=function(v){this.g.setOptions(v)},Ae("FACE_GEOMETRY",{Layout:{COLUMN_MAJOR:0,ROW_MAJOR:1,0:"COLUMN_MAJOR",1:"ROW_MAJOR"},PrimitiveType:{TRIANGLE:0,0:"TRIANGLE"},VertexType:{VERTEX_PT:0,0:"VERTEX_PT"},DEFAULT_CAMERA_PARAMS:{verticalFovDegrees:63,near:1,far:1e4}}),Ae("FaceMesh",io),Ae("FACEMESH_LIPS",zn),Ae("FACEMESH_LEFT_EYE",Gn),Ae("FACEMESH_LEFT_EYEBROW",hs),Ae("FACEMESH_LEFT_IRIS",[[474,475],[475,476],[476,477],[477,474]]),Ae("FACEMESH_RIGHT_EYE",oo),Ae("FACEMESH_RIGHT_EYEBROW",Os),Ae("FACEMESH_RIGHT_IRIS",[[469,470],[470,471],[471,472],[472,469]]),Ae("FACEMESH_FACE_OVAL",Ds),Ae("FACEMESH_CONTOURS",Zr),Ae("FACEMESH_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]]),Ae("matrixDataToMatrix",function(v){for(var S=v.getCols(),k=v.getRows(),W=v.getPackedDataList(),ee=[],he=0;he<k;he++)ee.push(Array(S));for(he=0;he<k;he++)for(var se=0;se<S;se++){var de=v.getLayout()===1?he*S+se:se*k+he;ee[he][se]=W[de]}return ee}),Ae("VERSION","0.4.1633559619")}).call(Pr);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const a0=1e-7,u0=1e-4;class c0{constructor(e,t){this.backend=e,this.dataMover=t,this.data=new WeakMap,this.dataIdsCount=0}get(e){return this.data.has(e)||this.dataMover.moveData(this.backend,e),this.data.get(e)}set(e,t){this.dataIdsCount++,this.data.set(e,t)}has(e){return this.data.has(e)}delete(e){return this.dataIdsCount--,this.data.delete(e)}numDataIds(){return this.dataIdsCount}}class pf{refCount(e){return Kn("refCount")}incRef(e){return Kn("incRef")}timerAvailable(){return!0}time(e){return Kn("time")}read(e){return Kn("read")}readSync(e){return Kn("readSync")}readToGPU(e,t){return Kn("readToGPU")}numDataIds(){return Kn("numDataIds")}disposeData(e,t){return Kn("disposeData")}write(e,t,r){return Kn("write")}move(e,t,r,s,o){return Kn("move")}memory(){return Kn("memory")}floatPrecision(){return Kn("floatPrecision")}epsilon(){return this.floatPrecision()===32?a0:u0}dispose(){return Kn("dispose")}}function Kn(n){throw new Error(`'${n}' not yet implemented or not found in the registry. This kernel may not be supported by the tfjs backend you have chosen`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fa(n,e,t){return Math.max(n,Math.min(e,t))}function jc(n){return n%2===0?n:n+1}function Li(n,e,t){const r=n[e];n[e]=n[t],n[t]=r}function l0(n){let e=0;for(let t=0;t<n.length;t++)e+=n[t];return e}function M(n,e){if(!n)throw new Error(typeof e=="string"?e:e())}function Qn(n,e,t=""){M(Bt(n,e),()=>t+` Shapes ${n} and ${e} must match`)}function bi(n){M(n!=null,()=>"The input to the tensor constructor must be a non-null value.")}function ui(n,e=[],t=!1){if(e==null&&(e=[]),Array.isArray(n)||ns(n)&&!t)for(let r=0;r<n.length;++r)ui(n[r],e,t);else e.push(n);return e}function Ce(n){if(n.length===0)return 1;let e=n[0];for(let t=1;t<n.length;t++)e*=n[t];return e}function Bt(n,e){if(n===e)return!0;if(n==null||e==null||n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function ci(n){return n%1===0}function Zu(n){const e=Math.ceil(Math.sqrt(n));return[e,Math.ceil(n/e)]}function si(n,e){return e<=n.length?n:n+" ".repeat(e-n.length)}function jl(n,e=s=>0,t,r=setTimeout){return new Promise((s,o)=>{let i=0;const a=()=>{if(n()){s();return}i++;const u=e(i);if(t!=null&&i>=t){o();return}r(a,u)};a()})}function h0(n,e){let t=1,r=-1;for(let o=0;o<n.length;++o)if(n[o]>=0)t*=n[o];else if(n[o]===-1){if(r!==-1)throw Error(`Shapes can only have 1 implicit size. Found -1 at dim ${r} and dim ${o}`);r=o}else if(n[o]<0)throw Error(`Shapes can not be < 0. Found ${n[o]} at dim ${o}`);if(r===-1){if(e>0&&e!==t)throw Error(`Size(${e}) must match the product of shape ${n}`);return n}if(t===0)throw Error(`Cannot infer the missing size in [${n}] when there are 0 elements`);if(e%t!==0)throw Error(`The implicit shape can't be a fractional number. Got ${e} / ${t}`);const s=n.slice();return s[r]=e/t,s}function Zt(n,e){const t=e.length;return n=n==null?e.map((r,s)=>s):[].concat(n),M(n.every(r=>r>=-t&&r<t),()=>`All values in axis param must be in range [-${t}, ${t}) but got axis ${n}`),M(n.every(r=>ci(r)),()=>`All values in axis param must be integers but got axis ${n}`),n.map(r=>r<0?t+r:r)}function Hs(n,e){const t=[],r=[],s=e!=null&&Array.isArray(e)&&e.length===0,o=e==null||s?null:Zt(e,n).sort();let i=0;for(let a=0;a<n.length;++a){if(o!=null){if(o[i]===a&&n[a]!==1)throw new Error(`Can't squeeze axis ${a} since its dim '${n[a]}' is not 1`);(o[i]==null||o[i]>a)&&n[a]===1&&(t.push(n[a]),r.push(a)),o[i]<=a&&i++}n[a]!==1&&(t.push(n[a]),r.push(a))}return{newShape:t,keptDims:r}}function vs(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else throw new Error(`Unknown data type ${n}`);return t}function _n(n,e){let t=null;if(n==null||n==="float32")t=new Float32Array(e);else if(n==="int32")t=new Int32Array(e);else if(n==="bool")t=new Uint8Array(e);else if(n==="string")t=new Array(e);else throw new Error(`Unknown data type ${n}`);return t}function f0(n,e){for(let t=0;t<n.length;t++){const r=n[t];if(isNaN(r)||!isFinite(r))throw Error(`A tensor of type ${e} being uploaded contains ${r}.`)}}function d0(n){return n==="bool"||n==="complex64"||n==="float32"||n==="int32"||n==="string"}function p0(n,e){return!(e==="complex64"||e==="float32"&&n!=="complex64"||e==="int32"&&n!=="float32"&&n!=="complex64"||e==="bool"&&n==="bool")}function ns(n){return n instanceof Float32Array||n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray}function Ju(n){if(n==="float32"||n==="int32")return 4;if(n==="complex64")return 8;if(n==="bool")return 1;throw new Error(`Unknown dtype ${n}`)}function m0(n){if(n==null)return 0;let e=0;return n.forEach(t=>e+=t.length),e}function Ja(n){return typeof n=="string"||n instanceof String}function g0(n){return typeof n=="boolean"}function y0(n){return typeof n=="number"}function eu(n){return Array.isArray(n)?eu(n[0]):n instanceof Float32Array?"float32":n instanceof Int32Array||n instanceof Uint8Array||n instanceof Uint8ClampedArray?"int32":y0(n)?"float32":Ja(n)?"string":g0(n)?"bool":"float32"}function Hl(n){return!!(n&&n.constructor&&n.call&&n.apply)}function ec(n,e){for(let t=e;t<n;++t)if(n%t===0)return t;return n}function rn(n){const e=n.length;if(e<2)return[];const t=new Array(e-1);t[e-2]=n[e-1];for(let r=e-3;r>=0;--r)t[r]=t[r+1]*n[r+1];return t}function mf(n,e,t,r=!1){const s=new Array;if(e.length===1){const o=e[0]*(r?2:1);for(let i=0;i<o;i++)s[i]=t[n+i]}else{const o=e[0],i=e.slice(1),a=i.reduce((u,c)=>u*c)*(r?2:1);for(let u=0;u<o;u++)s[u]=mf(n+u*a,i,t,r)}return s}function tc(n,e,t=!1){if(n.length===0)return e[0];const r=n.reduce((s,o)=>s*o)*(t?2:1);if(r===0)return[];if(r!==e.length)throw new Error(`[${n}] does not match the input size ${e.length}${t?" for a complex tensor":""}.`);return mf(0,n,e,t)}function gf(n,e){const t=zs(n,e);for(let r=0;r<t.length;r++)t[r]=1;return t}function zs(n,e){if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool")return new Uint8Array(n);throw new Error(`Unknown data type ${e}`)}function yf(n){n.forEach(e=>{M(Number.isInteger(e)&&e>=0,()=>`Tensor must have a shape comprised of positive integers but got shape [${n}].`)})}function nc(n,e,t){if(e===0)return 0;if(e===1)return n[0];let r=n[n.length-1];for(let s=0;s<n.length-1;++s)r+=t[s]*n[s];return r}function Hc(n,e,t){if(e===0)return[];if(e===1)return[n];const r=new Array(e);for(let s=0;s<r.length-1;++s)r[s]=Math.floor(n/t[s]),n-=r[s]*t[s];return r[r.length-1]=n,r}function li(n){return n&&n.then&&typeof n.then=="function"}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ql="tfjsflags";class x0{constructor(e){this.global=e,this.flags={},this.flagRegistry={},this.urlFlags={},this.getQueryParams=b0,this.populateURLFlags()}setPlatform(e,t){this.platform!=null&&(ue().getBool("IS_TEST")||ue().getBool("PROD")||console.warn(`Platform ${this.platformName} has already been set. Overwriting the platform with ${e}.`)),this.platformName=e,this.platform=t}registerFlag(e,t,r){if(this.flagRegistry[e]={evaluationFn:t,setHook:r},this.urlFlags[e]!=null){const s=this.urlFlags[e];ue().getBool("IS_TEST")||ue().getBool("PROD")||console.warn(`Setting feature override from URL ${e}: ${s}.`),this.set(e,s)}}async getAsync(e){return e in this.flags?this.flags[e]:(this.flags[e]=await this.evaluateFlag(e),this.flags[e])}get(e){if(e in this.flags)return this.flags[e];const t=this.evaluateFlag(e);if(li(t))throw new Error(`Flag ${e} cannot be synchronously evaluated. Please use getAsync() instead.`);return this.flags[e]=t,this.flags[e]}getNumber(e){return this.get(e)}getBool(e){return this.get(e)}getFlags(){return this.flags}get features(){return this.flags}set(e,t){if(this.flagRegistry[e]==null)throw new Error(`Cannot set flag ${e} as it has not been registered.`);this.flags[e]=t,this.flagRegistry[e].setHook!=null&&this.flagRegistry[e].setHook(t)}evaluateFlag(e){if(this.flagRegistry[e]==null)throw new Error(`Cannot evaluate flag '${e}': no evaluation function found.`);return this.flagRegistry[e].evaluationFn()}setFlags(e){this.flags=Object.assign({},e)}reset(){this.flags={},this.urlFlags={},this.populateURLFlags()}populateURLFlags(){if(typeof this.global>"u"||typeof this.global.location>"u"||typeof this.global.location.search>"u")return;const e=this.getQueryParams(this.global.location.search);ql in e&&e[ql].split(",").forEach(r=>{const[s,o]=r.split(":");this.urlFlags[s]=w0(s,o)})}}function b0(n){const e={};return n.replace(/[?&]([^=?&]+)(?:=([^&]*))?/g,(t,...r)=>(v0(e,r[0],r[1]),r.join("="))),e}function v0(n,e,t){n[decodeURIComponent(e)]=decodeURIComponent(t||"")}function w0(n,e){if(e=e.toLowerCase(),e==="true"||e==="false")return e==="true";if(`${+e}`===e)return+e;throw new Error(`Could not parse value flag value ${e} for flag ${n}.`)}function ue(){return xf}let xf=null;function C0(n){xf=n}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let Iu;function bf(){if(Iu==null){let n;if(typeof window<"u")n=window;else if(typeof global<"u")n=global;else if(typeof process<"u")n=process;else if(typeof self<"u")n=self;else throw new Error("Could not find a global object");Iu=n}return Iu}function T0(){const n=bf();return n._tfGlobals==null&&(n._tfGlobals=new Map),n._tfGlobals}function qc(n,e){const t=T0();if(t.has(n))return t.get(n);{const r=e();return t.set(n,r),t.get(n)}}const vf="Abs",wf="Acos",Cf="Acosh",Xc="Add",Tf="AddN",$f="All",Sf="Any",Nf="ArgMax",Ef="ArgMin",kf="Asin",If="Asinh",_f="Atan",Rf="Atanh",Af="Atan2",Of="AvgPool",$0="AvgPoolGrad",Df="AvgPool3D",S0="AvgPool3DGrad",Ff="BatchMatMul",Pf="BatchToSpaceND",Lf="Bincount",Bf="BroadcastArgs",Kc="Cast",Mf="Ceil",Vf="ClipByValue",Uf="Complex",Wf="ComplexAbs",zf="Concat",Gf="Conv2D",jf="Conv2DBackpropFilter",Hf="Conv2DBackpropInput",qf="Conv3D",N0="Conv3DBackpropFilterV2",Xf="Conv3DBackpropInputV2",Kf="Cos",Yf="Cosh",Qf="Cumprod",Zf="Cumsum",Jf="CropAndResize",ed="DenseBincount",td="DepthToSpace",nd="DepthwiseConv2dNative",rd="DepthwiseConv2dNativeBackpropFilter",sd="DepthwiseConv2dNativeBackpropInput",od="Diag",id="Dilation2D",ad="RealDiv",ud="Einsum",cd="Elu",E0="EluGrad",ld="Erf",hd="Equal",fd="Exp",dd="ExpandDims",pd="Expm1",md="FFT",gd="Fill",yd="FlipLeftRight",xd="Floor",bd="FloorDiv",vd="FusedBatchNorm",wd="GatherV2",Cd="GatherNd",Td="Greater",$d="GreaterEqual",Yc="Identity",Sd="IFFT",Nd="Imag",Ed="IsFinite",kd="IsInf",Id="IsNan",_d="LeakyRelu",Rd="Less",Ad="LessEqual",Od="LinSpace",Dd="Log",Fd="Log1p",Pd="LogicalAnd",Ld="LogicalNot",Bd="LogicalOr",Md="LRN",k0="LRNGrad",Vd="Max",Ud="Maximum",Wd="MaxPool",I0="MaxPoolGrad",zd="MaxPool3D",_0="MaxPool3DGrad",Gd="MaxPoolWithArgmax",jd="Mean",Hd="Min",qd="Minimum",Xd="MirrorPad",Kd="Mod",Yd="Multinomial",Qd="Multiply",Zd="Neg",Jd="NotEqual",ep="NonMaxSuppressionV3",tp="NonMaxSuppressionV4",np="NonMaxSuppressionV5",rp="OnesLike",sp="OneHot",op="Pack",ip="PadV2",ap="Pow",up="Prelu",cp="Prod",lp="RaggedGather",hp="RaggedTensorToTensor",fp="Range",dp="Real",pp="Reciprocal",mp="Relu",gp="Reshape",yp="ResizeNearestNeighbor",R0="ResizeNearestNeighborGrad",xp="ResizeBilinear",A0="ResizeBilinearGrad",bp="Relu6",vp="Reverse",wp="Round",Cp="Rsqrt",Tp="ScatterNd",$p="SearchSorted",Sp="Select",Np="Selu",Ep="Slice",kp="Sin",Ip="Sinh",_p="Sign",Rp="Sigmoid",Ap="Softplus",Op="Sqrt",Dp="Sum",Fp="SpaceToBatchND",Pp="SplitV",Lp="Softmax",Bp="SparseFillEmptyRows",Mp="SparseReshape",Vp="SparseSegmentMean",Up="SparseSegmentSum",Wp="SparseToDense",zp="SquaredDifference",O0="Square",Gp="StridedSlice",jp="StringNGrams",Hp="StringSplit",qp="StringToHashBucketFast",Xp="Sub",Kp="Tan",Yp="Tanh",Qc="Tile",Qp="TopK",Zp="Transform",_a="Transpose",Jp="Unique",e1="Unpack",t1="UnsortedSegmentSum",n1="ZerosLike",r1="Step",rc="FromPixels",s1="RotateWithOffset",sc="_FusedMatMul",oc="FusedConv2D",ic="FusedDepthwiseConv2D";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fr(...n){ue().getBool("IS_TEST")||ue().getBool("PROD")||console.warn(...n)}function D0(...n){ue().getBool("IS_TEST")||ue().getBool("PROD")||console.log(...n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pa=qc("kernelRegistry",()=>new Map),F0=qc("gradRegistry",()=>new Map);function ac(n,e){const t=o1(n,e);return Pa.get(t)}function Xl(n){return F0.get(n)}function Kl(n){const e=Pa.entries(),t=[];for(;;){const{done:r,value:s}=e.next();if(r)break;const[o,i]=s,[a]=o.split("_");a===n&&t.push(i)}return t}function P0(n){const{kernelName:e,backendName:t}=n,r=o1(e,t);Pa.has(r)&&Fr(`The kernel '${e}' for backend '${t}' is already registered`),Pa.set(r,n)}function o1(n,e){return`${e}_${n}`}var uc=St,fr=null;try{fr=new WebAssembly.Instance(new WebAssembly.Module(new Uint8Array([0,97,115,109,1,0,0,0,1,13,2,96,0,1,127,96,4,127,127,127,127,1,127,3,7,6,0,1,1,1,1,1,6,6,1,127,1,65,0,11,7,50,6,3,109,117,108,0,1,5,100,105,118,95,115,0,2,5,100,105,118,95,117,0,3,5,114,101,109,95,115,0,4,5,114,101,109,95,117,0,5,8,103,101,116,95,104,105,103,104,0,0,10,191,1,6,4,0,35,0,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,126,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,127,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,128,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,129,34,4,66,32,135,167,36,0,32,4,167,11,36,1,1,126,32,0,173,32,1,173,66,32,134,132,32,2,173,32,3,173,66,32,134,132,130,34,4,66,32,135,167,36,0,32,4,167,11])),{}).exports}catch{}function St(n,e,t){this.low=n|0,this.high=e|0,this.unsigned=!!t}St.prototype.__isLong__;Object.defineProperty(St.prototype,"__isLong__",{value:!0});function Bn(n){return(n&&n.__isLong__)===!0}St.isLong=Bn;var Yl={},Ql={};function Oo(n,e){var t,r,s;return e?(n>>>=0,(s=0<=n&&n<256)&&(r=Ql[n],r)?r:(t=Nt(n,(n|0)<0?-1:0,!0),s&&(Ql[n]=t),t)):(n|=0,(s=-128<=n&&n<128)&&(r=Yl[n],r)?r:(t=Nt(n,n<0?-1:0,!1),s&&(Yl[n]=t),t))}St.fromInt=Oo;function dr(n,e){if(isNaN(n))return e?bo:pr;if(e){if(n<0)return bo;if(n>=i1)return c1}else{if(n<=-Jl)return Fn;if(n+1>=Jl)return u1}return n<0?dr(-n,e).neg():Nt(n%hi|0,n/hi|0,e)}St.fromNumber=dr;function Nt(n,e,t){return new St(n,e,t)}St.fromBits=Nt;var La=Math.pow;function Zc(n,e,t){if(n.length===0)throw Error("empty string");if(n==="NaN"||n==="Infinity"||n==="+Infinity"||n==="-Infinity")return pr;if(typeof e=="number"?(t=e,e=!1):e=!!e,t=t||10,t<2||36<t)throw RangeError("radix");var r;if((r=n.indexOf("-"))>0)throw Error("interior hyphen");if(r===0)return Zc(n.substring(1),e,t).neg();for(var s=dr(La(t,8)),o=pr,i=0;i<n.length;i+=8){var a=Math.min(8,n.length-i),u=parseInt(n.substring(i,i+a),t);if(a<8){var c=dr(La(t,a));o=o.mul(c).add(dr(u))}else o=o.mul(s),o=o.add(dr(u))}return o.unsigned=e,o}St.fromString=Zc;function Mr(n,e){return typeof n=="number"?dr(n,e):typeof n=="string"?Zc(n,e):Nt(n.low,n.high,typeof e=="boolean"?e:n.unsigned)}St.fromValue=Mr;var Zl=1<<16,L0=1<<24,hi=Zl*Zl,i1=hi*hi,Jl=i1/2,eh=Oo(L0),pr=Oo(0);St.ZERO=pr;var bo=Oo(0,!0);St.UZERO=bo;var ri=Oo(1);St.ONE=ri;var a1=Oo(1,!0);St.UONE=a1;var cc=Oo(-1);St.NEG_ONE=cc;var u1=Nt(-1,2147483647,!1);St.MAX_VALUE=u1;var c1=Nt(-1,-1,!0);St.MAX_UNSIGNED_VALUE=c1;var Fn=Nt(0,-2147483648,!1);St.MIN_VALUE=Fn;var Ne=St.prototype;Ne.toInt=function(){return this.unsigned?this.low>>>0:this.low};Ne.toNumber=function(){return this.unsigned?(this.high>>>0)*hi+(this.low>>>0):this.high*hi+(this.low>>>0)};Ne.toString=function(e){if(e=e||10,e<2||36<e)throw RangeError("radix");if(this.isZero())return"0";if(this.isNegative())if(this.eq(Fn)){var t=dr(e),r=this.div(t),s=r.mul(t).sub(this);return r.toString(e)+s.toInt().toString(e)}else return"-"+this.neg().toString(e);for(var o=dr(La(e,6),this.unsigned),i=this,a="";;){var u=i.div(o),c=i.sub(u.mul(o)).toInt()>>>0,l=c.toString(e);if(i=u,i.isZero())return l+a;for(;l.length<6;)l="0"+l;a=""+l+a}};Ne.getHighBits=function(){return this.high};Ne.getHighBitsUnsigned=function(){return this.high>>>0};Ne.getLowBits=function(){return this.low};Ne.getLowBitsUnsigned=function(){return this.low>>>0};Ne.getNumBitsAbs=function(){if(this.isNegative())return this.eq(Fn)?64:this.neg().getNumBitsAbs();for(var e=this.high!=0?this.high:this.low,t=31;t>0&&(e&1<<t)==0;t--);return this.high!=0?t+33:t+1};Ne.isZero=function(){return this.high===0&&this.low===0};Ne.eqz=Ne.isZero;Ne.isNegative=function(){return!this.unsigned&&this.high<0};Ne.isPositive=function(){return this.unsigned||this.high>=0};Ne.isOdd=function(){return(this.low&1)===1};Ne.isEven=function(){return(this.low&1)===0};Ne.equals=function(e){return Bn(e)||(e=Mr(e)),this.unsigned!==e.unsigned&&this.high>>>31===1&&e.high>>>31===1?!1:this.high===e.high&&this.low===e.low};Ne.eq=Ne.equals;Ne.notEquals=function(e){return!this.eq(e)};Ne.neq=Ne.notEquals;Ne.ne=Ne.notEquals;Ne.lessThan=function(e){return this.comp(e)<0};Ne.lt=Ne.lessThan;Ne.lessThanOrEqual=function(e){return this.comp(e)<=0};Ne.lte=Ne.lessThanOrEqual;Ne.le=Ne.lessThanOrEqual;Ne.greaterThan=function(e){return this.comp(e)>0};Ne.gt=Ne.greaterThan;Ne.greaterThanOrEqual=function(e){return this.comp(e)>=0};Ne.gte=Ne.greaterThanOrEqual;Ne.ge=Ne.greaterThanOrEqual;Ne.compare=function(e){if(Bn(e)||(e=Mr(e)),this.eq(e))return 0;var t=this.isNegative(),r=e.isNegative();return t&&!r?-1:!t&&r?1:this.unsigned?e.high>>>0>this.high>>>0||e.high===this.high&&e.low>>>0>this.low>>>0?-1:1:this.sub(e).isNegative()?-1:1};Ne.comp=Ne.compare;Ne.negate=function(){return!this.unsigned&&this.eq(Fn)?Fn:this.not().add(ri)};Ne.neg=Ne.negate;Ne.add=function(e){Bn(e)||(e=Mr(e));var t=this.high>>>16,r=this.high&65535,s=this.low>>>16,o=this.low&65535,i=e.high>>>16,a=e.high&65535,u=e.low>>>16,c=e.low&65535,l=0,h=0,d=0,m=0;return m+=o+c,d+=m>>>16,m&=65535,d+=s+u,h+=d>>>16,d&=65535,h+=r+a,l+=h>>>16,h&=65535,l+=t+i,l&=65535,Nt(d<<16|m,l<<16|h,this.unsigned)};Ne.subtract=function(e){return Bn(e)||(e=Mr(e)),this.add(e.neg())};Ne.sub=Ne.subtract;Ne.multiply=function(e){if(this.isZero())return pr;if(Bn(e)||(e=Mr(e)),fr){var t=fr.mul(this.low,this.high,e.low,e.high);return Nt(t,fr.get_high(),this.unsigned)}if(e.isZero())return pr;if(this.eq(Fn))return e.isOdd()?Fn:pr;if(e.eq(Fn))return this.isOdd()?Fn:pr;if(this.isNegative())return e.isNegative()?this.neg().mul(e.neg()):this.neg().mul(e).neg();if(e.isNegative())return this.mul(e.neg()).neg();if(this.lt(eh)&&e.lt(eh))return dr(this.toNumber()*e.toNumber(),this.unsigned);var r=this.high>>>16,s=this.high&65535,o=this.low>>>16,i=this.low&65535,a=e.high>>>16,u=e.high&65535,c=e.low>>>16,l=e.low&65535,h=0,d=0,m=0,g=0;return g+=i*l,m+=g>>>16,g&=65535,m+=o*l,d+=m>>>16,m&=65535,m+=i*c,d+=m>>>16,m&=65535,d+=s*l,h+=d>>>16,d&=65535,d+=o*c,h+=d>>>16,d&=65535,d+=i*u,h+=d>>>16,d&=65535,h+=r*l+s*c+o*u+i*a,h&=65535,Nt(m<<16|g,h<<16|d,this.unsigned)};Ne.mul=Ne.multiply;Ne.divide=function(e){if(Bn(e)||(e=Mr(e)),e.isZero())throw Error("division by zero");if(fr){if(!this.unsigned&&this.high===-2147483648&&e.low===-1&&e.high===-1)return this;var t=(this.unsigned?fr.div_u:fr.div_s)(this.low,this.high,e.low,e.high);return Nt(t,fr.get_high(),this.unsigned)}if(this.isZero())return this.unsigned?bo:pr;var r,s,o;if(this.unsigned){if(e.unsigned||(e=e.toUnsigned()),e.gt(this))return bo;if(e.gt(this.shru(1)))return a1;o=bo}else{if(this.eq(Fn)){if(e.eq(ri)||e.eq(cc))return Fn;if(e.eq(Fn))return ri;var i=this.shr(1);return r=i.div(e).shl(1),r.eq(pr)?e.isNegative()?ri:cc:(s=this.sub(e.mul(r)),o=r.add(s.div(e)),o)}else if(e.eq(Fn))return this.unsigned?bo:pr;if(this.isNegative())return e.isNegative()?this.neg().div(e.neg()):this.neg().div(e).neg();if(e.isNegative())return this.div(e.neg()).neg();o=pr}for(s=this;s.gte(e);){r=Math.max(1,Math.floor(s.toNumber()/e.toNumber()));for(var a=Math.ceil(Math.log(r)/Math.LN2),u=a<=48?1:La(2,a-48),c=dr(r),l=c.mul(e);l.isNegative()||l.gt(s);)r-=u,c=dr(r,this.unsigned),l=c.mul(e);c.isZero()&&(c=ri),o=o.add(c),s=s.sub(l)}return o};Ne.div=Ne.divide;Ne.modulo=function(e){if(Bn(e)||(e=Mr(e)),fr){var t=(this.unsigned?fr.rem_u:fr.rem_s)(this.low,this.high,e.low,e.high);return Nt(t,fr.get_high(),this.unsigned)}return this.sub(this.div(e).mul(e))};Ne.mod=Ne.modulo;Ne.rem=Ne.modulo;Ne.not=function(){return Nt(~this.low,~this.high,this.unsigned)};Ne.and=function(e){return Bn(e)||(e=Mr(e)),Nt(this.low&e.low,this.high&e.high,this.unsigned)};Ne.or=function(e){return Bn(e)||(e=Mr(e)),Nt(this.low|e.low,this.high|e.high,this.unsigned)};Ne.xor=function(e){return Bn(e)||(e=Mr(e)),Nt(this.low^e.low,this.high^e.high,this.unsigned)};Ne.shiftLeft=function(e){return Bn(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Nt(this.low<<e,this.high<<e|this.low>>>32-e,this.unsigned):Nt(0,this.low<<e-32,this.unsigned)};Ne.shl=Ne.shiftLeft;Ne.shiftRight=function(e){return Bn(e)&&(e=e.toInt()),(e&=63)===0?this:e<32?Nt(this.low>>>e|this.high<<32-e,this.high>>e,this.unsigned):Nt(this.high>>e-32,this.high>=0?0:-1,this.unsigned)};Ne.shr=Ne.shiftRight;Ne.shiftRightUnsigned=function(e){if(Bn(e)&&(e=e.toInt()),e&=63,e===0)return this;var t=this.high;if(e<32){var r=this.low;return Nt(r>>>e|t<<32-e,t>>>e,this.unsigned)}else return e===32?Nt(t,0,this.unsigned):Nt(t>>>e-32,0,this.unsigned)};Ne.shru=Ne.shiftRightUnsigned;Ne.shr_u=Ne.shiftRightUnsigned;Ne.toSigned=function(){return this.unsigned?Nt(this.low,this.high,!1):this};Ne.toUnsigned=function(){return this.unsigned?this:Nt(this.low,this.high,!0)};Ne.toBytes=function(e){return e?this.toBytesLE():this.toBytesBE()};Ne.toBytesLE=function(){var e=this.high,t=this.low;return[t&255,t>>>8&255,t>>>16&255,t>>>24,e&255,e>>>8&255,e>>>16&255,e>>>24]};Ne.toBytesBE=function(){var e=this.high,t=this.low;return[e>>>24,e>>>16&255,e>>>8&255,e&255,t>>>24,t>>>16&255,t>>>8&255,t&255]};St.fromBytes=function(e,t,r){return r?St.fromBytesLE(e,t):St.fromBytesBE(e,t)};St.fromBytesLE=function(e,t){return new St(e[0]|e[1]<<8|e[2]<<16|e[3]<<24,e[4]|e[5]<<8|e[6]<<16|e[7]<<24,t)};St.fromBytesBE=function(e,t){return new St(e[4]<<24|e[5]<<16|e[6]<<8|e[7],e[0]<<24|e[1]<<16|e[2]<<8|e[3],t)};const B0=s0({__proto__:null,default:uc},[uc]);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yo=uc||B0;function tu(n){return yo.fromString(n,!0,16)}const l1=tu("c3a5c85c97cb3127"),go=tu("b492b66fbe98f273"),vn=tu("9ae16a3b2f90404f");function lc(n){return n.xor(n.shru(47))}function h1(n,e,t){const r=n.slice(e,e+t);return yo.fromBytes(Array.from(r),!0,!0)}function wt(n,e){return h1(n,e,8)}function th(n,e){return h1(n,e,4)}function Qt(n,e){return e===0?n:n.shru(e).or(n.shl(64-e))}function Vs(n,e,t=tu("9ddfea08eb382d69")){let r=n.xor(e).mul(t);r=r.xor(r.shru(47));let s=e.xor(r).mul(t);return s=s.xor(s.shru(47)),s=s.mul(t),s}function M0(n,e,t,r,s,o){s=s.add(n),o=Qt(o.add(s).add(r),21);const i=s;return s=s.add(e),s=s.add(t),o=o.add(Qt(s,44)),[s.add(r),o.add(i)]}function wa(n,e,t,r){return M0(wt(n,e),wt(n,e+8),wt(n,e+16),wt(n,e+24),t,r)}function V0(n,e=n.length){if(e>=8){const t=vn.add(e*2),r=wt(n,0).add(vn),s=wt(n,e-8),o=Qt(s,37).mul(t).add(r),i=Qt(r,25).add(s).mul(t);return Vs(o,i,t)}if(e>=4){const t=vn.add(e*2),r=th(n,0);return Vs(r.shl(3).add(e),th(n,e-4),t)}if(e>0){const t=n[0],r=n[e>>1],s=n[e-1],o=t+(r<<8),i=e+(s<<2);return lc(vn.mul(o).xor(l1.mul(i))).mul(vn)}return vn}function U0(n,e=n.length){const t=vn.add(e*2),r=wt(n,0).mul(go),s=wt(n,8),o=wt(n,e-8).mul(t),i=wt(n,e-16).mul(vn);return Vs(Qt(r.add(s),43).add(Qt(o,30)).add(i),r.add(Qt(s.add(vn),18)).add(o),t)}function W0(n,e=n.length){const t=vn.add(e*2),r=wt(n,0).mul(vn),s=wt(n,8),o=wt(n,e-8).mul(t),i=wt(n,e-16).mul(vn),a=Qt(r.add(s),43).add(Qt(o,30)).add(i),u=Vs(a,r.add(Qt(s.add(vn),18)).add(o),t),c=wt(n,16).mul(t),l=wt(n,24),h=a.add(wt(n,e-32)).mul(t),d=u.add(wt(n,e-24)).mul(t);return Vs(Qt(c.add(l),43).add(Qt(h,30)).add(d),c.add(Qt(l.add(r),18)).add(h),t)}function z0(n,e=n.length){const t=yo.fromNumber(81,!0);if(e<=32)return e<=16?V0(n,e):U0(n,e);if(e<=64)return W0(n,e);let r=t,s=t.mul(go).add(113),o=lc(s.mul(vn).add(113)).mul(vn),i=[yo.UZERO,yo.UZERO],a=[yo.UZERO,yo.UZERO];r=r.mul(vn).add(wt(n,0));let u=0;const c=(e-1>>6)*64,l=c+(e-1&63)-63;do r=Qt(r.add(s).add(i[0]).add(wt(n,u+8)),37).mul(go),s=Qt(s.add(i[1]).add(wt(n,u+48)),42).mul(go),r=r.xor(a[1]),s=s.add(i[0]).add(wt(n,u+40)),o=Qt(o.add(a[0]),33).mul(go),i=wa(n,u,i[1].mul(go),r.add(a[0])),a=wa(n,u+32,o.add(a[1]),s.add(wt(n,u+16))),[o,r]=[r,o],u+=64;while(u!==c);const h=go.add(o.and(255).shl(1));return u=l,a[0]=a[0].add(e-1&63),i[0]=i[0].add(a[0]),a[0]=a[0].add(i[0]),r=Qt(r.add(s).add(i[0]).add(wt(n,u+8)),37).mul(h),s=Qt(s.add(i[1]).add(wt(n,u+48)),42).mul(h),r=r.xor(a[1].mul(9)),s=s.add(i[0].mul(9).add(wt(n,u+40))),o=Qt(o.add(a[0]),33).mul(h),i=wa(n,u,i[1].mul(h),r.add(a[0])),a=wa(n,u+32,o.add(a[1]),s.add(wt(n,u+16))),[o,r]=[r,o],Vs(Vs(i[0],a[0],h).add(lc(s).mul(l1)).add(o),Vs(i[1],a[1],h).add(r),h)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vi(n,e){return e==="string"?To(n):nu([n],e)}function G0(n,e){return n instanceof Float32Array&&e==="float32"||n instanceof Int32Array&&e==="int32"||n instanceof Uint8Array&&e==="bool"}function nu(n,e){if(e==="string")throw new Error("Cannot convert a string[] to a TypedArray");if(Array.isArray(n)&&(n=ui(n)),ue().getBool("DEBUG")&&f0(n,e),G0(n,e))return n;if(e==null||e==="float32"||e==="complex64")return new Float32Array(n);if(e==="int32")return new Int32Array(n);if(e==="bool"){const t=new Uint8Array(n.length);for(let r=0;r<t.length;++r)Math.round(n[r])!==0&&(t[r]=1);return t}else throw new Error(`Unknown data type ${e}`)}function Rr(){return ue().platform.now()}function To(n,e="utf-8"){return e=e||"utf-8",ue().platform.encode(n,e)}function fi(n,e="utf-8"){return e=e||"utf-8",ue().platform.decode(n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j0{constructor(e,t){this.backendTimer=e,this.logger=t,t==null&&(this.logger=new q0)}profileKernel(e,t,r){let s;const o=()=>{s=r()};let i;const a=Rr();if(this.backendTimer.timerAvailable())i=this.backendTimer.time(o);else{o();for(const c of s)c.dataSync();i=Promise.resolve({kernelMs:Rr()-a})}if(ue().getBool("CHECK_COMPUTATION_FOR_ERRORS"))for(let c=0;c<s.length;c++){const l=s[c];l.data().then(h=>{H0(h,l.dtype,e)})}return{kernelName:e,outputs:s,inputs:t,timeMs:i.then(c=>c.kernelMs),extraInfo:i.then(c=>c.getExtraProfileInfo!=null?c.getExtraProfileInfo():"")}}logKernelProfile(e){const{kernelName:t,outputs:r,timeMs:s,inputs:o,extraInfo:i}=e;r.forEach(a=>{Promise.all([a.data(),s,i]).then(u=>{this.logger.logKernelProfile(t,a,u[0],u[1],o,u[2])})})}}function H0(n,e,t){if(e!=="float32")return!1;for(let r=0;r<n.length;r++){const s=n[r];if(isNaN(s)||!isFinite(s))return console.warn(`Found ${s} in the result of '${t}'`),!0}return!1}class q0{logKernelProfile(e,t,r,s,o,i){const a=typeof s=="number"?si(`${s}ms`,9):s.error,u=si(e,25),c=t.rank,l=t.size,h=si(t.shape.toString(),14);let d="";for(const m in o){const g=o[m];if(g!=null){const C=g.shape||t.shape,$=C.length;d+=`${m}: ${$}D ${$>0?C:""} `}}console.log(`%c${u}	%c${a}	%c${c}D ${h}	%c${l}	%c${d}	%c${i}`,"font-weight:bold","color:red","color:blue","color: orange","color: green","color: steelblue")}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X0(n,e,t){const r={},s={};for(let u=0;u<e.length;u++)r[e[u].id]=!0;for(let u=0;u<n.length;u++){const c=n[u],l=c.inputs;for(const h in l){const d=l[h];let m=!1;for(let g=0;g<e.length;g++)if(r[d.id]){c.outputs.forEach(C=>r[C.id]=!0),m=!0,s[c.id]=!0;break}if(m)break}}const o={};o[t.id]=!0;const i={};for(let u=n.length-1;u>=0;u--){const c=n[u],l=c.inputs;for(let h=0;h<c.outputs.length;h++)if(o[c.outputs[h].id]){for(const d in l)o[l[d].id]=!0,i[c.id]=!0;break}}const a=[];for(let u=0;u<n.length;u++){const c=n[u];if(s[c.id]&&i[c.id]){const l={};for(const d in c.inputs){const m=c.inputs[d];r[m.id]&&(l[d]=m)}const h=Object.assign({},c);h.inputs=l,h.outputs=c.outputs,a.push(h)}}return a}function K0(n,e,t,r){for(let s=e.length-1;s>=0;s--){const o=e[s],i=[];if(o.outputs.forEach(u=>{const c=n[u.id];c!=null?i.push(c):i.push(null)}),o.gradient==null)throw new Error(`Cannot compute gradient: gradient function not found for ${o.kernelName}.`);const a=o.gradient(i);for(const u in o.inputs){if(!(u in a))throw new Error(`Cannot backprop through input ${u}. Available gradients found: ${Object.keys(a)}.`);const c=t(()=>a[u]());if(c.dtype!=="float32")throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input ${u} must have 'float32' dtype, but has '${c.dtype}'`);const l=o.inputs[u];if(!Bt(c.shape,l.shape))throw new Error(`Error in gradient for op ${o.kernelName}. The gradient of input '${u}' has shape '${c.shape}', which does not match the shape of the input '${l.shape}'`);if(n[l.id]==null)n[l.id]=c;else{const h=n[l.id];n[l.id]=r(h,c),h.dispose()}}}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nh=20,Bi=3,_u=7;function Y0(n,e,t,r){const s=rn(e),o=Q0(n,e,t,s),i=e.length,a=Ra(n,e,t,s,o),u=["Tensor"];return r&&(u.push(`  dtype: ${t}`),u.push(`  rank: ${i}`),u.push(`  shape: [${e}]`),u.push("  values:")),u.push(a.map(c=>"    "+c).join(`
`)),u.join(`
`)}function Q0(n,e,t,r){const s=Ce(e),o=r[r.length-1],i=new Array(o).fill(0),a=e.length,u=t==="complex64"?Ui(n):n;if(a>1)for(let c=0;c<s/o;c++){const l=c*o;for(let h=0;h<o;h++)i[h]=Math.max(i[h],Vi(u[l+h],0,t).length)}return i}function Vi(n,e,t){let r;return Array.isArray(n)?r=`${parseFloat(n[0].toFixed(_u))} + ${parseFloat(n[1].toFixed(_u))}j`:Ja(n)?r=`'${n}'`:t==="bool"?r=f1(n):r=parseFloat(n.toFixed(_u)).toString(),si(r,e)}function f1(n){return n===0?"false":"true"}function Ra(n,e,t,r,s,o=!0){const i=t==="complex64"?2:1,a=e[0],u=e.length;if(u===0){if(t==="complex64"){const C=Ui(n);return[Vi(C[0],0,t)]}return t==="bool"?[f1(n[0])]:[n[0].toString()]}if(u===1){if(a>nh){const $=Bi*i;let T=Array.from(n.slice(0,$)),A=Array.from(n.slice((a-Bi)*i,a*i));return t==="complex64"&&(T=Ui(T),A=Ui(A)),["["+T.map((P,B)=>Vi(P,s[B],t)).join(", ")+", ..., "+A.map((P,B)=>Vi(P,s[a-Bi+B],t)).join(", ")+"]"]}return["["+(t==="complex64"?Ui(n):Array.from(n)).map(($,T)=>Vi($,s[T],t)).join(", ")+"]"]}const c=e.slice(1),l=r.slice(1),h=r[0]*i,d=[];if(a>nh){for(let C=0;C<Bi;C++){const $=C*h,T=$+h;d.push(...Ra(n.slice($,T),c,t,l,s,!1))}d.push("...");for(let C=a-Bi;C<a;C++){const $=C*h,T=$+h;d.push(...Ra(n.slice($,T),c,t,l,s,C===a-1))}}else for(let C=0;C<a;C++){const $=C*h,T=$+h;d.push(...Ra(n.slice($,T),c,t,l,s,C===a-1))}const m=u===2?",":"";d[0]="["+d[0]+m;for(let C=1;C<d.length-1;C++)d[C]=" "+d[C]+m;let g=`,
`;for(let C=2;C<u;C++)g+=`
`;return d[d.length-1]=" "+d[d.length-1]+"]"+(o?"":g),d}function Ui(n){const e=[];for(let t=0;t<n.length;t+=2)e.push([n[t],n[t+1]]);return e}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Hi{constructor(e,t,r){if(this.dtype=t,this.shape=e.slice(),this.size=Ce(e),r!=null){const s=r.length;M(s===this.size,()=>`Length of values '${s}' does not match the size inferred by the shape '${this.size}'.`)}if(t==="complex64")throw new Error("complex64 dtype TensorBuffers are not supported. Please create a TensorBuffer for the real and imaginary parts separately and call tf.complex(real, imag).");this.values=r||_n(t,this.size),this.strides=rn(e)}set(e,...t){t.length===0&&(t=[0]),M(t.length===this.rank,()=>`The number of provided coordinates (${t.length}) must match the rank (${this.rank})`);const r=this.locToIndex(t);this.values[r]=e}get(...e){e.length===0&&(e=[0]);let t=0;for(const s of e){if(s<0||s>=this.shape[t]){const o=`Requested out of range element at ${e}.   Buffer shape=${this.shape}`;throw new Error(o)}t++}let r=e[e.length-1];for(let s=0;s<e.length-1;++s)r+=this.strides[s]*e[s];return this.values[r]}locToIndex(e){if(this.rank===0)return 0;if(this.rank===1)return e[0];let t=e[e.length-1];for(let r=0;r<e.length-1;++r)t+=this.strides[r]*e[r];return t}indexToLoc(e){if(this.rank===0)return[];if(this.rank===1)return[e];const t=new Array(this.shape.length);for(let r=0;r<t.length-1;++r)t[r]=Math.floor(e/this.strides[r]),e-=t[r]*this.strides[r];return t[t.length-1]=e,t}get rank(){return this.shape.length}toTensor(){return Ar().makeTensor(this.values,this.shape,this.dtype)}}let Ar=null,ti=null;function Z0(n){Ar=n}function J0(n){ti=n}class Rt{constructor(e,t,r,s){this.kept=!1,this.isDisposedInternal=!1,this.shape=e.slice(),this.dtype=t||"float32",this.size=Ce(e),this.strides=rn(e),this.dataId=r,this.id=s,this.rankType=this.rank<5?this.rank.toString():"higher"}get rank(){return this.shape.length}async buffer(){const e=await this.data();return ti.buffer(this.shape,this.dtype,e)}bufferSync(){return ti.buffer(this.shape,this.dtype,this.dataSync())}async array(){const e=await this.data();return tc(this.shape,e,this.dtype==="complex64")}arraySync(){return tc(this.shape,this.dataSync(),this.dtype==="complex64")}async data(){this.throwIfDisposed();const e=Ar().read(this.dataId);if(this.dtype==="string"){const t=await e;try{return t.map(r=>fi(r))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}}return e}dataToGPU(e){return this.throwIfDisposed(),Ar().readToGPU(this.dataId,e)}dataSync(){this.throwIfDisposed();const e=Ar().readSync(this.dataId);if(this.dtype==="string")try{return e.map(t=>fi(t))}catch{throw new Error("Failed to decode the string bytes into utf-8. To get the original bytes, call tensor.bytes().")}return e}async bytes(){this.throwIfDisposed();const e=await Ar().read(this.dataId);return this.dtype==="string"?e:new Uint8Array(e.buffer)}dispose(){this.isDisposed||(Ar().disposeTensor(this),this.isDisposedInternal=!0)}get isDisposed(){return this.isDisposedInternal}throwIfDisposed(){if(this.isDisposed)throw new Error("Tensor is disposed.")}print(e=!1){return ti.print(this,e)}clone(){return this.throwIfDisposed(),ti.clone(this)}toString(e=!1){const t=this.dataSync();return Y0(t,this.shape,this.dtype,e)}cast(e){return this.throwIfDisposed(),ti.cast(this,e)}variable(e=!0,t,r){return this.throwIfDisposed(),Ar().makeVariable(this,e,t,r)}}Object.defineProperty(Rt,Symbol.hasInstance,{value:n=>!!n&&n.data!=null&&n.dataSync!=null&&n.throwIfDisposed!=null});function e3(){return qc("Tensor",()=>Rt)}e3();class hc extends Rt{constructor(e,t,r,s){super(e.shape,e.dtype,e.dataId,s),this.trainable=t,this.name=r}assign(e){if(e.dtype!==this.dtype)throw new Error(`dtype of the new value (${e.dtype}) and previous value (${this.dtype}) must match`);if(!Bt(e.shape,this.shape))throw new Error(`shape of the new value (${e.shape}) and previous value (${this.shape}) must match`);Ar().disposeTensor(this),this.dataId=e.dataId,Ar().incRef(this,null)}dispose(){Ar().disposeVariable(this),this.isDisposedInternal=!0}}Object.defineProperty(hc,Symbol.hasInstance,{value:n=>n instanceof Rt&&n.assign!=null&&n.assign instanceof Function});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var rh;(function(n){n.R0="R0",n.R1="R1",n.R2="R2",n.R3="R3",n.R4="R4",n.R5="R5",n.R6="R6"})(rh||(rh={}));var fc;(function(n){n.float32="float32",n.int32="int32",n.bool="int32",n.complex64="complex64"})(fc||(fc={}));var dc;(function(n){n.float32="float32",n.int32="int32",n.bool="bool",n.complex64="complex64"})(dc||(dc={}));var pc;(function(n){n.float32="float32",n.int32="float32",n.bool="float32",n.complex64="complex64"})(pc||(pc={}));var mc;(function(n){n.float32="complex64",n.int32="complex64",n.bool="complex64",n.complex64="complex64"})(mc||(mc={}));const t3={float32:pc,int32:fc,bool:dc,complex64:mc};function rs(n,e){if(n==="string"||e==="string"){if(n==="string"&&e==="string")return"string";throw new Error(`Can not upcast ${n} with ${e}`)}return t3[n][e]}function Jc(n){return rs(n,"int32")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Mt(n,e){if(n.dtype===e.dtype)return[n,e];const t=rs(n.dtype,e.dtype);return[n.cast(t),e.cast(t)]}function n3(n,e){M(n.dtype===e.dtype,()=>`The dtypes of the first(${n.dtype}) and second(${e.dtype}) input must match`)}function d1(n){const e=[];return p1(n,e,new Set),e}function p1(n,e,t){if(n==null)return;if(n instanceof Rt){e.push(n);return}if(!r3(n))return;const r=n;for(const s in r){const o=r[s];t.has(o)||(t.add(o),p1(o,e,t))}}function r3(n){return Array.isArray(n)||typeof n=="object"}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ru(n){return n.kernelName!=null}class sh{constructor(){this.registeredVariables={},this.nextTapeNodeId=0,this.numBytes=0,this.numTensors=0,this.numStringTensors=0,this.numDataBuffers=0,this.gradientDepth=0,this.kernelDepth=0,this.scopeStack=[],this.numDataMovesStack=[],this.nextScopeId=0,this.tensorInfo=new WeakMap,this.profiling=!1,this.activeProfile={newBytes:0,newTensors:0,peakBytes:0,kernels:[],result:null,get kernelNames(){return Array.from(new Set(this.kernels.map(e=>e.name)))}}}dispose(){for(const e in this.registeredVariables)this.registeredVariables[e].dispose()}}class di{constructor(e){this.ENV=e,this.registry={},this.registryFactory={},this.pendingBackendInitId=0,this.state=new sh}async ready(){if(this.pendingBackendInit!=null)return this.pendingBackendInit.then(()=>{});if(this.backendInstance!=null)return;const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t];if(await this.initializeBackend(r).success){await this.setBackend(r);return}}throw new Error("Could not initialize any backends, all backend initializations failed.")}get backend(){if(this.pendingBackendInit!=null)throw new Error(`Backend '${this.backendName}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);if(this.backendInstance==null){const{name:e,asyncInit:t}=this.initializeBackendsAndReturnBest();if(t)throw new Error(`The highest priority backend '${e}' has not yet been initialized. Make sure to await tf.ready() or await tf.setBackend() before calling other methods`);this.setBackend(e)}return this.backendInstance}backendNames(){return Object.keys(this.registryFactory)}findBackend(e){if(!(e in this.registry))if(e in this.registryFactory){const{asyncInit:t}=this.initializeBackend(e);if(t)return null}else return null;return this.registry[e]}findBackendFactory(e){return e in this.registryFactory?this.registryFactory[e].factory:null}registerBackend(e,t,r=1){return e in this.registryFactory?(Fr(`${e} backend was already registered. Reusing existing backend factory.`),!1):(this.registryFactory[e]={factory:t,priority:r},!0)}async setBackend(e){if(this.registryFactory[e]==null)throw new Error(`Backend name '${e}' not found in registry`);if(this.backendName=e,this.registry[e]==null){this.backendInstance=null;const{success:t,asyncInit:r}=this.initializeBackend(e);if(!(r?await t:t))return!1}return this.backendInstance=this.registry[e],this.setupRegisteredKernels(),this.profiler=new j0(this.backendInstance),!0}setupRegisteredKernels(){Kl(this.backendName).forEach(t=>{t.setupFunc!=null&&t.setupFunc(this.backendInstance)})}disposeRegisteredKernels(e){Kl(e).forEach(r=>{r.disposeFunc!=null&&r.disposeFunc(this.registry[e])})}initializeBackend(e){const t=this.registryFactory[e];if(t==null)throw new Error(`Cannot initialize backend ${e}, no registration found.`);try{const r=t.factory();if(r&&!(r instanceof pf)&&typeof r.then=="function"){const s=++this.pendingBackendInitId,o=r.then(i=>s<this.pendingBackendInitId?!1:(this.registry[e]=i,this.pendingBackendInit=null,!0)).catch(i=>(s<this.pendingBackendInitId||(this.pendingBackendInit=null,Fr(`Initialization of backend ${e} failed`),Fr(i.stack||i.message)),!1));return this.pendingBackendInit=o,{success:o,asyncInit:!0}}else return this.registry[e]=r,{success:!0,asyncInit:!1}}catch(r){return Fr(`Initialization of backend ${e} failed`),Fr(r.stack||r.message),{success:!1,asyncInit:!1}}}removeBackend(e){if(!(e in this.registryFactory))throw new Error(`${e} backend not found in registry`);this.backendName===e&&this.pendingBackendInit!=null&&this.pendingBackendInitId++,e in this.registry&&(this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e]),delete this.registryFactory[e],this.backendName===e&&(this.pendingBackendInit=null,this.backendName=null,this.backendInstance=null)}getSortedBackends(){if(Object.keys(this.registryFactory).length===0)throw new Error("No backend found in registry.");return Object.keys(this.registryFactory).sort((e,t)=>this.registryFactory[t].priority-this.registryFactory[e].priority)}initializeBackendsAndReturnBest(){const e=this.getSortedBackends();for(let t=0;t<e.length;t++){const r=e[t],{success:s,asyncInit:o}=this.initializeBackend(r);if(o||s)return{name:r,asyncInit:o}}throw new Error("Could not initialize any backends, all backend initializations failed.")}moveData(e,t){const r=this.state.tensorInfo.get(t),s=r.backend,o=this.readSync(t),i=s.refCount(t);s.disposeData(t,!0),r.backend=e,e.move(t,o,r.shape,r.dtype,i),this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack[this.state.numDataMovesStack.length-1]++}tidy(e,t){let r=null;if(t==null){if(typeof e!="function")throw new Error("Please provide a function to tidy()");t=e}else{if(typeof e!="string"&&!(e instanceof String))throw new Error("When calling with two arguments, the first argument to tidy() must be a string");if(typeof t!="function")throw new Error("When calling with two arguments, the 2nd argument to tidy() must be a function");r=e}let s;return this.scopedRun(()=>this.startScope(r),()=>this.endScope(s),()=>(s=t(),s instanceof Promise&&console.error("Cannot return a Promise inside of tidy."),s))}scopedRun(e,t,r){e();try{const s=r();return t(),s}catch(s){throw t(),s}}nextTensorId(){return di.nextTensorId++}nextVariableId(){return di.nextVariableId++}clone(e){const t=Q.runKernel(Yc,{x:e}),r={x:e},s=i=>({x:()=>{const a="float32",u={x:i},c={dtype:a};return Q.runKernel(Kc,u,c)}}),o=[];return this.addTapeNode(this.state.activeScope.name,r,[t],s,o,{}),t}runKernel(e,t,r){if(this.backendName==null&&this.backend,!(ac(e,this.backendName)!=null))throw new Error(`Kernel '${e}' not registered for backend '${this.backendName}'`);return this.runKernelFunc({kernelName:e,inputs:t,attrs:r})}shouldCheckForMemLeaks(){return this.ENV.getBool("IS_TEST")}checkKernelForMemLeak(e,t,r){const s=this.backend.numDataIds();let o=0;r.forEach(u=>{o+=u.dtype==="complex64"?3:1});const i=this.state.numDataMovesStack[this.state.numDataMovesStack.length-1],a=s-t-o-i;if(a>0)throw new Error(`Backend '${this.backendName}' has an internal memory leak (${a} data ids) after running '${e}'`)}runKernelFunc(e){let t,r=[];const s=this.isTapeOn(),o=this.state.numBytes,i=this.state.numTensors;this.shouldCheckForMemLeaks()&&this.state.numDataMovesStack.push(0);let a;this.backendName==null&&this.backend;let u;const c=Ru(e)?e.kernelName:this.state.activeScope!=null?this.state.activeScope.name:"";if(Ru(e)){const{kernelName:g,inputs:C,attrs:$}=e;this.backendName==null&&this.backend;const T=ac(g,this.backendName);M(T!=null,()=>`Cannot find registered kernel '${g}' for backend '${this.backendName}'`),a=()=>{const A=this.backend.numDataIds();u=T.kernelFunc({inputs:C,attrs:$,backend:this.backend});const P=Array.isArray(u)?u:[u];this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(g,A,P);const B=P.map(H=>H.rank!=null?H:this.makeTensorFromTensorInfo(H));if(s){const H=this.getTensorsForGradient(g,C,B);r=this.saveTensorsForBackwardMode(H)}return B}}else{const{forwardFunc:g}=e,C=$=>{!s||(r=$.map(T=>this.keep(this.clone(T))))};a=()=>{const $=this.backend.numDataIds();u=this.tidy(()=>g(this.backend,C));const T=Array.isArray(u)?u:[u];return this.shouldCheckForMemLeaks()&&this.checkKernelForMemLeak(c,$,T),T}}const{inputs:l,attrs:h}=e,d=Ru(e)?null:e.backwardsFunc;let m;return this.scopedRun(()=>this.state.kernelDepth++,()=>this.state.kernelDepth--,()=>{!this.ENV.getBool("DEBUG")&&!this.state.profiling?t=a():(m=this.profiler.profileKernel(c,l,()=>a()),this.ENV.getBool("DEBUG")&&this.profiler.logKernelProfile(m),t=m.outputs)}),s&&this.addTapeNode(c,l,t,d,r,h),this.state.profiling&&this.state.activeProfile.kernels.push({name:c,bytesAdded:this.state.numBytes-o,totalBytesSnapshot:this.state.numBytes,tensorsAdded:this.state.numTensors-i,totalTensorsSnapshot:this.state.numTensors,inputShapes:Object.keys(l).map(g=>l[g]!=null?l[g].shape:null),outputShapes:t.map(g=>g.shape),kernelTimeMs:m.timeMs,extraInfo:m.extraInfo}),Array.isArray(u)?t:t[0]}saveTensorsForBackwardMode(e){return e.map(r=>this.keep(this.clone(r)))}getTensorsForGradient(e,t,r){const s=Xl(e);if(s!=null){const o=s.inputsToSave||[],i=s.outputsToSave||[];let a;s.saveAllInputs?(M(Array.isArray(t),()=>"saveAllInputs is true, expected inputs to be an array."),a=Object.keys(t).map(c=>t[c])):a=o.map(c=>t[c]);const u=r.filter((c,l)=>i[l]);return a.concat(u)}return[]}makeTensor(e,t,r,s){if(e==null)throw new Error("Values passed to engine.makeTensor() are null");r=r||"float32",s=s||this.backend;let o=e;r==="string"&&Ja(e[0])&&(o=e.map(u=>To(u)));const i=s.write(o,t,r),a=new Rt(t,r,i,this.nextTensorId());if(this.trackTensor(a,s),r==="string"){const u=this.state.tensorInfo.get(i),c=m0(o);this.state.numBytes+=c-u.bytes,u.bytes=c}return a}makeTensorFromDataId(e,t,r,s){r=r||"float32";const o={dataId:e,shape:t,dtype:r};return this.makeTensorFromTensorInfo(o,s)}makeTensorFromTensorInfo(e,t){const{dataId:r,shape:s,dtype:o}=e,i=new Rt(s,o,r,this.nextTensorId());return this.trackTensor(i,t),i}makeVariable(e,t=!0,r,s){r=r||this.nextVariableId().toString(),s!=null&&s!==e.dtype&&(e=e.cast(s));const o=new hc(e,t,r,this.nextTensorId());if(this.state.registeredVariables[o.name]!=null)throw new Error(`Variable with name ${o.name} was already registered`);return this.state.registeredVariables[o.name]=o,this.incRef(o,this.backend),o}trackTensor(e,t){this.state.numTensors++,e.dtype==="string"&&this.state.numStringTensors++;let r=0;e.dtype!=="complex64"&&e.dtype!=="string"&&(r=e.size*Ju(e.dtype)),this.state.numBytes+=r,this.state.tensorInfo.has(e.dataId)||(this.state.numDataBuffers++,this.state.tensorInfo.set(e.dataId,{backend:t||this.backend,dtype:e.dtype,shape:e.shape,bytes:r})),e instanceof hc||this.track(e)}incRef(e,t){this.trackTensor(e,t),this.backend.incRef(e.dataId)}removeDataId(e,t){this.state.tensorInfo.has(e)&&this.state.tensorInfo.get(e).backend===t&&(this.state.tensorInfo.delete(e),this.state.numDataBuffers--)}disposeTensor(e){if(!this.state.tensorInfo.has(e.dataId))return;const t=this.state.tensorInfo.get(e.dataId);if(this.state.numTensors--,e.dtype==="string"&&(this.state.numStringTensors--,this.state.numBytes-=t.bytes),e.dtype!=="complex64"&&e.dtype!=="string"){const r=e.size*Ju(e.dtype);this.state.numBytes-=r}t.backend.disposeData(e.dataId)&&this.removeDataId(e.dataId,t.backend)}disposeVariables(){for(const e in this.state.registeredVariables){const t=this.state.registeredVariables[e];this.disposeVariable(t)}}disposeVariable(e){this.disposeTensor(e),this.state.registeredVariables[e.name]!=null&&delete this.state.registeredVariables[e.name]}memory(){const e=this.backend.memory();return e.numTensors=this.state.numTensors,e.numDataBuffers=this.state.numDataBuffers,e.numBytes=this.state.numBytes,this.state.numStringTensors>0&&(e.unreliable=!0,e.reasons==null&&(e.reasons=[]),e.reasons.push("Memory usage by string tensors is approximate (2 bytes per character)")),e}async profile(e){this.state.profiling=!0;const t=this.state.numBytes,r=this.state.numTensors;this.state.activeProfile.kernels=[],this.state.activeProfile.result=await e(),this.state.profiling=!1,this.state.activeProfile.peakBytes=Math.max(...this.state.activeProfile.kernels.map(s=>s.totalBytesSnapshot)),this.state.activeProfile.newBytes=this.state.numBytes-t,this.state.activeProfile.newTensors=this.state.numTensors-r;for(const s of this.state.activeProfile.kernels)s.kernelTimeMs=await s.kernelTimeMs,s.extraInfo=await s.extraInfo;return this.state.activeProfile}isTapeOn(){return this.state.gradientDepth>0&&this.state.kernelDepth===0}addTapeNode(e,t,r,s,o,i){const a={id:this.state.nextTapeNodeId++,kernelName:e,inputs:t,outputs:r,saved:o},u=Xl(e);u!=null&&(s=u.gradFunc),s!=null&&(a.gradient=c=>(c=c.map((l,h)=>{if(l==null){const d=r[h],m=zs(d.size,d.dtype);return this.makeTensor(m,d.shape,d.dtype)}return l}),s(c.length>1?c:c[0],o,i))),this.state.activeTape.push(a)}keep(e){return e.kept=!0,e}startTape(){this.state.gradientDepth===0&&(this.state.activeTape=[]),this.state.gradientDepth++}endTape(){this.state.gradientDepth--}startScope(e){const t={track:[],name:"unnamed scope",id:this.state.nextScopeId++};e&&(t.name=e),this.state.scopeStack.push(t),this.state.activeScope=t}endScope(e){const t=d1(e),r=new Set(t.map(o=>o.id));for(let o=0;o<this.state.activeScope.track.length;o++){const i=this.state.activeScope.track[o];!i.kept&&!r.has(i.id)&&i.dispose()}const s=this.state.scopeStack.pop();this.state.activeScope=this.state.scopeStack.length===0?null:this.state.scopeStack[this.state.scopeStack.length-1],t.forEach(o=>{!o.kept&&o.scopeId===s.id&&this.track(o)})}gradients(e,t,r,s=!1){if(M(t.length>0,()=>"gradients() received an empty list of xs."),r!=null&&r.dtype!=="float32")throw new Error(`dy must have 'float32' dtype, but has '${r.dtype}'`);const o=this.scopedRun(()=>this.startTape(),()=>this.endTape(),()=>this.tidy("forward",e));M(o instanceof Rt,()=>"The result y returned by f() must be a tensor.");const i=X0(this.state.activeTape,t,o);if(!s&&i.length===0&&t.length>0)throw new Error("Cannot compute gradient of y=f(x) with respect to x. Make sure that the f you passed encloses all operations that lead from x to y.");return this.tidy("backward",()=>{const a={};a[o.id]=r==null?s3(o.shape):r,K0(a,i,c=>this.tidy(c),o3);const u=t.map(c=>a[c.id]);return this.state.gradientDepth===0&&(this.state.activeTape.forEach(c=>{for(const l of c.saved)l.dispose()}),this.state.activeTape=null),{value:o,grads:u}})}customGrad(e){return M(Hl(e),()=>"The f passed in customGrad(f) must be a function."),(...t)=>{M(t.every(a=>a instanceof Rt),()=>"The args passed in customGrad(f)(x1, x2,...) must all be tensors");let r;const s={};t.forEach((a,u)=>{s[u]=a});const o=(a,u)=>(r=e(...t,u),M(r.value instanceof Rt,()=>"The function f passed in customGrad(f) must return an object where `obj.value` is a tensor"),M(Hl(r.gradFunc),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function."),r.value),i=(a,u)=>{const c=r.gradFunc(a,u),l=Array.isArray(c)?c:[c];M(l.length===t.length,()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns the same number of tensors as inputs passed to f(...)."),M(l.every(d=>d instanceof Rt),()=>"The function f passed in customGrad(f) must return an object where `obj.gradFunc` is a function that returns a list of only tensors.");const h={};return l.forEach((d,m)=>{h[m]=()=>d}),h};return this.runKernelFunc({forwardFunc:o,backwardsFunc:i,inputs:s})}}readSync(e){return this.state.tensorInfo.get(e).backend.readSync(e)}read(e){return this.state.tensorInfo.get(e).backend.read(e)}readToGPU(e,t){return this.state.tensorInfo.get(e).backend.readToGPU(e,t)}async time(e){const t=Rr(),r=await this.backend.time(e);return r.wallMs=Rr()-t,r}track(e){return this.state.activeScope!=null&&(e.scopeId=this.state.activeScope.id,this.state.activeScope.track.push(e)),e}get registeredVariables(){return this.state.registeredVariables}reset(){this.pendingBackendInitId++,this.state.dispose(),this.ENV.reset(),this.state=new sh;for(const e in this.registry)this.disposeRegisteredKernels(e),this.registry[e].dispose(),delete this.registry[e];this.backendName=null,this.backendInstance=null,this.pendingBackendInit=null}}di.nextTensorId=0;di.nextVariableId=0;function s3(n){const e=gf(Ce(n),"float32");return Q.makeTensor(e,n,"float32")}function m1(){const n=bf();if(n._tfengine==null){const e=new x0(n);n._tfengine=new di(e)}return C0(n._tfengine.ENV),Z0(()=>n._tfengine),n._tfengine}const Q=m1();function o3(n,e){const t={a:n,b:e};return Q.runKernel(Xc,t)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i3(){return typeof navigator<"u"&&navigator!=null}function g1(n){if(n||i3()){if(n||(n=navigator),n.product==="ReactNative")return!0;const e=n.userAgent||n.vendor||(typeof window<"u"?window.opera:"");if(!e){const t=n;return t.userAgentData&&t.userAgentData.mobile}return/(android|bb\d+|meego).+mobile|avantgo|bada\/|blackberry|blazer|compal|elaine|fennec|hiptop|iemobile|ip(hone|od)|iris|kindle|lge |maemo|midp|mmp|mobile.+firefox|netfront|opera m(ob|in)i|palm( os)?|phone|p(ixi|re)\/|plucker|pocket|psp|series(4|6)0|symbian|treo|up\.(browser|link)|vodafone|wap|windows ce|xda|xiino/i.test(e)||/1207|6310|6590|3gso|4thp|50[1-6]i|770s|802s|a wa|abac|ac(er|oo|s\-)|ai(ko|rn)|al(av|ca|co)|amoi|an(ex|ny|yw)|aptu|ar(ch|go)|as(te|us)|attw|au(di|\-m|r |s )|avan|be(ck|ll|nq)|bi(lb|rd)|bl(ac|az)|br(e|v)w|bumb|bw\-(n|u)|c55\/|capi|ccwa|cdm\-|cell|chtm|cldc|cmd\-|co(mp|nd)|craw|da(it|ll|ng)|dbte|dc\-s|devi|dica|dmob|do(c|p)o|ds(12|\-d)|el(49|ai)|em(l2|ul)|er(ic|k0)|esl8|ez([4-7]0|os|wa|ze)|fetc|fly(\-|_)|g1 u|g560|gene|gf\-5|g\-mo|go(\.w|od)|gr(ad|un)|haie|hcit|hd\-(m|p|t)|hei\-|hi(pt|ta)|hp( i|ip)|hs\-c|ht(c(\-| |_|a|g|p|s|t)|tp)|hu(aw|tc)|i\-(20|go|ma)|i230|iac( |\-|\/)|ibro|idea|ig01|ikom|im1k|inno|ipaq|iris|ja(t|v)a|jbro|jemu|jigs|kddi|keji|kgt( |\/)|klon|kpt |kwc\-|kyo(c|k)|le(no|xi)|lg( g|\/(k|l|u)|50|54|\-[a-w])|libw|lynx|m1\-w|m3ga|m50\/|ma(te|ui|xo)|mc(01|21|ca)|m\-cr|me(rc|ri)|mi(o8|oa|ts)|mmef|mo(01|02|bi|de|do|t(\-| |o|v)|zz)|mt(50|p1|v )|mwbp|mywa|n10[0-2]|n20[2-3]|n30(0|2)|n50(0|2|5)|n7(0(0|1)|10)|ne((c|m)\-|on|tf|wf|wg|wt)|nok(6|i)|nzph|o2im|op(ti|wv)|oran|owg1|p800|pan(a|d|t)|pdxg|pg(13|\-([1-8]|c))|phil|pire|pl(ay|uc)|pn\-2|po(ck|rt|se)|prox|psio|pt\-g|qa\-a|qc(07|12|21|32|60|\-[2-7]|i\-)|qtek|r380|r600|raks|rim9|ro(ve|zo)|s55\/|sa(ge|ma|mm|ms|ny|va)|sc(01|h\-|oo|p\-)|sdk\/|se(c(\-|0|1)|47|mc|nd|ri)|sgh\-|shar|sie(\-|m)|sk\-0|sl(45|id)|sm(al|ar|b3|it|t5)|so(ft|ny)|sp(01|h\-|v\-|v )|sy(01|mb)|t2(18|50)|t6(00|10|18)|ta(gt|lk)|tcl\-|tdg\-|tel(i|m)|tim\-|t\-mo|to(pl|sh)|ts(70|m\-|m3|m5)|tx\-9|up(\.b|g1|si)|utst|v400|v750|veri|vi(rg|te)|vk(40|5[0-3]|\-v)|vm40|voda|vulc|vx(52|53|60|61|70|80|81|83|85|98)|w3c(\-| )|webc|whit|wi(g |nc|nw)|wmlb|wonu|x700|yas\-|your|zeto|zte\-/i.test(e.substr(0,4))}return!1}function y1(){return typeof window<"u"&&window.document!=null||typeof WorkerGlobalScope<"u"}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Pn=ue();Pn.registerFlag("DEBUG",()=>!1,n=>{n&&console.warn("Debugging mode is ON. The output of every math call will be downloaded to CPU and checked for NaNs. This significantly impacts performance.")});Pn.registerFlag("IS_BROWSER",()=>y1());Pn.registerFlag("IS_NODE",()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u");Pn.registerFlag("IS_CHROME",()=>typeof navigator<"u"&&navigator!=null&&navigator.userAgent!=null&&/Chrome/.test(navigator.userAgent)&&/Google Inc/.test(navigator.vendor));Pn.registerFlag("PROD",()=>!1);Pn.registerFlag("TENSORLIKE_CHECK_SHAPE_CONSISTENCY",()=>Pn.getBool("DEBUG"));Pn.registerFlag("DEPRECATION_WARNINGS_ENABLED",()=>!0);Pn.registerFlag("IS_TEST",()=>!1);Pn.registerFlag("CHECK_COMPUTATION_FOR_ERRORS",()=>!0);Pn.registerFlag("WRAP_TO_IMAGEBITMAP",()=>!1);Pn.registerFlag("ENGINE_COMPILE_ONLY",()=>!1);Pn.registerFlag("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU",()=>!1);Pn.registerFlag("USE_SETTIMEOUTCUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qs(n,e){let t=n;if(ns(n))return e==="string"?[]:[n.length];if(!Array.isArray(n))return[];const r=[];for(;Array.isArray(t)||ns(t)&&e!=="string";)r.push(t.length),t=t[0];return Array.isArray(n)&&ue().getBool("TENSORLIKE_CHECK_SHAPE_CONSISTENCY")&&x1(n,r,[]),r}function x1(n,e,t){if(t=t||[],!Array.isArray(n)&&!ns(n)){M(e.length===0,()=>`Element arr[${t.join("][")}] is a primitive, but should be an array/TypedArray of ${e[0]} elements`);return}M(e.length>0,()=>`Element arr[${t.join("][")}] should be a primitive, but is an array of ${n.length} elements`),M(n.length===e[0],()=>`Element arr[${t.join("][")}] should have ${e[0]} elements, but has ${n.length} elements`);const r=e.slice(1);for(let s=0;s<n.length;++s)x1(n[s],r,t.concat(s))}function oh(n,e,t,r){if(n!=="string_or_numeric"){if(n==null)throw new Error("Expected dtype cannot be null.");if(n!=="numeric"&&n!==e||n==="numeric"&&e==="string")throw new Error(`Argument '${t}' passed to '${r}' must be ${n} tensor, but got ${e} tensor`)}}function L(n,e,t,r="numeric"){if(n instanceof Rt)return oh(r,n.dtype,e,t),n;let s=eu(n);if(s!=="string"&&["bool","int32","float32"].indexOf(r)>=0&&(s=r),oh(r,s,e,t),n==null||!ns(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string"){const u=n==null?"null":n.constructor.name;throw new Error(`Argument '${e}' passed to '${t}' must be a Tensor or TensorLike, but got '${u}'`)}const o=qs(n,s);!ns(n)&&!Array.isArray(n)&&(n=[n]);const a=s!=="string"?nu(n,s):ui(n,[],!0);return Q.makeTensor(a,o,s)}function Ba(n,e,t,r="numeric"){if(!Array.isArray(n))throw new Error(`Argument ${e} passed to ${t} must be a \`Tensor[]\` or \`TensorLike[]\``);return n.map((o,i)=>L(o,`${e}[${i}]`,t,r))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b1="__op";function X(n){const e=Object.keys(n);if(e.length!==1)throw new Error(`Please provide an object with a single key (operation name) mapping to a function. Got an object with ${e.length} keys.`);let t=e[0];const r=n[t];t.endsWith("_")&&(t=t.substring(0,t.length-1)),t=t+b1;const s=(...o)=>{Q.startScope(t);try{const i=r(...o);return li(i)&&console.error("Cannot return a Promise inside of tidy."),Q.endScope(i),i}catch(i){throw Q.endScope(null),i}};return Object.defineProperty(s,"name",{value:t,configurable:!0}),s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a3(n,e){const t=L(n,"real","complex"),r=L(e,"imag","complex");Qn(t.shape,r.shape,`real and imag shapes, ${t.shape} and ${r.shape}, must match in call to tf.complex().`);const s={real:t,imag:r};return Q.runKernel(Uf,s)}const Gs=X({complex_:a3});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xs(n,e,t,r){if(r==null&&(r=eu(n)),r==="complex64")throw new Error("Cannot construct a complex64 tensor directly. Please use tf.complex(real, imag).");if(!ns(n)&&!Array.isArray(n)&&typeof n!="number"&&typeof n!="boolean"&&typeof n!="string")throw new Error("values passed to tensor(values) must be a number/boolean/string or an array of numbers/booleans/strings, or a TypedArray");if(e!=null){yf(e);const s=Ce(e),o=Ce(t);M(s===o,()=>`Based on the provided shape, [${e}], the tensor should have ${s} values but has ${o}`);for(let i=0;i<t.length;++i){const a=t[i],u=i===t.length-1?a!==Ce(e.slice(i)):!0;M(t[i]===e[i]||!u,()=>`Error creating a new Tensor. Inferred shape (${t}) does not match the provided shape (${e}). `)}}return!ns(n)&&!Array.isArray(n)&&(n=[n]),e=e||t,n=r!=="string"?nu(n,r):ui(n,[],!0),Q.makeTensor(n,e,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ts(n,e,t){const r=qs(n,t);return Xs(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gc={float32:4,float16:2,int32:4,uint16:2,uint8:1,bool:1,complex64:8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ma=4;async function u3(n,e){const t=[],r=[],s=Array.isArray(n)?n.map(i=>i.name):Object.keys(n);for(let i=0;i<s.length;++i){const a=s[i],u=Array.isArray(n)?n[i].tensor:n[a];if(u.dtype!=="float32"&&u.dtype!=="int32"&&u.dtype!=="bool"&&u.dtype!=="string"&&u.dtype!=="complex64")throw new Error(`Unsupported dtype in weight '${a}': ${u.dtype}`);const c={name:a,shape:u.shape,dtype:u.dtype};if(u.dtype==="string"){const l=new Promise(async h=>{const d=await u.bytes(),m=d.reduce(($,T)=>$+T.length,0)+Ma*d.length,g=new Uint8Array(m);let C=0;for(let $=0;$<d.length;$++){const T=d[$],A=new Uint8Array(new Uint32Array([T.length]).buffer);g.set(A,C),C+=Ma,g.set(T,C),C+=T.length}h(g)});r.push(l)}else r.push(u.data());e!=null&&(c.group=e),t.push(c)}const o=await Promise.all(r);return{data:c3(o),specs:t}}function v1(n,e){const t={};let r,s=0;for(const o of e){const i=o.name,a=o.dtype,u=o.shape,c=Ce(u);let l;if("quantization"in o){const h=o.quantization;if(h.dtype==="uint8"||h.dtype==="uint16"){if(!("min"in h&&"scale"in h))throw new Error(`Weight ${o.name} with quantization ${h.dtype} doesn't have corresponding metadata min and scale.`)}else if(h.dtype==="float16"){if(a!=="float32")throw new Error(`Weight ${o.name} is quantized with ${h.dtype} which only supports weights of type float32 not ${a}.`)}else throw new Error(`Weight ${o.name} has unknown quantization dtype ${h.dtype}. Supported quantization dtypes are: 'uint8', 'uint16', and 'float16'.`);const d=gc[h.dtype],m=n.slice(s,s+c*d),g=h.dtype==="uint8"?new Uint8Array(m):new Uint16Array(m);if(a==="float32")if(h.dtype==="uint8"||h.dtype==="uint16"){l=new Float32Array(g.length);for(let C=0;C<g.length;C++){const $=g[C];l[C]=$*h.scale+h.min}}else if(h.dtype==="float16")r===void 0&&(r=m3()),l=r(g);else throw new Error(`Unsupported quantization type ${h.dtype} for weight type float32.`);else if(a==="int32"){if(h.dtype!=="uint8"&&h.dtype!=="uint16")throw new Error(`Unsupported quantization type ${h.dtype} for weight type int32.`);l=new Int32Array(g.length);for(let C=0;C<g.length;C++){const $=g[C];l[C]=Math.round($*h.scale+h.min)}}else throw new Error(`Unsupported dtype in weight '${i}': ${a}`);s+=c*d}else if(a==="string"){const h=Ce(o.shape);l=[];for(let d=0;d<h;d++){const m=new Uint32Array(n.slice(s,s+Ma))[0];s+=Ma;const g=new Uint8Array(n.slice(s,s+m));l.push(g),s+=m}}else{const h=gc[a],d=n.slice(s,s+c*h);if(a==="float32")l=new Float32Array(d);else if(a==="int32")l=new Int32Array(d);else if(a==="bool")l=new Uint8Array(d);else if(a==="complex64"){l=new Float32Array(d);const m=new Float32Array(l.length/2),g=new Float32Array(l.length/2);for(let T=0;T<m.length;T++)m[T]=l[T*2],g[T]=l[T*2+1];const C=ts(m,u,"float32"),$=ts(g,u,"float32");t[i]=Gs(C,$),C.dispose(),$.dispose()}else throw new Error(`Unsupported dtype in weight '${i}': ${a}`);s+=c*h}a!=="complex64"&&(t[i]=ts(l,u,a))}return t}function c3(n){if(n===null)throw new Error(`Invalid input value: ${JSON.stringify(n)}`);let e=0;const t=[];n.forEach(o=>{if(e+=o.byteLength,t.push(o.byteLength===o.buffer.byteLength?o:new o.constructor(o)),!(o instanceof Float32Array||o instanceof Int32Array||o instanceof Uint8Array))throw new Error(`Unsupported TypedArray subtype: ${o.constructor.name}`)});const r=new Uint8Array(e);let s=0;return t.forEach(o=>{r.set(new Uint8Array(o.buffer),s),s+=o.byteLength}),r.buffer}const el=typeof Buffer<"u"&&(typeof Blob>"u"||typeof atob>"u"||typeof btoa>"u");function ih(n){return el?Buffer.byteLength(n):new Blob([n]).size}function l3(n){if(el)return Buffer.from(n).toString("base64");const e=new Uint8Array(n);let t="";for(let r=0,s=e.length;r<s;r++)t+=String.fromCharCode(e[r]);return btoa(t)}function h3(n){if(el){const r=Buffer.from(n,"base64");return r.buffer.slice(r.byteOffset,r.byteOffset+r.byteLength)}const e=atob(n),t=new Uint8Array(e.length);for(let r=0;r<e.length;++r)t.set([e.charCodeAt(r)],r);return t.buffer}function tl(n){if(n.length===1)return n[0];let e=0;n.forEach(s=>{e+=s.byteLength});const t=new Uint8Array(e);let r=0;return n.forEach(s=>{t.set(new Uint8Array(s),r),r+=s.byteLength}),t.buffer}function ah(n){const e="/";for(n=n.trim();n.endsWith(e);)n=n.slice(0,n.length-1);const t=n.split(e);return t[t.length-1]}function w1(n,e){const t={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy,weightsManifest:e};return n.signature!=null&&(t.signature=n.signature),n.userDefinedMetadata!=null&&(t.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(t.modelInitializer=n.modelInitializer),n.trainingConfig!=null&&(t.trainingConfig=n.trainingConfig),t}function C1(n,e,t){const r={modelTopology:n.modelTopology,format:n.format,generatedBy:n.generatedBy,convertedBy:n.convertedBy};if(n.trainingConfig!=null&&(r.trainingConfig=n.trainingConfig),n.weightsManifest!=null){if(!e)throw new Error("modelJSON has weightsManifest but weightSpecs is null");if(!t)throw new Error("modelJSON has weightsManifest but weightData is null");r.weightSpecs=e,r.weightData=t}return n.signature!=null&&(r.signature=n.signature),n.userDefinedMetadata!=null&&(r.userDefinedMetadata=n.userDefinedMetadata),n.modelInitializer!=null&&(r.modelInitializer=n.modelInitializer),r}async function nl(n,e){let t,r;return n.weightsManifest!=null&&([t,r]=await e(n.weightsManifest)),C1(n,t,r)}function ra(n){if(n.modelTopology instanceof ArrayBuffer)throw new Error("Expected JSON model topology, received ArrayBuffer.");return{dateSaved:new Date,modelTopologyType:"JSON",modelTopologyBytes:n.modelTopology==null?0:ih(JSON.stringify(n.modelTopology)),weightSpecsBytes:n.weightSpecs==null?0:ih(JSON.stringify(n.weightSpecs)),weightDataBytes:n.weightData==null?0:n.weightData.byteLength}}function T1(n){const e=[];for(const t of n)e.push(...t.weights);return e}function f3(){const n=t=>{let r=t<<13,s=0;for(;(r&8388608)===0;)s-=8388608,r<<=1;return r&=-8388609,s+=947912704,r|s},e=new Uint32Array(2048);e[0]=0;for(let t=1;t<1024;t++)e[t]=n(t);for(let t=1024;t<2048;t++)e[t]=939524096+(t-1024<<13);return e}function d3(){const n=new Uint32Array(64);n[0]=0,n[31]=1199570944,n[32]=2147483648,n[63]=3347054592;for(let e=1;e<31;e++)n[e]=e<<23;for(let e=33;e<63;e++)n[e]=2147483648+(e-32<<23);return n}function p3(){const n=new Uint32Array(64);for(let e=0;e<64;e++)n[e]=1024;return n[0]=n[32]=0,n}function m3(){const n=f3(),e=d3(),t=p3();return r=>{const s=new ArrayBuffer(4*r.length),o=new Uint32Array(s);for(let i=0;i<r.length;i++){const a=r[i],u=n[t[a>>10]+(a&1023)]+e[a>>10];o[i]=u}return new Float32Array(s)}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _t{constructor(){this.saveRouters=[],this.loadRouters=[]}static getInstance(){return _t.instance==null&&(_t.instance=new _t),_t.instance}static registerSaveRouter(e){_t.getInstance().saveRouters.push(e)}static registerLoadRouter(e){_t.getInstance().loadRouters.push(e)}static getSaveHandlers(e){return _t.getHandlers(e,"save")}static getLoadHandlers(e,t){return _t.getHandlers(e,"load",t)}static getHandlers(e,t,r){const s=[];return(t==="load"?_t.getInstance().loadRouters:_t.getInstance().saveRouters).forEach(i=>{const a=i(e,r);a!==null&&s.push(a)}),s}}const g3=n=>_t.registerSaveRouter(n),y3=n=>_t.registerLoadRouter(n),x3=n=>_t.getSaveHandlers(n),b3=(n,e)=>_t.getLoadHandlers(n,e);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yc="tensorflowjs",xc=1,vo="models_store",Bs="model_info_store";function $1(){if(!ue().getBool("IS_BROWSER"))throw new Error("Failed to obtain IndexedDB factory because the current environmentis not a web browser.");const n=typeof window>"u"?self:window,e=n.indexedDB||n.mozIndexedDB||n.webkitIndexedDB||n.msIndexedDB||n.shimIndexedDB;if(e==null)throw new Error("The current browser does not appear to support IndexedDB.");return e}function bc(n){const e=n.result;e.createObjectStore(vo,{keyPath:"modelPath"}),e.createObjectStore(Bs,{keyPath:"modelPath"})}class No{constructor(e){if(this.indexedDB=$1(),e==null||!e)throw new Error("For IndexedDB, modelPath must not be null, undefined or empty.");this.modelPath=e}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");return this.databaseAction(this.modelPath,e)}async load(){return this.databaseAction(this.modelPath)}databaseAction(e,t){return new Promise((r,s)=>{const o=this.indexedDB.open(yc,xc);o.onupgradeneeded=()=>bc(o),o.onsuccess=()=>{const i=o.result;if(t==null){const a=i.transaction(vo,"readonly"),c=a.objectStore(vo).get(this.modelPath);c.onsuccess=()=>{if(c.result==null)return i.close(),s(new Error(`Cannot find model with path '${this.modelPath}' in IndexedDB.`));r(c.result.modelArtifacts)},c.onerror=l=>(i.close(),s(c.error)),a.oncomplete=()=>i.close()}else{const a=ra(t),u=i.transaction(Bs,"readwrite");let c=u.objectStore(Bs);const l=c.put({modelPath:this.modelPath,modelArtifactsInfo:a});let h;l.onsuccess=()=>{h=i.transaction(vo,"readwrite");const m=h.objectStore(vo).put({modelPath:this.modelPath,modelArtifacts:t,modelArtifactsInfo:a});m.onsuccess=()=>r({modelArtifactsInfo:a}),m.onerror=g=>{c=u.objectStore(Bs);const C=c.delete(this.modelPath);C.onsuccess=()=>(i.close(),s(m.error)),C.onerror=$=>(i.close(),s(m.error))}},l.onerror=d=>(i.close(),s(l.error)),u.oncomplete=()=>{h==null?i.close():h.oncomplete=()=>i.close()}}},o.onerror=i=>s(o.error)})}}No.URL_SCHEME="indexeddb://";const S1=n=>ue().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(No.URL_SCHEME)?v3(n.slice(No.URL_SCHEME.length)):null;_t.registerSaveRouter(S1);_t.registerLoadRouter(S1);function v3(n){return new No(n)}function w3(n){return n.startsWith(No.URL_SCHEME)?n.slice(No.URL_SCHEME.length):n}class C3{constructor(){this.indexedDB=$1()}async listModels(){return new Promise((e,t)=>{const r=this.indexedDB.open(yc,xc);r.onupgradeneeded=()=>bc(r),r.onsuccess=()=>{const s=r.result,o=s.transaction(Bs,"readonly"),a=o.objectStore(Bs).getAll();a.onsuccess=()=>{const u={};for(const c of a.result)u[c.modelPath]=c.modelArtifactsInfo;e(u)},a.onerror=u=>(s.close(),t(a.error)),o.oncomplete=()=>s.close()},r.onerror=s=>t(r.error)})}async removeModel(e){return e=w3(e),new Promise((t,r)=>{const s=this.indexedDB.open(yc,xc);s.onupgradeneeded=()=>bc(s),s.onsuccess=()=>{const o=s.result,i=o.transaction(Bs,"readwrite"),a=i.objectStore(Bs),u=a.get(e);let c;u.onsuccess=()=>{if(u.result==null)return o.close(),r(new Error(`Cannot find model with path '${e}' in IndexedDB.`));{const l=a.delete(e),h=()=>{c=o.transaction(vo,"readwrite");const m=c.objectStore(vo).delete(e);m.onsuccess=()=>t(u.result.modelArtifactsInfo),m.onerror=g=>r(u.error)};l.onsuccess=h,l.onerror=d=>(h(),o.close(),r(u.error))}},u.onerror=l=>(o.close(),r(u.error)),i.oncomplete=()=>{c==null?o.close():c.oncomplete=()=>o.close()}},s.onerror=o=>r(s.error)})}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ms="/",ni="tensorflowjs_models",N1="info",T3="model_topology",$3="weight_specs",S3="weight_data",N3="model_metadata";function E1(n){return{info:[ni,n,N1].join(ms),topology:[ni,n,T3].join(ms),weightSpecs:[ni,n,$3].join(ms),weightData:[ni,n,S3].join(ms),modelMetadata:[ni,n,N3].join(ms)}}function k1(n){for(const e of Object.values(n))window.localStorage.removeItem(e)}function E3(n){const e=n.split(ms);if(e.length<3)throw new Error(`Invalid key format: ${n}`);return e.slice(1,e.length-1).join(ms)}function k3(n){return n.startsWith(Eo.URL_SCHEME)?n.slice(Eo.URL_SCHEME.length):n}class Eo{constructor(e){if(!ue().getBool("IS_BROWSER")||typeof window>"u"||typeof window.localStorage>"u")throw new Error("The current environment does not support local storage.");if(this.LS=window.localStorage,e==null||!e)throw new Error("For local storage, modelPath must not be null, undefined or empty.");this.modelPath=e,this.keys=E1(this.modelPath)}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserLocalStorage.save() does not support saving model topology in binary formats yet.");{const t=JSON.stringify(e.modelTopology),r=JSON.stringify(e.weightSpecs),s=ra(e);try{this.LS.setItem(this.keys.info,JSON.stringify(s)),this.LS.setItem(this.keys.topology,t),this.LS.setItem(this.keys.weightSpecs,r),this.LS.setItem(this.keys.weightData,l3(e.weightData));const o={format:e.format,generatedBy:e.generatedBy,convertedBy:e.convertedBy,signature:e.signature!=null?e.signature:void 0,userDefinedMetadata:e.userDefinedMetadata!=null?e.userDefinedMetadata:void 0,modelInitializer:e.modelInitializer!=null?e.modelInitializer:void 0,trainingConfig:e.trainingConfig!=null?e.trainingConfig:void 0};return this.LS.setItem(this.keys.modelMetadata,JSON.stringify(o)),{modelArtifactsInfo:s}}catch{throw k1(this.keys),new Error(`Failed to save model '${this.modelPath}' to local storage: size quota being exceeded is a possible cause of this failure: modelTopologyBytes=${s.modelTopologyBytes}, weightSpecsBytes=${s.weightSpecsBytes}, weightDataBytes=${s.weightDataBytes}.`)}}}async load(){const e=JSON.parse(this.LS.getItem(this.keys.info));if(e==null)throw new Error(`In local storage, there is no model with name '${this.modelPath}'`);if(e.modelTopologyType!=="JSON")throw new Error("BrowserLocalStorage does not support loading non-JSON model topology yet.");const t={},r=JSON.parse(this.LS.getItem(this.keys.topology));if(r==null)throw new Error(`In local storage, the topology of model '${this.modelPath}' is missing.`);t.modelTopology=r;const s=JSON.parse(this.LS.getItem(this.keys.weightSpecs));if(s==null)throw new Error(`In local storage, the weight specs of model '${this.modelPath}' are missing.`);t.weightSpecs=s;const o=this.LS.getItem(this.keys.modelMetadata);if(o!=null){const a=JSON.parse(o);t.format=a.format,t.generatedBy=a.generatedBy,t.convertedBy=a.convertedBy,a.signature!=null&&(t.signature=a.signature),a.userDefinedMetadata!=null&&(t.userDefinedMetadata=a.userDefinedMetadata),a.modelInitializer!=null&&(t.modelInitializer=a.modelInitializer),a.trainingConfig!=null&&(t.trainingConfig=a.trainingConfig)}const i=this.LS.getItem(this.keys.weightData);if(i==null)throw new Error(`In local storage, the binary weight values of model '${this.modelPath}' are missing.`);return t.weightData=h3(i),t}}Eo.URL_SCHEME="localstorage://";const I1=n=>ue().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(Eo.URL_SCHEME)?I3(n.slice(Eo.URL_SCHEME.length)):null;_t.registerSaveRouter(I1);_t.registerLoadRouter(I1);function I3(n){return new Eo(n)}class _3{constructor(){M(ue().getBool("IS_BROWSER"),()=>"Current environment is not a web browser"),M(typeof window>"u"||typeof window.localStorage<"u",()=>"Current browser does not appear to support localStorage"),this.LS=window.localStorage}async listModels(){const e={},t=ni+ms,r=ms+N1;for(let s=0;s<this.LS.length;++s){const o=this.LS.key(s);if(o.startsWith(t)&&o.endsWith(r)){const i=E3(o);e[i]=JSON.parse(this.LS.getItem(o))}}return e}async removeModel(e){e=k3(e);const t=E1(e);if(this.LS.getItem(t.info)==null)throw new Error(`Cannot find model at path '${e}'`);const r=JSON.parse(this.LS.getItem(t.info));return k1(t),r}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const oi="://";class bn{constructor(){this.managers={}}static getInstance(){return bn.instance==null&&(bn.instance=new bn),bn.instance}static registerManager(e,t){M(e!=null,()=>"scheme must not be undefined or null."),e.endsWith(oi)&&(e=e.slice(0,e.indexOf(oi))),M(e.length>0,()=>"scheme must not be an empty string.");const r=bn.getInstance();M(r.managers[e]==null,()=>`A model store manager is already registered for scheme '${e}'.`),r.managers[e]=t}static getManager(e){const t=bn.getInstance().managers[e];if(t==null)throw new Error(`Cannot find model manager for scheme '${e}'`);return t}static getSchemes(){return Object.keys(bn.getInstance().managers)}}function Aa(n){if(n.indexOf(oi)===-1)throw new Error(`The url string provided does not contain a scheme. Supported schemes are: ${bn.getSchemes().join(",")}`);return{scheme:n.split(oi)[0],path:n.split(oi)[1]}}async function _1(n,e,t=!1){M(n!==e,()=>`Old path and new path are the same: '${n}'`);const r=_t.getLoadHandlers(n);M(r.length>0,()=>`Copying failed because no load handler is found for source URL ${n}.`),M(r.length<2,()=>`Copying failed because more than one (${r.length}) load handlers for source URL ${n}.`);const s=r[0],o=_t.getSaveHandlers(e);M(o.length>0,()=>`Copying failed because no save handler is found for destination URL ${e}.`),M(o.length<2,()=>`Copying failed because more than one (${r.length}) save handlers for destination URL ${e}.`);const i=o[0],a=Aa(n).scheme,u=Aa(n).path,c=a===Aa(n).scheme,l=await s.load();t&&c&&await bn.getManager(a).removeModel(u);const h=await i.save(l);return t&&!c&&await bn.getManager(a).removeModel(u),h.modelArtifactsInfo}async function R3(){const n=bn.getSchemes(),e={};for(const t of n){const r=await bn.getManager(t).listModels();for(const s in r){const o=t+oi+s;e[o]=r[s]}}return e}async function A3(n){const e=Aa(n);return bn.getManager(e.scheme).removeModel(e.path)}async function O3(n,e){return _1(n,e,!1)}async function D3(n,e){return _1(n,e,!0)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F3{constructor(){this.messageName="setTimeoutCustom",this.functionRefs=[],this.handledMessageCount=0,this.hasEventListener=!1}fetch(e,t){return fetch(e,t)}now(){return performance.now()}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Browser's encoder only supports utf-8, but got ${t}`);return this.textEncoder==null&&(this.textEncoder=new TextEncoder),this.textEncoder.encode(e)}decode(e,t){return new TextDecoder(t).decode(e)}setTimeoutCustom(e,t){if(!window||!ue().getBool("USE_SETTIMEOUTCUSTOM")){setTimeout(e,t);return}this.functionRefs.push(e),setTimeout(()=>{window.postMessage({name:this.messageName,index:this.functionRefs.length-1},"*")},t),this.hasEventListener||(this.hasEventListener=!0,window.addEventListener("message",r=>{if(r.source===window&&r.data.name===this.messageName){r.stopPropagation();const s=this.functionRefs[r.data.index];s(),this.handledMessageCount++,this.handledMessageCount===this.functionRefs.length&&(this.functionRefs=[],this.handledMessageCount=0)}},!0))}}if(ue().get("IS_BROWSER")){ue().setPlatform("browser",new F3);try{bn.registerManager(Eo.URL_SCHEME,new _3)}catch{}try{bn.registerManager(No.URL_SCHEME,new C3)}catch{}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P3={importFetch:()=>require("node-fetch")};let Au;class L3{constructor(){this.util=require("util"),this.textEncoder=new this.util.TextEncoder}fetch(e,t){return ue().global.fetch!=null?ue().global.fetch(e,t):(Au==null&&(Au=P3.importFetch()),Au(e,t))}now(){const e=process.hrtime();return e[0]*1e3+e[1]/1e6}encode(e,t){if(t!=="utf-8"&&t!=="utf8")throw new Error(`Node built-in encoder only supports utf-8, but got ${t}`);return this.textEncoder.encode(e)}decode(e,t){return e.length===0?"":new this.util.TextDecoder(t).decode(e)}}ue().get("IS_NODE")&&!ue().get("IS_BROWSER")&&ue().setPlatform("node",new L3);/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ot(n,e="float32",t){return e=e||"float32",yf(n),new Hi(n,e,t)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B3(n,e){const t=L(n,"x","cast");if(!d0(e))throw new Error(`Failed to cast to unknown dtype ${e}`);if(e==="string"&&t.dtype!=="string"||e!=="string"&&t.dtype==="string")throw new Error("Only strings can be casted to strings");const r={x:t},s={dtype:e};return Q.runKernel(Kc,r,s)}const At=X({cast_:B3});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M3(n){const t={x:L(n,"x","clone","string_or_numeric")};return Q.runKernel(Yc,t)}const Us=X({clone_:M3});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R1(n,e=!1){console.log(n.toString(e))}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */m1();const V3={buffer:Ot,cast:At,clone:Us,print:R1};J0(V3);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U3="model",W3=".json",z3=".weights.bin";function uh(n){return new Promise(e=>setTimeout(e)).then(n)}class ko{constructor(e){if(!ue().getBool("IS_BROWSER"))throw new Error("browserDownloads() cannot proceed because the current environment is not a browser.");e.startsWith(ko.URL_SCHEME)&&(e=e.slice(ko.URL_SCHEME.length)),(e==null||e.length===0)&&(e=U3),this.modelJsonFileName=e+W3,this.weightDataFileName=e+z3}async save(e){if(typeof document>"u")throw new Error("Browser downloads are not supported in this environment since `document` is not present");const t=window.URL.createObjectURL(new Blob([e.weightData],{type:"application/octet-stream"}));if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserDownloads.save() does not support saving model topology in binary formats yet.");{const r=[{paths:["./"+this.weightDataFileName],weights:e.weightSpecs}],s=w1(e,r),o=window.URL.createObjectURL(new Blob([JSON.stringify(s)],{type:"application/json"})),i=this.modelJsonAnchor==null?document.createElement("a"):this.modelJsonAnchor;if(i.download=this.modelJsonFileName,i.href=o,await uh(()=>i.dispatchEvent(new MouseEvent("click"))),e.weightData!=null){const a=this.weightDataAnchor==null?document.createElement("a"):this.weightDataAnchor;a.download=this.weightDataFileName,a.href=t,await uh(()=>a.dispatchEvent(new MouseEvent("click")))}return{modelArtifactsInfo:ra(e)}}}}ko.URL_SCHEME="downloads://";class G3{constructor(e){if(e==null||e.length<1)throw new Error(`When calling browserFiles, at least 1 file is required, but received ${e}`);this.jsonFile=e[0],this.weightsFiles=e.slice(1)}async load(){return new Promise((e,t)=>{const r=new FileReader;r.onload=s=>{const o=JSON.parse(s.target.result),i=o.modelTopology;if(i==null){t(new Error(`modelTopology field is missing from file ${this.jsonFile.name}`));return}if(o.weightsManifest==null){t(new Error(`weightManifest field is missing from file ${this.jsonFile.name}`));return}if(this.weightsFiles.length===0){e({modelTopology:i});return}const u=nl(o,c=>this.loadWeights(c));e(u)},r.onerror=s=>t(`Failed to read model topology and weights manifest JSON from file '${this.jsonFile.name}'. BrowserFiles supports loading Keras-style tf.Model artifacts only.`),r.readAsText(this.jsonFile)})}loadWeights(e){const t=[],r=[];for(const i of e)t.push(...i.weights),r.push(...i.paths);const s=this.checkManifestAndWeightFiles(e),o=r.map(i=>this.loadWeightsFile(i,s[i]));return Promise.all(o).then(i=>[t,tl(i)])}loadWeightsFile(e,t){return new Promise((r,s)=>{const o=new FileReader;o.onload=i=>{const a=i.target.result;r(a)},o.onerror=i=>s(`Failed to weights data from file of path '${e}'.`),o.readAsArrayBuffer(t)})}checkManifestAndWeightFiles(e){const t=[],r=this.weightsFiles.map(o=>ah(o.name)),s={};for(const o of e)o.paths.forEach(i=>{const a=ah(i);if(t.indexOf(a)!==-1)throw new Error(`Duplicate file basename found in weights manifest: '${a}'`);if(t.push(a),r.indexOf(a)===-1)throw new Error(`Weight file with basename '${a}' is not provided.`);s[i]=this.weightsFiles[r.indexOf(a)]});if(t.length!==this.weightsFiles.length)throw new Error(`Mismatch in the number of files in weights manifest (${t.length}) and the number of weight files provided (${this.weightsFiles.length}).`);return s}}const j3=n=>ue().getBool("IS_BROWSER")&&!Array.isArray(n)&&n.startsWith(ko.URL_SCHEME)?H3(n.slice(ko.URL_SCHEME.length)):null;_t.registerSaveRouter(j3);function H3(n="model"){return new ko(n)}function q3(n){return new G3(n)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ch(n,e,t,r){i(n),t=t==null?0:t,r=r==null?1:r,a(t,r);let s=0;const o=u=>(u.then(c=>{const l=t+ ++s/n.length*(r-t);return e(l),c}),u);function i(u){M(u!=null&&Array.isArray(u)&&u.length>0,()=>"promises must be a none empty array")}function a(u,c){M(u>=0&&u<=1,()=>`Progress fraction must be in range [0, 1], but got startFraction ${u}`),M(c>=0&&c<=1,()=>`Progress fraction must be in range [0, 1], but got endFraction ${c}`),M(c>=u,()=>`startFraction must be no more than endFraction, but got startFraction ${u} and endFraction ${c}`)}return Promise.all(n.map(o))}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function A1(n,e){e==null&&(e={});const t=e.fetchFunc==null?ue().platform.fetch:e.fetchFunc,r=n.map(h=>t(h,e.requestInit,{isBinary:!0})),s=0,o=.5,a=(e.onProgress==null?await Promise.all(r):await ch(r,e.onProgress,s,o)).map(h=>h.arrayBuffer()),u=.5,c=1;return e.onProgress==null?await Promise.all(a):await ch(a,e.onProgress,u,c)}async function X3(n,e="",t,r){return O1(i=>A1(i,{requestInit:r}))(n,e,t)}function O1(n){return async(e,t="",r)=>{const s=e.map(()=>!1),o={},i=r!=null?r.map(()=>!1):[],a=[];if(e.forEach((m,g)=>{let C=0;m.weights.forEach($=>{const T="quantization"in $?$.quantization.dtype:$.dtype,A=gc[T]*Ce($.shape),P=()=>{s[g]=!0,o[g]==null&&(o[g]=[]),o[g].push({manifestEntry:$,groupOffset:C,sizeBytes:A})};r!=null?r.forEach((B,H)=>{B===$.name&&(P(),i[H]=!0)}):P(),a.push($.name),C+=A})}),!i.every(m=>m)){const m=r.filter((g,C)=>!i[C]);throw new Error(`Could not find weights in manifest with names: ${m.join(", ")}. 
Manifest JSON has weights with names: ${a.join(", ")}.`)}const u=s.reduce((m,g,C)=>(g&&m.push(C),m),[]),c=[];u.forEach(m=>{e[m].paths.forEach(g=>{const C=t+(t.endsWith("/")?"":"/")+g;c.push(C)})});const l=await n(c),h={};let d=0;return u.forEach(m=>{const g=e[m].paths.length;let C=0;for(let B=0;B<g;B++)C+=l[d+B].byteLength;const $=new ArrayBuffer(C),T=new Uint8Array($);let A=0;for(let B=0;B<g;B++){const H=new Uint8Array(l[d+B]);T.set(H,A),A+=H.byteLength}o[m].forEach(B=>{const H=$.slice(B.groupOffset,B.groupOffset+B.sizeBytes),x=v1(H,[B.manifestEntry]);for(const re in x)h[re]=x[re]}),d+=g}),h}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const K3="application/octet-stream",Y3="application/json";class rl{constructor(e,t){if(this.DEFAULT_METHOD="POST",t==null&&(t={}),this.weightPathPrefix=t.weightPathPrefix,this.onProgress=t.onProgress,this.weightUrlConverter=t.weightUrlConverter,t.fetchFunc!=null?(M(typeof t.fetchFunc=="function",()=>"Must pass a function that matches the signature of `fetch` (see https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API)"),this.fetch=t.fetchFunc):this.fetch=ue().platform.fetch,M(e!=null&&e.length>0,()=>"URL path for http must not be null, undefined or empty."),Array.isArray(e)&&M(e.length===2,()=>`URL paths for http must have a length of 2, (actual length is ${e.length}).`),this.path=e,t.requestInit!=null&&t.requestInit.body!=null)throw new Error("requestInit is expected to have no pre-existing body, but has one.");this.requestInit=t.requestInit||{}}async save(e){if(e.modelTopology instanceof ArrayBuffer)throw new Error("BrowserHTTPRequest.save() does not support saving model topology in binary formats yet.");const t=Object.assign({method:this.DEFAULT_METHOD},this.requestInit);t.body=new FormData;const r=[{paths:["./model.weights.bin"],weights:e.weightSpecs}],s=w1(e,r);t.body.append("model.json",new Blob([JSON.stringify(s)],{type:Y3}),"model.json"),e.weightData!=null&&t.body.append("model.weights.bin",new Blob([e.weightData],{type:K3}),"model.weights.bin");const o=await this.fetch(this.path,t);if(o.ok)return{modelArtifactsInfo:ra(e),responses:[o]};throw new Error(`BrowserHTTPRequest.save() failed due to HTTP response status ${o.status}.`)}async load(){const e=await this.fetch(this.path,this.requestInit);if(!e.ok)throw new Error(`Request to ${this.path} failed with status code ${e.status}. Please verify this URL points to the model JSON of the model to load.`);let t;try{t=await e.json()}catch{let i=`Failed to parse model JSON of response from ${this.path}.`;throw this.path.endsWith(".pb")?i+=" Your path contains a .pb file extension. Support for .pb models have been removed in TensorFlow.js 1.0 in favor of .json models. You can re-convert your Python TensorFlow model using the TensorFlow.js 1.0 conversion scripts or you can convert your.pb models with the 'pb2json'NPM script in the tensorflow/tfjs-converter repository.":i+=" Please make sure the server is serving valid JSON for this request.",new Error(i)}const r=t.modelTopology,s=t.weightsManifest;if(r==null&&s==null)throw new Error(`The JSON from HTTP path ${this.path} contains neither model topology or manifest for weights.`);return nl(t,o=>this.loadWeights(o))}async loadWeights(e){const t=Array.isArray(this.path)?this.path[1]:this.path,[r,s]=Q3(t),o=this.weightPathPrefix||r,i=T1(e),a=[],u=[];for(const l of e)for(const h of l.paths)this.weightUrlConverter!=null?u.push(this.weightUrlConverter(h)):a.push(o+h+s);this.weightUrlConverter&&a.push(...await Promise.all(u));const c=await A1(a,{requestInit:this.requestInit,fetchFunc:this.fetch,onProgress:this.onProgress});return[i,tl(c)]}}rl.URL_SCHEME_REGEX=/^https?:\/\//;function Q3(n){const e=n.lastIndexOf("/"),t=n.lastIndexOf("?"),r=n.substring(0,e),s=t>e?n.substring(t):"";return[r+"/",s]}function vc(n){return n.match(rl.URL_SCHEME_REGEX)!=null}const D1=(n,e)=>{if(typeof fetch>"u"&&(e==null||e.fetchFunc==null))return null;{let t=!0;if(Array.isArray(n)?t=n.every(r=>vc(r)):t=vc(n),t)return sl(n,e)}return null};_t.registerSaveRouter(D1);_t.registerLoadRouter(D1);function sl(n,e){return new rl(n,e)}function Z3(n,e){return sl(n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ou{constructor(e){this.modelArtifacts=e}load(){return this.modelArtifacts}}class F1{constructor(e){this.saveHandler=e}save(e){return this.saveHandler(e)}}class J3{constructor(e){e.load&&(this.load=()=>Promise.resolve(e.load())),e.save&&(this.save=t=>Promise.resolve(e.save(t)))}}function e4(n,e,t,r){const s=arguments;return new J3(P1(...s))}function P1(n,e,t,r){return arguments.length===1?n.modelTopology!=null||n.weightSpecs!=null?new Ou(n):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Ou({modelTopology:n})):(console.warn("Please call tf.io.fromMemory() with only one argument. The argument should be of type ModelArtifacts. The multi-argument signature of tf.io.fromMemory() has been deprecated and will be removed in a future release."),new Ou({modelTopology:n,weightSpecs:e,weightData:t,trainingConfig:r}))}function t4(n){return new F1(n)}function n4(n){return new F1(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const L1=Object.freeze(Object.defineProperty({__proto__:null,browserFiles:q3,browserHTTPRequest:Z3,concatenateArrayBuffers:tl,decodeWeights:v1,encodeWeights:u3,fromMemory:e4,fromMemorySync:P1,getLoadHandlers:b3,getModelArtifactsForJSON:nl,getModelArtifactsForJSONSync:C1,getModelArtifactsInfoForJSON:ra,getSaveHandlers:x3,getWeightSpecs:T1,http:sl,isHTTPScheme:vc,loadWeights:X3,registerLoadRouter:y3,registerSaveRouter:g3,weightsLoaderFactory:O1,withSaveHandler:t4,withSaveHandlerSync:n4,copyModel:O3,listModels:R3,moveModel:D3,removeModel:A3},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r4(n,e,t=!1,r=!1){let s=L(n,"a","matMul"),o=L(e,"b","matMul");[s,o]=Mt(s,o);const i={a:s,b:o},a={transposeA:t,transposeB:r};return Q.runKernel(Ff,i,a)}const mt=X({matMul_:r4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s4(n,e,t=1,r=0,s="int32"){if(e<2)throw new Error(`Error in oneHot: depth must be >=2, but it is ${e}`);const i={indices:L(n,"indices","oneHot","int32")},a={dtype:s,depth:e,onValue:t,offValue:r};return Q.runKernel(sp,i,a)}const o4=X({oneHot_:s4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zo(){return Q}function Lt(n,e){return Q.tidy(n,e)}function es(n){d1(n).forEach(t=>t.dispose())}function Ms(n){return Q.keep(n)}function i4(n,e,t=1){return Q.registerBackend(n,e,t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a4(n){const t={input:L(n,"input","imag")};return Q.runKernel(Nd,t)}const ru=X({imag_:a4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function u4(n){const t={x:L(n,"x","neg")};return Q.runKernel(Zd,t)}const bs=X({neg_:u4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c4(n){const t={input:L(n,"input","real")};return Q.runKernel(dp,t)}const qi=X({real_:c4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l4(n,e,t){const r=L(n,"x","transpose");if(e==null&&(e=r.shape.map((i,a)=>a).reverse()),M(r.rank===e.length,()=>`Error in transpose: rank of input ${r.rank} must match length of perm ${e}.`),e.forEach(i=>{M(i>=0&&i<r.rank,()=>`All entries in 'perm' must be between 0 and ${r.rank-1} but got ${e}`)}),r.rank<=1)return r.clone();const s={x:r},o={perm:e};return r.dtype==="complex64"?Lt(()=>{let i=qi(r),a=ru(r);return i=Q.runKernel(_a,{x:i},o),a=Q.runKernel(_a,{x:a},o),t&&(a=bs(a)),Gs(i,a)}):Q.runKernel(_a,s,o)}const wc=X({transpose_:l4});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Va(n,e){const t=n.length,r=[];for(let s=0;s<t;s++){const o=t-1-s,i=n[o]||1;(e[e.length-1-s]||1)>1&&i===1&&r.unshift(o)}return r}function B1(n,e){const t=[];for(let r=0;r<e.length;r++){const s=n[n.length-r-1],o=e.length-r-1,i=e[o];(s==null||s===1&&i>1)&&t.unshift(o)}return t}function ot(n,e){const t=[],r=Math.max(n.length,e.length);for(let s=0;s<r;s++){let o=n[n.length-s-1];o==null&&(o=1);let i=e[e.length-s-1];if(i==null&&(i=1),o===1)t.unshift(i);else if(i===1)t.unshift(o);else if(o!==i){const a=`Operands could not be broadcast together with shapes ${n} and ${e}.`;throw Error(a)}else t.unshift(o)}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M1(n,e,t){if(bi(n),e!=null&&e.length!==3)throw new Error("tensor3d() requires shape to have three numbers");const r=qs(n,t);if(r.length!==3&&r.length!==1)throw new Error("tensor3d() requires values to be number[][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor3d() requires shape to be provided when `values` are a flat array");return Xs(n,e,r,t)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */let fo;function h4(n,e=3){if(e>4)throw new Error("Cannot construct Tensor with more than 4 channels from pixels.");if(n==null)throw new Error("pixels passed to tf.browser.fromPixels() can not be null");let t=!1,r=!1,s=!1,o=!1,i=!1,a=!1;if(n.data instanceof Uint8Array)t=!0;else if(typeof ImageData<"u"&&n instanceof ImageData)r=!0;else if(typeof HTMLVideoElement<"u"&&n instanceof HTMLVideoElement)s=!0;else if(typeof HTMLImageElement<"u"&&n instanceof HTMLImageElement)o=!0;else if(n.getContext!=null)i=!0;else if(typeof ImageBitmap<"u"&&n instanceof ImageBitmap)a=!0;else throw new Error(`pixels passed to tf.browser.fromPixels() must be either an HTMLVideoElement, HTMLImageElement, HTMLCanvasElement, ImageData in browser, or OffscreenCanvas, ImageData in webworker or {data: Uint32Array, width: number, height: number}, but was ${n.constructor.name}`);if(ac(rc,Q.backendName)!=null){const g={pixels:n},C={numChannels:e};return Q.runKernel(rc,g,C)}const[c,l]=s?[n.videoWidth,n.videoHeight]:[n.width,n.height];let h;if(i)h=n.getContext("2d").getImageData(0,0,c,l).data;else if(r||t)h=n.data;else if(o||s||a){if(fo==null)if(typeof document>"u")if(typeof OffscreenCanvas<"u"&&typeof OffscreenCanvasRenderingContext2D<"u")fo=new OffscreenCanvas(1,1).getContext("2d");else throw new Error("Cannot parse input in current context. Reason: OffscreenCanvas Context2D rendering is not supported.");else fo=document.createElement("canvas").getContext("2d",{willReadFrequently:!0});fo.canvas.width=c,fo.canvas.height=l,fo.drawImage(n,0,0,c,l),h=fo.getImageData(0,0,c,l).data}let d;if(e===4)d=new Int32Array(h);else{const g=c*l;d=new Int32Array(g*e);for(let C=0;C<g;C++)for(let $=0;$<e;++$)d[C*e+$]=h[C*4+$]}return M1(d,[l,c,e],"int32")}async function V1(n,e){let t=L(n,"img","toPixels");if(!(n instanceof Rt)){const c=t;t=At(c,"int32"),c.dispose()}if(t.rank!==2&&t.rank!==3)throw new Error(`toPixels only supports rank 2 or 3 tensors, got rank ${t.rank}.`);const[r,s]=t.shape.slice(0,2),o=t.rank===2?1:t.shape[2];if(o>4||o===2)throw new Error(`toPixels only supports depth of size 1, 3 or 4 but got ${o}`);if(t.dtype!=="float32"&&t.dtype!=="int32")throw new Error(`Unsupported type for toPixels: ${t.dtype}. Please use float32 or int32 tensors.`);const i=await t.data(),a=t.dtype==="float32"?255:1,u=new Uint8ClampedArray(s*r*4);for(let c=0;c<r*s;++c){const l=[0,0,0,255];for(let d=0;d<o;d++){const m=i[c*o+d];if(t.dtype==="float32"){if(m<0||m>1)throw new Error(`Tensor values for a float32 Tensor must be in the range [0 - 1] but encountered ${m}.`)}else if(t.dtype==="int32"&&(m<0||m>255))throw new Error(`Tensor values for a int32 Tensor must be in the range [0 - 255] but encountered ${m}.`);o===1?(l[0]=m*a,l[1]=m*a,l[2]=m*a):l[d]=m*a}const h=c*4;u[h+0]=Math.round(l[0]),u[h+1]=Math.round(l[1]),u[h+2]=Math.round(l[2]),u[h+3]=Math.round(l[3])}if(e!=null){e.width=s,e.height=r;const c=e.getContext("2d"),l=new ImageData(u,s,r);c.putImageData(l,0,0)}return t!==n&&t.dispose(),u}const U1=X({fromPixels_:h4});function W1(n,e){const t=n.shape.length,r=e.shape.length;if(t<1)throw new Error(`tf.gatherND() expects the input to be rank 1 or higher, but the rank was ${t}.`);if(r<1)throw new Error(`tf.gatherND() expects the indices to be rank 1 or higher, but the rank was ${r}.`);if(e.dtype!=="int32")throw new Error(`tf.gatherND() expects the indices to be int32 type, but the dtype was ${e.dtype}.`);if(e.shape[r-1]>t)throw new Error(`index innermost dimension length must be <= tensor rank; saw: ${e.shape[r-1]} vs. ${t}`);if(Ce(n.shape)===0)throw new Error(`Requested more than 0 entries, but input is empty. Input shape: ${n.shape}.`);const s=e.shape,o=s[s.length-1];let i=1;for(let h=0;h<s.length-1;++h)i*=s[h];const a=n.shape,u=s.slice();u.pop();let c=1;for(let h=o;h<t;++h)c*=a[h],u.push(a[h]);const l=[...rn(n.shape).map(h=>h/c),1].slice(0,o);return[u,i,c,l]}function z1(n,e,t){const r=e.rank>1?e.shape[e.rank-1]:1,s=e.rank>1?e.rank-1:1,o=`Must have updates.shape = indices.shape[:batchDim] + shape[sliceDim:], got updates.shape: ${t.shape}, indices.shape: ${e.shape}, shape: ${n}, sliceDim: ${r}, and batchDim: ${s}.`;if(t.rank<s)throw new Error(o+` update.rank < ${s}. `);if(n.length<r+(t.rank-s))throw new Error(o+` Output shape length < ${r+(t.rank-s)}`);if(t.rank!==s+n.length-r)throw new Error(o+` update.rank != ${s+n.length-r}`);for(let i=0;i<s;++i)if(t.shape[i]!==e.shape[i])throw new Error(o+` updates.shape[${i}] (${t.shape[i]}) != indices.shape[${i}] (${e.shape[i]}).`);for(let i=0;i<t.rank-s;++i)if(t.shape[i+s]!==n[i+r])throw new Error(o+` updates.shape[${i+s}] (${t.shape[i+s]}) != shape[${i+s}] (${n[i+s]})`)}function G1(n,e,t){if(e.rank<1)throw new Error(`tf.scatterND() expects the indices to be rank 1 or higher, but the rank was ${e.rank}.`);if(n.rank<1)throw new Error(`tf.scatterND() expects the updates to be rank 1 or higher, but the rank was ${n.rank}.`);if(e.dtype!=="int32")throw new Error(`The dtype of 'indices' should be int32, but got dtype: ${e.dtype}`);if(t.length<1)throw new Error(`Output rank must be greater or equal to 1, but got shape: ${t}`);if(t.length===0){if(e.size===0)throw new Error(`Indices specified for empty output. indices shape: ${e.shape}`);if(n.size===0)throw new Error(`Updates specified for empty output. updates shape: ${n.shape}`)}z1(t,e,n)}function ol(n,e,t){const r=e.shape.length,s=r>1?e.shape[r-1]:1,o=t.length;let i=1;for(let h=s;h<o;++h)i*=t[h];const a=s<1?1:s,u=Ce(e.shape)/a,c=[...rn(t.slice(0,s)),1],l=Ce(t);return{sliceRank:s,numUpdates:u,sliceSize:i,strides:c,outputSize:l}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cc=-2,f4=-1;function j1(n,e,t){const r=n.shape.length;M(r===e.length,()=>`Error in slice${r}D: Length of begin ${e} must match the rank of the array (${r}).`),M(r===t.length,()=>`Error in slice${r}D: Length of size ${t} must match the rank of the array (${r}).`);for(let s=0;s<r;++s)M(e[s]+t[s]<=n.shape[s],()=>`Error in slice${r}D: begin[${s}] + size[${s}] (${e[s]+t[s]}) would overflow input.shape[${s}] (${n.shape[s]})`)}function d4(n){const e=[];let t=0;for(;n>0;)n&1&&e.push(t),n/=2,t++;return e}function H1(n,e,t){const r=[];for(let s=0;s<n.length;s++)r[s]=Math.ceil((e[s]-n[s])/t[s]);return r}function q1(n,e,t,r){const s=[...n];for(let o=s.length;o<r.length;o++)s.push(1);for(let o=0;o<t;o++)o===0?s[e]=1:(s.splice(e,0,1),s.pop());return s}function X1(n,e,t){return t<=n?t:t-(e-1)}function K1(n,e){const t=[];for(let r=0;r<n;r++)t.push(e+r);return t}function p4(n,e,t,r,s,o,i,a,u){const c=n.length;let l=new Array(c),h=new Array(c),d=new Array(c);if(e.length&&t>0){const m=e[0],g=t+1;l=Y1(i,m,g,r,n),h=Q1(a,m,g,s,n),d=q1(o,m,g,n)}else for(let m=0;m<c;m++)l[m]=J1(i,r,o,n,m,u),h[m]=e2(a,s,o,n,m,u),d[m]=Z1(o,m,u);return{begin:l,end:h,strides:d}}function Y1(n,e,t,r,s){const o=[...s],i=K1(t,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=0;else{const u=X1(e,t,a);let c=r[u];n&1<<u&&(c=0),o[a]=c}return o}function Q1(n,e,t,r,s){const o=[...s],i=K1(t,e);for(let a=0;a<o.length;a++)if(i.indexOf(a)>-1)o[a]=Number.MAX_SAFE_INTEGER;else{const u=X1(e,t,a);let c=r[u];n&1<<u&&(c=Number.MAX_SAFE_INTEGER),o[a]=c}for(let a=0;a<o.length;a++){const u=s[a];o[a]<0&&(o[a]+=u),o[a]=Fa(0,o[a],s[a])}return o}function Z1(n,e,t){let r=n[e];return(t&1<<e||r==null)&&(r=1),r}function J1(n,e,t,r,s,o){let i=e[s];const a=t[s]||1;(n&1<<s||o&1<<s||i==null)&&(a>0?i=Number.MIN_SAFE_INTEGER:i=Number.MAX_SAFE_INTEGER);const u=r[s];return i<0&&(i+=u),i=Fa(0,i,u-1),i}function e2(n,e,t,r,s,o){let i=e[s];const a=t[s]||1;(n&1<<s||o&1<<s||i==null)&&(a>0?i=Number.MAX_SAFE_INTEGER:i=Number.MIN_SAFE_INTEGER);const u=r[s];return i<0&&(i+=u),a>0?i=Fa(0,i,u):i=Fa(-1,i,u-1),i}function il(n,e,t){let r=t.length;for(let s=0;s<t.length;s++)if(t[s]>1){r=s;break}for(let s=r+1;s<t.length;s++)if(e[s]>0||t[s]!==n[s])return!1;return!0}function al(n,e){let t=n.length>0?n[n.length-1]:1;for(let r=0;r<n.length-1;r++)t+=n[r]*e[r];return t}function t2(n,e,t){let r;const s=n.shape.length;typeof e=="number"?r=[e,...new Array(s-1).fill(0)]:e.length<s?r=e.concat(new Array(s-e.length).fill(0)):r=e.slice(),r.forEach(i=>{M(i!==-1,()=>"slice() does not support negative begin indexing.")});let o;return t==null?o=new Array(s).fill(-1):typeof t=="number"?o=[t,...new Array(s-1).fill(-1)]:t.length<s?o=t.concat(new Array(s-t.length).fill(-1)):o=t,o=o.map((i,a)=>i>=0?i:(M(i===-1,()=>`Negative size values should be exactly -1 but got ${i} for the slice() size at index ${a}.`),n.shape[a]-r[a])),[r,o]}function n2(n,e,t,r,s,o,i,a,u){let c;if(r==null?(c=new Array(e.length),c.fill(1)):c=r,i!=null&&(i&i-1)!==0)throw new Error("Multiple ellipses in slice is not allowed.");let l=!1;const h={dims:c.length,numAddAxisAfterEllipsis:0,begin:e.slice(),end:t.slice(),strides:c.slice(),beginMask:s,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:u};for(let P=0;P<h.dims;P++)l&&(1<<P&a)!==0&&h.numAddAxisAfterEllipsis++,1<<P&i&&(l=!0);l||(h.ellipsisMask|=1<<h.dims,h.dims++);const d={dims:n.length,beginMask:0,endMask:0,beginValid:!1,endValid:!1};m4(h,d);let m=!0,g=!0,C=!0;const $=[],T=[];for(let P=0;P<n.length;++P){if(d.strides[P]===0)throw Error(`strides[${P}] must be non-zero`);const B=!!(d.shrinkAxisMask&1<<P),H=n[P];if(H===-1){$.push(B?1:-1);continue}const x=[d.beginMask&1<<P,d.endMask&1<<P],re=[d.strides[P]>0?0:-1,d.strides[P]>0?H:H-1];if(B&&d.strides[P]<=0)throw Error("only stride 1 allowed on non-range indexing.");C=C&&d.strides[P]===1;const oe=!!(d.beginMask&1<<P&&d.endMask&1<<P);if(d.beginValid&&d.endValid){if(B){const Ie=d.begin[P]<0?H+d.begin[P]:d.begin[P];if(d.begin[P]=Ie,d.end[P]=d.begin[P]+1,Ie<0||Ie>=H)throw Error(`slice index ${d.begin[P]} of dimension ${P} out of bounds.`)}else d.begin[P]=lh(d.begin[P],0,d.strides[P],H,x,re),d.end[P]=lh(d.end[P],1,d.strides[P],H,x,re);const $e=d.strides[P]===1&&d.begin[P]===0&&d.end[P]===H;m=m&&$e,g=g&&(P===0&&d.strides[P]===1||$e)}else m=m&&d.strides[P]===1&&oe,g=g&&(P===0&&d.strides[P]===1||oe);let ie,le=!1;if(d.beginValid&&d.endValid?(ie=d.end[P]-d.begin[P],le=!0):B?(ie=1,le=!0):oe&&H>=0&&(d.strides[P]<0?ie=-H:ie=H,le=!0),le){let $e;ie===0||ie<0!=d.strides[P]<0?$e=0:$e=Math.trunc(ie/d.strides[P])+(ie%d.strides[P]!==0?1:0),$.push($e)}else $.push(-1)}for(let P=0;P<d.finalShapeGatherIndices.length;++P){const B=d.finalShapeGatherIndices[P];B>=0?T.push($[B]):B===Cc&&T.push(1)}return{finalShapeSparse:T.filter((P,B)=>d.finalShapeGatherIndices[B]!==Cc),finalShape:T,isIdentity:m,sliceDim0:g,isSimpleSlice:C,begin:d.begin,end:d.end,strides:d.strides}}function m4(n,e){e.beginMask=0,e.endMask=0,e.shrinkAxisMask=0;let t=0;e.beginValid=n.begin!=null,e.endValid=n.end!=null,e.begin=new Array(e.dims),e.end=new Array(e.dims),e.strides=new Array(e.dims),e.finalShapeGatherIndices=[],e.finalShapeGatherIndicesSparse=[],e.inputShapeGatherIndicesSparse=new Array(e.dims);for(let r=0;r<n.dims;r++)if(1<<r&n.ellipsisMask){const s=Math.min(e.dims-(n.dims-r)+1+n.numAddAxisAfterEllipsis,e.dims);for(;t<s;t++)e.begin[t]=0,e.end[t]=0,e.strides[t]=1,e.beginMask|=1<<t,e.endMask|=1<<t,e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(-1),e.inputShapeGatherIndicesSparse[t]=r}else if(1<<r&n.newAxisMask)e.finalShapeGatherIndices.push(Cc),e.finalShapeGatherIndicesSparse.push(-1);else{if(t===e.begin.length)throw Error(`Index out of range using input dim ${t}; input has only ${e.dims} dims, ${e.begin.length}.`);n.begin!=null&&(e.begin[t]=n.begin[r]),n.end!=null&&(e.end[t]=n.end[r]),e.strides[t]=n.strides[r],n.beginMask&1<<r&&(e.beginMask|=1<<t),n.endMask&1<<r&&(e.endMask|=1<<t),n.shrinkAxisMask&1<<r?(e.finalShapeGatherIndices.push(f4),e.finalShapeGatherIndicesSparse.push(-1),e.shrinkAxisMask|=1<<t):(e.finalShapeGatherIndices.push(t),e.finalShapeGatherIndicesSparse.push(r)),e.inputShapeGatherIndicesSparse[t]=r,t++}}function lh(n,e,t,r,s,o){if(s[e])return t>0?o[e]:o[e+1&1];{const i=n<0?r+n:n;return i<o[0]?o[0]:i>o[1]?o[1]:i}}const g4=Object.freeze(Object.defineProperty({__proto__:null,assertParamsValid:j1,maskToAxes:d4,computeOutShape:H1,stridesWithElidedDims:q1,getNormalizedAxes:p4,startIndicesWithElidedDims:Y1,stopIndicesWithElidedDims:Q1,stridesForAxis:Z1,startForAxis:J1,stopForAxis:e2,isSliceContinous:il,computeFlatOffset:al,parseSliceParams:t2,sliceInfo:n2},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y4(n,e){let t=L(n,"a","add"),r=L(e,"b","add");[t,r]=Mt(t,r);const s={a:t,b:r};return Q.runKernel(Xc,s)}const Ct=X({add_:y4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x4(n,e){let t=L(n,"a","floorDiv"),r=L(e,"b","floorDiv");[t,r]=Mt(t,r);const s={a:t,b:r};return Q.runKernel(bd,s)}const r2=X({floorDiv_:x4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b4(n,e){let t=L(n,"a","div"),r=L(e,"b","div");if([t,r]=Mt(t,r),t.dtype==="int32"&&r.dtype==="int32")return r2(t,r);const s={a:t,b:r},o={};return Q.runKernel(ad,s,o)}const xt=X({div_:b4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function v4(n,e){let t=L(n,"a","mul"),r=L(e,"b","mul");[t,r]=Mt(t,r);const s={a:t,b:r};return Q.runKernel(Qd,s)}const We=X({mul_:v4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w4(n){const e=L(n,"x","abs");if(e.dtype==="complex64"){const t={x:e};return Q.runKernel(Wf,t)}else{const t={x:e};return Q.runKernel(vf,t)}}const lr=X({abs_:w4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C4(n){const t={x:L(n,"x","acos")};return Q.runKernel(wf,t)}const T4=X({acos_:C4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $4(n){const t={x:L(n,"x","acosh")};return Q.runKernel(Cf,t)}const S4=X({acosh_:$4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N4(n){M(Array.isArray(n),()=>"The argument passed to tf.addN() must be a list of tensors"),M(n.length>=1,()=>`Must pass at least one tensor to tf.addN(), but got ${n.length}`);const e=n.map((s,o)=>L(s,`tensors${o}`,"addN")),t=e[0];e.forEach(s=>{if(s.dtype!==t.dtype)throw new Error("All tensors passed to tf.addN() must have the same dtype")}),e.forEach(s=>{if(!Bt(s.shape,t.shape))throw new Error("All tensors passed to tf.addN() must have the same shape")});const r=e;return Q.runKernel(Tf,r)}const E4=X({addN_:N4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k4(n,e=null,t=!1){const s={x:L(n,"x","all","bool")},o={axis:e,keepDims:t};return Q.runKernel($f,s,o)}const I4=X({all_:k4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _4(n,e=null,t=!1){const s={x:L(n,"x","any","bool")},o={axis:e,keepDims:t};return Q.runKernel(Sf,s,o)}const R4=X({any_:_4});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A4(n,e=0){const r={x:L(n,"x","argMax")},s={axis:e};return Q.runKernel(Nf,r,s)}const O4=X({argMax_:A4});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D4(n,e=0){const r={x:L(n,"x","argMin")},s={axis:e};return Q.runKernel(Ef,r,s)}const F4=X({argMin_:D4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P4(n){const t={x:L(n,"x","asin")};return Q.runKernel(kf,t)}const L4=X({asin_:P4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B4(n){const t={x:L(n,"x","asinh")};return Q.runKernel(If,t)}const M4=X({asinh_:B4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function V4(n){const t={x:L(n,"x","atan")};return Q.runKernel(_f,t)}const U4=X({atan_:V4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W4(n,e){let t=L(n,"a","atan2"),r=L(e,"b","atan2");[t,r]=Mt(t,r);const s={a:t,b:r};return Q.runKernel(Af,s)}const z4=X({atan2_:W4});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G4(n){const t={x:L(n,"x","atanh")};return Q.runKernel(Rf,t)}const j4=X({atanh_:G4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s2(n,e,t,r,s="NHWC",o){const i=n[3],a=[...e,i],u=wi(s);return Zn(n,a,t,o,r,null,null,u)}function Do(n,e,t,r,s,o,i="channelsLast"){const[a,u]=Ua(e);let c;if(i==="channelsLast")c=[a,u,n[3],n[3]];else if(i==="channelsFirst")c=[a,u,n[1],n[1]];else throw new Error(`Unknown dataFormat ${i}`);return Zn(n,c,t,r,s,o,!1,i)}function sa(n,e,t,r,s,o,i="NDHWC"){const[a,u,c]=Tc(e);let l,h;if(i==="NDHWC")h="channelsLast",l=[a,u,c,n[4],n[4]];else if(i==="NCDHW")h="channelsFirst",l=[a,u,c,n[1],n[1]];else throw new Error(`Unknown dataFormat ${i}`);return oa(n,l,t,r,s,!1,h,o)}function Zn(n,e,t,r,s,o,i=!1,a="channelsLast"){let[u,c,l,h]=[-1,-1,-1,-1];if(a==="channelsLast")[u,c,l,h]=n;else if(a==="channelsFirst")[u,h,c,l]=n;else throw new Error(`Unknown dataFormat ${a}`);const[d,m,,g]=e,[C,$]=Ua(t),[T,A]=Ua(r),P=ii(d,T),B=ii(m,A),{padInfo:H,outHeight:x,outWidth:re}=X4(s,c,l,C,$,P,B,o,a),oe=i?g*h:g;let ie;return a==="channelsFirst"?ie=[u,oe,x,re]:a==="channelsLast"&&(ie=[u,x,re,oe]),{batchSize:u,dataFormat:a,inHeight:c,inWidth:l,inChannels:h,outHeight:x,outWidth:re,outChannels:oe,padInfo:H,strideHeight:C,strideWidth:$,filterHeight:d,filterWidth:m,effectiveFilterHeight:P,effectiveFilterWidth:B,dilationHeight:T,dilationWidth:A,inShape:n,outShape:ie,filterShape:e}}function oa(n,e,t,r,s,o=!1,i="channelsLast",a){let[u,c,l,h,d]=[-1,-1,-1,-1,-1];if(i==="channelsLast")[u,c,l,h,d]=n;else if(i==="channelsFirst")[u,d,c,l,h]=n;else throw new Error(`Unknown dataFormat ${i}`);const[m,g,C,,$]=e,[T,A,P]=Tc(t),[B,H,x]=Tc(r),re=ii(m,B),oe=ii(g,H),ie=ii(C,x),{padInfo:le,outDepth:$e,outHeight:Ie,outWidth:Ae}=K4(s,c,l,h,T,A,P,re,oe,ie,a),Ge=o?$*d:$;let Ye;return i==="channelsFirst"?Ye=[u,Ge,$e,Ie,Ae]:i==="channelsLast"&&(Ye=[u,$e,Ie,Ae,Ge]),{batchSize:u,dataFormat:i,inDepth:c,inHeight:l,inWidth:h,inChannels:d,outDepth:$e,outHeight:Ie,outWidth:Ae,outChannels:Ge,padInfo:le,strideDepth:T,strideHeight:A,strideWidth:P,filterDepth:m,filterHeight:g,filterWidth:C,effectiveFilterDepth:re,effectiveFilterHeight:oe,effectiveFilterWidth:ie,dilationDepth:B,dilationHeight:H,dilationWidth:x,inShape:n,outShape:Ye,filterShape:e}}function H4(n,e,t,r,s){r==null&&(r=ul(n,e,t));const o=n[0],i=n[1],a=$o((o-e+2*r)/t+1,s),u=$o((i-e+2*r)/t+1,s);return[a,u]}function q4(n,e,t,r,s,o){s==null&&(s=ul(n,e,r));const i=n[0],a=n[1],u=n[2],c=$o((i-e+2*s)/r+1,o),l=$o((a-e+2*s)/r+1,o),h=$o((u-e+2*s)/r+1,o);return[c,l,h,t]}function ul(n,e,t,r=1){const s=ii(e,r);return Math.floor((n[0]*(t-1)-t+s)/2)}function Ua(n){return typeof n=="number"?[n,n,n]:n.length===2?[n[0],n[1],1]:n}function Tc(n){return typeof n=="number"?[n,n,n]:n}function ii(n,e){return e<=1?n:n+(n-1)*(e-1)}function X4(n,e,t,r,s,o,i,a,u){let c,l,h;if(typeof n=="number"){c={top:n,bottom:n,left:n,right:n,type:n===0?"VALID":"NUMBER"};const m=H4([e,t],o,r,n,a);l=m[0],h=m[1]}else if(n==="same"){l=Math.ceil(e/r),h=Math.ceil(t/s);const d=Math.max(0,(l-1)*r+o-e),m=Math.max(0,(h-1)*s+i-t),g=Math.floor(d/2),C=d-g,$=Math.floor(m/2),T=m-$;c={top:g,bottom:C,left:$,right:T,type:"SAME"}}else if(n==="valid")c={top:0,bottom:0,left:0,right:0,type:"VALID"},l=Math.ceil((e-o+1)/r),h=Math.ceil((t-i+1)/s);else if(typeof n=="object"){const d=u==="channelsLast"?n[1][0]:n[2][0],m=u==="channelsLast"?n[1][1]:n[2][1],g=u==="channelsLast"?n[2][0]:n[3][0],C=u==="channelsLast"?n[2][1]:n[3][1];c={top:d,bottom:m,left:g,right:C,type:d===0&&m===0&&g===0&&C===0?"VALID":"EXPLICIT"},l=$o((e-o+d+m)/r+1,a),h=$o((t-i+g+C)/s+1,a)}else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:c,outHeight:l,outWidth:h}}function K4(n,e,t,r,s,o,i,a,u,c,l){let h,d,m,g;if(typeof n=="number"){h={top:n,bottom:n,left:n,right:n,front:n,back:n,type:n===0?"VALID":"NUMBER"};const $=q4([e,t,r,1],a,1,s,n,l);d=$[0],m=$[1],g=$[2]}else if(n==="same"){d=Math.ceil(e/s),m=Math.ceil(t/o),g=Math.ceil(r/i);const C=(d-1)*s+a-e,$=(m-1)*o+u-t,T=(g-1)*i+c-r,A=Math.floor(C/2),P=C-A,B=Math.floor($/2),H=$-B,x=Math.floor(T/2),re=T-x;h={top:B,bottom:H,left:x,right:re,front:A,back:P,type:"SAME"}}else if(n==="valid")h={top:0,bottom:0,left:0,right:0,front:0,back:0,type:"VALID"},d=Math.ceil((e-a+1)/s),m=Math.ceil((t-u+1)/o),g=Math.ceil((r-c+1)/i);else throw Error(`Unknown padding parameter: ${n}`);return{padInfo:h,outDepth:d,outHeight:m,outWidth:g}}function $o(n,e){if(!e)return Math.trunc(n);switch(e){case"round":return Math.round(n);case"ceil":return Math.ceil(n);case"floor":return Math.floor(n);default:throw new Error(`Unknown roundingMode ${e}`)}}function Xi(n){const[e,t,r]=Ua(n);return e===1&&t===1&&r===1}function Mn(n,e){return Xi(n)||Xi(e)}function wi(n){if(n==="NHWC")return"channelsLast";if(n==="NCHW")return"channelsFirst";throw new Error(`Unknown dataFormat ${n}`)}function gr(n,e,t){if(t!=null){if(typeof e=="string")throw Error(`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);if(typeof e=="number")M(ci(e),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${e}.`);else if(typeof e=="object")e.forEach(r=>{r.forEach(s=>{M(ci(s),()=>`Error in ${n}: pad must be an integer when using dimRoundingMode ${t} but got pad ${s}.`)})});else throw Error(`Error in ${n}: Unknown padding parameter: ${e}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y4(n,e){const r={x:L(n,"x","reshape","string_or_numeric")},s={shape:e};return Q.runKernel(gp,r,s)}const me=X({reshape_:Y4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q4(n,e,t,r,s){const o=L(n,"x","avgPool","float32"),i=1;M(Mn(t,i),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`);let a=o,u=!1;o.rank===3&&(u=!0,a=me(o,[1,o.shape[0],o.shape[1],o.shape[2]])),M(a.rank===4,()=>`Error in avgPool: x must be rank 4 but got rank ${a.rank}.`),gr("avgPool",r,s);const c={x:a},l={filterSize:e,strides:t,pad:r,dimRoundingMode:s};let h=Q.runKernel(Of,c,l);return h=At(h,o.dtype),u?me(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const o2=X({avgPool_:Q4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z4(n,e,t,r,s,o="NDHWC"){const i=L(n,"x","avgPool3d","float32");let a=i,u=!1;i.rank===4&&(u=!0,a=me(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),M(a.rank===5,()=>`Error in avgPool3d: x must be rank 5 but got rank ${a.rank}.`),M(o==="NDHWC",()=>`Error in avgPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),gr("avgPool3d",r,s);const c={x:a},l={filterSize:e,strides:t,pad:r,dimRoundingMode:s,dataFormat:o};let h=Q.runKernel(Df,c,l);return h=At(h,a.dtype),u?me(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const J4=X({avgPool3d_:Z4});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ey(n,e=0){M(n.length>=1,()=>"Pass at least one tensor to concat");const t=Ba(n,"tensors","concat","string_or_numeric");if(t[0].dtype==="complex64"&&t.forEach(o=>{if(o.dtype!=="complex64")throw new Error(`Cannot concatenate complex64 tensors with a tensor
          with dtype ${o.dtype}. `)}),t.length===1)return Us(t[0]);const r=t,s={axis:e};return Q.runKernel(zf,r,s)}const sn=X({concat_:ey});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ty(n){const t={x:L(n,"x","sigmoid","float32")};return Q.runKernel(Rp,t)}const So=X({sigmoid_:ty});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ny(n,e,t){const r=L(n,"x","slice","string_or_numeric");if(r.rank===0)throw new Error("Slicing scalar is not possible");const s={x:r},o={begin:e,size:t};return Q.runKernel(Ep,s,o)}const Ze=X({slice_:ny});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ry(n){const t={x:L(n,"x","tanh","float32")};return Q.runKernel(Yp,t)}const $c=X({tanh_:ry});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sy(n,e,t,r,s,o){const i=L(n,"forgetBias","basicLSTMCell"),a=L(e,"lstmKernel","basicLSTMCell"),u=L(t,"lstmBias","basicLSTMCell"),c=L(r,"data","basicLSTMCell"),l=L(s,"c","basicLSTMCell"),h=L(o,"h","basicLSTMCell"),d=sn([c,h],1),m=mt(d,a),g=Ct(m,u),C=g.shape[0],$=g.shape[1]/4,T=[C,$],A=Ze(g,[0,0],T),P=Ze(g,[0,$],T),B=Ze(g,[0,$*2],T),H=Ze(g,[0,$*3],T),x=Ct(We(So(A),$c(P)),We(l,So(Ct(i,B)))),re=We($c(x),So(H));return[x,re]}const oy=X({basicLSTMCell_:sy});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iy(n,e,t){const r=L(n,"x","batchToSpaceND"),s=e.reduce((a,u)=>a*u);M(r.rank>=1+e.length,()=>`input rank is ${r.rank} but should be > than blockShape.length ${e.length}`),M(t.length===e.length,()=>`crops.length is ${t.length} but should be equal to blockShape.length  ${e.length}`),M(r.shape[0]%s===0,()=>`input tensor batch is ${r.shape[0]} but is not divisible by the product of the elements of blockShape ${e.join(" * ")} === ${s}`);const o={x:r},i={blockShape:e,crops:t};return Q.runKernel(Pf,o,i)}const i2=X({batchToSpaceND_:iy});function ay(n){let e;return n.rank===0||n.rank===1?e=me(n,[1,1,1,n.size]):n.rank===2?e=me(n,[1,1,n.shape[0],n.shape[1]]):n.rank===3?e=me(n,[1,n.shape[0],n.shape[1],n.shape[2]]):e=n,e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uy(n,e,t,r,s,o){o==null&&(o=.001);const i=L(n,"x","batchNorm"),a=L(e,"mean","batchNorm"),u=L(t,"variance","batchNorm");let c;s!=null&&(c=L(s,"scale","batchNorm"));let l;r!=null&&(l=L(r,"offset","batchNorm")),M(a.rank===u.rank,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),M(l==null||a.rank===l.rank,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),M(c==null||a.rank===c.rank,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");const d={x:ay(i),scale:c,offset:l,mean:a,variance:u},m={varianceEpsilon:o},g=Q.runKernel(vd,d,m);return me(g,i.shape)}const su=X({batchNorm_:uy});function cy(n,e,t,r,s,o){const i=L(n,"x","batchNorm"),a=L(e,"mean","batchNorm"),u=L(t,"variance","batchNorm");let c;s!=null&&(c=L(s,"scale","batchNorm"));let l;return r!=null&&(l=L(r,"offset","batchNorm")),M(i.rank===2,()=>`Error in batchNorm2D: x must be rank 2 but got rank ${i.rank}.`),M(a.rank===2||a.rank===1,()=>`Error in batchNorm2D: mean must be rank 2 or rank 1 but got rank ${a.rank}.`),M(u.rank===2||u.rank===1,()=>`Error in batchNorm2D: variance must be rank 2 or rank 1 but got rank ${u.rank}.`),c!=null&&M(c.rank===2||c.rank===1,()=>`Error in batchNorm2D: scale must be rank 2 or rank 1 but got rank ${c.rank}.`),l!=null&&M(l.rank===2||l.rank===1,()=>`Error in batchNorm2D: offset must be rank 2 or rank 1 but got rank ${l.rank}.`),su(i,a,u,l,c,o)}const ly=X({batchNorm2d_:cy});function hy(n,e,t,r,s,o){const i=L(n,"x","batchNorm"),a=L(e,"mean","batchNorm"),u=L(t,"variance","batchNorm");let c;s!=null&&(c=L(s,"scale","batchNorm"));let l;return r!=null&&(l=L(r,"offset","batchNorm")),M(i.rank===3,()=>`Error in batchNorm3D: x must be rank 3 but got rank ${i.rank}.`),M(a.rank===3||a.rank===1,()=>`Error in batchNorm3D: mean must be rank 3 or rank 1 but got rank ${a.rank}.`),M(u.rank===3||u.rank===1,()=>`Error in batchNorm3D: variance must be rank 3 or rank 1 but got rank ${u.rank}.`),c!=null&&M(c.rank===3||c.rank===1,()=>`Error in batchNorm3D: scale must be rank 3 or rank 1 but got rank ${c.rank}.`),l!=null&&M(l.rank===3||l.rank===1,()=>`Error in batchNorm3D: offset must be rank 3 or rank 1 but got rank ${l.rank}.`),su(i,a,u,l,c,o)}const fy=X({batchNorm3d_:hy});function dy(n,e,t,r,s,o){const i=L(n,"x","batchNorm"),a=L(e,"mean","batchNorm"),u=L(t,"variance","batchNorm");let c;s!=null&&(c=L(s,"scale","batchNorm"));let l;return r!=null&&(l=L(r,"offset","batchNorm")),M(i.rank===4,()=>`Error in batchNorm4D: x must be rank 4 but got rank ${i.rank}.`),M(a.rank===4||a.rank===1,()=>`Error in batchNorm4D: mean must be rank 4 or rank 1 but got rank ${a.rank}.`),M(u.rank===4||u.rank===1,()=>`Error in batchNorm4D: variance must be rank 4 or rank 1 but got rank ${u.rank}.`),c!=null&&M(c.rank===4||c.rank===1,()=>`Error in batchNorm4D: scale must be rank 4 or rank 1 but got rank ${c.rank}.`),l!=null&&M(l.rank===4||l.rank===1,()=>`Error in batchNorm4D: offset must be rank 4 or rank 1 but got rank ${l.rank}.`),su(i,a,u,l,c,o)}const py=X({batchNorm4d_:dy});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function my(n,e,t){const r=L(n,"x","bincount"),s=L(e,"weights","bincount");M(r.dtype==="int32",()=>`Error in bincount: input dtype must be int32, but got ${r.dtype}`),M(t>=0,()=>`size must be non-negative, but got ${t}.`),M(s.size===r.size||s.size===0,()=>`Error in bincount: weights must have the same size as input or0-length, but got input shape: ${r.shape}, weights shape: ${s.shape}.`);const o={x:r,weights:s},i={size:t};return Q.runKernel(Lf,o,i)}const a2=X({bincount_:my});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gy(n,e){const t=L(n,"s0","broadcastArgs","int32"),r=L(e,"s1","broadcastArgs","int32");if(t.rank!==1)throw new Error(`broadcastArgs(): first input must be a vector (rank=1). Has rank ${t.rank}`);if(r.rank!==1)throw new Error(`broadcastArgs(): second input must be a vector (rank=1). Has rank ${r.rank}`);const s={s0:t,s1:r};return Q.runKernel(Bf,s)}const yy=X({broadcastArgs_:gy});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xy(n,e){let t=L(n,"broadcastTo","x");const r=t.shape;if(e.some(c=>!(c>0)||c%1!==0))throw new Error(`broadcastTo(): Invalid broadcast shape [${e}].`);if(e.length<t.rank)throw new Error(`broadcastTo(): shape.length=${e.length} < input.rank=${t.rank}.`);if(e.length>t.rank){const c=t.shape.slice();for(;c.length<e.length;)c.unshift(1);t=me(t,c)}const s=t.shape,o=Array.from(e);for(let c=e.length-1;c>=0;c--)if(s[c]===e[c])o[c]=1;else if(t.shape[c]!==1)throw new Error(`broadcastTo(): [${r}] cannot be broadcast to [${e}].`);if(o.map((c,l)=>c>1?l:-1).filter(c=>c>=0).length===0)return Us(t);const a={x:t},u={reps:o};return Q.runKernel(Qc,a,u)}const Gi=X({broadcastTo_:xy});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function by(n){const t={x:L(n,"x","ceil","float32")};return Q.runKernel(Mf,t)}const vy=X({ceil_:by});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ou(n,e,t){const r={shape:n,value:e,dtype:t};return Q.runKernel(gd,{},r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wy(n,e,t){const r=L(n,"x","clipByValue");if(M(e<=t,()=>`Error in clip: min (${e}) must be less than or equal to max (${t}).`),e===t)return ou(r.shape,e,r.dtype);const s={x:r},o={clipValueMin:e,clipValueMax:t};return Q.runKernel(Vf,s,o)}const u2=X({clipByValue_:wy});function Cy(n){return sn(n,0)}const Ty=X({concat1d_:Cy});function $y(n,e){return sn(n,e)}const Sy=X({concat2d_:$y});function Ny(n,e){return sn(n,e)}const Ey=X({concat3d_:Ny});function ky(n,e){return sn(n,e)}const Iy=X({concat4d_:ky});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _y(n,e,t,r,s="NHWC",o=[1,1],i){const a=L(n,"x","conv2d","float32"),u=L(e,"filter","conv2d","float32");let c=a,l=!1;a.rank===3&&(l=!0,c=me(a,[1,a.shape[0],a.shape[1],a.shape[2]])),M(c.rank===4,()=>`Error in conv2d: input must be rank 4, but got rank ${c.rank}.`),M(u.rank===4,()=>`Error in conv2d: filter must be rank 4, but got rank ${u.rank}.`),gr("conv2d",r,i);const h=s==="NHWC"?c.shape[3]:c.shape[1];M(h===u.shape[2],()=>`Error in conv2d: depth of input (${h}) must match input depth for filter ${u.shape[2]}.`),M(Mn(t,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`);const d={x:c,filter:u},m={strides:t,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i},g=Q.runKernel(Gf,d,m);return l?me(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const iu=X({conv2d_:_y});function Ry(n,e,t,r,s="NWC",o=1,i){const a=L(n,"x","conv1d"),u=L(e,"filter","conv1d");let c=a,l=!1;a.rank===2&&(l=!0,c=me(a,[1,a.shape[0],a.shape[1]])),M(c.rank===3,()=>`Error in conv1d: input must be rank 3, but got rank ${c.rank}.`),M(u.rank===3,()=>`Error in conv1d: filter must be rank 3, but got rank ${u.rank}.`),gr("conv1d",r,i),M(c.shape[2]===u.shape[1],()=>`Error in conv1d: depth of input (${c.shape[2]}) must match input depth for filter ${u.shape[1]}.`),M(Mn(t,o),()=>`Error in conv1D: Either stride or dilation must be 1. Got stride ${t} and dilation '${o}'`),M(s==="NWC",()=>`Error in conv1d: got dataFormat of ${s} but only NWC is currently supported.`);const h=me(u,[1,u.shape[0],u.shape[1],u.shape[2]]),d=me(c,[c.shape[0],1,c.shape[1],c.shape[2]]),$=iu(d,h,[1,t],r,"NHWC",[1,o],i);return l?me($,[$.shape[2],$.shape[3]]):me($,[$.shape[0],$.shape[2],$.shape[3]])}const Ay=X({conv1d_:Ry});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oy(n,e,t,r,s,o="NHWC",i){M(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let a=n,u=e,c=!1;e.rank===3&&(c=!0,u=me(e,[1,e.shape[0],e.shape[1],e.shape[2]]),a=[1,n[0],n[1],n[2]]),M(a.length===4,()=>`Error in conv2dDerInput: inShape must be length 4, but got length ${a.length}.`),M(u.rank===4,()=>`Error in conv2dDerInput: dy must be rank 4, but got rank ${u.rank}`),M(t.rank===4,()=>`Error in conv2dDerInput: filter must be rank 4, but got rank ${t.rank}`);const l=o==="NHWC"?a[3]:a[1],h=o==="NHWC"?u.shape[3]:u.shape[1];M(l===t.shape[2],()=>`Error in conv2dDerInput: depth of input (${l}) must match input depth for filter ${t.shape[2]}.`),M(h===t.shape[3],()=>`Error in conv2dDerInput: depth of output (${h}) must match output depth for filter ${t.shape[3]}.`),gr("conv2dDerInput",s,i);const d={dy:u,filter:t},m={strides:r,pad:s,dataFormat:o,dimRoundingMode:i,inputShape:a},g=Q.runKernel(Hf,d,m);return c?me(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const c2=X({conv2DBackpropInput_:Oy});function Dy(n,e,t,r,s,o){const i=L(n,"x","conv2dTranspose"),a=L(e,"filter","conv2dTranspose");return c2(t,i,a,r,s,"NHWC",o)}const Fy=X({conv2dTranspose_:Dy});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Py(n,e,t,r,s="NDHWC",o=[1,1,1]){const i=L(n,"x","conv3d"),a=L(e,"filter","conv3d");let u=i,c=!1;i.rank===4&&(c=!0,u=me(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),M(u.rank===5,()=>`Error in conv3d: input must be rank 5, but got rank ${u.rank}.`),M(a.rank===5,()=>`Error in conv3d: filter must be rank 5, but got rank ${a.rank}.`),M(u.shape[4]===a.shape[3],()=>`Error in conv3d: depth of input (${u.shape[4]}) must match input depth for filter ${a.shape[3]}.`),M(Mn(t,o),()=>`Error in conv3D: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`),M(s==="NDHWC",()=>`Error in conv3d: got dataFormat of ${s} but only NDHWC is currently supported.`);const l={x:u,filter:a},h={strides:t,pad:r,dataFormat:s,dilations:o},d=Q.runKernel(qf,l,h);return c?me(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const Ly=X({conv3d_:Py});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function By(n,e,t,r,s){M(n.length===e.rank,()=>`Length of inShape (${n.length}) and rank of dy (${e.rank}) must match`);let o=n,i=e,a=!1;e.rank===4&&(a=!0,i=me(e,[1,e.shape[0],e.shape[1],e.shape[2],e.shape[3]]),o=[1,n[0],n[1],n[2],n[3]]);const u=o[4],c=i.shape[4];M(o.length===5,()=>`Error in conv3dDerInput: inShape must be length 5, but got length ${o.length}.`),M(i.rank===5,()=>`Error in conv3dDerInput: dy must be rank 5, but got rank ${i.rank}`),M(t.rank===5,()=>`Error in conv3dDerInput: filter must be rank 5, but got rank ${t.rank}`),M(u===t.shape[3],()=>`Error in conv3dDerInput: depth of input (${u}) must match input depth for filter ${t.shape[3]}.`),M(c===t.shape[4],()=>`Error in conv3dDerInput: depth of output (${c}) must match output depth for filter ${t.shape[4]}.`);const l={dy:i,filter:t},h={pad:s,strides:r,inputShape:o},d=Q.runKernel(Xf,l,h);return a?me(d,[d.shape[1],d.shape[2],d.shape[3],d.shape[4]]):d}const My=X({conv3DBackpropInput_:By});function Vy(n,e,t,r,s){const o=L(n,"x","conv3dTranspose"),i=L(e,"filter","conv3dTranspose");return My(t,o,i,r,s)}const Uy=X({conv3dTranspose_:Vy});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wy(n){const t={x:L(n,"x","cos","float32")};return Q.runKernel(Kf,t)}const zy=X({cos_:Wy});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gy(n){const t={x:L(n,"x","cosh","float32")};return Q.runKernel(Yf,t)}const jy=X({cosh_:Gy});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the 'License');
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an 'AS IS' BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hy(n,e=0,t=!1,r=!1){const o={x:L(n,"x","cumprod")},i={axis:e,exclusive:t,reverse:r};return Q.runKernel(Qf,o,i)}const qy=X({cumprod_:Hy});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xy(n,e=0,t=!1,r=!1){const o={x:L(n,"x","cumsum")},i={axis:e,exclusive:t,reverse:r};return Q.runKernel(Zf,o,i)}const Ky=X({cumsum_:Xy});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yy(n,e,t,r=!1){const s=L(n,"x","denseBincount"),o=L(e,"weights","denseBincount");M(s.dtype==="int32",()=>`Error in denseBincount: input dtype must be int32, but got ${s.dtype}`),M(s.rank<=2,()=>`Error in denseBincount: input must be at most rank 2, but got rank ${s.rank}.`),M(t>=0,()=>`size must be non-negative, but got ${t}.`),M(o.size===s.size||o.size===0,()=>`Error in denseBincount: weights must have the same shape as x or 0-length, but got x shape: ${s.shape}, weights shape: ${o.shape}.`);const i={x:s,weights:o},a={size:t,binaryOutput:r};return Q.runKernel(ed,i,a)}const Qy=X({denseBincount_:Yy});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zy(n,e,t="NHWC"){const r=L(n,"x","depthToSpace","float32"),s=t==="NHWC"?r.shape[1]:r.shape[2],o=t==="NHWC"?r.shape[2]:r.shape[3],i=t==="NHWC"?r.shape[3]:r.shape[1];M(e>1,()=>`blockSize should be > 1 for depthToSpace, but was: ${e}`),M(s*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${s} and ${e}  for depthToSpace with input shape
    ${r.shape}`),M(o*e>=0,()=>`Negative dimension size caused by overflow when multiplying
    ${o} and ${e} for depthToSpace with input shape
        ${r.shape}`),M(i%(e*e)===0,()=>`Dimension size must be evenly divisible by ${e*e} but is ${i} for depthToSpace with input shape ${r.shape}`);const a={x:r},u={blockSize:e,dataFormat:t};return Q.runKernel(td,a,u)}const Jy=X({depthToSpace_:Zy});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ex(n,e,t,r,s="NHWC",o=[1,1],i){const a=L(n,"x","depthwiseConv2d","float32"),u=L(e,"filter","depthwiseConv2d","float32");let c=a,l=!1;a.rank===3&&(l=!0,c=me(a,[1,a.shape[0],a.shape[1],a.shape[2]])),M(c.rank===4,()=>`Error in depthwiseConv2d: input must be rank 4, but got rank ${c.rank}.`),M(u.rank===4,()=>`Error in depthwiseConv2d: filter must be rank 4, but got rank ${u.rank}.`);const h=s==="NHWC"?c.shape[3]:c.shape[1];M(h===u.shape[2],()=>`Error in depthwiseConv2d: number of input channels (${h}) must match the inChannels dimension in filter ${u.shape[2]}.`),gr("depthwiseConv2d",r,i);const d={x:c,filter:u},m={strides:t,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i},g=Q.runKernel(nd,d,m);return l?me(g,[g.shape[1],g.shape[2],g.shape[3]]):g}const cl=X({depthwiseConv2d_:ex});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tx(n){const t={x:L(n,"x","diag")};return Q.runKernel(od,t)}const nx=X({diag_:tx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rx(n,e,t,r,s=[1,1],o="NHWC"){const i=L(n,"x","dilation2d"),a=L(e,"filter","dilation2d");M(i.rank===3||i.rank===4,()=>`Error in dilation2d: input must be rank 3 or 4, but got rank ${i.rank}.`),M(a.rank===3,()=>`Error in dilation2d: filter must be rank 3, but got rank ${a.rank}.`),M(o==="NHWC",()=>`Error in dilation2d: Only NHWC is currently supported, but got dataFormat of ${o}`);let u=i,c=!1;i.rank===3&&(u=me(i,[1,i.shape[0],i.shape[1],i.shape[2]]),c=!0);const l={x:u,filter:a},h={strides:t,pad:r,dilations:s},d=Q.runKernel(id,l,h);return c?me(d,[d.shape[1],d.shape[2],d.shape[3]]):d}const sx=X({dilation2d_:rx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ox(n,e){let t=L(n,"a","equal","string_or_numeric"),r=L(e,"b","equal","string_or_numeric");[t,r]=Mt(t,r),ot(t.shape,r.shape);const s={a:t,b:r};return Q.runKernel(hd,s)}const l2=X({equal_:ox});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ix(n,e,t){const r=L(e,"a","where"),s=L(t,"b","where"),o=L(n,"condition","where","bool"),i=ot(ot(o.shape,r.shape),s.shape),a=Gi(o,i),u=Gi(r,i),c=Gi(s,i),l={condition:a,t:u,e:c};return Q.runKernel(Sp,l)}const pi=X({where_:ix});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ax(n){const t={x:L(n,"x","zerosLike")};return Q.runKernel(n1,t)}const ll=X({zerosLike_:ax});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ux(n,e){let t=L(n,"a","div"),r=L(e,"b","div");[t,r]=Mt(t,r);const s=xt(t,r),o=ll(s),i=l2(r,o);return pi(i,o,s)}const cx=X({divNoNan_:ux});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lx(n,e){const t=L(n,"t1","dot"),r=L(e,"t2","dot");M((t.rank===1||t.rank===2)&&(r.rank===1||r.rank===2),()=>`Error in dot: inputs must all be rank 1 or 2, but got ranks ${t.rank} and ${r.rank}.`);const s=t.rank===1?t.size:t.shape[1],o=r.rank===1?r.size:r.shape[0];if(M(s===o,()=>`Error in dot: inner dimensions of inputs must match, but got ${s} and ${o}.`),t.rank===1&&r.rank===1){const i=me(t,[1,-1]),a=me(r,[-1,1]),u=mt(i,a);return me(u,[])}else if(t.rank===1&&r.rank===2){const i=me(t,[1,-1]),a=me(r,[r.shape[0],r.shape[1]]),u=mt(i,a);return me(u,[u.size])}else if(t.rank===2&&r.rank===1){const i=me(r,[-1,1]),a=mt(t,i);return me(a,[a.size])}else{const i=me(r,[r.shape[0],r.shape[1]]);return mt(t,i)}}const hx=X({dot_:lx});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fx(n,...e){const t=e.map((s,o)=>L(s,`tensors${o}`,"einsum")),r={equation:n};return Q.runKernel(ud,t,r)}const dx=X({einsum_:fx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function px(n){const t={x:L(n,"x","elu","float32")};return Q.runKernel(cd,t)}const h2=X({elu_:px});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mx(n){let e=L(n,"x","erf");M(e.dtype==="int32"||e.dtype==="float32",()=>"Input dtype must be `int32` or `float32`."),e.dtype==="int32"&&(e=At(e,"float32"));const t={x:e};return Q.runKernel(ld,t)}const gx=X({erf_:mx});/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hl(n,e){for(let t=0;t<n.length;++t)if(n[n.length-t-1]!==e-1-t)return!1;return!0}function f2(n,e,t){const r=n.length+e.length,s=[];let o=0,i=0;for(let a=0;a<r;a++)t.indexOf(a)===-1?s.push(n[o++]):s.push(e[i++]);return s}function ss(n,e){const t=[],r=n.length;for(let o=0;o<r;o++)e.indexOf(o)===-1&&t.push(n[o]);const s=e.map(o=>n[o]);return[t,s]}function Jn(n,e){const t=e.map(r=>1);return f2(n,t,e)}function Vr(n,e,t){M(hl(e,t),()=>`${n} supports only inner-most axes for now. Got axes ${e} and rank-${t} input.`)}function yr(n,e){if(hl(n,e))return null;const t=[];for(let r=0;r<e;++r)n.indexOf(r)===-1&&t.push(r);return n.forEach(r=>t.push(r)),t}function fl(n){return n.map((e,t)=>[t,e]).sort((e,t)=>e[1]-t[1]).map(e=>e[0])}function xr(n,e){const t=[];for(let r=e-n;r<e;++r)t.push(r);return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yx(n,e=null,t=!1){const s={x:L(n,"x","max")},o={reductionIndices:e,keepDims:t};return Q.runKernel(Vd,s,o)}const ai=X({max_:yx});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xx(n,e=null,t=!1){const s={x:L(n,"x","min")},o={axis:e,keepDims:t};return Q.runKernel(Hd,s,o)}const Sc=X({min_:xx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bx(n,e){let t=L(n,"base","pow"),r=L(e,"exp","pow");[t,r]=Mt(t,r);const s={a:t,b:r};return Q.runKernel(ap,s)}const dl=X({pow_:bx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ct(n,e){if((ns(n)&&e!=="string"||Array.isArray(n))&&e!=="complex64")throw new Error("Error creating a new Scalar: value must be a primitive (number|boolean|string)");if(e==="string"&&ns(n)&&!(n instanceof Uint8Array))throw new Error("When making a scalar from encoded string, the value must be `Uint8Array`.");return Xs(n,[],[],e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vx(n){const t={x:L(n,"x","sqrt","float32")};return Q.runKernel(Op,t)}const Nc=X({sqrt_:vx});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wx(n){const e=L(n,"x","square"),t={};return Q.runKernel("Square",{x:e},t)}const au=X({square_:wx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cx(n,e=null,t=!1){let r=L(n,"x","sum");r.dtype==="bool"&&(r=At(r,"int32"));const s={x:r},o={axis:e,keepDims:t};return Q.runKernel(Dp,s,o)}const $t=X({sum_:Cx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tx(n,e="euclidean",t=null,r=!1){n=L(n,"x","norm");const s=d2(n,e,t);let o=s.shape;if(r){const i=Zt(t,n.shape);o=Jn(s.shape,i)}return me(s,o)}function d2(n,e,t=null){if(n.rank===0)return lr(n);if(n.rank!==1&&t===null)return d2(me(n,[-1]),e,t);if(n.rank===1||typeof t=="number"||Array.isArray(t)&&t.length===1){if(e===1)return $t(lr(n),t);if(e===1/0)return ai(lr(n),t);if(e===-1/0)return Sc(lr(n),t);if(e==="euclidean"||e===2)return Nc($t(dl(lr(n),ct(2,"int32")),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}if(Array.isArray(t)&&t.length===2){if(e===1)return ai($t(lr(n),t[0]),t[1]-1);if(e===1/0)return ai($t(lr(n),t[1]),t[0]);if(e===-1/0)return Sc($t(lr(n),t[1]),t[0]);if(e==="fro"||e==="euclidean")return Nc($t(au(n),t));throw new Error(`Error in norm: invalid ord value: ${e}`)}throw new Error(`Error in norm: invalid axis: ${t}`)}const uu=X({norm_:Tx});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $x(n,e=null,t=!1){return uu(n,"euclidean",e,t)}const Sx=X({euclideanNorm_:$x});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nx(n){const t={x:L(n,"x","exp")};return Q.runKernel(fd,t)}const ws=X({exp_:Nx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ex(n,e=0){const t=L(n,"x","expandDims","string_or_numeric");M(e<=t.rank,()=>"Axis must be <= rank of the tensor");const r={input:t},s={dim:e};return Q.runKernel(dd,r,s)}const Or=X({expandDims_:Ex});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kx(n){const t={x:L(n,"x","expm1")};return Q.runKernel(pd,t)}const Ix=X({expm1_:kx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _x(n,e){const t=L(n,"x","tile","string_or_numeric");M(t.rank===e.length,()=>`Error in transpose: rank of input ${t.rank} must match length of reps ${e}.`);const r={x:t},s={reps:e};return Q.runKernel(Qc,r,s)}const ji=X({tile_:_x});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rx(n,e,t,r="float32"){e==null&&(e=n);const s=Ot([n,e],r),o=n<=e?n:e;for(let a=0;a<o;++a)s.set(1,a,a);const i=me(s.toTensor(),[n,e]);if(t==null)return i;if(t.length===1)return ji(Or(i,0),[t[0],1,1]);if(t.length===2)return ji(Or(Or(i,0),0),[t[0],t[1],1,1]);if(t.length===3)return ji(Or(Or(Or(i,0),0),0),[t[0],t[1],t[2],1,1]);throw new Error(`eye() currently supports only 1D and 2D batchShapes, but received ${t.length}D.`)}const p2=X({eye_:Rx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ax(n){const t={x:L(n,"x","floor","float32")};return Q.runKernel(xd,t)}const m2=X({floor_:Ax});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ox(n,e,t=0,r=0){const s=L(n,"x","gather"),o=L(e,"indices","gather","int32"),i={x:s,indices:o},a={axis:t,batchDims:r};return Q.runKernel(wd,i,a)}const g2=X({gather_:Ox});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Dx(n,e){let t=L(n,"a","greater","string_or_numeric"),r=L(e,"b","greater","string_or_numeric");[t,r]=Mt(t,r),ot(t.shape,r.shape);const s={a:t,b:r};return Q.runKernel(Td,s)}const cu=X({greater_:Dx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fx(n,e){let t=L(n,"a","greaterEqual","string_or_numeric"),r=L(e,"b","greaterEqual","string_or_numeric");[t,r]=Mt(t,r),ot(t.shape,r.shape);const s={a:t,b:r};return Q.runKernel($d,s)}const y2=X({greaterEqual_:Fx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Px(n){const t={x:L(n,"x","isFinite")};return Q.runKernel(Ed,t)}const Lx=X({isFinite_:Px});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bx(n){const t={x:L(n,"x","isInf")};return Q.runKernel(kd,t)}const Mx=X({isInf_:Bx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Vx(n){const t={x:L(n,"x","isNaN")};return Q.runKernel(Id,t)}const Ux=X({isNaN_:Vx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wx(n,e=.2){const r={x:L(n,"x","leakyRelu")},s={alpha:e};return Q.runKernel(_d,r,s)}const x2=X({leakyRelu_:Wx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zx(n,e){let t=L(n,"a","less","string_or_numeric"),r=L(e,"b","less","string_or_numeric");[t,r]=Mt(t,r),ot(t.shape,r.shape);const s={a:t,b:r};return Q.runKernel(Rd,s)}const Gx=X({less_:zx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jx(n,e){let t=L(n,"a","lessEqual","string_or_numeric"),r=L(e,"b","lessEqual","string_or_numeric");[t,r]=Mt(t,r),ot(t.shape,r.shape);const s={a:t,b:r};return Q.runKernel(Ad,s)}const pl=X({lessEqual_:jx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hx(n,e,t){if(t<=0)throw new Error("The number of values should be positive.");const r={start:n,stop:e,num:t};return Q.runKernel(Od,{},r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qx(n,e=5,t=1,r=1,s=.5){const o=L(n,"x","localResponseNormalization");M(o.rank===4||o.rank===3,()=>`Error in localResponseNormalization: x must be rank 3 or 4 but got
               rank ${o.rank}.`),M(ci(e),()=>`Error in localResponseNormalization: depthRadius must be an integer but got depthRadius ${e}.`);let i=o,a=!1;o.rank===3&&(a=!0,i=me(o,[1,o.shape[0],o.shape[1],o.shape[2]]));const u={x:i},c={depthRadius:e,bias:t,alpha:r,beta:s},l=Q.runKernel(Md,u,c);return a?me(l,[l.shape[1],l.shape[2],l.shape[3]]):l}const Xx=X({localResponseNormalization_:qx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kx(n){const t={x:L(n,"x","log","float32")};return Q.runKernel(Dd,t)}const Ki=X({log_:Kx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yx(n){const t={x:L(n,"x","log1p")};return Q.runKernel(Fd,t)}const b2=X({log1p_:Yx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cs(n){return Q.customGrad(n)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qx(n){const t={x:L(n,"x","softplus")};return Q.runKernel(Ap,t)}const v2=X({softplus_:Qx});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zx(n){const e=L(n,"x","logSigmoid");return Cs(r=>({value:bs(v2(bs(r))),gradFunc:i=>We(i,So(bs(r)))}))(e)}const Jx=X({logSigmoid_:Zx});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function eb(n,e){let t=L(n,"a","sub"),r=L(e,"b","sub");[t,r]=Mt(t,r);const s={a:t,b:r};return Q.runKernel(Xp,s)}const nt=X({sub_:eb});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tb(n,e=-1){const t=L(n,"logits","logSoftmax");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Log Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and axis was ${e}`);return Cs((s,o)=>{const a=ai(s,e,!0),u=nt(s,a),c=nt(At(u,"float32"),Ki($t(ws(u),e,!0)));return o([c]),{value:c,gradFunc:(h,d)=>{const[m]=d,g=!0,C=ws(m);return nt(h,We($t(h,e,g),C))}}})(t)}const nb=X({logSoftmax_:tb});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rb(n,e=null,t=!1){const r=L(n,"x","logSumExp"),s=Zt(e,r.shape),o=ai(r,s,!0),i=nt(r,o),a=ws(i),u=$t(a,s),c=Ki(u),l=Ct(me(o,c.shape),c);if(t){const h=Jn(l.shape,s);return me(l,h)}return l}const w2=X({logSumExp_:rb});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sb(n,e){const t=L(n,"a","logicalAnd","bool"),r=L(e,"b","logicalAnd","bool");ot(t.shape,r.shape);const s={a:t,b:r};return Q.runKernel(Pd,s)}const Wa=X({logicalAnd_:sb});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ob(n){const t={x:L(n,"x","logicalNot","bool")};return Q.runKernel(Ld,t)}const C2=X({logicalNot_:ob});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ib(n,e){const t=L(n,"a","logicalOr","bool"),r=L(e,"b","logicalOr","bool");ot(t.shape,r.shape);const s={a:t,b:r};return Q.runKernel(Bd,s)}const T2=X({logicalOr_:ib});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ab(n,e){const t=L(n,"a","logicalXor","bool"),r=L(e,"b","logicalXor","bool");return ot(t.shape,r.shape),Wa(T2(n,e),C2(Wa(n,e)))}const ub=X({logicalXor_:ab});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ca=2147483648;function cb(n,e,t="left"){const r=L(n,"sortedSequence","searchSorted"),s=L(e,"values","searchSorted"),o=r.shape[r.shape.length-1],i=s.shape[s.shape.length-1],a=me(r,[-1,o]),u=me(s,[-1,i]);if(a.rank<2)throw new Error("Sorted input argument must be at least 2-dimensional");if(a.shape[0]!==u.shape[0])throw new Error("Leading dimension of 'sortedSequence' and 'values' must match.");if(Ce(u.shape)>=Ca)throw new Error(`values tensor size must less than ${Ca}`);if(a.shape[1]>=Ca)throw new Error(`trailing dim_size must less than ${Ca} for int32 output type, was ${a.shape[1]}`);const c={sortedSequence:a,values:u},l={side:t};return Q.runKernel($p,c,l)}const ml=X({searchSorted_:cb});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lb(n,e){return ml(n,e,"left")}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hb(n,e,t,r,s){const o=L(n,"x","maxPool"),i=1;let a=o,u=!1;o.rank===3&&(u=!0,a=me(o,[1,o.shape[0],o.shape[1],o.shape[2]])),M(a.rank===4,()=>`Error in maxPool: input must be rank 4 but got rank ${a.rank}.`),M(Mn(t,i),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${t} and dilations '${i}'`),gr("maxPool",r,s);const c={x:a},l={filterSize:e,strides:t,pad:r,dimRoundingMode:s},h=Q.runKernel(Wd,c,l);return u?me(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const $2=X({maxPool_:hb});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fb(n,e=[1,1,1],t,r,s,o="NDHWC"){const i=L(n,"x","maxPool3d");let a=i,u=!1;i.rank===4&&(u=!0,a=me(i,[1,i.shape[0],i.shape[1],i.shape[2],i.shape[3]])),M(a.rank===5,()=>`Error in maxPool3d: x must be rank 5 but got rank ${a.rank}.`),M(o==="NDHWC",()=>`Error in maxPool3d: Only NDHWC is currently supported, but got dataFormat of ${o}`),gr("maxPool3d",r,s);const c={x:a},l={filterSize:e,strides:t,pad:r,dimRoundingMode:s,dataFormat:o},h=Q.runKernel(zd,c,l);return u?me(h,[h.shape[1],h.shape[2],h.shape[3],h.shape[4]]):h}const db=X({maxPool3d_:fb});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pb(n,e,t,r,s=!1){const i={x:L(n,"x","maxPoolWithArgmax")},a={filterSize:e,strides:t,pad:r,includeBatchInIndex:s},u=Q.runKernel(Gd,i,a);return{result:u[0],indexes:u[1]}}const mb=X({maxPoolWithArgmax_:pb});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gb(n,e){let t=L(n,"a","maximum"),r=L(e,"b","maximum");[t,r]=Mt(t,r),t.dtype==="bool"&&(t=At(t,"int32"),r=At(r,"int32")),ot(t.shape,r.shape);const s={a:t,b:r};return Q.runKernel(Ud,s)}const yb=X({maximum_:gb});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xb(n,e=null,t=!1){const s={x:L(n,"x","mean")},o={axis:e,keepDims:t};return Q.runKernel(jd,s,o)}const za=X({mean_:xb});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Io(n,e="float32"){if(e==="complex64"){const r=Io(n,"float32"),s=Io(n,"float32");return Gs(r,s)}const t=zs(Ce(n),e);return Q.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wo(n,e="float32"){if(e==="complex64"){const r=wo(n,"float32"),s=Io(n,"float32");return Gs(r,s)}const t=gf(Ce(n),e);return Q.makeTensor(t,n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bb(n,e,{indexing:t="xy"}={}){if(t!=="xy"&&t!=="ij")throw new TypeError(`${t} is not a valid third argument to meshgrid`);if(n===void 0)return[];let r=L(n,"x","meshgrid",n instanceof Rt?n.dtype:"float32");if(e===void 0)return[r];let s=L(e,"y","meshgrid",e instanceof Rt?e.dtype:"float32");const o=Ce(r.shape),i=Ce(s.shape);return t==="xy"?(r=me(r,[1,-1]),s=me(s,[-1,1]),[mt(wo([i,1],r.dtype),r),mt(s,wo([1,o],s.dtype))]):(r=me(r,[-1,1]),s=me(s,[1,-1]),[mt(r,wo([1,i],r.dtype)),mt(wo([o,1],s.dtype),s)])}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vb(n,e){let t=L(n,"a","minimum"),r=L(e,"b","minimum");[t,r]=Mt(t,r),t.dtype==="bool"&&(t=At(t,"int32"),r=At(r,"int32")),ot(t.shape,r.shape);const s={a:t,b:r};return Q.runKernel(qd,s)}const S2=X({minimum_:vb});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wb(n,e,t){M(t==="reflect"||t==="symmetric",()=>`Invalid mode. Mode must be either reflect or symmetric. Got ${t}.`);const r=L(n,"x","mirrorPad");if(r.rank===0)throw new Error("mirrorPad(scalar) is not defined. Pass non-scalar to mirrorPad");M(e.length===r.rank,()=>`Padding doesn't match input. Must be ${r.rank}. Got ${e.length}.`);const s=t==="reflect"?1:0;for(let a=0;a<r.rank;a++)M(e[a].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),M(e[a][0]>=0&&e[a][0]<=r.shape[a]-s&&e[a][1]>=0&&e[a][1]<=r.shape[a]-s,()=>`Padding in dimension ${a} cannot be greater than or equal to ${r.shape[a]-s} or less than 0 for input of shape ${r.shape}`);const o={paddings:e,mode:t},i={x:r};return Q.runKernel(Xd,i,o)}const Cb=X({mirrorPad_:wb});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tb(n,e){let t=L(n,"a","mod"),r=L(e,"b","mod");[t,r]=Mt(t,r);const s={a:t,b:r};return Q.runKernel(Kd,s)}const $b=X({mod_:Tb});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sb(n,e=null,t=!1){n=L(n,"x","moments");const r=Zt(e,n.shape),s=za(n,r,t);let o=s.shape;t||(o=Jn(s.shape,r));const i=au(nt(At(n,"float32"),me(s,o))),a=za(i,r,t);return{mean:s,variance:a}}const Nb=X({moments_:Sb});function Eb(n,e,t,r){const s=L(e,"data","multiRNNCell"),o=Ba(t,"c","multiRNNCell"),i=Ba(r,"h","multiRNNCell");let a=s;const u=[];for(let h=0;h<n.length;h++){const d=n[h](a,o[h],i[h]);u.push(d[0]),u.push(d[1]),a=d[1]}const c=[],l=[];for(let h=0;h<u.length;h+=2)c.push(u[h]),l.push(u[h+1]);return[c,l]}const kb=X({multiRNNCell_:Eb});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ib(n,e,t,r=!1){const s=L(n,"logits","multinomial"),o=s.size,i=s.rank;if(o<2)throw new Error(`Error in multinomial: you need at least 2 outcomes, but got ${o}.`);if(i>2)throw new Error(`Rank of probabilities must be 1 or 2, but is ${i}`);t=t||Math.random();const u={logits:i===1?me(s,[1,-1]):s},c={numSamples:e,seed:t,normalized:r},l=Q.runKernel(Yd,u,c);return i===1?me(l,[l.size]):l}const _b=X({multinomial_:Ib});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rb(n,e){let t=L(n,"a","notEqual","string_or_numeric"),r=L(e,"b","notEqual","string_or_numeric");[t,r]=Mt(t,r),ot(t.shape,r.shape);const s={a:t,b:r};return Q.runKernel(Jd,s)}const N2=X({notEqual_:Rb});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ab(n){const t={x:L(n,"x","onesLike")};return Q.runKernel(rp,t)}const Ob=X({onesLike_:Ab});function Db(n,e){const t=L(n,"v1","outerProduct"),r=L(e,"v2","outerProduct");M(t.rank===1&&r.rank===1,()=>`Error in outerProduct: inputs must be rank 1, but got ranks ${t.rank} and ${r.rank}.`);const s=me(t,[-1,1]),o=me(r,[1,-1]);return mt(s,o)}const Fb=X({outerProduct_:Db});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pb(n,e,t=0){const r=L(n,"x","pad");if(r.rank===0)throw new Error("pad(scalar) is not defined. Pass non-scalar to pad");const s={paddings:e,constantValue:t},o={x:r};return Q.runKernel(ip,o,s)}const ia=X({pad_:Pb});function Lb(n,e,t=0){return M(e.length===2,()=>"Invalid number of paddings. Must be length of 2."),ia(n,[e],t)}const Bb=X({pad1d_:Lb});function Mb(n,e,t=0){return M(e.length===2&&e[0].length===2&&e[1].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ia(n,e,t)}const Vb=X({pad2d_:Mb});function Ub(n,e,t=0){return M(e.length===3&&e[0].length===2&&e[1].length===2&&e[2].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ia(n,e,t)}const Wb=X({pad3d_:Ub});function zb(n,e,t=0){return M(e.length===4&&e[0].length===2&&e[1].length===2&&e[2].length===2&&e[3].length===2,()=>"Invalid number of paddings. Must be length of 2 each."),ia(n,e,t)}const Gb=X({pad4d_:zb});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jb(n,e,t){const r=L(n,"x","spaceToBatchND");M(r.rank>=1+e.length,()=>`input rank ${r.rank} should be > than [blockShape] ${e.length}`),M(t.length===e.length,()=>`paddings.shape[0] ${t.length} must be equal to [blockShape] ${e.length}`),M(r.shape.reduce((i,a,u)=>u>0&&u<=e.length?i&&(a+t[u-1][0]+t[u-1][1])%e[u-1]===0:i,!0),()=>`input spatial dimensions ${r.shape.slice(1)} with paddings ${t.toString()} must be divisible by blockShapes ${e.toString()}`);const s={x:r},o={blockShape:e,paddings:t};return Q.runKernel(Fp,s,o)}const E2=X({spaceToBatchND_:jb});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hb(n,e,t,r,s,o,i){s==null&&(s=[1,1]),o==null&&(o=1),r===0&&(r="valid");const a=L(n,"x","maxPool");let u=a,c=!1;a.rank===3&&(c=!0,u=me(a,[1,a.shape[0],a.shape[1],a.shape[2]])),M(Mn(o,s),()=>`Error in pool: Either strides or dilations must be 1. Got strides ${o} and dilations '${s}'`);const l=Do(u.shape,e,o,s,r),h=[l.dilationHeight,l.dilationWidth];let d;r==="same"?d=Xb([l.filterHeight,l.filterWidth],h):d=[[0,0],[0,0]];const m=h[0]===1&&h[1]===1,[g,C]=qb([l.inHeight,l.inWidth],h,d),$=m?r:"valid",T=m?u:E2(u,h,g),P=(t==="avg"?()=>o2(T,e,o,$,i):()=>$2(T,e,o,$,i))(),B=m?P:i2(P,h,C);return c?me(B,[B.shape[1],B.shape[2],B.shape[3]]):B}function qb(n,e,t){const r=t.map(l=>l[0]),s=t.map(l=>l[1]),o=n.concat(r,s),i=e.map((l,h)=>(l-o[h]%l)%l),a=s.map((l,h)=>l+i[h]),u=e.map((l,h)=>[r[h],a[h]]),c=e.map((l,h)=>[0,i[h]]);return[u,c]}function Xb(n,e){const r=n.map((i,a)=>i+(i-1)*(e[a]-1)).map(i=>i-1),s=r.map(i=>Math.floor(i/2)),o=r.map((i,a)=>i-s[a]);return r.map((i,a)=>[s[a],o[a]])}const Kb=X({pool_:Hb});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yb(n,e){const t=L(n,"x","prelu"),r=L(e,"alpha","prelu"),s={x:t,alpha:r};return Q.runKernel(up,s)}const k2=X({prelu_:Yb});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qb(n,e=null,t=!1){let r=L(n,"x","prod");r.dtype==="bool"&&(r=At(r,"int32"));const s={x:r},o={axis:e,keepDims:t};return Q.runKernel(cp,s,o)}const Zb=X({prod_:Qb});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jb(n,e,t,r){const s=n.map((l,h)=>L(l,`tensors${h}`,"raggedGather","int32")),o=L(e,"paramsDenseValues","raggedGather"),i=L(t,"indices","raggedGather","int32"),a={paramsNestedSplits:s,paramsDenseValues:o,indices:i},u={outputRaggedRank:r},c=Q.runKernel(lp,a,u);return{outputNestedSplits:c.slice(0,c.length-1),outputDenseValues:c[c.length-1]}}const ev=X({raggedGather_:Jb});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tv(n,e,t,r,s){const o=L(n,"shape","raggedTensorToTensor","int32"),i=L(e,"values","raggedTensorToTensor"),a=L(t,"defaultValue","raggedTensorToTensor",i.dtype),u=r.map((h,d)=>L(h,`tensors${d}`,"raggedTensorToTensor","int32")),c={shape:o,values:i,defaultValue:a,rowPartitionTensors:u},l={rowPartitionTypes:s};return Q.runKernel(hp,c,l)}const nv=X({raggedTensorToTensor_:tv});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function rv(n,e,t){const r=Ce(n);let s=null;if(t==null||t==="float32")s=new Float32Array(r);else if(t==="int32")s=new Int32Array(r);else if(t==="bool")s=new Uint8Array(r);else throw new Error(`Unknown data type ${t}`);for(let o=0;o<r;o++)s[o]=e();return Q.makeTensor(s,n,t)}const sv=X({rand_:rv});var I2={exports:{}};(function(n){(function(e,t,r){function s(u){var c=this,l=a();c.next=function(){var h=2091639*c.s0+c.c*23283064365386963e-26;return c.s0=c.s1,c.s1=c.s2,c.s2=h-(c.c=h|0)},c.c=1,c.s0=l(" "),c.s1=l(" "),c.s2=l(" "),c.s0-=l(u),c.s0<0&&(c.s0+=1),c.s1-=l(u),c.s1<0&&(c.s1+=1),c.s2-=l(u),c.s2<0&&(c.s2+=1),l=null}function o(u,c){return c.c=u.c,c.s0=u.s0,c.s1=u.s1,c.s2=u.s2,c}function i(u,c){var l=new s(u),h=c&&c.state,d=l.next;return d.int32=function(){return l.next()*4294967296|0},d.double=function(){return d()+(d()*2097152|0)*11102230246251565e-32},d.quick=d,h&&(typeof h=="object"&&o(h,l),d.state=function(){return o(l,{})}),d}function a(){var u=4022871197,c=function(l){l=String(l);for(var h=0;h<l.length;h++){u+=l.charCodeAt(h);var d=.02519603282416938*u;u=d>>>0,d-=u,d*=u,u=d>>>0,d-=u,u+=d*4294967296}return(u>>>0)*23283064365386963e-26};return c}t&&t.exports?t.exports=i:r&&r.amd?r(function(){return i}):this.alea=i})(Pr,n,!1)})(I2);var _2={exports:{}};(function(n){(function(e,t,r){function s(a){var u=this,c="";u.x=0,u.y=0,u.z=0,u.w=0,u.next=function(){var h=u.x^u.x<<11;return u.x=u.y,u.y=u.z,u.z=u.w,u.w^=u.w>>>19^h^h>>>8},a===(a|0)?u.x=a:c+=a;for(var l=0;l<c.length+64;l++)u.x^=c.charCodeAt(l)|0,u.next()}function o(a,u){return u.x=a.x,u.y=a.y,u.z=a.z,u.w=a.w,u}function i(a,u){var c=new s(a),l=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(d+m)/(1<<21);while(g===0);return g},h.int32=c.next,h.quick=h,l&&(typeof l=="object"&&o(l,c),h.state=function(){return o(c,{})}),h}t&&t.exports?t.exports=i:r&&r.amd?r(function(){return i}):this.xor128=i})(Pr,n,!1)})(_2);var R2={exports:{}};(function(n){(function(e,t,r){function s(a){var u=this,c="";u.next=function(){var h=u.x^u.x>>>2;return u.x=u.y,u.y=u.z,u.z=u.w,u.w=u.v,(u.d=u.d+362437|0)+(u.v=u.v^u.v<<4^(h^h<<1))|0},u.x=0,u.y=0,u.z=0,u.w=0,u.v=0,a===(a|0)?u.x=a:c+=a;for(var l=0;l<c.length+64;l++)u.x^=c.charCodeAt(l)|0,l==c.length&&(u.d=u.x<<10^u.x>>>4),u.next()}function o(a,u){return u.x=a.x,u.y=a.y,u.z=a.z,u.w=a.w,u.v=a.v,u.d=a.d,u}function i(a,u){var c=new s(a),l=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(d+m)/(1<<21);while(g===0);return g},h.int32=c.next,h.quick=h,l&&(typeof l=="object"&&o(l,c),h.state=function(){return o(c,{})}),h}t&&t.exports?t.exports=i:r&&r.amd?r(function(){return i}):this.xorwow=i})(Pr,n,!1)})(R2);var A2={exports:{}};(function(n){(function(e,t,r){function s(a){var u=this;u.next=function(){var l=u.x,h=u.i,d,m;return d=l[h],d^=d>>>7,m=d^d<<24,d=l[h+1&7],m^=d^d>>>10,d=l[h+3&7],m^=d^d>>>3,d=l[h+4&7],m^=d^d<<7,d=l[h+7&7],d=d^d<<13,m^=d^d<<9,l[h]=m,u.i=h+1&7,m};function c(l,h){var d,m=[];if(h===(h|0))m[0]=h;else for(h=""+h,d=0;d<h.length;++d)m[d&7]=m[d&7]<<15^h.charCodeAt(d)+m[d+1&7]<<13;for(;m.length<8;)m.push(0);for(d=0;d<8&&m[d]===0;++d);for(d==8?m[7]=-1:m[d],l.x=m,l.i=0,d=256;d>0;--d)l.next()}c(u,a)}function o(a,u){return u.x=a.x.slice(),u.i=a.i,u}function i(a,u){a==null&&(a=+new Date);var c=new s(a),l=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(d+m)/(1<<21);while(g===0);return g},h.int32=c.next,h.quick=h,l&&(l.x&&o(l,c),h.state=function(){return o(c,{})}),h}t&&t.exports?t.exports=i:r&&r.amd?r(function(){return i}):this.xorshift7=i})(Pr,n,!1)})(A2);var O2={exports:{}};(function(n){(function(e,t,r){function s(a){var u=this;u.next=function(){var l=u.w,h=u.X,d=u.i,m,g;return u.w=l=l+1640531527|0,g=h[d+34&127],m=h[d=d+1&127],g^=g<<13,m^=m<<17,g^=g>>>15,m^=m>>>12,g=h[d]=g^m,u.i=d,g+(l^l>>>16)|0};function c(l,h){var d,m,g,C,$,T=[],A=128;for(h===(h|0)?(m=h,h=null):(h=h+"\0",m=0,A=Math.max(A,h.length)),g=0,C=-32;C<A;++C)h&&(m^=h.charCodeAt((C+32)%h.length)),C===0&&($=m),m^=m<<10,m^=m>>>15,m^=m<<4,m^=m>>>13,C>=0&&($=$+1640531527|0,d=T[C&127]^=m+$,g=d==0?g+1:0);for(g>=128&&(T[(h&&h.length||0)&127]=-1),g=127,C=4*128;C>0;--C)m=T[g+34&127],d=T[g=g+1&127],m^=m<<13,d^=d<<17,m^=m>>>15,d^=d>>>12,T[g]=m^d;l.w=$,l.X=T,l.i=g}c(u,a)}function o(a,u){return u.i=a.i,u.w=a.w,u.X=a.X.slice(),u}function i(a,u){a==null&&(a=+new Date);var c=new s(a),l=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(d+m)/(1<<21);while(g===0);return g},h.int32=c.next,h.quick=h,l&&(l.X&&o(l,c),h.state=function(){return o(c,{})}),h}t&&t.exports?t.exports=i:r&&r.amd?r(function(){return i}):this.xor4096=i})(Pr,n,!1)})(O2);var D2={exports:{}};(function(n){(function(e,t,r){function s(a){var u=this,c="";u.next=function(){var h=u.b,d=u.c,m=u.d,g=u.a;return h=h<<25^h>>>7^d,d=d-m|0,m=m<<24^m>>>8^g,g=g-h|0,u.b=h=h<<20^h>>>12^d,u.c=d=d-m|0,u.d=m<<16^d>>>16^g,u.a=g-h|0},u.a=0,u.b=0,u.c=-1640531527,u.d=1367130551,a===Math.floor(a)?(u.a=a/4294967296|0,u.b=a|0):c+=a;for(var l=0;l<c.length+20;l++)u.b^=c.charCodeAt(l)|0,u.next()}function o(a,u){return u.a=a.a,u.b=a.b,u.c=a.c,u.d=a.d,u}function i(a,u){var c=new s(a),l=u&&u.state,h=function(){return(c.next()>>>0)/4294967296};return h.double=function(){do var d=c.next()>>>11,m=(c.next()>>>0)/4294967296,g=(d+m)/(1<<21);while(g===0);return g},h.int32=c.next,h.quick=h,l&&(typeof l=="object"&&o(l,c),h.state=function(){return o(c,{})}),h}t&&t.exports?t.exports=i:r&&r.amd?r(function(){return i}):this.tychei=i})(Pr,n,!1)})(D2);var F2={exports:{}};const ov={},iv=Object.freeze(Object.defineProperty({__proto__:null,default:ov},Symbol.toStringTag,{value:"Module"})),av=o0(iv);(function(n){(function(e,t,r){var s=256,o=6,i=52,a="random",u=r.pow(s,o),c=r.pow(2,i),l=c*2,h=s-1,d;function m(B,H,x){var re=[];H=H==!0?{entropy:!0}:H||{};var oe=T($(H.entropy?[B,P(t)]:B==null?A():B,3),re),ie=new g(re),le=function(){for(var $e=ie.g(o),Ie=u,Ae=0;$e<c;)$e=($e+Ae)*s,Ie*=s,Ae=ie.g(1);for(;$e>=l;)$e/=2,Ie/=2,Ae>>>=1;return($e+Ae)/Ie};return le.int32=function(){return ie.g(4)|0},le.quick=function(){return ie.g(4)/4294967296},le.double=le,T(P(ie.S),t),(H.pass||x||function($e,Ie,Ae,Ge){return Ge&&(Ge.S&&C(Ge,ie),$e.state=function(){return C(ie,{})}),Ae?(r[a]=$e,Ie):$e})(le,oe,"global"in H?H.global:this==r,H.state)}function g(B){var H,x=B.length,re=this,oe=0,ie=re.i=re.j=0,le=re.S=[];for(x||(B=[x++]);oe<s;)le[oe]=oe++;for(oe=0;oe<s;oe++)le[oe]=le[ie=h&ie+B[oe%x]+(H=le[oe])],le[ie]=H;(re.g=function($e){for(var Ie,Ae=0,Ge=re.i,Ye=re.j,at=re.S;$e--;)Ie=at[Ge=h&Ge+1],Ae=Ae*s+at[h&(at[Ge]=at[Ye=h&Ye+Ie])+(at[Ye]=Ie)];return re.i=Ge,re.j=Ye,Ae})(s)}function C(B,H){return H.i=B.i,H.j=B.j,H.S=B.S.slice(),H}function $(B,H){var x=[],re=typeof B,oe;if(H&&re=="object")for(oe in B)try{x.push($(B[oe],H-1))}catch{}return x.length?x:re=="string"?B:B+"\0"}function T(B,H){for(var x=B+"",re,oe=0;oe<x.length;)H[h&oe]=h&(re^=H[h&oe]*19)+x.charCodeAt(oe++);return P(H)}function A(){try{var B;return d&&(B=d.randomBytes)?B=B(s):(B=new Uint8Array(s),(e.crypto||e.msCrypto).getRandomValues(B)),P(B)}catch{var H=e.navigator,x=H&&H.plugins;return[+new Date,e,x,e.screen,P(t)]}}function P(B){return String.fromCharCode.apply(0,B)}if(T(r.random(),t),n.exports){n.exports=m;try{d=av}catch{}}else r["seed"+a]=m})(typeof self<"u"?self:Pr,[],Math)})(F2);var uv=I2.exports,cv=_2.exports,lv=R2.exports,hv=A2.exports,fv=O2.exports,dv=D2.exports,Fo=F2.exports;Fo.alea=uv;Fo.xor128=cv;Fo.xorwow=lv;Fo.xorshift7=hv;Fo.xor4096=fv;Fo.tychei=dv;var gl=Fo;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class yl{constructor(e,t,r,s,o){this.mean=e,this.stdDev=t,this.dtype=r,this.nextVal=NaN,this.truncated=s,this.truncated&&(this.upper=this.mean+this.stdDev*2,this.lower=this.mean-this.stdDev*2);const i=o||Math.random();this.random=gl.alea(i.toString())}nextValue(){if(!isNaN(this.nextVal)){const s=this.nextVal;return this.nextVal=NaN,s}let e,t,r=!1;for(;!r;){let s,o,i;do s=2*this.random()-1,o=2*this.random()-1,i=s*s+o*o;while(i>=1||i===0);const a=Math.sqrt(-2*Math.log(i)/i);e=this.mean+this.stdDev*s*a,t=this.mean+this.stdDev*o*a,(!this.truncated||this.isValidTruncated(e))&&(r=!0)}return(!this.truncated||this.isValidTruncated(t))&&(this.nextVal=this.convertValue(t)),this.convertValue(e)}convertValue(e){return this.dtype==null||this.dtype==="float32"?e:Math.round(e)}isValidTruncated(e){return e<=this.upper&&e>=this.lower}}class pv{constructor(e,t,r,s){this.alpha=e,this.beta=1/t,this.dtype=r;const o=s||Math.random();this.randu=gl.alea(o.toString()),this.randn=new yl(0,1,r,!1,this.randu()),e<1?this.d=e+2/3:this.d=e-1/3,this.c=1/Math.sqrt(9*this.d)}nextValue(){let e,t,r,s,o,i;for(;;){do s=this.randn.nextValue(),i=1+this.c*s;while(i<=0);if(i*=i*i,e=s*s,t=1-.331*e*e,r=.5*e+this.d*(1-i+Math.log(i)),o=this.randu(),o<t||Math.log(o)<r)break}return i=1/this.beta*this.d*i,this.alpha<1&&(i*=Math.pow(this.randu(),1/this.alpha)),this.convertValue(i)}convertValue(e){return this.dtype==="float32"?e:Math.round(e)}}class mv{constructor(e=0,t=1,r,s){if(this.canReturnFloat=()=>this.dtype==null||this.dtype==="float32",this.min=e,this.range=t-e,this.dtype=r,s==null&&(s=Math.random()),typeof s=="number"&&(s=s.toString()),!this.canReturnFloat()&&this.range<=1)throw new Error(`The difference between ${e} - ${t} <= 1 and dtype is not float`);this.random=gl.alea(s)}convertValue(e){return this.canReturnFloat()?e:Math.round(e)}nextValue(){return this.convertValue(this.min+this.range*this.random())}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function gv(n,e,t=1,r="float32",s){if(t==null&&(t=1),r==null&&(r="float32"),r!=="float32"&&r!=="int32")throw new Error(`Unsupported data type ${r}`);const o=new pv(e,t,r,s),i=Ot(n,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const yv=X({randomGamma_:gv});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xv(n,e=0,t=1,r,s){if(r!=null&&r==="bool")throw new Error(`Unsupported data type ${r}`);const o=new yl(e,t,r,!1,s),i=Ot(n,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const P2=X({randomNormal_:xv});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bv(n,e,t){if(e!=null&&e==="bool")throw new Error(`Unsupported data type ${e}`);return P2(n,0,1,e,t)}const vv=X({randomStandardNormal_:bv});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wv(n,e=0,t=1,r="float32",s){const o=Ot(n,r),i=new mv(e,t,null,s);for(let a=0;a<o.values.length;a++)o.values[a]=i.nextValue();return o.toTensor()}const L2=X({randomUniform_:wv});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yi(n,e,t=1,r="float32"){if(t===0)throw new Error("Cannot have a step of zero");const s={start:n,stop:e,step:t,dtype:r};return Q.runKernel(fp,{},s)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cv(n){const t={x:L(n,"x","reciprocal")};return Q.runKernel(pp,t)}const Tv=X({reciprocal_:Cv});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $v(n){const t={x:L(n,"x","relu")};return Q.runKernel(mp,t)}const lu=X({relu_:$v});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sv(n){const t={x:L(n,"x","relu6")};return Q.runKernel(bp,t)}const B2=X({relu6_:Sv});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nv(n,e){const r={x:L(n,"x","reverse")},s={dims:e};return Q.runKernel(vp,r,s)}const _o=X({reverse_:Nv});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ev(n){const e=L(n,"x","reverse");return M(e.rank===1,()=>`Error in reverse1D: x must be rank 1 but got rank ${e.rank}.`),_o(e,0)}const kv=X({reverse1d_:Ev});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Iv(n,e){const t=L(n,"x","reverse");return M(t.rank===2,()=>`Error in reverse2D: x must be rank 2 but got rank ${t.rank}.`),_o(t,e)}const _v=X({reverse2d_:Iv});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rv(n,e){const t=L(n,"x","reverse");return M(t.rank===3,()=>`Error in reverse3D: x must be rank 3 but got rank ${t.rank}.`),_o(t,e)}const Av=X({reverse3d_:Rv});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ov(n,e){const t=L(n,"x","reverse");return M(t.rank===4,()=>`Error in reverse4D: x must be rank 4 but got rank ${t.rank}.`),_o(t,e)}const Dv=X({reverse4d_:Ov});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Fv(n){const t={x:L(n,"x","round")};return Q.runKernel(wp,t)}const M2=X({round_:Fv});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pv(n){const t={x:L(n,"x","rsqrt","float32")};return Q.runKernel(Cp,t)}const Lv=X({rsqrt_:Pv});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bv(n){const t={x:L(n,"x","selu")};return Q.runKernel(Np,t)}const Mv=X({selu_:Bv});function Vv(n,e,t,r,s,o=[1,1],i="NHWC"){const a=L(n,"x","separableConv2d"),u=L(e,"depthwiseFilter","separableConv2d"),c=L(t,"pointwiseFilter","separableConv2d");let l=a,h=!1;if(a.rank===3&&(h=!0,l=me(a,[1,a.shape[0],a.shape[1],a.shape[2]])),i==="NCHW")throw new Error("separableConv2d currently does not support dataFormat NCHW; only NHWC is supported");M(l.rank===4,()=>`Error in separableConv2d: input must be rank 4, but got rank ${l.rank}.`),M(u.rank===4,()=>`Error in separableConv2d: depthwise filter must be rank 4, but got rank ${u.rank}.`),M(c.rank===4,()=>`Error in separableConv2d: pointwise filter must be rank 4, but got rank ${u.rank}.`),M(c.shape[0]===1,()=>`Error in separableConv2d: the first dimension of pointwise filter  must be 1, but got ${c.shape[0]}.`),M(c.shape[1]===1,()=>`Error in separableConv2d: the second dimension of pointwise filter must be 1, but got ${c.shape[1]}.`);const d=u.shape[2],m=u.shape[3];M(c.shape[2]===d*m,()=>`Error in separableConv2d: the third dimension of pointwise filter must be ${d*m}, but got ${c.shape[2]}.`);const g=cl(l,u,r,s,i,o),$=iu(g,c,1,"valid",i);return h?me($,[$.shape[1],$.shape[2],$.shape[3]]):$}const Uv=X({separableConv2d_:Vv});/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Wv(n,e){const t=L(n,"x","setdiff1d"),r=L(e,"y","setdiff1d");M(t.dtype===r.dtype,()=>`x and y should have the same dtype, but got x (${t.dtype}) and y (${r.dtype}).`),M(t.rank===1,()=>`x should be 1D tensor, but got x (${t.shape}).`),M(r.rank===1,()=>`y should be 1D tensor, but got y (${r.shape}).`);const s=await t.data(),o=await r.data(),i=new Set(o);let a=0;for(let l=0;l<s.length;l++)i.has(s[l])||a++;const u=new Hi([a],t.dtype),c=new Hi([a],"int32");for(let l=0,h=0;l<s.length;l++)i.has(s[l])||(u.values[h]=s[l],c.values[h]=l,h++);return[u.toTensor(),c.toTensor()]}const zv=Wv;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Gv(n){const t={x:L(n,"x","sign")};return Q.runKernel(_p,t)}const jv=X({sign_:Gv});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hv(n){const t={x:L(n,"x","sin","float32")};return Q.runKernel(kp,t)}const qv=X({sin_:Hv});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xv(n){const t={x:L(n,"x","sinh")};return Q.runKernel(Ip,t)}const Kv=X({sinh_:Xv});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yv(n,e,t){const r=L(n,"x","slice1d");return M(r.rank===1,()=>`slice1d expects a rank-1 tensor, but got a rank-${r.rank} tensor`),Ze(r,[e],[t])}const Qv=X({slice1d_:Yv});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zv(n,e,t){const r=L(n,"x","slice2d");return M(r.rank===2,()=>`slice2d expects a rank-2 tensor, but got a rank-${r.rank} tensor`),Ze(r,e,t)}const Jv=X({slice2d_:Zv});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ew(n,e,t){const r=L(n,"x","slice3d");return M(r.rank===3,()=>`slice3d expects a rank-3 tensor, but got a rank-${r.rank} tensor`),Ze(r,e,t)}const tw=X({slice3d_:ew});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nw(n,e,t){const r=L(n,"x","slice4d");return M(r.rank===4,()=>`slice4d expects a rank-4 tensor, but got a rank-${r.rank} tensor`),Ze(r,e,t)}const rw=X({slice4d_:nw});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sw(n,e=-1){const t=L(n,"logits","softmax","float32");if(e===-1&&(e=t.rank-1),e!==t.rank-1)throw Error(`Softmax along a non-last dimension is not yet supported. Logits was rank ${t.rank} and dim was ${e}`);const r={logits:t},s={dim:e};return Q.runKernel(Lp,r,s)}const ow=X({softmax_:sw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function iw(n){M(n.dtype==="complex64",()=>`The dtype for tf.spectral.fft() must be complex64 but got ${n.dtype}.`);const e={input:n};return Q.runKernel(md,e)}const xl=X({fft_:iw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function aw(n){M(n.dtype==="complex64",()=>`The dtype for tf.spectral.ifft() must be complex64 but got ${n.dtype}.`);const e={input:n};return Q.runKernel(Sd,e)}const Ga=X({ifft_:aw});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uw(n){const e=n.shape[n.shape.length-1],t=n.size/e;let r;if(e<=2){const s=me(n,[t,e]);r=Ga(s)}else{const s=[t,2*(e-1)],o=me(qi(n),[t,e]),i=me(ru(n),[t,e]),a=_o(Ze(o,[0,1],[t,e-2]),1),u=We(_o(Ze(i,[0,1],[t,e-2]),1),ct(-1)),c=sn([o,a],1),l=sn([i,u],1),h=me(Gs(c,l),[s[0],s[1]]);r=Ga(h)}if(r=qi(r),n.rank===3&&n.shape[0]!==0){const s=r,o=n.shape[0];r=me(r,[o,r.shape[0]/o,r.shape[1]]),s.dispose()}return r}const V2=X({irfft_:uw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function cw(n,e,t=0){const s={x:L(n,"x","split")},o={numOrSizeSplits:e,axis:t};return Q.runKernel(Pp,s,o)}const Qi=X({split_:cw});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lw(n,e){M(n.dtype==="float32",()=>`The dtype for rfft() must be real value but got ${n.dtype}`);let t=n.shape[n.shape.length-1];const r=n.size/t;let s;if(e!=null&&e<t){const g=n.shape.map($=>0),C=n.shape.map($=>$);C[n.shape.length-1]=e,s=Ze(n,g,C),t=e}else if(e!=null&&e>t){const g=n.shape.map(C=>C);g[n.shape.length-1]=e-t,s=sn([n,Io(g)],n.shape.length-1),t=e}else s=n;const o=ll(s),i=me(Gs(s,o),[r,t]),a=xl(i),u=Math.floor(t/2)+1,c=qi(a),l=ru(a),h=Qi(c,[u,t-u],c.shape.length-1),d=Qi(l,[u,t-u],l.shape.length-1),m=s.shape.slice();return m[s.shape.length-1]=u,me(Gs(h[0],d[0]),m)}const bl=X({rfft_:lw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hw(n,e){let t=L(n,"a","squaredDifference"),r=L(e,"b","squaredDifference");[t,r]=Mt(t,r),ot(t.shape,r.shape);const s={a:t,b:r},o={};return Q.runKernel(zp,s,o)}const U2=X({squaredDifference_:hw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fw(n,e){const t=L(n,"x","squeeze","string_or_numeric");return me(t,Hs(t.shape,e).newShape)}const Yt=X({squeeze_:fw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dw(n,e=0){const t=Ba(n,"tensors","stack","string_or_numeric");M(t.length>=1,()=>"Pass at least one tensor to tf.stack"),t.length>0&&M(e<=t[0].rank,()=>"Axis must be <= rank of the tensor");const r=t,s={axis:e};return Q.runKernel(op,r,s)}const Ts=X({stack_:dw});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function pw(n,e=0){const r={x:L(n,"x","step")},s={alpha:e};return Q.runKernel(r1,r,s)}const W2=X({step_:pw});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function mw(n,e,t,r,s=0,o=0,i=0,a=0,u=0){const l={x:L(n,"x","stridedSlice","string_or_numeric")},h={begin:e,end:t,strides:r,beginMask:s,endMask:o,ellipsisMask:i,newAxisMask:a,shrinkAxisMask:u};return Q.runKernel(Gp,l,h)}const gw=X({stridedSlice_:mw});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yw(n){const t={x:L(n,"x","tan","float32")};return Q.runKernel(Kp,t)}const xw=X({tan_:yw});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tn(n,e){bi(n);const t=qs(n,e);if(t.length!==1)throw new Error("tensor1d() requires values to be a flat/TypedArray");return Xs(n,null,t,e)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ws(n,e,t){if(bi(n),e!=null&&e.length!==2)throw new Error("tensor2d() requires shape to have two numbers");const r=qs(n,t);if(r.length!==2&&r.length!==1)throw new Error("tensor2d() requires values to be number[][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor2d() requires shape to be provided when `values` are a flat/TypedArray");return Xs(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bw(n,e,t){if(bi(n),e!=null&&e.length!==4)throw new Error("tensor4d() requires shape to have four numbers");const r=qs(n,t);if(r.length!==4&&r.length!==1)throw new Error("tensor4d() requires values to be number[][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor4d() requires shape to be provided when `values` are a flat array");return Xs(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vw(n,e,t){if(bi(n),e!=null&&e.length!==5)throw new Error("tensor5d() requires shape to have five numbers");const r=qs(n,t);if(r.length!==5&&r.length!==1)throw new Error("tensor5d() requires values to be number[][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor5d() requires shape to be provided when `values` are a flat array");return Xs(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ww(n,e,t){if(bi(n),e!=null&&e.length!==6)throw new Error("tensor6d() requires shape to have six numbers");const r=qs(n,t);if(r.length!==6&&r.length!==1)throw new Error("tensor6d() requires values to be number[][][][][][] or flat/TypedArray");if(r.length===1&&e==null)throw new Error("tensor6d() requires shape to be provided when `values` are a flat array");return e=e||r,Xs(n,e,r,t)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cw(n,e=1,t=!0){const r=L(n,"x","topk");if(r.rank===0)throw new Error("topk() expects the input to be of rank 1 or higher");const s=r.shape[r.shape.length-1];if(e<0)throw new Error(`'k' passed to topk() must be >= 0 but got ${e}`);if(e>s)throw new Error(`'k' passed to topk() must be <= the last dimension (${s}) but got ${e}`);const o={x:r},i={k:e,sorted:t},[a,u]=Q.runKernel(Qp,o,i);return{values:a,indices:u}}const Tw=X({topk_:Cw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $w(n,e=0,t=1,r,s){if(r!=null&&r==="bool")throw new Error("Unsupported data type $ { dtype }");const o=new yl(e,t,r,!0,s),i=Ot(n,r);for(let a=0;a<i.values.length;a++)i.values[a]=o.nextValue();return i.toTensor()}const Sw=X({truncatedNormal_:$w});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Nw(n,e=0){const t=L(n,"x","unique","string_or_numeric");M(t.rank>0,()=>"The input tensor must be at least 1D");const r={x:t},s={axis:e},[o,i]=Q.runKernel(Jp,r,s);return{values:o,indices:i}}const Ew=X({unique_:Nw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kw(n,e,t){const r=L(n,"x","unsortedSegmentSum"),s=L(e,"segmentIds","unsortedSegmentSum","int32");M(ci(t),()=>"numSegments must be of dtype int");const o={x:r,segmentIds:s},i={numSegments:t};return Q.runKernel(t1,o,i)}const Iw=X({unsortedSegmentSum_:kw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _w(n,e=0){const t=L(n,"x","unstack","string_or_numeric");M(e>=-t.shape.length&&e<t.shape.length,()=>`Axis = ${e} is not in [-${t.shape.length}, ${t.shape.length})`);const r={value:t},s={axis:e};return Q.runKernel(e1,r,s)}const Po=X({unstack_:_w});/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rw(n,e){return ml(n,e,"right")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Aw(n,e=!0,t,r){return Q.makeVariable(n,e,t,r)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z2(n,e){const t=[];for(let o=0;o<e.length;o++)e[o]&&t.push(o);const r=Ot(n,"int32"),s=Ot([t.length,n.length],"int32");for(let o=0;o<t.length;o++){const i=r.indexToLoc(t[o]),a=o*n.length;s.values.set(i,a)}return s.toTensor()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Ow(n){const e=L(n,"condition","whereAsync","bool"),t=await e.data(),r=z2(e.shape,t);return n!==e&&e.dispose(),r}const G2=Ow;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Dw(n,e,t){const r=L(n,"tensor","boolMask"),s=L(e,"mask","boolMask","bool"),o=t==null?0:t,i=s.rank,a=r.shape;M(i>0,()=>"mask cannot be scalar"),Qn(a.slice(o,o+i),s.shape,"mask's shape must match the first K dimensions of tensor's shape,");let u=1;for(let C=o;C<o+i;C++)u*=a[C];const c=a.slice(0,o).concat([u],a.slice(o+i)),l=me(r,c),h=me(s,[-1]),d=await G2(h),m=Yt(d,[1]),g=g2(l,m,o);return n!==r&&r.dispose(),e!==s&&s.dispose(),m.dispose(),l.dispose(),h.dispose(),d.dispose(),g}const Fw=Dw;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Pw(n,e,t,r,s=!0){const o=L(n,"v","movingAverage"),i=L(e,"x","movingAverage"),a=L(t,"decay","movingAverage");n3(o,i),M(Bt(o.shape,i.shape),()=>"Shape mismatch in v and x");const u=ct(1),c=nt(u,a);let l=We(nt(i,o),c);if(s){M(r!=null,()=>"When using zeroDebias: true, step is required.");const h=L(r,"step","movingAverage");l=xt(l,nt(u,dl(a,h)))}return Ct(o,l)}const Lw=X({movingAverage_:Pw});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Bw(n,e,t){const r=L(n,"indices","scatterND","int32"),s=L(e,"updates","scatterND");G1(s,r,t);const o={indices:r,updates:s},i={shape:t};return Q.runKernel(Tp,o,i)}const Mw=X({scatterND_:Bw});function Vw(n,e,t,r){if(n.dtype!=="int32")throw new Error(`tf.sparseToDense() expects the indices to be int32 type, but the dtype was ${n.dtype}.`);if(n.rank>2)throw new Error(`sparseIndices should be a scalar, vector, or matrix, but got shape ${n.shape}.`);const s=n.rank>0?n.shape[0]:1,o=n.rank>1?n.shape[1]:1;if(t.length!==o)throw new Error(`outputShape has incorrect number of elements:, ${t.length}, should be: ${o}.`);const i=e.size;if(!(e.rank===0||e.rank===1&&i===s))throw new Error(`sparseValues has incorrect shape ${e.shape}, should be [] or [${s}]`);if(e.dtype!==r.dtype)throw new Error("sparseValues.dtype must match defaultValues.dtype")}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Uw(n,e,t,r=0){const s=L(n,"sparseIndices","sparseToDense","int32"),o=L(e,"sparseValues","sparseToDense","string_or_numeric"),i=L(r,"defaultValue","sparseToDense",o.dtype);Vw(s,o,t,i);const a={sparseIndices:s,sparseValues:o,defaultValue:i},u={outputShape:t};return Q.runKernel(Wp,a,u)}const Ww=X({sparseToDense_:Uw});/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zw(n,e){const t=L(e,"indices","gatherND","int32"),s={params:L(n,"x","gatherND","string_or_numeric"),indices:t};return Q.runKernel(Cd,s)}const Gw=X({gatherND_:zw});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jw(n,e){if(e==null)return n.shape.slice();if(Bt(n.shape,e))return e;if(n.shape.length===e.length){const t=[];for(let r=0;r<n.shape.length;r++)e[r]==null&&n.shape[r]!=null?t.push(n.shape[r]):t.push(e[r]);return t}return e}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Hw(n,e,t,r){const s=L(n,"x","dropout");if(M(s.dtype==="float32",()=>`x has to be a floating point tensor since it's going to be scaled, but got a ${s.dtype} tensor instead.`),M(e>=0&&e<1,()=>`rate must be a float in the range [0, 1), but got ${e}.`),e===0)return n instanceof Rt?s.clone():s;const o=jw(s,t),i=1-e,a=xt(m2(Ct(L2(o,0,1,"float32",r),i)),i);return We(s,a)}const qw=X({dropout_:Hw});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j2(n){return Math.floor(Math.pow(2,Math.ceil(Math.log(n)/Math.log(2))))}function vl(n,e,t){const r=1-n%2,s=new Float32Array(n);for(let o=0;o<n;++o){const i=2*Math.PI*o/(n+r-1);s[o]=e-t*Math.cos(i)}return Tn(s,"float32")}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function Xw(n,e,t=1){const r=L(n,"predictions","inTopK"),s=L(e,"targets","inTopK");M(r.rank>1,()=>`inTopK() expects the predictions to be of rank 2 or higher, but got ${r.rank}`),M(r.rank-1===s.rank,()=>`predictions rank should be 1 larger than targets rank, but got predictions rank ${r.rank} and targets rank ${s.rank}`),Qn(r.shape.slice(0,r.shape.length-1),s.shape,"predictions's shape should be align with the targets' shape, except the last dimension.");const o=r.shape[r.shape.length-1];M(t>0&&t<=o,()=>`'k' passed to inTopK() must be > 0 && <= the predictions last dimension (${o}), but got ${t}`);const i=await r.data(),a=await s.data(),[u,c]=[i.length/o,o],l=vs("bool",u);for(let h=0;h<u;h++){const d=h*c,m=i.subarray(d,d+c),g=[];for(let C=0;C<m.length;C++)g.push({value:m[C],index:C});g.sort((C,$)=>$.value-C.value),l[h]=0;for(let C=0;C<t;C++)if(g[C].index===a[h]){l[h]=1;break}}return n!==r&&r.dispose(),e!==s&&s.dispose(),ts(l,s.shape,"bool")}const Kw=Xw;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Yw(n,e,t,r,s,o="NHWC",i){let a=n;n.rank===3&&(a=me(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let u=e;u.rank===3&&(u=me(e,[1,e.shape[0],e.shape[1],e.shape[2]])),M(a.rank===4,()=>`Error in conv2dDerFilter: input must be rank 4, but got shape ${a.shape}.`),M(u.rank===4,()=>`Error in conv2dDerFilter: dy must be rank 4, but got shape ${u.shape}.`),M(t.length===4,()=>`Error in conv2dDerFilter: filterShape must be length 4, but got ${t}.`);const c=o==="NHWC"?a.shape[3]:a.shape[1],l=o==="NHWC"?u.shape[3]:u.shape[1];M(c===t[2],()=>`Error in conv2dDerFilter: depth of input ${c}) must match input depth in filter (${t[2]}.`),M(l===t[3],()=>`Error in conv2dDerFilter: depth of dy (${l}) must match output depth for filter (${t[3]}).`),gr("conv2dDerFilter",s,i);const h={x:a,dy:u},d={strides:r,pad:s,dataFormat:o,dimRoundingMode:i,filterShape:t};return Q.runKernel(jf,h,d)}const Qw=X({conv2DBackpropFilter_:Yw});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hu(n,e,t){if(t==null||t==="linear")return n;if(t==="relu")return We(n,W2(e));throw new Error(`Cannot compute gradient for fused activation ${t}.`)}function fu(n,e){let t=e;const r=B1(n.shape,e.shape);return r.length>0&&(t=$t(t,r)),me(t,n.shape)}function du(n,e,t,r){if(e==="linear")return n;if(e==="relu")return lu(n);if(e==="elu")return h2(n);if(e==="relu6")return B2(n);if(e==="prelu")return k2(n,t);if(e==="leakyrelu")return x2(n,r);if(e==="sigmoid")return So(n);throw new Error(`Unknown fused activation ${e}.`)}const pu=(n,e)=>!(n>0)||e==="linear";/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zw({x:n,filter:e,strides:t,pad:r,dataFormat:s="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:u="linear",preluActivationWeights:c,leakyreluAlpha:l}){if(u=u||"linear",pu(Q.state.gradientDepth,u)===!1){M(s==="NHWC",()=>`Error in fused conv2d: got dataFormat of ${s} but only NHWC is currently supported for the case of gradient depth is 0 and the activation is not linear.`);let x=iu(n,e,t,r,s,o,i);return a!=null&&(x=Ct(x,a)),du(x,u,c,l)}const h=L(n,"x","conv2d","float32"),d=L(e,"filter","conv2d","float32");let m=h,g=!1;h.rank===3&&(g=!0,m=me(h,[1,h.shape[0],h.shape[1],h.shape[2]])),M(m.rank===4,()=>`Error in fused conv2d: input must be rank 4, but got rank ${m.rank}.`),M(d.rank===4,()=>`Error in fused conv2d: filter must be rank 4, but got rank ${d.rank}.`),gr("fused conv2d",r,i);const C=s==="NHWC"?m.shape[3]:m.shape[1];M(d.shape[2]===C,()=>`Error in conv2d: depth of input (${C}) must match input depth for filter ${d.shape[2]}.`),M(Mn(t,o),()=>`Error in conv2D: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`);const $=Zn(m.shape,d.shape,t,o,r,i);let T;a!=null&&(T=L(a,"bias","fused conv2d"),[T]=Mt(T,h),s==="NHWC"?ot($.outShape,T.shape):(M(T.shape.length<=1,()=>`Error in fused conv2d: only supports scalar or 1-D Tensor bias for NCHW format but got the bias of rank-${T.shape.length}.`),M(T.shape.length===0||T.shape[0]===$.outChannels||T.shape[0]===1,()=>`Error in fused conv2d: bias shape (${T.shape}) is not compatible with the number of output channels (${$.outChannels})`)));let A;if(c!=null){const x=c.shape;if(M(x.length<=1||x.length===3,()=>`Error in fused conv2d: only supports scalar, 1-D Tensor or 3-D Tensor PReLU activation weights but got a tensor of rank-${x.length}.`),x.length===1)M(x[0]===1||x[0]===$.outChannels,()=>`Error in fused conv2d: PReLU activation weights (${x}) is not compatible with the number of output channels (${$.outChannels}).`);else if(x.length===3)try{ot(x,$.outShape)}catch{const oe=`Error in fused conv2d: PReLU activation weights (${x}) is not compatible with the output shape of the conv2d (${$.outShape}).`;throw Error(oe)}A=L(c,"prelu weights","fused conv2d")}const P=(x,re)=>{M(s==="NHWC",()=>`Error in gradient of fused conv2D: got dataFormat of ${s} but only NHWC is currently supported.`);const[oe,ie,le,$e]=re,Ie=hu(x,le,u);M(Xi(o),()=>`Error in gradient of fused conv2D: dilation rates greater than 1 are not yet supported in gradients. Got dilations '${o}'`);const Ae=c2(ie.shape,Ie,oe,t,r),Ge=Qw(ie,Ie,oe.shape,t,r),Ye=[Ae,Ge];if($e!=null){const at=fu($e,Ie);Ye.push(at)}return Ye},B={x:m,filter:d,bias:T,preluActivationWeights:A},H={strides:t,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i,activation:u,leakyreluAlpha:l};return a==null?Cs((re,oe,ie)=>{let le=Q.runKernel(oc,B,H);return ie([oe,re,le]),g&&(le=me(le,[le.shape[1],le.shape[2],le.shape[3]])),{value:le,gradFunc:P}})(m,d):Cs((re,oe,ie,le)=>{let $e=Q.runKernel(oc,B,H);return le([oe,re,$e,ie]),g&&($e=me($e,[$e.shape[1],$e.shape[2],$e.shape[3]])),{value:$e,gradFunc:P}})(m,d,T)}const Jw=X({fusedConv2d_:Zw});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e6(n,e,t,r,s,o=[1,1],i){let a=n;n.rank===3&&(a=me(n,[1,n.shape[0],n.shape[1],n.shape[2]]));let u=e;u.rank===3&&(u=me(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={x:a,dy:u},l={strides:r,pad:s,dimRoundingMode:i,dilations:o,filterShape:t};return Q.runKernel(rd,c,l)}const t6=X({depthwiseConv2dNativeBackpropFilter_:e6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n6(n,e,t,r,s,o=[1,1],i){let a=e,u=!1;e.rank===3&&(u=!0,a=me(e,[1,e.shape[0],e.shape[1],e.shape[2]]));const c={dy:a,filter:t},l={strides:r,pad:s,dimRoundingMode:i,dilations:o,inputShape:n},h=Q.runKernel(sd,c,l);return u?me(h,[h.shape[1],h.shape[2],h.shape[3]]):h}const r6=X({depthwiseConv2dNativeBackpropInput_:n6});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s6({x:n,filter:e,strides:t,pad:r,dataFormat:s="NHWC",dilations:o=[1,1],dimRoundingMode:i,bias:a,activation:u="linear",preluActivationWeights:c,leakyreluAlpha:l}){if(pu(Q.state.gradientDepth,u)===!1){let H=cl(n,e,t,r,s,o,i);return a!=null&&(H=Ct(H,a)),du(H,u,c,l)}const h=L(n,"x","depthwiseConv2d","float32"),d=L(e,"filter","depthwiseConv2d","float32");let m=h,g=!1;h.rank===3&&(g=!0,m=me(h,[1,h.shape[0],h.shape[1],h.shape[2]])),M(m.rank===4,()=>`Error in fused depthwiseConv2d: input must be rank 4, but got rank ${m.rank}.`),M(d.rank===4,()=>`Error in fused depthwiseConv2d: filter must be rank 4, but got rank ${d.rank}.`),M(m.shape[3]===d.shape[2],()=>`Error in fused depthwiseConv2d: number of input channels (${m.shape[3]}) must match the inChannels dimension in filter ${d.shape[2]}.`),o==null&&(o=[1,1]),M(Mn(t,o),()=>`Error in fused depthwiseConv2d: Either strides or dilations must be 1. Got strides ${t} and dilations '${o}'`),gr("fused depthwiseConv2d",r,i);const C=Zn(m.shape,d.shape,t,o,r,i,!0);let $;a!=null&&($=L(a,"bias","fused conv2d"),[$]=Mt($,h),ot(C.outShape,$.shape));let T;c!=null&&(T=L(c,"prelu weights","fused depthwiseConv2d"));const A=(H,x)=>{M(Xi(o),()=>`Error in gradient of fused depthwiseConv2d: dilation rates greater than 1 are not yet supported. Got dilations '${o}'`);const[re,oe,ie,le]=x,$e=hu(H,ie,u),Ie=r6(oe.shape,$e,re,t,r,o,i),Ae=t6(oe,$e,re.shape,t,r,o,i);if(le!=null){const Ge=fu($,$e);return[Ie,Ae,Ge]}return[Ie,Ae]},P={x:m,filter:d,bias:$,preluActivationWeights:T},B={strides:t,pad:r,dataFormat:s,dilations:o,dimRoundingMode:i,activation:u,leakyreluAlpha:l};return a==null?Cs((x,re,oe)=>{let ie=Q.runKernel(ic,P,B);return oe([re,x,ie]),g&&(ie=me(ie,[ie.shape[1],ie.shape[2],ie.shape[3]])),{value:ie,gradFunc:A}})(m,d):Cs((x,re,oe,ie)=>{let le=Q.runKernel(ic,P,B);return ie([re,x,le,oe]),g&&(le=me(le,[le.shape[1],le.shape[2],le.shape[3]])),{value:le,gradFunc:A}})(m,d,$)}const o6=X({fusedDepthwiseConv2d_:s6});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function i6({a:n,b:e,transposeA:t=!1,transposeB:r=!1,bias:s,activation:o="linear",preluActivationWeights:i,leakyreluAlpha:a=.2}){if(pu(Q.state.gradientDepth,o)===!1){let $e=mt(n,e,t,r);return s!=null&&($e=Ct($e,s)),du($e,o,i,a)}let u=L(n,"a","fused matMul"),c=L(e,"b","fused matMul");[u,c]=Mt(u,c);const l=t?u.shape[u.rank-2]:u.shape[u.rank-1],h=r?c.shape[c.rank-1]:c.shape[c.rank-2],d=t?u.shape[u.rank-1]:u.shape[u.rank-2],m=r?c.shape[c.rank-2]:c.shape[c.rank-1],g=u.shape.slice(0,-2),C=c.shape.slice(0,-2),$=Ce(g),T=Ce(C);M(l===h,()=>`Error in fused matMul: inner shapes (${l}) and (${h}) of Tensors with shapes ${u.shape} and ${c.shape} and transposeA=${t} and transposeB=${r} must match.`);const P=ot(u.shape.slice(0,-2),c.shape.slice(0,-2)).concat([d,m]),B=t?me(u,[$,l,d]):me(u,[$,d,l]),H=r?me(c,[T,m,h]):me(c,[T,h,m]);let x;s!=null&&(x=L(s,"bias","fused matMul"),[x]=Mt(x,u),ot(P,x.shape));let re;i!=null&&(re=L(i,"prelu weights","fused matMul"));const oe=($e,Ie)=>{const[Ae,Ge,Ye,at]=Ie,ut=hu(me($e,Ye.shape),Ye,o);let lt,Dt;if(!t&&!r?(lt=mt(ut,Ge,!1,!0),Dt=mt(Ae,ut,!0,!1)):!t&&r?(lt=mt(ut,Ge,!1,!1),Dt=mt(ut,Ae,!0,!1)):t&&!r?(lt=mt(Ge,ut,!1,!0),Dt=mt(Ae,ut,!1,!1)):(lt=mt(Ge,ut,!0,!0),Dt=mt(ut,Ae,!0,!0)),s!=null){const an=fu(at,ut);return[lt,Dt,an]}else return[lt,Dt]},ie={a:B,b:H,bias:x,preluActivationWeights:re},le={transposeA:t,transposeB:r,activation:o,leakyreluAlpha:a};return s==null?Cs((Ie,Ae,Ge)=>{const Ye=Q.runKernel(sc,ie,le);return Ge([Ie,Ae,Ye]),{value:me(Ye,P),gradFunc:oe}})(B,H):Cs((Ie,Ae,Ge,Ye)=>{const at=Q.runKernel(sc,ie,le);return Ye([Ie,Ae,at,Ge]),{value:me(at,P),gradFunc:oe}})(B,H,x)}const a6=X({fusedMatMul_:i6});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u6=Object.freeze(Object.defineProperty({__proto__:null,conv2d:Jw,depthwiseConv2d:o6,matMul:a6},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c6(n){return vl(n,.54,.46)}const l6=X({hammingWindow_:c6});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h6(n){return vl(n,.5,.5)}const H2=X({hannWindow_:h6});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f6(n,e,t,r=!1,s=0){let o=0;const i=[];for(;o+e<=n.size;)i.push(Ze(n,o,e)),o+=t;if(r)for(;o<n.size;){const a=o+e-n.size,u=sn([Ze(n,o,e-a),ou([a],s)]);i.push(u),o+=t}return i.length===0?Ws([],[0,e]):me(sn(i),[i.length,e])}const q2=X({frame_:f6});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d6(n,e,t,r,s=H2){r==null&&(r=j2(e));const o=q2(n,e,t),i=We(o,s(e));return bl(i,r)}const p6=X({stft_:d6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m6(n,e,t,r,s="bilinear",o=0){const i=L(n,"image","cropAndResize"),a=L(e,"boxes","cropAndResize","float32"),u=L(t,"boxInd","cropAndResize","int32"),c=a.shape[0];M(i.rank===4,()=>`Error in cropAndResize: image must be rank 4,but got rank ${i.rank}.`),M(a.rank===2&&a.shape[1]===4,()=>`Error in cropAndResize: boxes must be have size [${c},4] but had shape ${a.shape}.`),M(u.rank===1&&u.shape[0]===c,()=>`Error in cropAndResize: boxInd must be have size [${c}] but had shape ${a.shape}.`),M(r.length===2,()=>`Error in cropAndResize: cropSize must be of length 2, but got length ${r.length}.`),M(r[0]>=1&&r[1]>=1,()=>`cropSize must be atleast [1,1], but was ${r}`),M(s==="bilinear"||s==="nearest",()=>`method must be bilinear or nearest, but was ${s}`);const l={image:i,boxes:a,boxInd:u},h={method:s,extrapolationValue:o,cropSize:r};return Q.runKernel(Jf,l,h)}const g6=X({cropAndResize_:m6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y6(n){const e=L(n,"image","flipLeftRight","float32");M(e.rank===4,()=>`Error in flipLeftRight: image must be rank 4,but got rank ${e.rank}.`);const t={image:e};return Q.runKernel(yd,t,{})}const x6=X({flipLeftRight_:y6});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b6(n){const e=L(n,"image","grayscaleToRGB"),t=e.rank-1,r=e.shape[t];M(e.rank>=2,()=>`Error in grayscaleToRGB: images must be at least rank 2, but got rank ${e.rank}.`),M(r===1,()=>`Error in grayscaleToRGB: last dimension of a grayscale image should be size 1, but got size ${r}.`);const s=new Array(e.rank);return s.fill(1,0,t),s[t]=3,ji(e,s)}const v6=X({grayscaleToRGB_:b6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w6(n,e,t=0,r=.5){const s=L(n,"image","rotateWithOffset","float32");M(s.rank===4,()=>`Error in rotateWithOffset: image must be rank 4,but got rank ${s.rank}.`);const o={image:s},i={radians:e,fillValue:t,center:r};return Q.runKernel(s1,o,i)}const C6=X({rotateWithOffset_:w6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ci(n,e,t,r,s,o){r==null&&(r=.5),s==null&&(s=Number.NEGATIVE_INFINITY),o==null&&(o=0);const i=n.shape[0];return t=Math.min(t,i),M(0<=r&&r<=1,()=>`iouThreshold must be in [0, 1], but was '${r}'`),M(n.rank===2,()=>`boxes must be a 2D tensor, but was of rank '${n.rank}'`),M(n.shape[1]===4,()=>`boxes must have 4 columns, but 2nd dimension was ${n.shape[1]}`),M(e.rank===1,()=>"scores must be a 1D tensor"),M(e.shape[0]===i,()=>`scores has incompatible shape with boxes. Expected ${i}, but was ${e.shape[0]}`),M(0<=o&&o<=1,()=>`softNmsSigma must be in [0, 1], but was '${o}'`),{maxOutputSize:t,iouThreshold:r,scoreThreshold:s,softNmsSigma:o}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T6(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY){const o=L(n,"boxes","nonMaxSuppression","float32"),i=L(e,"scores","nonMaxSuppression","float32"),a=Ci(o,i,t,r,s);t=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const u={maxOutputSize:t,iouThreshold:r,scoreThreshold:s};return Q.runKernel(ep,{boxes:o,scores:i},u)}const $6=X({nonMaxSuppression_:T6});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S6(n,e,t){const r=N6(n,e,t),s=r<0?-(r+1):r;n.splice(s,0,e)}function N6(n,e,t){return k6(n,e,t||E6)}function E6(n,e){return n>e?1:n<e?-1:0}function k6(n,e,t){let r=0,s=n.length,o=0,i=!1;for(;r<s;){o=r+(s-r>>>1);const a=t(e,n[o]);a>0?r=o+1:(s=o,i=!a)}return i?r:-r-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X2(n,e,t,r,s){return wl(n,e,t,r,s,0)}function K2(n,e,t,r,s,o){return wl(n,e,t,r,s,0,!1,o,!0)}function Y2(n,e,t,r,s,o){return wl(n,e,t,r,s,o,!0)}function wl(n,e,t,r,s,o,i=!1,a=!1,u=!1){const c=[];for(let $=0;$<e.length;$++)e[$]>s&&c.push({score:e[$],boxIndex:$,suppressBeginIndex:0});c.sort(hh);const l=o>0?-.5/o:0,h=[],d=[];for(;h.length<t&&c.length>0;){const $=c.pop(),{score:T,boxIndex:A,suppressBeginIndex:P}=$;if(T<s)break;let B=!1;for(let H=h.length-1;H>=P;--H){const x=I6(n,A,h[H]);if(x>=r){B=!0;break}if($.score=$.score*_6(r,l,x),$.score<=s)break}$.suppressBeginIndex=h.length,B||($.score===T?(h.push(A),d.push($.score)):$.score>s&&S6(c,$,hh))}const m=h.length,g=t-m;a&&g>0&&(h.push(...new Array(g).fill(0)),d.push(...new Array(g).fill(0)));const C={selectedIndices:h};return i&&(C.selectedScores=d),u&&(C.validOutputs=m),C}function I6(n,e,t){const r=n.subarray(e*4,e*4+4),s=n.subarray(t*4,t*4+4),o=Math.min(r[0],r[2]),i=Math.min(r[1],r[3]),a=Math.max(r[0],r[2]),u=Math.max(r[1],r[3]),c=Math.min(s[0],s[2]),l=Math.min(s[1],s[3]),h=Math.max(s[0],s[2]),d=Math.max(s[1],s[3]),m=(a-o)*(u-i),g=(h-c)*(d-l);if(m<=0||g<=0)return 0;const C=Math.max(o,c),$=Math.max(i,l),T=Math.min(a,h),A=Math.min(u,d),P=Math.max(T-C,0)*Math.max(A-$,0);return P/(m+g-P)}function _6(n,e,t){const r=Math.exp(e*t*t);return t<=n?r:0}function hh(n,e){return n.score-e.score||n.score===e.score&&e.boxIndex-n.boxIndex}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function R6(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY){const o=L(n,"boxes","nonMaxSuppressionAsync"),i=L(e,"scores","nonMaxSuppressionAsync"),a=Ci(o,i,t,r,s);t=a.maxOutputSize,r=a.iouThreshold,s=a.scoreThreshold;const u=await Promise.all([o.data(),i.data()]),c=u[0],l=u[1],{selectedIndices:h}=X2(c,l,t,r,s);return o!==n&&o.dispose(),i!==e&&i.dispose(),Tn(h,"int32")}const A6=R6;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O6(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,o=0){const i=L(n,"boxes","nonMaxSuppression"),a=L(e,"scores","nonMaxSuppression"),u=Ci(i,a,t,r,s,o);t=u.maxOutputSize,r=u.iouThreshold,s=u.scoreThreshold,o=u.softNmsSigma;const c={boxes:i,scores:a},l={maxOutputSize:t,iouThreshold:r,scoreThreshold:s,softNmsSigma:o},h=Q.runKernel(np,c,l);return{selectedIndices:h[0],selectedScores:h[1]}}const D6=X({nonMaxSuppressionWithScore_:O6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function F6(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,o=0){const i=L(n,"boxes","nonMaxSuppressionAsync"),a=L(e,"scores","nonMaxSuppressionAsync"),u=Ci(i,a,t,r,s,o);t=u.maxOutputSize,r=u.iouThreshold,s=u.scoreThreshold,o=u.softNmsSigma;const c=await Promise.all([i.data(),a.data()]),l=c[0],h=c[1],{selectedIndices:d,selectedScores:m}=Y2(l,h,t,r,s,o);return i!==n&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:Tn(d,"int32"),selectedScores:Tn(m)}}const P6=F6;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L6(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,o=!1){const i=L(n,"boxes","nonMaxSuppression"),a=L(e,"scores","nonMaxSuppression"),u=Ci(i,a,t,r,s,null),c=u.maxOutputSize,l=u.iouThreshold,h=u.scoreThreshold,d={boxes:i,scores:a},m={maxOutputSize:c,iouThreshold:l,scoreThreshold:h,padToMaxOutputSize:o},g=Q.runKernel(tp,d,m);return{selectedIndices:g[0],validOutputs:g[1]}}const B6=X({nonMaxSuppressionPadded_:L6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */async function M6(n,e,t,r=.5,s=Number.NEGATIVE_INFINITY,o=!1){const i=L(n,"boxes","nonMaxSuppressionAsync"),a=L(e,"scores","nonMaxSuppressionAsync"),u=Ci(i,a,t,r,s,null),c=u.maxOutputSize,l=u.iouThreshold,h=u.scoreThreshold,[d,m]=await Promise.all([i.data(),a.data()]),{selectedIndices:g,validOutputs:C}=K2(d,m,c,l,h,o);return i!==n&&i.dispose(),a!==e&&a.dispose(),{selectedIndices:Tn(g,"int32"),validOutputs:ct(C,"int32")}}const V6=M6;/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U6(n,e,t=!1,r=!1){const s=L(n,"images","resizeBilinear");M(s.rank===3||s.rank===4,()=>`Error in resizeBilinear: x must be rank 3 or 4, but got rank ${s.rank}.`),M(e.length===2,()=>`Error in resizeBilinear: new shape must 2D, but got shape ${e}.`),M(r===!1||t===!1,()=>"Error in resizeBilinear: If halfPixelCenters is true, alignCorners must be false.");let o=s,i=!1;s.rank===3&&(i=!0,o=me(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:o},u={alignCorners:t,halfPixelCenters:r,size:e},c=Q.runKernel(xp,a,u);return i?me(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const W6=X({resizeBilinear_:U6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z6(n,e,t=!1,r=!1){const s=L(n,"images","resizeNearestNeighbor");M(s.rank===3||s.rank===4,()=>`Error in resizeNearestNeighbor: x must be rank 3 or 4, but got rank ${s.rank}.`),M(e.length===2,()=>`Error in resizeNearestNeighbor: new shape must 2D, but got shape ${e}.`),M(s.dtype==="float32"||s.dtype==="int32",()=>"`images` must have `int32` or `float32` as dtype"),M(r===!1||t===!1,()=>"Error in resizeNearestNeighbor: If halfPixelCenters is true, alignCorners must be false.");let o=s,i=!1;s.rank===3&&(i=!0,o=me(s,[1,s.shape[0],s.shape[1],s.shape[2]]));const a={images:o},u={alignCorners:t,halfPixelCenters:r,size:e},c=Q.runKernel(yp,a,u);return i?me(c,[c.shape[1],c.shape[2],c.shape[3]]):c}const G6=X({resizeNearestNeighbor_:z6});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * https://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j6(n,e="binary",t=!1,r=.5){const s=L(n,"image","threshold"),o=.2989,i=.587,a=.114,u=s.shape[0]*s.shape[1];let c=We(Tn([r]),255),l,h,d,m;if(M(s.rank===3,()=>`Error in threshold: image must be rank 3,but got rank ${s.rank}.`),M(s.shape[2]===3||s.shape[2]===1,()=>`Error in threshold: image color channel must be equal to 3 or 1but got ${s.shape[2]}.`),M(s.dtype==="int32"||s.dtype==="float32",()=>`Error in dtype: image dtype must be int32 or float32,but got dtype ${s.dtype}.`),M(e==="otsu"||e==="binary",()=>`Method must be binary or otsu, but was ${e}`),s.shape[2]===3){[l,h,d]=Qi(s,[1,1,1],-1);const $=We(l,o),T=We(h,i),A=We(d,a);m=Ct(Ct($,T),A)}else m=n;if(e==="otsu"){const $=a2(At(M2(m),"int32"),ts([]),256);c=H6($,u)}const g=t?pl(m,c):cu(m,c);return At(We(g,255),"int32")}function H6(n,e){let t=Tn([-1]),r=Tn([0]),s=Tn([0]),o,i,a,u,c,l;for(let h=0;h<n.size-1;h++){o=Ze(n,0,h+1),i=Ze(n,h+1),c=xt($t(o),e),l=xt($t(i),e);const d=$t(We(o,Yi(0,o.size)));a=xt(d,$t(o));const m=ou(i.shape,o.size),g=Ct(Yi(0,i.size),m),C=We(i,g);u=xt($t(C),$t(i));const $=nt(a,u),T=nt(a,u),A=We(c,l);s=We(We(A,$),T);const P=cu(s,r);r=pi(P,s,r),t=pi(P,Tn([h]),t)}return t}const q6=X({threshold_:j6});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function X6(n,e,t="nearest",r="constant",s=0,o){const i=L(n,"image","transform","float32"),a=L(e,"transforms","transform","float32");M(i.rank===4,()=>`Error in transform: image must be rank 4,but got rank ${i.rank}.`),M(a.rank===2&&(a.shape[0]===i.shape[0]||a.shape[0]===1)&&a.shape[1]===8,()=>"Error in transform: Input transform should be batch x 8 or 1 x 8"),M(o==null||o.length===2,()=>`Error in transform: outputShape must be [height, width] or null, but got ${o}.`);const u={image:i,transforms:a},c={interpolation:t,fillMode:r,fillValue:s,outputShape:o};return Q.runKernel(Zp,u,c)}const K6=X({transform_:X6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y6(n,e,t){M(e%1===0,()=>`bandPart(): numLower must be an integer, got ${e}.`),M(t%1===0,()=>`bandPart(): numUpper must be an integer, got ${t}.`);const r=L(n,"a","bandPart");M(r.rank>=2,()=>`bandPart(): Rank must be at least 2, got ${r.rank}.`);const s=r.shape,[o,i]=r.shape.slice(-2);if(!(e<=o))throw new Error(`bandPart(): numLower (${e}) must not be greater than the number of rows (${o}).`);if(!(t<=i))throw new Error(`bandPart(): numUpper (${t}) must not be greater than the number of columns (${i}).`);e<0&&(e=o),t<0&&(t=i);const a=me(Yi(0,o,1,"int32"),[-1,1]),u=Yi(0,i,1,"int32"),c=nt(a,u),l=Wa(pl(c,ct(+e,"int32")),y2(c,ct(-t,"int32"))),h=Io([o,i],r.dtype);return me(Ts(Po(me(r,[-1,o,i])).map(d=>pi(l,d,h))),s)}const Q6=X({bandPart_:Y6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z6(n){let e;if(Array.isArray(n)){e=!1,M(n!=null&&n.length>0,()=>"Gram-Schmidt process: input must not be null, undefined, or empty");const s=n[0].shape[0];for(let o=1;o<n.length;++o)M(n[o].shape[0]===s,()=>`Gram-Schmidt: Non-unique lengths found in the input vectors: (${n[o].shape[0]} vs. ${s})`)}else e=!0,n=Qi(n,n.shape[0],0).map(s=>Yt(s,[0]));M(n.length<=n[0].shape[0],()=>`Gram-Schmidt: Number of vectors (${n.length}) exceeds number of dimensions (${n[0].shape[0]}).`);const t=[],r=n;for(let s=0;s<n.length;++s)t.push(Q.tidy(()=>{let o=r[s];if(s>0)for(let i=0;i<s;++i){const a=We($t(We(t[i],o)),t[i]);o=nt(o,a)}return xt(o,uu(o,"euclidean"))}));return e?Ts(t,0):t}const J6=X({gramSchmidt_:Z6});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function e5(n,e=!1){if(M(n.rank>=2,()=>`qr() requires input tensor to have a rank >= 2, but got rank ${n.rank}`),n.rank===2)return fh(n,e);{const t=n.shape.slice(0,n.shape.length-2).reduce((u,c)=>u*c),r=Po(me(n,[t,n.shape[n.shape.length-2],n.shape[n.shape.length-1]]),0),s=[],o=[];r.forEach(u=>{const[c,l]=fh(u,e);s.push(c),o.push(l)});const i=me(Ts(s,0),n.shape),a=me(Ts(o,0),n.shape);return[i,a]}}function fh(n,e=!1){return Q.tidy(()=>{M(n.shape.length===2,()=>`qr2d() requires a 2D Tensor, but got a ${n.shape.length}D Tensor.`);const t=n.shape[0],r=n.shape[1];let s=p2(t),o=Us(n);const i=Ws([[1]],[1,1]);let a=Us(i);const u=t>=r?r:t;for(let c=0;c<u;++c){const l=o,h=a,d=s;[a,o,s]=Q.tidy(()=>{const m=Ze(o,[c,c],[t-c,1]),g=uu(m),C=Ze(o,[c,c],[1,1]),$=pi(cu(C,0),Ws([[-1]]),Ws([[1]])),T=nt(C,We($,g)),A=xt(m,T);A.shape[0]===1?a=Us(i):a=sn([i,Ze(A,[1,0],[A.shape[0]-1,A.shape[1]])],0);const P=bs(xt(mt($,T),g)),B=Ze(o,[c,0],[t-c,r]),H=We(P,a),x=wc(a);if(c===0)o=nt(B,mt(H,mt(x,B)));else{const ie=nt(B,mt(H,mt(x,B)));o=sn([Ze(o,[0,0],[c,r]),ie],0)}const re=wc(H),oe=Ze(s,[0,c],[t,s.shape[1]-c]);if(c===0)s=nt(oe,mt(mt(oe,a),re));else{const ie=nt(oe,mt(mt(oe,a),re));s=sn([Ze(s,[0,0],[t,c]),ie],1)}return[a,o,s]}),es([l,h,d])}return!e&&t>r&&(s=Ze(s,[0,0],[t,r]),o=Ze(o,[0,0],[r,r])),[s,o]})}const t5=X({qr_:e5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var In;(function(n){n[n.NONE=0]="NONE",n[n.MEAN=1]="MEAN",n[n.SUM=2]="SUM",n[n.SUM_BY_NONZERO_WEIGHTS=3]="SUM_BY_NONZERO_WEIGHTS"})(In||(In={}));function n5(n,e,t=In.SUM_BY_NONZERO_WEIGHTS){const r=L(n,"losses","computeWeightedLoss");let s=null;e!=null&&(s=L(e,"weights","computeWeightedLoss"));const o=s==null?r:We(r,s);if(t===In.NONE)return o;if(t===In.SUM)return $t(o);if(t===In.MEAN){if(s==null)return za(o);{const i=r.size/s.size,a=xt($t(o),$t(s));return i>1?xt(a,ct(i)):a}}if(t===In.SUM_BY_NONZERO_WEIGHTS){if(s==null)return xt($t(o),ct(r.size));{const i=We(s,wo(r.shape)),a=At($t(N2(i,ct(0))),"float32");return xt($t(o),a)}}throw Error(`Unknown reduction: ${t}`)}const Ns=X({computeWeightedLoss_:n5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function r5(n,e,t,r=In.SUM_BY_NONZERO_WEIGHTS){const s=L(n,"labels","absoluteDifference"),o=L(e,"predictions","absoluteDifference");let i=null;t!=null&&(i=L(t,"weights","absoluteDifference")),Qn(s.shape,o.shape,"Error in absoluteDifference: ");const a=lr(nt(s,o));return Ns(a,i,r)}const s5=X({absoluteDifference_:r5});function o5(n,e,t,r,s=In.SUM_BY_NONZERO_WEIGHTS){const o=L(n,"labels","cosineDistance"),i=L(e,"predictions","cosineDistance");let a=null;r!=null&&(a=L(r,"weights","cosineDistance")),Qn(o.shape,i.shape,"Error in cosineDistance: ");const u=ct(1),c=nt(u,$t(We(o,i),t,!0));return Ns(c,a,s)}const i5=X({cosineDistance_:o5});function a5(n,e,t,r=In.SUM_BY_NONZERO_WEIGHTS){let s=L(n,"labels","hingeLoss");const o=L(e,"predictions","hingeLoss");let i=null;t!=null&&(i=L(t,"weights","hingeLoss")),Qn(s.shape,o.shape,"Error in hingeLoss: ");const a=ct(1);s=nt(We(ct(2),s),a);const u=lu(nt(a,We(s,o)));return Ns(u,i,r)}const u5=X({hingeLoss_:a5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c5(n,e,t,r=1,s=In.SUM_BY_NONZERO_WEIGHTS){const o=L(n,"labels","huberLoss"),i=L(e,"predictions","huberLoss");let a=null;t!=null&&(a=L(t,"weights","huberLoss")),Qn(o.shape,i.shape,"Error in huberLoss: ");const u=ct(r),c=lr(nt(i,o)),l=S2(c,u),h=nt(c,l),d=Ct(We(ct(.5),au(l)),We(u,h));return Ns(d,a,s)}const l5=X({huberLoss_:c5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h5(n,e,t,r=1e-7,s=In.SUM_BY_NONZERO_WEIGHTS){const o=L(n,"labels","logLoss"),i=L(e,"predictions","logLoss");let a=null;t!=null&&(a=L(t,"weights","logLoss")),Qn(o.shape,i.shape,"Error in logLoss: ");const u=ct(1),c=ct(r),l=bs(We(o,Ki(Ct(i,c)))),h=We(nt(u,o),Ki(Ct(nt(u,i),c))),d=nt(l,h);return Ns(d,a,s)}const f5=X({logLoss_:h5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function d5(n,e,t,r=In.SUM_BY_NONZERO_WEIGHTS){const s=L(n,"labels","meanSquaredError"),o=L(e,"predictions","meanSquaredError");let i=null;t!=null&&(i=L(t,"weights","meanSquaredError")),Qn(s.shape,o.shape,"Error in meanSquaredError: ");const a=U2(s,o);return Ns(a,i,r)}const p5=X({meanSquaredError_:d5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m5(n,e){const t=L(n,"labels","sigmoidCrossEntropyWithLogits"),r=L(e,"logits","sigmoidCrossEntropyWithLogits");Qn(t.shape,r.shape,"Error in sigmoidCrossEntropyWithLogits: ");const s=lu(r),o=We(r,t),i=b2(ws(bs(lr(r))));return Ct(nt(s,o),i)}function g5(n,e,t,r=0,s=In.SUM_BY_NONZERO_WEIGHTS){let o=L(n,"multiClassLabels","sigmoidCrossEntropy");const i=L(e,"logits","sigmoidCrossEntropy");let a=null;if(t!=null&&(a=L(t,"weights","sigmoidCrossEntropy")),Qn(o.shape,i.shape,"Error in sigmoidCrossEntropy: "),r>0){const c=ct(r),l=ct(1),h=ct(.5);o=Ct(We(o,nt(l,c)),We(h,c))}const u=m5(o,i);return Ns(u,a,s)}const y5=X({sigmoidCrossEntropy_:g5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x5(n,e,t=-1){if(t===-1&&(t=e.rank-1),t!==e.rank-1)throw Error(`Softmax cross entropy along a non-last dimension is not yet supported. Labels / logits was rank ${e.rank} and dim was ${t}`);return Cs((s,o,i)=>{const u=w2(o,[t],!0),c=nt(At(o,"float32"),u);i([s,c]);const l=bs(We(c,s));return{value:$t(l,[t]),gradFunc:(m,g)=>{const[C,$]=g,T=Jn(m.shape,[t]);return[We(me(m,T),nt(At(C,"float32"),ws($))),We(me(m,T),nt(ws($),At(C,"float32")))]}}})(n,e)}function b5(n,e,t,r=0,s=In.SUM_BY_NONZERO_WEIGHTS){let o=L(n,"onehotLabels","softmaxCrossEntropy");const i=L(e,"logits","softmaxCrossEntropy");let a=null;if(t!=null&&(a=L(t,"weights","softmaxCrossEntropy")),Qn(o.shape,i.shape,"Error in softmaxCrossEntropy: "),r>0){const c=ct(r),l=ct(1),h=ct(o.shape[1]);o=Ct(We(o,nt(l,c)),xt(c,h))}const u=x5(o,i);return Ns(u,a,s)}const v5=X({softmaxCrossEntropy_:b5});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function w5(n,e,t,r){const s=L(n,"indices","sparseFillEmptyRows","int32"),o=L(e,"values","sparseFillEmptyRows"),i=L(t,"denseShape","sparseFillEmptyRows","int32"),a=L(r,"defaultValue","sparseFillEmptyRows",o.dtype);if(s.rank!==2)throw new Error(`Indices should be Tensor2D but received shape
        ${s.shape}`);if(o.rank!==1)throw new Error(`Values should be Tensor1D but received shape ${o.shape}`);if(i.rank!==1)throw new Error(`Dense shape should be Tensor1D but received shape ${i.shape}`);if(a.rank!==0)throw new Error(`Default value should be a scalar but received shape ${a.shape}`);const u={indices:s,values:o,denseShape:i,defaultValue:a},c=Q.runKernel(Bp,u);return{outputIndices:c[0],outputValues:c[1],emptyRowIndicator:c[2],reverseIndexMap:c[3]}}const C5=X({sparseFillEmptyRows_:w5});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function T5(n,e,t){const r=L(n,"inputIndices","sparseReshape","int32"),s=L(e,"inputShape","sparseReshape","int32"),o=L(t,"newShape","sparseReshape","int32");if(r.rank!==2)throw new Error(`Input indices should be Tensor2D but received shape
        ${r.shape}`);if(s.rank!==1)throw new Error(`Input shape should be Tensor1D but received shape ${s.shape}`);if(o.rank!==1)throw new Error(`New shape should be Tensor1D but received shape ${o.shape}`);const i={inputIndices:r,inputShape:s,newShape:o},a=Q.runKernel(Mp,i);return{outputIndices:a[0],outputShape:a[1]}}const $5=X({sparseReshape_:T5});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function S5(n,e,t){const r=L(n,"data","sparseSegmentMean"),s=L(e,"indices","sparseSegmentMean","int32"),o=L(t,"segmentIds","sparseSegmentMean","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
          ${s.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
          ${o.shape}`);const i={data:r,indices:s,segmentIds:o};return Q.runKernel(Vp,i)}const N5=X({sparseSegmentMean_:S5});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E5(n,e,t){const r=L(n,"data","sparseSegmentSum"),s=L(e,"indices","sparseSegmentSum","int32"),o=L(t,"segmentIds","sparseSegmentSum","int32");if(r.rank<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.rank!==1)throw new Error(`Indices should be Tensor1D but received shape
         ${s.shape}`);if(o.rank!==1)throw new Error(`Segment ids should be Tensor1D but received shape
         ${o.shape}`);const i={data:r,indices:s,segmentIds:o};return Q.runKernel(Up,i)}const k5=X({sparseSegmentSum_:E5});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I5(n,e,t,r,s,o,i,a){const u=L(n,"data","stringNGrams","string");if(u.dtype!=="string")throw new Error("Data must be of datatype string");if(u.shape.length!==1)throw new Error(`Data must be a vector, saw: ${u.shape}`);const c=L(e,"dataSplits","stringNGrams");if(c.dtype!=="int32")throw new Error("Data splits must be of datatype int32");const l={separator:t,nGramWidths:r,leftPad:s,rightPad:o,padWidth:i,preserveShortSequences:a},h={data:u,dataSplits:c},d=Q.runKernel(jp,h,l);return{nGrams:d[0],nGramsSplits:d[1]}}const _5=X({stringNGrams_:I5});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R5(n,e,t=!0){const r=L(n,"input","stringSplit","string"),s=L(e,"delimiter","stringSplit","string");if(r.rank!==1)throw new Error(`Input should be Tensor1D but received shape ${r.shape}`);if(s.rank!==0)throw new Error(`Delimiter should be a scalar but received shape ${s.shape}`);const o={skipEmpty:t},i={input:r,delimiter:s},a=Q.runKernel(Hp,i,o);return{indices:a[0],values:a[1],shape:a[2]}}const A5=X({stringSplit_:R5});/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O5(n,e){const t=L(n,"input","stringToHashBucketFast","string"),r={numBuckets:e};if(e<=0)throw new Error("Number of buckets must be at least 1");const s={input:t};return Q.runKernel(qp,s,r)}const D5=X({stringToHashBucketFast_:O5});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const F5={fft:xl,ifft:Ga,rfft:bl,irfft:V2},P5={hammingWindow:l6,hannWindow:H2,frame:q2,stft:p6},Ti={flipLeftRight:x6,grayscaleToRGB:v6,resizeNearestNeighbor:G6,resizeBilinear:W6,rotateWithOffset:C6,cropAndResize:g6,nonMaxSuppression:$6,nonMaxSuppressionAsync:A6,nonMaxSuppressionWithScore:D6,nonMaxSuppressionWithScoreAsync:P6,nonMaxSuppressionPadded:B6,nonMaxSuppressionPaddedAsync:V6,threshold:q6,transform:K6},L5={bandPart:Q6,gramSchmidt:J6,qr:t5},B5={absoluteDifference:s5,computeWeightedLoss:Ns,cosineDistance:i5,hingeLoss:u5,huberLoss:l5,logLoss:f5,meanSquaredError:p5,sigmoidCrossEntropy:y5,softmaxCrossEntropy:v5},M5={sparseFillEmptyRows:C5,sparseReshape:$5,sparseSegmentMean:N5,sparseSegmentSum:k5},V5={stringNGrams:_5,stringSplit:A5,stringToHashBucketFast:D5};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U5=(()=>typeof requestAnimationFrame<"u"?requestAnimationFrame:typeof setImmediate<"u"?setImmediate:n=>n())();function W5(){return new Promise(n=>U5(()=>n()))}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q2(n,e){const t=n[0].length;n.forEach((s,o)=>{M(s.length===t,()=>`Error in concat${t}D: rank of tensors[${o}] must be the same as the rank of the rest (${t})`)}),M(e>=0&&e<t,()=>`Error in concat${t}D: axis must be between 0 and ${t-1}.`);const r=n[0];n.forEach((s,o)=>{for(let i=0;i<t;i++)M(i===e||s[i]===r[i],()=>`Error in concat${t}D: Shape of tensors[${o}] (${s}) does not match the shape of the rest (${r}) along the non-concatenated axis ${o}.`)})}function Ro(n,e){const t=n[0].slice();for(let r=1;r<n.length;r++)t[e]+=n[r][e];return t}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Dr;(function(n){n[n.FIRST_DIM_SIZE=0]="FIRST_DIM_SIZE",n[n.VALUE_ROWIDS=1]="VALUE_ROWIDS",n[n.ROW_LENGTHS=2]="ROW_LENGTHS",n[n.ROW_SPLITS=3]="ROW_SPLITS",n[n.ROW_LIMITS=4]="ROW_LIMITS",n[n.ROW_STARTS=5]="ROW_STARTS"})(Dr||(Dr={}));function Z2(n,e,t){let r=new Array;if(t==null&&e==null)return r;if(e==null)for(;r.length<n+t.length;)r.push(-1);else r=e.slice();if(t==null)return r;if(n+t.length!==r.length)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.rank = ${n+t.length}, but shape.rank = ${r.length}`);for(let s=1;s<t.length;++s){const o=t[s],i=r[r.length-t.length+s],a=r[i];if(o>=0)if(a>=0){if(a!==o)throw new Error(`rt input.shape and shape=${e} are incompatible: rt input.shape[${s+n}] = ${o} but shape[${s+n}] = ${a}`)}else r[i]=o}return r}function J2(n){const e={FIRST_DIM_SIZE:Dr.FIRST_DIM_SIZE,VALUE_ROWIDS:Dr.VALUE_ROWIDS,ROW_LENGTHS:Dr.ROW_LENGTHS,ROW_SPLITS:Dr.ROW_SPLITS,ROW_LIMITS:Dr.ROW_LIMITS,ROW_STARTS:Dr.ROW_STARTS},t=[];for(const r of n)if(r in e)t.push(e[r]);else break;return t}function em(n){return n.length===0?0:n[0]===Dr.FIRST_DIM_SIZE?n.length-1:n.length}function tm(n,e){if(n==null||e==null)return;const t=n.length,r=e.length;if(t>=r)throw new Error(`defaultValue.shape=${n} and ragged tensor flatValues.shape=${e}, are incompatible: defaultValue.rank = ${t} must be less than ragged tensor input flatValues.rank = ${r})`);for(let s=0;s<Math.min(t,r-1);++s){const o=n[s],i=e[s+1];if(o>=0&&i>=0&&o!==1&&o!==i)throw new Error(`defaultValue.shape=${n}, and ragged tensor input flatValues.shape=${e} are incompatible: defaultValue.shape[${s-n.length}] = ${o} but ragged tensor input.flatValues.shape[${s-n.length}] = ${i}`)}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Cl=30;function mu(n){return n<=Cl?n:ec(n,Math.floor(Math.sqrt(n)))}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function nm(n,e,t){const r=t*(typeof n=="number"?n:n[0]),s=e*(typeof n=="number"?n:n[1]);return[r,s]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tl(n,e,t,r=!0){let s=[];if(r)s=s.concat(e.slice(0)),s.push(n[0]/t),s=s.concat(n.slice(1));else{s=s.concat(n[0]);const o=e.length;for(let i=0;i<o;++i)s=s.concat([n[i+1]/e[i],e[i]]);s=s.concat(n.slice(o+1))}return s}function $l(n,e,t=!0){const r=[];if(t){r.push(e);for(let s=e+1;s<n;++s)s<=2*e?(r.push(s),r.push(s-(e+1))):r.push(s)}else{const s=[],o=[];for(let i=1;i<n;++i)i>=e*2+1||i%2===1?o.push(i):s.push(i);r.push(...s),r.push(0),r.push(...o)}return r}function Sl(n,e,t,r=!0){const s=[];r?s.push(n[0]/t):s.push(n[0]*t);for(let o=1;o<n.length;++o)o<=e.length?r?s.push(e[o-1]*n[o]):s.push(n[o]/e[o-1]):s.push(n[o]);return s}function rm(n,e){const t=[0];for(let r=0;r<e;++r)t.push(n[r][0]);return t}function sm(n,e,t){const r=n.slice(0,1);for(let s=0;s<t;++s)r.push(n[s+1]-e[s][0]-e[s][1]);return r}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const om=1.7580993408473768,im=1.0507009873554805;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const am=.3275911,um=.254829592,cm=-.284496736,lm=1.421413741,hm=-1.453152027,fm=1.061405429;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ec(n,e){if(n.length!==e.length)throw new Error(`Cannot merge real and imag arrays of different lengths. real:${n.length}, imag: ${e.length}.`);const t=new Float32Array(n.length*2);for(let r=0;r<t.length;r+=2)t[r]=n[r/2],t[r+1]=e[r/2];return t}function z5(n){const e=new Float32Array(n.length/2),t=new Float32Array(n.length/2);for(let r=0;r<n.length;r+=2)e[r/2]=n[r],t[r/2]=n[r+1];return{real:e,imag:t}}function G5(n){const e=Math.ceil(n.length/4),t=new Float32Array(e),r=new Float32Array(e);for(let s=0;s<n.length;s+=4)t[Math.floor(s/4)]=n[s],r[Math.floor(s/4)]=n[s+1];return{real:t,imag:r}}function j5(n){const e=Math.floor(n.length/4),t=new Float32Array(e),r=new Float32Array(e);for(let s=2;s<n.length;s+=4)t[Math.floor(s/4)]=n[s],r[Math.floor(s/4)]=n[s+1];return{real:t,imag:r}}function H5(n,e){const t=n[e*2],r=n[e*2+1];return{real:t,imag:r}}function q5(n,e,t,r){n[r*2]=e,n[r*2+1]=t}function X5(n,e){const t=new Float32Array(n/2),r=new Float32Array(n/2);for(let s=0;s<Math.ceil(n/2);s++){const o=(e?2:-2)*Math.PI*(s/n);t[s]=Math.cos(o),r[s]=Math.sin(o)}return{real:t,imag:r}}function K5(n,e,t){const r=(t?2:-2)*Math.PI*(n/e),s=Math.cos(r),o=Math.sin(r);return{real:s,imag:o}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Du="->",Y5=/->/g,dh=",",ph="...";function dm(n,e){n=n.replace(/\s/g,"");const t=(n.length-n.replace(Y5,"").length)/Du.length;if(t<1)throw new Error("Equations without an arrow are not supported.");if(t>1)throw new Error(`Equation must contain exactly one arrow ("${Du}").`);const[r,s]=n.split(Du);M(r.indexOf(ph)===-1,()=>`The ellipsis notation ("${ph}") is not supported yet.`);const o=r.split(dh),i=o.length;if(e!==i)throw new Error(`Expected ${i} input tensors, received ${e}`);if(i>2)throw new Error("Support for more than 2 input tensors is not implemented yet.");const a=[];for(let d=0;d<s.length;++d){const m=s[d];if(!o.some(g=>g.indexOf(m)!==-1))throw new Error(`Output subscripts contain the label ${m} not present in the input subscripts.`);a.indexOf(m)===-1&&a.push(m)}for(let d=0;d<r.length;++d){const m=r[d];a.indexOf(m)===-1&&m!==dh&&a.push(m)}const u=new Array(o.length);for(let d=0;d<i;++d){if(new Set(o[d].split("")).size!==o[d].length)throw new Error(`Found duplicate axes in input component ${o[d]}. Support for duplicate axes in input is not implemented yet.`);u[d]=[];for(let m=0;m<o[d].length;++m)u[d].push(a.indexOf(o[d][m]))}const c=a.length,l=s.length,h=[];for(let d=l;d<c;++d)h.push(d);return{allDims:a,summedDims:h,idDims:u}}function pm(n,e){let t=new Array(n);t.fill(-1);for(let s=0;s<e.length;++s)t[e[s]]=s;const r=[];for(let s=0;s<n;++s)t[s]===-1&&r.push(s);return t=t.filter(s=>s!==-1),{permutationIndices:t,expandDims:r}}function mm(n,e,t){const r=new Array(n);for(let s=0;s<t.length;++s){const o=t[s].shape;for(let i=0;i<e[s].length;++i)r[e[s][i]]===void 0?r[e[s][i]]=o[i]:M(r[e[s][i]]===o[i],()=>`Expected dimension ${r[e[s][i]]} at axis ${i} of input shaped ${JSON.stringify(o)}, but got dimension ${o[i]}`)}}function gm(n,e){const t=n,r=[];let s=0;n.length===0&&t.push(-1),s=n.length+1;for(let i=0;i<s;++i)r.push([]);const o=[];for(let i=0;i<t.length;++i){const a=t[i],u=Q5(e,a);for(const c of u)o.indexOf(c)===-1&&(r[i].push(c),o.push(c))}return{path:t,steps:r}}function ym(n){return n.every((e,t)=>e===t)}function Q5(n,e){const t=[];for(let r=0;r<n.length;++r)(n[r].length===0||n[r].indexOf(e)!==-1||e===-1)&&t.push(r);return t}function xm(n,e,t=0){let r=[];if(typeof e=="number")M(n.shape[t]%e===0,()=>"Number of splits must evenly divide the axis."),r=new Array(e).fill(n.shape[t]/e);else{const s=e.reduce((i,a)=>(a===-1&&(i+=1),i),0);M(s<=1,()=>"There should be only one negative value in split array.");const o=e.indexOf(-1);if(o!==-1){const i=e.reduce((a,u)=>u>0?a+u:a);e[o]=n.shape[t]-i}M(n.shape[t]===e.reduce((i,a)=>i+a),()=>"The sum of sizes must match the size of the axis dimension."),r=e}return r}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bm(n){return`Received SparseTensor with denseShape[0] = 0 but
  indices.shape[0] = ${n}`}function vm(n,e){return`indices(${n}, 0) is invalid: ${e} < 0`}function wm(n,e,t){return`indices(${n}, 0) is invalid: ${e} >= ${t}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cm(n,e){return`only one output dimension may be -1, not both ${n} and ${e}`}function Tm(n,e){return`size ${n} must be non-negative, not ${e}`}function $m(){return"reshape cannot infer the missing input size for an empty tensor unless all specified input sizes are non-zero"}function Sm(n,e){const t=Ce(n),r=Ce(e);return`Input to reshape is a SparseTensor with ${t}
  dense values, but the requested shape requires a multiple of ${r}. inputShape=${n} outputShape= ${e}`}function Nm(n,e){const t=Ce(n),r=Ce(e);return`Input to reshape is a tensor with ${t} dense values, but the requested shape has ${r}. inputShape=${n} outputShape=${e}`}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kc(){return"segment ids must be >= 0"}function Em(){return"segment ids are not increasing"}function km(n,e){return`Segment id ${n} out of range [0, ${e}), possibly because segmentIds input is not sorted.`}function Im(n,e,t){return`Bad: indices[${n}] == ${e} out of range [0, ${t})`}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _m(n,e){let t=!1,r;for(n<=Cl?(r=n,t=!0):r=ec(n,Math.floor(Math.sqrt(n)));!t;)r>e||r===n?t=!0:r=ec(n,r+1);return r}function Rm(n,e,t){const r=[],s=n.length;for(let o=0;o<s;o++)o!==e?r.push(n[o]):r.push(t);return r}function Am(n,e,t,r){const s=e.shape.length,o=n.shape.length;if(r!==0&&(r<-s||r>s))throw new Error(`Expect batchDims in the range of [-${s}, ${s}], but got ${r}`);if(r<0&&(r+=s),r>o)throw new Error(`batchDims (${r}) must be less than rank(x) (
    ${o}).`);if(t<r)throw new Error(`batchDims (${r}) must be less than or equal to axis (${t}).`);for(let h=0;h<r;++h)if(n.shape[h]!==e.shape[h])throw new Error(`x.shape[${h}]: ${n.shape[h]} should be equal to indices.shape[${h}]: ${e.shape[h]}.`);const i=n.shape[t],a=[];let u=1,c=1,l=1;for(let h=0;h<r;++h)a.push(n.shape[h]),u*=n.shape[h];for(let h=r;h<t;h++)a.push(n.shape[h]),c*=n.shape[h];for(let h=r;h<s;h++)a.push(e.shape[h]);for(let h=t+1;h<o;h++)a.push(n.shape[h]),l*=n.shape[h];return{batchSize:u,sliceSize:l,outerSize:c,dimSize:i,outputShape:a}}const Z5=Object.freeze(Object.defineProperty({__proto__:null,segOpComputeOptimalWindowSize:_m,computeOutShape:Rm,collectGatherOpShapeInfo:Am},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Zi(n){try{return n.map(e=>fi(e))}catch(e){throw new Error(`Failed to decode encoded string bytes into utf-8, error: ${e}`)}}function Om(n){return n.map(e=>To(e))}const J5=Object.freeze(Object.defineProperty({__proto__:null,slice_util:g4,segment_util:Z5,fromUint8ToStringArray:Zi,fromStringArrayToUint8:Om,upcastType:rs,axesAreInnerMostDims:hl,combineLocations:f2,computeOutAndReduceShapes:ss,expandShapeToKeepDim:Jn,assertAxesAreInnerMostDims:Vr,getAxesPermutation:yr,getUndoAxesPermutation:fl,getInnerMostAxes:xr,getBroadcastDims:Va,getReductionAxes:B1,assertAndGetBroadcastShape:ot,assertParamsConsistent:Q2,computeOutShape:Ro,computeDilation2DInfo:s2,computePool2DInfo:Do,computePool3DInfo:sa,computeConv2DInfo:Zn,computeConv3DInfo:oa,computeDefaultPad:ul,tupleValuesAreOne:Xi,eitherStridesOrDilationsAreOne:Mn,convertConv2DDataFormat:wi,checkPadOnDimRoundingMode:gr,getFusedDyActivation:hu,getFusedBiasGradient:fu,applyActivation:du,shouldFuse:pu,get RowPartitionType(){return Dr},combineRaggedTensorToTensorShapes:Z2,getRowPartitionTypesHelper:J2,getRaggedRank:em,validateDefaultValueShape:tm,PARALLELIZE_THRESHOLD:Cl,computeOptimalWindowSize:mu,getImageCenter:nm,getReshaped:Tl,getPermuted:$l,getReshapedPermuted:Sl,getSliceBeginCoords:rm,getSliceSize:sm,prepareAndValidate:W1,validateUpdateShape:z1,validateInput:G1,calculateShapes:ol,SELU_SCALEALPHA:om,SELU_SCALE:im,ERF_P:am,ERF_A1:um,ERF_A2:cm,ERF_A3:lm,ERF_A4:hm,ERF_A5:fm,warn:Fr,log:D0,mergeRealAndImagArrays:Ec,splitRealAndImagArrays:z5,complexWithEvenIndex:G5,complexWithOddIndex:j5,getComplexWithIndex:H5,assignToTypedArray:q5,exponents:X5,exponent:K5,decodeEinsumEquation:dm,getEinsumPermutation:pm,checkEinsumDimSizes:mm,getEinsumComputePath:gm,isIdentityPermutation:ym,prepareSplitSize:xm,getSparseFillEmptyRowsIndicesDenseShapeMismatch:bm,getSparseFillEmptyRowsNegativeIndexErrorMessage:vm,getSparseFillEmptyRowsOutOfRangeIndexErrorMessage:wm,getSparseReshapeMultipleNegativeOneOutputDimErrorMessage:Cm,getSparseReshapeNegativeOutputDimErrorMessage:Tm,getSparseReshapeEmptyTensorZeroOutputDimErrorMessage:$m,getSparseReshapeInputOutputMultipleErrorMessage:Sm,getSparseReshapeInputOutputMismatchErrorMessage:Nm,getSparseSegmentReductionNegativeSegmentIdsErrorMessage:kc,getSparseSegmentReductionNonIncreasingSegmentIdsErrorMessage:Em,getSparseSegmentReductionSegmentIdOutOfRangeErrorMessage:km,getSparseSegmentReductionIndicesOutOfRangeErrorMessage:Im},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xo={},Ta={alpha:!1,antialias:!1,premultipliedAlpha:!1,preserveDrawingBuffer:!1,depth:!1,stencil:!1,failIfMajorPerformanceCaveat:!0};function eC(n,e){xo[n]=e}function Br(n,e){if(!(n in xo)||e!=null){const r=nC(n,e);if(r!==null)xo[n]=r;else return console.log("Could not get context for WebGL version",n),null}const t=xo[n];return t==null||t.isContextLost()?(delete xo[n],Br(n)):(t.disable(t.DEPTH_TEST),t.disable(t.STENCIL_TEST),t.disable(t.BLEND),t.disable(t.DITHER),t.disable(t.POLYGON_OFFSET_FILL),t.disable(t.SAMPLE_COVERAGE),t.enable(t.SCISSOR_TEST),t.enable(t.CULL_FACE),t.cullFace(t.BACK),xo[n])}function tC(n){if(typeof OffscreenCanvas<"u"&&n===2)return new OffscreenCanvas(300,150);if(typeof document<"u")return document.createElement("canvas");throw new Error("Cannot create a canvas in this context")}function nC(n,e){if(n!==1&&n!==2)throw new Error("Cannot get WebGL rendering context, WebGL is disabled.");const t=e==null?tC(n):e;return t.addEventListener("webglcontextlost",r=>{r.preventDefault(),delete xo[n]},!1),ue().getBool("SOFTWARE_WEBGL_ENABLED")&&(Ta.failIfMajorPerformanceCaveat=!1),n===1?t.getContext("webgl",Ta)||t.getContext("experimental-webgl",Ta):t.getContext("webgl2",Ta)}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var Ji;(function(n){n[n.DENSE=0]="DENSE",n[n.SHARED_BATCH=1]="SHARED_BATCH"})(Ji||(Ji={}));var Yn;(function(n){n[n.RENDER=0]="RENDER",n[n.UPLOAD=1]="UPLOAD",n[n.PIXELS=2]="PIXELS",n[n.DOWNLOAD=3]="DOWNLOAD"})(Yn||(Yn={}));var nn;(function(n){n[n.UNPACKED_FLOAT16=0]="UNPACKED_FLOAT16",n[n.UNPACKED_FLOAT32=1]="UNPACKED_FLOAT32",n[n.PACKED_4X1_UNSIGNED_BYTE=2]="PACKED_4X1_UNSIGNED_BYTE",n[n.PACKED_2X2_FLOAT32=3]="PACKED_2X2_FLOAT32",n[n.PACKED_2X2_FLOAT16=4]="PACKED_2X2_FLOAT16"})(nn||(nn={}));function aa(n,e){return[e,n]}function rC(n,e){return n*e}function $a(n){const e=Ce(n),t=Math.ceil(e/4);return Zu(t)}function $i(n,e){return[Math.max(1,Math.ceil(e/2)),Math.max(1,Math.ceil(n/2))]}function sC(n,e){const[t,r]=$i(n,e);return t*r*4}function Nl(n,e){const t=n;let r,s,o,i,a,u,c,l,h,d;return ue().getNumber("WEBGL_VERSION")===2?(r=t.R32F,s=t.R16F,o=t.RGBA16F,i=t.RGBA32F,a=t.RED,c=4,l=1,h=t.HALF_FLOAT,d=t.FLOAT,u=t.RGBA8):(r=n.RGBA,s=n.RGBA,o=n.RGBA,i=t.RGBA,a=n.RGBA,c=4,l=4,h=e!=null?e.HALF_FLOAT_OES:null,d=n.FLOAT,u=n.RGBA),{internalFormatFloat:r,internalFormatHalfFloat:s,internalFormatPackedHalfFloat:o,internalFormatPackedFloat:i,textureFormatFloat:a,downloadTextureFormat:u,downloadUnpackNumChannels:c,defaultNumChannels:l,textureTypeHalfFloat:h,textureTypeFloat:d}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function De(n,e){const t=e();return ue().getBool("DEBUG")&&oC(n),t}function oC(n){const e=n.getError();if(e!==n.NO_ERROR)throw new Error("WebGL Error: "+cC(n,e))}const iC=596e-10,aC=65504;function uC(n){return!!(ue().getBool("WEBGL_RENDER_FLOAT32_ENABLED")||n===0||iC<Math.abs(n)&&Math.abs(n)<aC)}function cC(n,e){switch(e){case n.NO_ERROR:return"NO_ERROR";case n.INVALID_ENUM:return"INVALID_ENUM";case n.INVALID_VALUE:return"INVALID_VALUE";case n.INVALID_OPERATION:return"INVALID_OPERATION";case n.INVALID_FRAMEBUFFER_OPERATION:return"INVALID_FRAMEBUFFER_OPERATION";case n.OUT_OF_MEMORY:return"OUT_OF_MEMORY";case n.CONTEXT_LOST_WEBGL:return"CONTEXT_LOST_WEBGL";default:return`Unknown error code ${e}`}}function Sa(n,e){return Es(n,()=>n.getExtension(e),'Extension "'+e+'" not supported on this browser.')}function lC(n,e){const t=Es(n,()=>n.createShader(n.VERTEX_SHADER),"Unable to create vertex WebGLShader.");if(De(n,()=>n.shaderSource(t,e)),De(n,()=>n.compileShader(t)),n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw console.log(n.getShaderInfoLog(t)),new Error("Failed to compile vertex shader.");return t}function hC(n,e){const t=Es(n,()=>n.createShader(n.FRAGMENT_SHADER),"Unable to create fragment WebGLShader.");if(De(n,()=>n.shaderSource(t,e)),De(n,()=>n.compileShader(t)),ue().get("ENGINE_COMPILE_ONLY"))return t;if(n.getShaderParameter(t,n.COMPILE_STATUS)===!1)throw Dm(e,n.getShaderInfoLog(t)),new Error("Failed to compile fragment shader.");return t}const fC=/ERROR: [0-9]+:([0-9]+):/g;function Dm(n,e){const t=fC.exec(e);if(t==null){console.log(`Couldn't parse line number in error: ${e}`),console.log(n);return}const r=+t[1],s=n.split(`
`),o=s.length.toString().length+2,i=s.map((h,d)=>si((d+1).toString(),o)+h);let a=0;for(let h=0;h<i.length;h++)a=Math.max(i[h].length,a);const u=i.slice(0,r-1),c=i.slice(r-1,r),l=i.slice(r);console.log(u.join(`
`)),console.log(e.split(`
`)[0]),console.log(`%c ${si(c[0],a)}`,"border:1px solid red; background-color:#e3d2d2; color:#a61717"),console.log(l.join(`
`))}function dC(n){return Es(n,()=>n.createProgram(),"Unable to create WebGLProgram.")}function pC(n,e){if(De(n,()=>n.linkProgram(e)),!ue().get("ENGINE_COMPILE_ONLY")&&n.getProgramParameter(e,n.LINK_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Failed to link vertex and fragment shaders.")}function Fu(n,e){if(De(n,()=>n.validateProgram(e)),n.getProgramParameter(e,n.VALIDATE_STATUS)===!1)throw console.log(n.getProgramInfoLog(e)),new Error("Shader program validation failed.")}function mC(n,e){const t=Es(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return De(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),De(n,()=>n.bufferData(n.ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function gC(n,e){const t=Es(n,()=>n.createBuffer(),"Unable to create WebGLBuffer");return De(n,()=>n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,t)),De(n,()=>n.bufferData(n.ELEMENT_ARRAY_BUFFER,e,n.STATIC_DRAW)),t}function yC(n){return Es(n,()=>n.createTexture(),"Unable to create WebGLTexture.")}function xC(n,e){const t=ue().getNumber("WEBGL_MAX_TEXTURE_SIZE");if(n<=0||e<=0){const r=`[${n}x${e}]`;throw new Error("Requested texture size "+r+" is invalid.")}if(n>t||e>t){const r=`[${n}x${e}]`,s=`[${t}x${t}]`;throw new Error("Requested texture size "+r+" greater than WebGL maximum on this browser / GPU "+s+".")}}function bC(n){return Es(n,()=>n.createFramebuffer(),"Unable to create WebGLFramebuffer.")}function mh(n,e,t,r,s,o,i){const a=n.getAttribLocation(e,t);return a===-1?!1:(De(n,()=>n.bindBuffer(n.ARRAY_BUFFER,r)),De(n,()=>n.vertexAttribPointer(a,s,n.FLOAT,!1,o,i)),De(n,()=>n.enableVertexAttribArray(a)),!0)}function vC(n,e,t){SC(n,t),De(n,()=>n.activeTexture(n.TEXTURE0+t)),De(n,()=>n.bindTexture(n.TEXTURE_2D,e))}function wC(n,e,t){return Es(n,()=>n.getUniformLocation(e,t),'uniform "'+t+'" not present in program.')}function CC(n,e,t){return n.getUniformLocation(e,t)}function TC(n,e,t,r){De(n,()=>vC(n,e,r)),De(n,()=>n.uniform1i(t,r))}function Pu(n,e,t){De(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,t)),De(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,e,0))}function gh(n,e){De(n,()=>n.bindFramebuffer(n.FRAMEBUFFER,e)),De(n,()=>n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,null,0))}function Na(n){const e=n.checkFramebufferStatus(n.FRAMEBUFFER);if(e!==n.FRAMEBUFFER_COMPLETE)throw new Error("Error binding framebuffer: "+$C(n,e))}function $C(n,e){switch(e){case n.FRAMEBUFFER_INCOMPLETE_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT:return"FRAMEBUFFER_INCOMPLETE_MISSING_ATTACHMENT";case n.FRAMEBUFFER_INCOMPLETE_DIMENSIONS:return"FRAMEBUFFER_INCOMPLETE_DIMENSIONS";case n.FRAMEBUFFER_UNSUPPORTED:return"FRAMEBUFFER_UNSUPPORTED";default:return`unknown error ${e}`}}function Es(n,e,t){const r=De(n,()=>e());if(r==null)throw new Error(t);return r}function SC(n,e){const t=n.MAX_COMBINED_TEXTURE_IMAGE_UNITS-1,r=e+n.TEXTURE0;if(r<n.TEXTURE0||r>t){const s=`[gl.TEXTURE0, gl.TEXTURE${t}]`;throw new Error(`textureUnit must be in ${s}.`)}}function mi(n,e=2){return Ce(n.slice(0,n.length-e))}function gi(n){if(n.length===0)throw Error("Cannot get rows and columns of an empty shape array.");return[n.length>1?n[n.length-2]:1,n[n.length-1]]}function Lu(n){let e=[1,1,1];return n.length===0||n.length===1&&n[0]===1||(e=[mi(n),...gi(n)]),e}function NC(n,e=!1){let t=ue().getNumber("WEBGL_MAX_TEXTURE_SIZE"),r=ue().getNumber("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE");r===1/0&&ue().getBool("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE")&&(r=t/2),e&&(t=t*2,r=r*2,n=n.map((a,u)=>u>=n.length-2?jc(n[u]):n[u]),n.length===1&&(n=[2,n[0]])),n.length!==2&&(n=Hs(n).newShape);let s=Ce(n),o=null;n.length<=1&&s<=t?o=[1,s]:n.length===2&&n[0]<=t&&n[1]<=t?o=n:n.length===3&&n[0]*n[1]<=t&&n[2]<=t?o=[n[0]*n[1],n[2]]:n.length===3&&n[0]<=t&&n[1]*n[2]<=t?o=[n[0],n[1]*n[2]]:n.length===4&&n[0]*n[1]*n[2]<=t&&n[3]<=t?o=[n[0]*n[1]*n[2],n[3]]:n.length===4&&n[0]<=t&&n[1]*n[2]*n[3]<=t&&(o=[n[0],n[1]*n[2]*n[3]]);const i=o!=null&&Math.max(...o)>r&&Math.min(...o)<=(e?2:1)&&Math.min(...o)>0;if(o==null||i)if(e){const a=mi(n);let u=2,c=2;n.length&&([u,c]=gi(n)),s=a*(u/2)*(c/2),o=Zu(s).map(l=>l*2)}else o=Zu(s);return o}function Ea(n){return n%2===0}function ja(n,e){if(n=n.slice(-2),e=e.slice(-2),Bt(n,e)||!n.length||!e.length||n[0]===0||n[1]===0||e[0]===0||e[1]===0)return!0;if(n.length!==e.length){const t=n.slice(-1)[0],r=e.slice(-1)[0];if(t===r||Ea(t)&&Ea(r)&&(n[0]===1||e[0]===1))return!0}return n[1]===e[1]&&Ea(n[0])&&Ea(e[0])}let Bu,Mu;function EC(n){if(Bu==null){const e=Br(n);Bu=e.getParameter(e.MAX_TEXTURE_SIZE)}return Bu}function kC(n){if(Mu==null){const e=Br(n);Mu=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS)}return Math.min(16,Mu)}function IC(n){if(n===0)return 0;let e;const t=Br(n);return mr(t,"EXT_disjoint_timer_query_webgl2")&&n===2?e=2:mr(t,"EXT_disjoint_timer_query")?e=1:e=0,e}function mr(n,e){return n.getExtension(e)!=null}function yh(n){try{if(Br(n)!=null)return!0}catch(e){return console.log("Error when getting WebGL context: ",e),!1}return!1}function _C(n){if(n===0)return!1;const e=Br(n);if(n===1){if(!mr(e,"OES_texture_float"))return!1}else if(!mr(e,"EXT_color_buffer_float"))return!1;return Ic(e)}function RC(n){if(n===0)return!1;const e=Br(n);if(n===1){if(!mr(e,"OES_texture_float")||!mr(e,"WEBGL_color_buffer_float"))return!1}else{if(mr(e,"EXT_color_buffer_float"))return Ic(e);const r="EXT_color_buffer_half_float";if(mr(e,r)){const s=e.getExtension(r);return AC(e,s)}return!1}return Ic(e)}function Ic(n){const e=Nl(n),t=n.createTexture();n.bindTexture(n.TEXTURE_2D,t);const r=1,s=1;n.texImage2D(n.TEXTURE_2D,0,e.internalFormatFloat,r,s,0,e.textureFormatFloat,e.textureTypeFloat,null);const o=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,o),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,t,0);const i=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(t),n.deleteFramebuffer(o),i}function AC(n,e){const t=Nl(n,e),r=n.createTexture();n.bindTexture(n.TEXTURE_2D,r);const s=1,o=1;n.texImage2D(n.TEXTURE_2D,0,t.internalFormatHalfFloat,s,o,0,t.textureFormatFloat,t.textureTypeHalfFloat,null);const i=n.createFramebuffer();n.bindFramebuffer(n.FRAMEBUFFER,i),n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0,n.TEXTURE_2D,r,0);const a=n.checkFramebufferStatus(n.FRAMEBUFFER)===n.FRAMEBUFFER_COMPLETE;return n.bindTexture(n.TEXTURE_2D,null),n.bindFramebuffer(n.FRAMEBUFFER,null),n.deleteTexture(r),n.deleteFramebuffer(i),a}function OC(n){return n!==2?!1:Br(n).fenceSync!=null}function ua(n,e){Array.isArray(n)||(n=[n]),n.forEach(t=>{t!=null&&M(t.dtype!=="complex64",()=>`${e} does not support complex64 tensors in the WebGL backend.`)})}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Le=ue();Le.registerFlag("HAS_WEBGL",()=>Le.getNumber("WEBGL_VERSION")>0);Le.registerFlag("WEBGL_VERSION",()=>yh(2)?2:yh(1)?1:0);Le.registerFlag("WEBGL_CHECK_NUMERICAL_PROBLEMS",()=>!1);Le.registerFlag("WEBGL_BUFFER_SUPPORTED",()=>Le.get("WEBGL_VERSION")===2);Le.registerFlag("WEBGL_CPU_FORWARD",()=>!0);Le.registerFlag("WEBGL_FORCE_F16_TEXTURES",()=>!1);Le.registerFlag("WEBGL_PACK",()=>Le.getBool("HAS_WEBGL"));Le.registerFlag("WEBGL_PACK_NORMALIZATION",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_PACK_CLIP",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_PACK_DEPTHWISECONV",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_PACK_BINARY_OPERATIONS",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_PACK_UNARY_OPERATIONS",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_PACK_ARRAY_OPERATIONS",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_PACK_IMAGE_OPERATIONS",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_PACK_REDUCE",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_LAZILY_UNPACK",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_CONV_IM2COL",()=>Le.getBool("WEBGL_PACK"));Le.registerFlag("WEBGL_MAX_TEXTURE_SIZE",()=>EC(Le.getNumber("WEBGL_VERSION")));Le.registerFlag("WEBGL_MAX_TEXTURES_IN_SHADER",()=>kC(Le.getNumber("WEBGL_VERSION")));Le.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION",()=>{const n=Le.getNumber("WEBGL_VERSION");return n===0?0:IC(n)});Le.registerFlag("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE",()=>Le.getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0&&!g1());Le.registerFlag("WEBGL_RENDER_FLOAT32_CAPABLE",()=>_C(Le.getNumber("WEBGL_VERSION")));Le.registerFlag("WEBGL_RENDER_FLOAT32_ENABLED",()=>Le.getBool("WEBGL_FORCE_F16_TEXTURES")?!1:Le.getBool("WEBGL_RENDER_FLOAT32_CAPABLE"));Le.registerFlag("WEBGL_DOWNLOAD_FLOAT_ENABLED",()=>RC(Le.getNumber("WEBGL_VERSION")));Le.registerFlag("WEBGL_FENCE_API_ENABLED",()=>OC(Le.getNumber("WEBGL_VERSION")));Le.registerFlag("WEBGL_SIZE_UPLOAD_UNIFORM",()=>Le.getBool("WEBGL_RENDER_FLOAT32_ENABLED")?4:0);Le.registerFlag("WEBGL_DELETE_TEXTURE_THRESHOLD",()=>-1,n=>{if(n<0&&n!==-1)throw new Error(`WEBGL_DELETE_TEXTURE_THRESHOLD must be -1 (indicating never delete) or at least 0, but got ${n}.`)});Le.registerFlag("WEBGL_FLUSH_THRESHOLD",()=>g1()?1:-1,n=>{if(n<0&&n!==-1)throw new Error(`WEBGL_FLUSH_THRESHOLD must be -1 (indicating never manual flush) or at least 0, but got ${n}.`)});Le.registerFlag("CPU_HANDOFF_SIZE_THRESHOLD",()=>128);Le.registerFlag("WEBGL_USE_SHAPES_UNIFORMS",()=>!1);Le.registerFlag("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD",()=>1e5);Le.registerFlag("TOPK_K_CPU_HANDOFF_THRESHOLD",()=>128);Le.registerFlag("WEBGL_EXP_CONV",()=>!1);Le.registerFlag("SOFTWARE_WEBGL_ENABLED",()=>Le.getBool("IS_TEST"));Le.registerFlag("WEBGL_MAX_SIZE_FOR_NARROW_TEXTURE",()=>1/0);Le.registerFlag("WEBGL_AUTO_SQUARIFY_NARROW_TEXTURE_SHAPE",()=>!1);Le.registerFlag("WEBGL2_ISNAN_CUSTOM",()=>!1);/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Sn(){let n,e,t,r,s,o,i,a,u,c;return ue().getNumber("WEBGL_VERSION")===2?(n="#version 300 es",e="in",t="out",r="in",s="texture",o="outputColor",i="out vec4 outputColor;",a=ue().getBool("WEBGL2_ISNAN_CUSTOM")?`
      bool isnan_custom(float val) {
        uint floatToUint = floatBitsToUint(val);
        return (floatToUint & 0x7fffffffu) > 0x7f800000u;
      }

      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan_custom(val.x),
          isnan_custom(val.y), isnan_custom(val.z), isnan_custom(val.w));
      }

      #define isnan(value) isnan_custom(value)
    `:"",u="",c=`
      #define round(value) newRound(value)
      int newRound(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 newRound(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `):(n="",e="attribute",t="varying",r="varying",s="texture2D",o="gl_FragColor",i="",a=`
      #define isnan(value) isnan_custom(value)
      bool isnan_custom(float val) {
        return (val > 0. || val < 1. || val == 0.) ? false : true;
      }
      bvec4 isnan_custom(vec4 val) {
        return bvec4(isnan(val.x), isnan(val.y), isnan(val.z), isnan(val.w));
      }
    `,u=`
      uniform float INFINITY;

      bool isinf(float val) {
        return abs(val) == INFINITY;
      }
      bvec4 isinf(vec4 val) {
        return equal(abs(val), vec4(INFINITY));
      }
    `,c=`
      int round(float value) {
        return int(floor(value + 0.5));
      }

      ivec4 round(vec4 value) {
        return ivec4(floor(value + vec4(0.5)));
      }
    `),{version:n,attribute:e,varyingVs:t,varyingFs:r,texture2D:s,output:o,defineOutput:i,defineSpecialNaN:a,defineSpecialInf:u,defineRound:c}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Lo(n,e,t="index"){const r=rn(e);return r.map((s,o)=>{const i=`int ${n[o]} = ${t} / ${s}`,a=o===r.length-1?`int ${n[o+1]} = ${t} - ${n[o]} * ${s}`:`index -= ${n[o]} * ${s}`;return`${i}; ${a};`}).join("")}function gu(n,e,t="index"){const r=rn(e);return r.map((s,o)=>{const i=`int ${n[o]} = ${t} / outShapeStrides[${o}]`,a=o===r.length-1?`int ${n[o+1]} = ${t} - ${n[o]} * outShapeStrides[${o}]`:`index -= ${n[o]} * outShapeStrides[${o}]`;return`${i}; ${a};`}).join("")}function DC(n,e){const t=n.length,r=n.map(o=>`${e}[${o}]`),s=new Array(t-1);s[t-2]=r[t-1];for(let o=t-3;o>=0;--o)s[o]=`(${s[o+1]} * ${r[o+1]})`;return s}function FC(n,e,t="index"){const r=n.map((o,i)=>i),s=DC(r,e);return s.map((o,i)=>{const a=`int ${n[i]} = ${t} / ${s[i]}`,u=i===s.length-1?`int ${n[i+1]} = ${t} - ${n[i]} * ${s[i]}`:`index -= ${n[i]} * ${s[i]}`;return`${a}; ${u};`}).join("")}function El(n){const e=rn(n).map(t=>t.toString());return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * ${e[0]} + coords.y * ${e[1]} + coords.z;
  }
`}function kl(){return`
  int getFlatIndex(ivec3 coords) {
    return coords.x * outShapeStrides[0] + coords.y * outShapeStrides[1] + coords.z;
  }
`}const Fm=`
  const float FLOAT_MAX = 1.70141184e38;
  const float FLOAT_MIN = 1.17549435e-38;

  lowp vec4 encode_float(highp float v) {
    if (isnan(v)) {
      return vec4(255, 255, 255, 255);
    }

    highp float av = abs(v);

    if(av < FLOAT_MIN) {
      return vec4(0.0, 0.0, 0.0, 0.0);
    } else if(v > FLOAT_MAX) {
      return vec4(0.0, 0.0, 128.0, 127.0) / 255.0;
    } else if(v < -FLOAT_MAX) {
      return vec4(0.0, 0.0,  128.0, 255.0) / 255.0;
    }

    highp vec4 c = vec4(0,0,0,0);

    highp float e = floor(log2(av));
    highp float m = exp2(fract(log2(av))) - 1.0;

    c[2] = floor(128.0 * m);
    m -= c[2] / 128.0;
    c[1] = floor(32768.0 * m);
    m -= c[1] / 32768.0;
    c[0] = floor(8388608.0 * m);

    highp float ebias = e + 127.0;
    c[3] = floor(ebias / 2.0);
    ebias -= c[3] * 2.0;
    c[2] += floor(ebias) * 128.0;

    c[3] += 128.0 * step(0.0, -v);

    return c / 255.0;
  }
`;/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{getBroadcastDims:Pm}=J5;function PC(n,e,t){const r=[];if(n.forEach(m=>{const g=Ce(m.shapeInfo.logicalShape);if(m.shapeInfo.isUniform?r.push(`uniform float ${m.name}${g>1?`[${g}]`:""};`):(r.push(`uniform sampler2D ${m.name};`),r.push(`uniform int offset${m.name};`)),t.enableShapeUniforms){const{uniformShape:C}=Il(t.packedInputs,m.shapeInfo.logicalShape,m.shapeInfo.texShape);switch(C.length){case 1:r.push(`uniform int ${m.name}Shape;`);break;case 2:r.push(`uniform ivec2 ${m.name}Shape;`);break;case 3:r.push(`uniform ivec3 ${m.name}Shape;`);break;case 4:r.push(`uniform ivec4 ${m.name}Shape;`);break}r.push(`uniform ivec2 ${m.name}TexShape;`)}}),t.enableShapeUniforms){switch(e.logicalShape.length){case 1:r.push("uniform int outShape;");break;case 2:r.push("uniform ivec2 outShape;"),r.push("uniform int outShapeStrides;");break;case 3:r.push("uniform ivec3 outShape;"),r.push("uniform ivec2 outShapeStrides;");break;case 4:r.push("uniform ivec4 outShape;"),r.push("uniform ivec3 outShapeStrides;");break}r.push("uniform ivec2 outTexShape;")}t.customUniforms&&t.customUniforms.forEach(m=>{r.push(`uniform ${m.type} ${m.name}${m.arrayIndex?`[${m.arrayIndex}]`:""};`)});const s=r.join(`
`),o=n.map(m=>LC(m,e,t.packedInputs,t.enableShapeUniforms)).join(`
`),i=e.texShape,a=Sn(),u=VC(a);let c,l,h=zC(a);return e.isPacked?(c=BC(e.logicalShape,i,t.enableShapeUniforms),l=WC(a)):(c=MC(e.logicalShape,i,t.enableShapeUniforms),l=UC(a)),t.packedInputs&&(h+=qC),[h,u,l,s,c,o,t.userCode].join(`
`)}function Si(n,e=!1){const t=n.shapeInfo.logicalShape;switch(t.length){case 0:return oT(n,e);case 1:return aT(n,e);case 2:return cT(n,e);case 3:return hT(n,e);case 4:return dT(n,e);case 5:return pT(n);case 6:return mT(n);default:throw new Error(`${t.length}-D input sampling is not yet supported`)}}function Lm(n,e){switch(n.shapeInfo.logicalShape.length){case 0:return sT(n);case 1:return iT(n,e);case 2:return uT(n,e);case 3:return lT(n,e);default:return fT(n,e)}}function LC(n,e,t=!1,r){let s="";t?s+=Lm(n,r):s+=Si(n,r);const o=n.shapeInfo.logicalShape,i=e.logicalShape;return o.length<=i.length&&(t?s+=gT(n,e):s+=yT(n,e)),s}function BC(n,e,t){switch(n.length){case 0:return Bm();case 1:return XC(n,e,t);case 2:return nT(n,e,t);case 3:return YC(n,e,t);default:return ZC(n,e,t)}}function MC(n,e,t){switch(n.length){case 0:return Bm();case 1:return KC(n,e,t);case 2:return rT(n,e,t);case 3:return QC(n,e,t);case 4:return JC(n,e,t);case 5:return eT(n,e);case 6:return tT(n,e);default:throw new Error(`${n.length}-D output sampling is not yet supported`)}}function VC(n){return`
    float sampleTexture(sampler2D textureSampler, vec2 uv) {
      return ${n.texture2D}(textureSampler, uv).r;
    }
  `}function UC(n){return`
    void setOutput(float val) {
      ${n.output} = vec4(val, 0, 0, 0);
    }
  `}function WC(n){return`
    void setOutput(vec4 val) {
      ${n.output} = val;
    }
  `}function zC(n){return`${n.version}
    precision highp float;
    precision highp int;
    precision highp sampler2D;
    ${n.varyingFs} vec2 resultUV;
    ${n.defineOutput}
    const vec2 halfCR = vec2(0.5, 0.5);

    struct ivec5
    {
      int x;
      int y;
      int z;
      int w;
      int u;
    };

    struct ivec6
    {
      int x;
      int y;
      int z;
      int w;
      int u;
      int v;
    };

    uniform float NAN;
    ${n.defineSpecialNaN}
    ${n.defineSpecialInf}
    ${n.defineRound}

    int imod(int x, int y) {
      return x - y * (x / y);
    }

    int idiv(int a, int b, float sign) {
      int res = a / b;
      int mod = imod(a, b);
      if (sign < 0. && mod != 0) {
        res -= 1;
      }
      return res;
    }

    //Based on the work of Dave Hoskins
    //https://www.shadertoy.com/view/4djSRW
    #define HASHSCALE1 443.8975
    float random(float seed){
      vec2 p = resultUV * seed;
      vec3 p3  = fract(vec3(p.xyx) * HASHSCALE1);
      p3 += dot(p3, p3.yzx + 19.19);
      return fract((p3.x + p3.y) * p3.z);
    }

    ${GC}
    ${jC}
    ${HC}
  `}const GC=`
vec2 uvFromFlat(int texNumR, int texNumC, int index) {
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
vec2 packedUVfrom1D(int texNumR, int texNumC, int index) {
  int texelIndex = index / 2;
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,jC=`
vec2 packedUVfrom2D(int texelsInLogicalRow, int texNumR,
  int texNumC, int row, int col) {
  int texelIndex = (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = texelIndex / texNumC;
  int texC = texelIndex - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,HC=`
vec2 packedUVfrom3D(int texNumR, int texNumC,
    int texelsInBatch, int texelsInLogicalRow, int b,
    int row, int col) {
  int index = b * texelsInBatch + (row / 2) * texelsInLogicalRow + (col / 2);
  int texR = index / texNumC;
  int texC = index - texR * texNumC;
  return (vec2(texC, texR) + halfCR) / vec2(texNumC, texNumR);
}
`,qC=`
  float getChannel(vec4 frag, vec2 innerDims) {
    vec2 modCoord = mod(innerDims, 2.);
    return modCoord.x == 0. ?
      (modCoord.y == 0. ? frag.r : frag.g) :
      (modCoord.y == 0. ? frag.b : frag.a);
  }
  float getChannel(vec4 frag, int dim) {
    float modCoord = mod(float(dim), 2.);
    return modCoord == 0. ? frag.r : frag.g;
  }
`;function Bm(){return`
    int getOutputCoords() {
      return 0;
    }
  `}function XC(n,e,t){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];return r[0]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ceil(float(outTexShape[1]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.x * ${r[1]}.0);
      }
    `:r[1]===1?t?`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ceil(float(outTexShape[0]) / 2.0));
      }
    `:`
      int getOutputCoords() {
        return 2 * int(resultUV.y * ${r[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      return 2 * (resTexRC.x * packedTexShape[1] + resTexRC.y);
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      return 2 * (resTexRC.x * ${r[1]} + resTexRC.y);
    }
  `}function KC(n,e,t){return e[0]===1?t?`
      int getOutputCoords() {
        return int(resultUV.x * float(outTexShape[1]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.x * ${e[1]}.0);
      }
    `:e[1]===1?t?`
      int getOutputCoords() {
        return int(resultUV.y * float(outTexShape[0]));
      }
    `:`
      int getOutputCoords() {
        return int(resultUV.y * ${e[0]}.0);
      }
    `:t?`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      return resTexRC.x * outTexShape[1] + resTexRC.y;
    }
  `:`
    int getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      return resTexRC.x * ${e[1]} + resTexRC.y;
    }
  `}function YC(n,e,t){if(t)return`
    ivec3 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec3(b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(n[2]/2),o=s*Math.ceil(n[1]/2);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec3(b, r, c);
    }
  `}function QC(n,e,t){if(t)return`
  ivec3 getOutputCoords() {
    ivec2 resTexRC = ivec2(resultUV.yx *
                           vec2(outTexShape[0], outTexShape[1]));
    int index = resTexRC.x * outTexShape[1] + resTexRC.y;
    ${gu(["r","c","d"],n)}
    return ivec3(r, c, d);
  }
`;const r=Lo(["r","c","d"],n);return`
    ivec3 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec3(r, c, d);
    }
  `}function ZC(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));
      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;

      int texelsInLogicalRow = int(ceil(float(outShape[3]) / 2.0));
      int texelsInBatch = texelsInLogicalRow * int(ceil(float(outShape[2]) / 2.0));
      int texelsInBatchN = texelsInBatch * outShape[1];

      int b2 = index / texelsInBatchN;
      index -= b2 * texelsInBatchN;

      int b = index / texelsInBatch;
      index -= b * texelsInBatch;

      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec4(b2, b, r, c);
    }
  `;const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)],s=Math.ceil(n[n.length-1]/2),o=s*Math.ceil(n[n.length-2]/2);let i=o,a="",u="b, r, c";for(let c=2;c<n.length-1;c++)i*=n[n.length-c-1],a=`
      int b${c} = index / ${i};
      index -= b${c} * ${i};
    `+a,u=`b${c}, `+u;return`
    ivec${n.length} getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));
      int index = resTexRC.x * ${r[1]} + resTexRC.y;

      ${a}

      int b = index / ${o};
      index -= b * ${o};

      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec${n.length}(${u});
    }
  `}function JC(n,e,t){if(t)return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      ${gu(["r","c","d","d2"],n)}
      return ivec4(r, c, d, d2);
    }
  `;const r=Lo(["r","c","d","d2"],n);return`
    ivec4 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      ${r}
      return ivec4(r, c, d, d2);
    }
  `}function eT(n,e){const t=Lo(["r","c","d","d2","d3"],n);return`
    ivec5 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx * vec2(${e[0]},
                             ${e[1]}));

      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec5 outShape = ivec5(r, c, d, d2, d3);
      return outShape;
    }
  `}function tT(n,e){const t=Lo(["r","c","d","d2","d3","d4"],n);return`
    ivec6 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
        vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;

      ${t}

      ivec6 result = ivec6(r, c, d, d2, d3, d4);
      return result;
    }
  `}function nT(n,e,t){const r=[Math.ceil(e[0]/2),Math.ceil(e[1]/2)];if(Bt(n,e))return t?`
      ivec2 getOutputCoords() {
        ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
        return 2 * ivec2(resultUV.yx * vec2(packedTexShape[0], packedTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return 2 * ivec2(resultUV.yx * vec2(${r[0]}, ${r[1]}));
      }
    `;const s=Math.ceil(n[1]/2);return t?`
    ivec2 getOutputCoords() {
      ivec2 packedTexShape = ivec2(ceil(float(outTexShape[0]) / 2.0), ceil(float(outTexShape[1]) / 2.0));
      int texelsInLogicalRow = int(ceil(float(outShape[1]) / 2.0));
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(packedTexShape[0], packedTexShape[1]));

      int index = resTexRC.x * packedTexShape[1] + resTexRC.y;
      int r = 2 * (index / texelsInLogicalRow);
      int c = imod(index, texelsInLogicalRow) * 2;

      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${r[0]}, ${r[1]}));

      int index = resTexRC.x * ${r[1]} + resTexRC.y;
      int r = 2 * (index / ${s});
      int c = imod(index, ${s}) * 2;

      return ivec2(r, c);
    }
  `}function rT(n,e,t){return Bt(n,e)?t?`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(outTexShape[0], outTexShape[1]));
      }
    `:`
      ivec2 getOutputCoords() {
        return ivec2(resultUV.yx * vec2(${e[0]}, ${e[1]}));
      }
    `:n[1]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(index, 0);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(index, 0);
      }
    `:n[0]===1?t?`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(outTexShape[0], outTexShape[1]));
        int index = resTexRC.x * outTexShape[1] + resTexRC.y;
        return ivec2(0, index);
      }
    `:`
      ivec2 getOutputCoords() {
        ivec2 resTexRC = ivec2(resultUV.yx *
                               vec2(${e[0]}, ${e[1]}));
        int index = resTexRC.x * ${e[1]} + resTexRC.y;
        return ivec2(0, index);
      }
    `:t?`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(outTexShape[0], outTexShape[1]));
      int index = resTexRC.x * outTexShape[1] + resTexRC.y;
      int r = index / outShape[1];
      int c = index - r * outShape[1];
      return ivec2(r, c);
    }
  `:`
    ivec2 getOutputCoords() {
      ivec2 resTexRC = ivec2(resultUV.yx *
                             vec2(${e[0]}, ${e[1]}));
      int index = resTexRC.x * ${e[1]} + resTexRC.y;
      int r = index / ${n[1]};
      int c = index - r * ${n[1]};
      return ivec2(r, c);
    }
  `}function Bo(n){return`offset${n}`}function sT(n){const e=n.name,t="get"+e.charAt(0).toUpperCase()+e.slice(1),r=Sn();return`
    vec4 ${t}() {
      return ${r.texture2D}(${e}, halfCR);
    }
  `}function oT(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`float ${r}() {return ${t};}`;const[s,o]=n.shapeInfo.texShape;if(s===1&&o===1)return`
      float ${r}() {
        return sampleTexture(${t}, halfCR);
      }
    `;const i=Bo(t);if(e)return`
    float ${r}() {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], ${i});
      return sampleTexture(${t}, uv);
    }
  `;const[a,u]=n.shapeInfo.texShape;return`
    float ${r}() {
      vec2 uv = uvFromFlat(${a}, ${u}, ${i});
      return sampleTexture(${t}, uv);
    }
  `}function iT(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),s=n.shapeInfo.texShape,o=Sn();if(e)return`
    vec4 ${r}(int index) {
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      vec2 uv = packedUVfrom1D(
        packedTexShape[0], packedTexShape[1], index);
      return ${o.texture2D}(${t}, uv);
    }
  `;const i=[Math.ceil(s[0]/2),Math.ceil(s[1]/2)];return`
    vec4 ${r}(int index) {
      vec2 uv = packedUVfrom1D(
        ${i[0]}, ${i[1]}, index);
      return ${o.texture2D}(${t}, uv);
    }
  `}function aT(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1);if(n.shapeInfo.isUniform)return`
      float ${r}(int index) {
        ${Ni(n)}
      }
    `;const s=n.shapeInfo.texShape,o=s[0],i=s[1];if(i===1&&o===1)return`
      float ${r}(int index) {
        return sampleTexture(${t}, halfCR);
      }
    `;const a=Bo(t);return i===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / float(${t}TexShape[0]));
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2(0.5, (float(index + ${a}) + 0.5) / ${o}.0);
        return sampleTexture(${t}, uv);
      }
    `:o===1?e?`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / float(${t}TexShape[1]), 0.5);
        return sampleTexture(${t}, uv);
      }
    `:`
      float ${r}(int index) {
        vec2 uv = vec2((float(index + ${a}) + 0.5) / ${i}.0, 0.5);
        return sampleTexture(${t}, uv);
      }
    `:e?`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${t}TexShape[0], ${t}TexShape[1], index + ${a});
      return sampleTexture(${t}, uv);
    }
  `:`
    float ${r}(int index) {
      vec2 uv = uvFromFlat(${o}, ${i}, index + ${a});
      return sampleTexture(${t}, uv);
    }
  `}function uT(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n.shapeInfo.texShape,i=o[0],a=o[1],u=Sn();if(o!=null&&Bt(t,o))return e?`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);

        return ${u.texture2D}(${r}, uv);
      }
    `:`
      vec4 ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${a}.0, ${i}.0);

        return ${u.texture2D}(${r}, uv);
      }
    `;if(e)return`
    vec4 ${s}(int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom2D(valuesPerRow, packedTexShape[0], packedTexShape[1], row, col);
      return ${u.texture2D}(${r}, uv);
    }
  `;const c=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)],l=Math.ceil(t[1]/2);return`
    vec4 ${s}(int row, int col) {
      vec2 uv = packedUVfrom2D(${l}, ${c[0]}, ${c[1]}, row, col);
      return ${u.texture2D}(${r}, uv);
    }
  `}function cT(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n.shapeInfo.texShape;if(o!=null&&Bt(t,o)){if(e)return`
      float ${s}(int row, int col) {
        vec2 uv = (vec2(col, row) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `;const d=o[0],m=o[1];return`
    float ${s}(int row, int col) {
      vec2 uv = (vec2(col, row) + halfCR) / vec2(${m}.0, ${d}.0);
      return sampleTexture(${r}, uv);
    }
  `}const{newShape:i,keptDims:a}=Hs(t),u=i;if(u.length<t.length){const d=Ei(n,u),m=["row","col"];return`
      ${Si(d,e)}
      float ${s}(int row, int col) {
        return ${s}(${ki(m,a)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col) {
        int index = round(dot(vec2(row, col), vec2(${t[1]}, 1)));
        ${Ni(n)}
      }
    `;const c=o[0],l=o[1],h=Bo(r);return l===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2(0.5, (index + 0.5) / float(${r}TexShape[0]));
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2(0.5, (index + 0.5) / ${c}.0);
      return sampleTexture(${r}, uv);
    }
  `:c===1?e?`
      float ${s}(int row, int col) {
        float index = dot(vec3(row, col, ${h}), vec3(${r}Shape[1], 1, 1));
        vec2 uv = vec2((index + 0.5) / float(${r}TexShape[1]), 0.5);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col) {
      float index = dot(vec3(row, col, ${h}), vec3(${t[1]}, 1, 1));
      vec2 uv = vec2((index + 0.5) / ${l}.0, 0.5);
      return sampleTexture(${r}, uv);
    }
  `:e?`
      float ${s}(int row, int col) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${r}Shape[1] + col + ${h};
        vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
        return sampleTexture(${r}, uv);
      }
    `:`
  float ${s}(int row, int col) {
    // Explicitly use integer operations as dot() only works on floats.
    int index = row * ${t[1]} + col + ${h};
    vec2 uv = uvFromFlat(${c}, ${l}, index);
    return sampleTexture(${r}, uv);
  }
`}function lT(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=n.shapeInfo.texShape,i=[Math.ceil(o[0]/2),Math.ceil(o[1]/2)];if(t[0]===1){const d=t.slice(1),m=[1,2],g=Ei(n,d),C=["b","row","col"];return`
        ${Lm(g,e)}
        vec4 ${s}(int b, int row, int col) {
          return ${s}(${ki(C,m)});
        }
      `}const a=Sn();if(e)return`
    vec4 ${s}(int b, int row, int col) {
      ivec2 packedTexShape = ivec2(ceil(float(${r}TexShape[0]) / 2.0), ceil(float(${r}TexShape[1]) / 2.0));
      int valuesPerRow = int(ceil(float(${r}Shape[2]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${r}Shape[1]) / 2.0));
      vec2 uv = packedUVfrom3D(
        packedTexShape[0], packedTexShape[1], texelsInBatch, valuesPerRow, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `;const u=i[0],c=i[1],l=Math.ceil(t[2]/2),h=l*Math.ceil(t[1]/2);return`
    vec4 ${s}(int b, int row, int col) {
      vec2 uv = packedUVfrom3D(
        ${u}, ${c}, ${h}, ${l}, b, row, col);
      return ${a.texture2D}(${r}, uv);
    }
  `}function hT(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t[1]*t[2],i=t[2],{newShape:a,keptDims:u}=Hs(t),c=a;if(c.length<t.length){const C=Ei(n,c),$=["row","col","depth"];return`
        ${Si(C,e)}
        float ${s}(int row, int col, int depth) {
          return ${s}(${ki($,u)});
        }
      `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth) {
        int index = round(dot(vec3(row, col, depth),
                          vec3(${o}, ${i}, 1)));
        ${Ni(n)}
      }
    `;const l=n.shapeInfo.texShape,h=l[0],d=l[1],m=n.shapeInfo.flatOffset;if(d===o&&m==null)return e?`
      float ${s}(int row, int col, int depth) {
        int stride1 = ${r}Shape[2];
        float texR = float(row);
        float texC = dot(vec2(col, depth), vec2(stride1, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
        float ${s}(int row, int col, int depth) {
          float texR = float(row);
          float texC = dot(vec2(col, depth), vec2(${i}, 1));
          vec2 uv = (vec2(texC, texR) + halfCR) /
                     vec2(${d}.0, ${h}.0);
          return sampleTexture(${r}, uv);
        }
      `;if(d===i&&m==null)return e?`
      float ${s}(int row, int col, int depth) {
        float texR = dot(vec2(row, col), vec2(${r}Shape[1], 1));
        float texC = float(depth);
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
    float ${s}(int row, int col, int depth) {
      float texR = dot(vec2(row, col), vec2(${t[1]}, 1));
      float texC = float(depth);
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${d}.0, ${h}.0);
      return sampleTexture(${r}, uv);
    }
  `;const g=Bo(r);return e?`
    float ${s}(int row, int col, int depth) {
      // Explicitly use integer operations as dot() only works on floats.
      int stride0 = ${r}Shape[1] * ${r}Shape[2];
      int stride1 = ${r}Shape[2];
      int index = row * stride0 + col * stride1 + depth + ${g};
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index);
      return sampleTexture(${r}, uv);
    }
    `:`
      float ${s}(int row, int col, int depth) {
        // Explicitly use integer operations as dot() only works on floats.
        int index = row * ${o} + col * ${i} + depth + ${g};
        vec2 uv = uvFromFlat(${h}, ${d}, index);
        return sampleTexture(${r}, uv);
      }
  `}function fT(n,e){const t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),s=Sn();if(e)return`
    vec4 ${r}(int b2, int b, int row, int col) {
      int valuesPerRow = int(ceil(float(${t}Shape[3]) / 2.0));
      int texelsInBatch = valuesPerRow * int(ceil(float(${t}Shape[2]) / 2.0));
      int index = b * texelsInBatch + (row / 2) * valuesPerRow + (col / 2);
      texelsInBatch *= ${t}Shape[1];
      index = b2 * texelsInBatch + index;
      ivec2 packedTexShape = ivec2(ceil(float(${t}TexShape[0]) / 2.0), ceil(float(${t}TexShape[1]) / 2.0));
      int texR = index / packedTexShape[1];
      int texC = index - texR * packedTexShape[1];
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(packedTexShape[1], packedTexShape[0]); return ${s.texture2D}(${t}, uv);
    }
  `;const o=n.shapeInfo.logicalShape,i=o.length,a=n.shapeInfo.texShape,u=[Math.ceil(a[0]/2),Math.ceil(a[1]/2)],c=u[0],l=u[1],h=Math.ceil(o[i-1]/2);let d=h*Math.ceil(o[i-2]/2),m="int b, int row, int col",g=`b * ${d} + (row / 2) * ${h} + (col / 2)`;for(let C=2;C<i-1;C++)m=`int b${C}, `+m,d*=o[i-C-1],g=`b${C} * ${d} + `+g;return`
    vec4 ${r}(${m}) {
      int index = ${g};
      int texR = index / ${l};
      int texC = index - texR * ${l};
      vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${l}, ${c});
      return ${s.texture2D}(${t}, uv);
    }
  `}function dT(n,e){const t=n.shapeInfo.logicalShape,r=n.name,s="get"+r.charAt(0).toUpperCase()+r.slice(1),o=t[3],i=t[2]*o,a=t[1]*i,{newShape:u,keptDims:c}=Hs(t);if(u.length<t.length){const A=Ei(n,u),P=["row","col","depth","depth2"];return`
      ${Si(A,e)}
      float ${s}(int row, int col, int depth, int depth2) {
        return ${s}(${ki(P,c)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${s}(int row, int col, int depth, int depth2) {
        int index = round(dot(vec4(row, col, depth, depth2),
                          vec4(${a}, ${i}, ${o}, 1)));
        ${Ni(n)}
      }
    `;const l=n.shapeInfo.flatOffset,h=n.shapeInfo.texShape,d=h[0],m=h[1],g=`int stride2 = ${r}Shape[3];`,C=`int stride1 = ${r}Shape[2] * stride2;`,$=`int stride0 = ${r}Shape[1] * stride1;`;if(m===a&&l==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        ${g}
        ${C}
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(stride1, stride2, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = float(row);
        float texC =
            dot(vec3(col, depth, depth2),
                vec3(${i}, ${o}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${m}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;if(m===o&&l==null)return e?`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${r}Shape[1] * ${r}Shape[2], ${r}Shape[2], 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${r}TexShape[1], ${r}TexShape[0]);
        return sampleTexture(${r}, uv);
      }
    `:`
      float ${s}(int row, int col, int depth, int depth2) {
        float texR = dot(vec3(row, col, depth),
                         vec3(${t[1]*t[2]}, ${t[2]}, 1));
        float texC = float(depth2);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${m}.0, ${d}.0);
        return sampleTexture(${r}, uv);
      }
    `;const T=Bo(r);return e?`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      ${g}
      ${C}
      ${$}
      int index = row * stride0 + col * stride1 +
          depth * stride2 + depth2;
      vec2 uv = uvFromFlat(${r}TexShape[0], ${r}TexShape[1], index + ${T});
      return sampleTexture(${r}, uv);
    }
  `:`
    float ${s}(int row, int col, int depth, int depth2) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} +
          depth * ${o} + depth2;
      vec2 uv = uvFromFlat(${d}, ${m}, index + ${T});
      return sampleTexture(${r}, uv);
    }
  `}function pT(n){const e=n.shapeInfo.logicalShape,t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),s=e[4],o=e[3]*s,i=e[2]*o,a=e[1]*i,{newShape:u,keptDims:c}=Hs(e);if(u.length<e.length){const C=Ei(n,u),$=["row","col","depth","depth2","depth3"];return`
      ${Si(C)}
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        return ${r}(${ki($,c)});
      }
    `}if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float index = dot(
          vec4(row, col, depth, depth2),
          vec4(${a}, ${i}, ${o}, ${s})) +
          depth3;
        ${Ni(n)}
      }
    `;const l=n.shapeInfo.flatOffset,h=n.shapeInfo.texShape,d=h[0],m=h[1];if(m===a&&l==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
                         vec4(${i}, ${o}, ${s}, 1));
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${m}.0, ${d}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(m===s&&l==null)return`
      float ${r}(int row, int col, int depth, int depth2, int depth3) {
        float texR = dot(
          vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]},
               ${e[2]*e[3]}, ${e[3]}, 1));
        int texC = depth3;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${m}.0, ${d}.0);
        return sampleTexture(${t}, uv);
      }
    `;const g=Bo(t);return`
    float ${r}(int row, int col, int depth, int depth2, int depth3) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${a} + col * ${i} + depth * ${o} +
          depth2 * ${s} + depth3 + ${g};
      vec2 uv = uvFromFlat(${d}, ${m}, index);
      return sampleTexture(${t}, uv);
    }
  `}function mT(n){const e=n.shapeInfo.logicalShape,t=n.name,r="get"+t.charAt(0).toUpperCase()+t.slice(1),{newShape:s,keptDims:o}=Hs(e);if(s.length<e.length){const $=Ei(n,s),T=["row","col","depth","depth2","depth3","depth4"];return`
      ${Si($)}
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        return ${r}(${ki(T,o)});
      }
    `}const i=e[5],a=e[4]*i,u=e[3]*a,c=e[2]*u,l=e[1]*c;if(n.shapeInfo.isUniform)return`
      float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
        int index = round(dot(
          vec4(row, col, depth, depth2),
          vec4(${l}, ${c}, ${u}, ${a})) +
          dot(
            vec2(depth3, depth4),
            vec2(${i}, 1)));
        ${Ni(n)}
      }
    `;const h=n.shapeInfo.flatOffset,d=n.shapeInfo.texShape,m=d[0],g=d[1];if(g===l&&h==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        int texR = row;
        float texC = dot(vec4(col, depth, depth2, depth3),
          vec4(${c}, ${u}, ${a}, ${i})) +
               float(depth4);
        vec2 uv = (vec2(texC, texR) + halfCR) /
                   vec2(${g}.0, ${m}.0);
        return sampleTexture(${t}, uv);
      }
    `;if(g===i&&h==null)return`
      float ${r}(int row, int col, int depth,
                    int depth2, int depth3, int depth4) {
        float texR = dot(vec4(row, col, depth, depth2),
          vec4(${e[1]*e[2]*e[3]*e[4]},
               ${e[2]*e[3]*e[4]},
               ${e[3]*e[4]},
               ${e[4]})) + float(depth3);
        int texC = depth4;
        vec2 uv = (vec2(texC, texR) + halfCR) /
                  vec2(${g}.0, ${m}.0);
        return sampleTexture(${t}, uv);
      }
    `;const C=Bo(t);return`
    float ${r}(int row, int col, int depth,
                  int depth2, int depth3, int depth4) {
      // Explicitly use integer operations as dot() only works on floats.
      int index = row * ${l} + col * ${c} + depth * ${u} +
          depth2 * ${a} + depth3 * ${i} + depth4 + ${C};
      vec2 uv = uvFromFlat(${m}, ${g}, index);
      return sampleTexture(${t}, uv);
    }
  `}function Ni(n){const e=n.name,t=Ce(n.shapeInfo.logicalShape);return t<2?`return ${e};`:`
    for (int i = 0; i < ${t}; i++) {
      if (i == index) {
        return ${e}[i];
      }
    }
  `}function gT(n,e){const t=n.name,r=t.charAt(0).toUpperCase()+t.slice(1),s="get"+r+"AtOutCoords",o=n.shapeInfo.logicalShape.length,i=e.logicalShape.length,a=Pm(n.shapeInfo.logicalShape,e.logicalShape),u=Tt(i),c=i-o;let l;const h=["x","y","z","w","u","v"];o===0?l="":i<2&&a.length>=1?l="coords = 0;":l=a.map(A=>`coords.${h[A+c]} = 0;`).join(`
`);let d="";i<2&&o>0?d="coords":d=n.shapeInfo.logicalShape.map((A,P)=>`coords.${h[P+c]}`).join(", ");let m="return outputValue;";const C=Ce(n.shapeInfo.logicalShape)===1,T=Ce(e.logicalShape)===1;if(o===1&&!C&&!T)m=`
      return vec4(outputValue.xy, outputValue.xy);
    `;else if(C&&!T)i===1?m=`
        return vec4(outputValue.x, outputValue.x, 0., 0.);
      `:m=`
        return vec4(outputValue.x);
      `;else if(a.length){const A=o-2,P=o-1;a.indexOf(A)>-1&&a.indexOf(P)>-1?m="return vec4(outputValue.x);":a.indexOf(A)>-1?m="return vec4(outputValue.x, outputValue.y, outputValue.x, outputValue.y);":a.indexOf(P)>-1&&(m="return vec4(outputValue.xx, outputValue.zz);")}return`
    vec4 ${s}() {
      ${u} coords = getOutputCoords();
      ${l}
      vec4 outputValue = get${r}(${d});
      ${m}
    }
  `}function yT(n,e){const t=n.name,r=t.charAt(0).toUpperCase()+t.slice(1),s="get"+r+"AtOutCoords",o=e.texShape,i=n.shapeInfo.texShape,a=n.shapeInfo.logicalShape.length,u=e.logicalShape.length;if(!n.shapeInfo.isUniform&&a===u&&n.shapeInfo.flatOffset==null&&Bt(i,o))return`
      float ${s}() {
        return sampleTexture(${t}, resultUV);
      }
    `;const c=Tt(u),l=Pm(n.shapeInfo.logicalShape,e.logicalShape),h=u-a;let d;const m=["x","y","z","w","u","v"];a===0?d="":u<2&&l.length>=1?d="coords = 0;":d=l.map(C=>`coords.${m[C+h]} = 0;`).join(`
`);let g="";return u<2&&a>0?g="coords":g=n.shapeInfo.logicalShape.map((C,$)=>`coords.${m[$+h]}`).join(", "),`
    float ${s}() {
      ${c} coords = getOutputCoords();
      ${d}
      return get${r}(${g});
    }
  `}function Tt(n){if(n<=1)return"int";if(n===2)return"ivec2";if(n===3)return"ivec3";if(n===4)return"ivec4";if(n===5)return"ivec5";if(n===6)return"ivec6";throw Error(`GPU for rank ${n} is not yet supported`)}function Il(n,e,t){const{newShape:r,keptDims:s}=Hs(e),o=e.length,i=n&&o===3&&e[0]===1,a=i?e.slice(1):r,u=!n&&o>1&&!Bt(e,t)&&r.length<o||i;return{useSqueezeShape:u,uniformShape:u?a:e,keptDims:s}}function Ei(n,e){const t=JSON.parse(JSON.stringify(n));return t.shapeInfo.logicalShape=e,t}function ki(n,e){return e.map(t=>n[t]).join(", ")}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xT(n,e,t,r){const s=t.map((l,h)=>{const d={logicalShape:l.shape,texShape:l.isUniform?null:l.texData.texShape,isUniform:l.isUniform,isPacked:l.isUniform?!1:l.texData.isPacked,flatOffset:null};return l.texData!=null&&l.texData.slice!=null&&l.texData.slice.flatOffset>0&&(d.flatOffset=l.texData.slice.flatOffset),{name:e.variableNames[h],shapeInfo:d}}),o=s.map(l=>l.shapeInfo),i={logicalShape:r.shape,texShape:r.texData.texShape,isUniform:!1,isPacked:r.texData.isPacked,flatOffset:null},a=PC(s,i,e),u=hC(n.gl,a),c=n.createProgram(u);return ue().get("ENGINE_COMPILE_ONLY")?{program:e,fragmentShader:u,source:a,webGLProgram:c,inShapeInfos:o,outShapeInfo:i,uniformLocations:null,customUniformLocations:null,infLoc:null,nanLoc:null,inShapesLocations:null,inTexShapesLocations:null,outShapeLocation:null,outShapeStridesLocation:null,outTexShapeLocation:null}:Object.assign({program:e,fragmentShader:u,source:a,webGLProgram:c,inShapeInfos:o,outShapeInfo:i},Mm(n,e,c))}function Mm(n,e,t){const r={},s={},o={},i=[];let a,u,c,l=null,h=null;h=n.getUniformLocation(t,"NAN",!1),ue().getNumber("WEBGL_VERSION")===1&&(l=n.getUniformLocation(t,"INFINITY",!1));const d=!1;for(let m=0;m<e.variableNames.length;m++){const g=e.variableNames[m];r[g]=n.getUniformLocation(t,g,d),r[`offset${g}`]=n.getUniformLocation(t,`offset${g}`,d),e.enableShapeUniforms&&(s[`${g}Shape`]=n.getUniformLocation(t,`${g}Shape`,d),o[`${g}TexShape`]=n.getUniformLocation(t,`${g}TexShape`,d))}return e.enableShapeUniforms&&(a=n.getUniformLocation(t,"outShape",d),c=n.getUniformLocation(t,"outShapeStrides",d),u=n.getUniformLocation(t,"outTexShape",d)),e.customUniforms&&e.customUniforms.forEach((m,g)=>{i[g]=n.getUniformLocation(t,m.name,d)}),{uniformLocations:r,customUniformLocations:i,infLoc:l,nanLoc:h,inShapesLocations:s,inTexShapesLocations:o,outShapeLocation:a,outShapeStridesLocation:c,outTexShapeLocation:u}}function xh(n,e){if(n.length!==e.length)throw Error(`Binary was compiled with ${n.length} inputs, but was executed with ${e.length} inputs`);n.forEach((t,r)=>{const s=t.logicalShape,o=e[r],i=o.shape;if(!Bt(s,i))throw Error(`Binary was compiled with different shapes than the current args. Shapes ${s} and ${i} must match`);if(t.isUniform&&o.isUniform)return;const a=t.texShape,u=o.isUniform?null:o.texData.texShape;if(!Bt(a,u))throw Error(`Binary was compiled with different texture shapes than the current args. Shape ${a} and ${u} must match`)})}function bT(n,e,t,r,s){e.program.enableShapeUniforms||(xh(e.inShapeInfos,t),xh([e.outShapeInfo],[r]));const o=r.texData.texture,i=r.texData.texShape;r.texData.isPacked?n.setOutputPackedMatrixTexture(o.texture,i[0],i[1]):n.setOutputMatrixTexture(o.texture,i[0],i[1]),n.setProgram(e.webGLProgram),ue().getNumber("WEBGL_VERSION")===1&&e.infLoc!==null&&n.gl.uniform1f(e.infLoc,1/0),e.nanLoc!==null&&n.gl.uniform1f(e.nanLoc,NaN),t.forEach((u,c)=>{const l=e.program.variableNames[c],h=e.uniformLocations[l],d=e.uniformLocations[`offset${l}`],m=e.inShapesLocations[`${l}Shape`],g=e.inTexShapesLocations[`${l}TexShape`];if(m){const{uniformShape:C}=Il(e.program.packedInputs,u.shape,u.texData.texShape);switch(C.length){case 1:n.gl.uniform1iv(m,new Int32Array(C));break;case 2:n.gl.uniform2iv(m,new Int32Array(C));break;case 3:n.gl.uniform3iv(m,new Int32Array(C));break;case 4:n.gl.uniform4iv(m,new Int32Array(C));break}}if(g&&n.gl.uniform2i(g,u.texData.texShape[0],u.texData.texShape[1]),h!=null){if(u.isUniform){if(Ce(u.shape)<2)n.gl.uniform1f(h,u.uniformValues[0]);else{let C=u.uniformValues;C instanceof Float32Array||(C=new Float32Array(C)),n.gl.uniform1fv(h,C)}return}u.texData.slice!=null&&d!=null&&n.gl.uniform1i(d,u.texData.slice.flatOffset),n.setInputMatrixTexture(u.texData.texture.texture,h,c)}});const a=e.outShapeLocation;if(a)switch(r.shape.length){case 1:n.gl.uniform1iv(a,new Int32Array(r.shape));break;case 2:n.gl.uniform2iv(a,new Int32Array(r.shape));break;case 3:n.gl.uniform3iv(a,new Int32Array(r.shape));break;case 4:n.gl.uniform4iv(a,new Int32Array(r.shape));break}if(e.outShapeStridesLocation){const u=rn(r.shape);switch(r.shape.length){case 2:n.gl.uniform1iv(e.outShapeStridesLocation,new Int32Array(u));break;case 3:n.gl.uniform2iv(e.outShapeStridesLocation,new Int32Array(u));break;case 4:n.gl.uniform3iv(e.outShapeStridesLocation,new Int32Array(u));break}}e.outTexShapeLocation&&n.gl.uniform2i(e.outTexShapeLocation,r.texData.texShape[0],r.texData.texShape[1]),e.program.customUniforms&&s&&e.program.customUniforms.forEach((u,c)=>{const l=e.customUniformLocations[c],h=s[c];if(u.type==="float")n.gl.uniform1fv(l,h);else if(u.type==="vec2")n.gl.uniform2fv(l,h);else if(u.type==="vec3")n.gl.uniform3fv(l,h);else if(u.type==="vec4")n.gl.uniform4fv(l,h);else if(u.type==="int")n.gl.uniform1iv(l,h);else if(u.type==="ivec2")n.gl.uniform2iv(l,h);else if(u.type==="ivec3")n.gl.uniform3iv(l,h);else if(u.type==="ivec4")n.gl.uniform4iv(l,h);else throw Error(`uniform type ${u.type} is not supported yet.`)}),n.executeProgram()}function vT(n,e,t){let r="";e.concat(t).forEach(i=>{const a=i.texData!=null&&i.texData.slice!=null&&i.texData.slice.flatOffset>0;if(n.enableShapeUniforms&&!i.isUniform){const u=i.texData.texShape,{useSqueezeShape:c,uniformShape:l,keptDims:h}=Il(n.packedInputs,i.shape,u);let d="",m="",g="";if(l.length===1&&n.packedInputs){const H=[Math.ceil(u[0]/2),Math.ceil(u[1]/2)];d=`${H[0]>1}_${H[1]>1}`}else if(l.length===2&&!n.packedInputs)m=`${l[0]>1}_${l[1]>1}`;else if(l.length>2&&!n.packedInputs){const H=rn(l);g=`${H[0]===u[1]}_${H[H.length-1]===u[1]}`}const C=i.shape.length,$=l.length===2&&Bt(i.shape,u),T=Ce(i.shape)===1,A=Va(i.shape,t.shape),P=!n.packedInputs&&C===t.shape.length&&Bt(u,t.texData.texShape),B=n.packedInputs||l.length>2?"":`${u[0]>1}_${u[1]>1}`;r+=`${C}_${P}_${c?h:""}_${l.length}_${T}_${A}_${$}_${d}_${m}_${g}_${B}_${a}`}else{const u=i.isUniform?"uniform":i.texData.texShape;r+=`${i.shape}_${u}_${a}`}});const s=n.userCode;let o=n.constructor.name;return o+="_"+r+"_"+s+`${ue().getNumber("WEBGL_VERSION")}`,o}function Nn(n){return ue().getBool("WEBGL_USE_SHAPES_UNIFORMS")&&n<=4}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class wT{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outPackingScheme=Ji.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=Sn();this.outputShape=e,this.enableShapeUniforms=Nn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?gu(["r","c","d"],e):Lo(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getA(rc.x, rc.y, rc.z);
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class CT{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outPackingScheme=Ji.DENSE,this.customUniforms=[{name:"texShape",type:"ivec2"}];const t=Sn();this.outputShape=e,this.enableShapeUniforms=Nn(this.outputShape.length),this.userCode=`
      ivec3 outCoordsFromFlatIndex(int index) {
        ${this.enableShapeUniforms?gu(["r","c","d"],e):Lo(["r","c","d"],e)}
        return ivec3(r, c, d);
      }

      void main() {
        ivec2 resTexRC = ivec2(resultUV.yx * vec2(texShape[0], texShape[1]));
        int index = 4 * (resTexRC.x * texShape[1] + resTexRC.y);

        vec4 result = vec4(0.);

        for (int i=0; i<4; i++) {
          int flatIndex = index + i;
          ivec3 rc = outCoordsFromFlatIndex(flatIndex);
          result[i] = getChannel(getA(rc.x, rc.y, rc.z), vec2(rc.y, rc.z));
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TT{constructor(e){this.variableNames=["A"],this.outTexUsage=Yn.DOWNLOAD;const t=Sn();this.outputShape=e,this.userCode=`
      ${Fm}

      void main() {
        float x = getAAtOutCoords();
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class $T{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outTexUsage=Yn.DOWNLOAD;const t=Sn();this.outputShape=e,this.userCode=`
      ${Fm}

      void main() {
        ivec3 coords = getOutputCoords();
        float x = getChannel(getAAtOutCoords(), vec2(coords.y, coords.z));
        ${t.output} = encode_float(x);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ST{constructor(e,t=!1){this.variableNames=["A"],this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Sn();this.outputShape=e,this.enableShapeUniforms=Nn(this.outputShape.length);let s="result";t&&(s="floor(result * 255. + 0.5)"),this.userCode=`
      ${this.enableShapeUniforms?kl():El(e)}

      void main() {
        ivec3 coords = getOutputCoords();

        int flatIndex = getFlatIndex(coords);
        int offset = imod(flatIndex, 4);

        flatIndex = idiv(flatIndex, 4, 1.);

        int r = flatIndex / texShape[1];
        int c = imod(flatIndex, texShape[1]);
        vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
        vec4 values = ${r.texture2D}(A, uv);

        float result;

        if(offset == 0) {
          result = values[0];
        } else if(offset == 1) {
          result = values[1];
        } else if(offset == 2) {
          result = values[2];
        } else {
          result = values[3];
        }

        ${r.output} = vec4(${s}, 0., 0., 0.);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NT{constructor(e,t=!1){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.customUniforms=[{name:"texShape",type:"ivec2"}];const r=Sn();this.outputShape=e,this.enableShapeUniforms=Nn(this.outputShape.length);let s="",o="result";t&&(o="floor(result * 255. + 0.5)");for(let i=0;i<=1;i++)for(let a=0;a<=1;a++){const u=i*2+a;s+=`
          localCoords = coords;
          if(localCoords[2] + ${a} < ${this.enableShapeUniforms?"outShape[2]":`${e[2]}`}) {
          localCoords[2] += ${a};
          if (localCoords[1] + ${i} < ${this.enableShapeUniforms?"outShape[1]":`${e[1]}`}) {
            localCoords[1] += ${i};

            flatIndex = getFlatIndex(localCoords);
            offset = imod(flatIndex, 4);

            flatIndex = idiv(flatIndex, 4, 1.);

            int r = flatIndex / texShape[1];
            int c = imod(flatIndex, texShape[1]);
            vec2 uv = (vec2(c, r) + halfCR) / vec2(texShape[1], texShape[0]);
            values = ${r.texture2D}(A, uv);

            if (offset == 0) {
              result[${u}] = values[0];
            } else if (offset == 1) {
              result[${u}] = values[1];
            } else if (offset == 2) {
              result[${u}] = values[2];
            } else {
              result[${u}] = values[3];
            }
          }
        }
        `}this.userCode=`
        ${this.enableShapeUniforms?kl():El(e)}

        void main() {
          ivec3 coords = getOutputCoords();

          vec4 result = vec4(0.);
          int flatIndex, r, c, offset;
          ivec3 localCoords;
          vec2 uv;
          vec4 values;

          ${s}

          ${r.output} = ${o};
        }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ET(n){const e=Sn(),t=`${e.version}
    precision highp float;
    ${e.attribute} vec3 clipSpacePos;
    ${e.attribute} vec2 uv;
    ${e.varyingVs} vec2 resultUV;

    void main() {
      gl_Position = vec4(clipSpacePos, 1);
      resultUV = uv;
    }`;return lC(n,t)}function kT(n){const e=new Float32Array([-1,1,0,0,1,-1,-1,0,0,0,1,1,0,1,1,1,-1,0,1,0]);return mC(n,e)}function IT(n){const e=new Uint16Array([0,1,2,2,1,3]);return gC(n,e)}function ca(n,e,t,r,s,o){xC(e,t);const i=yC(n),a=n.TEXTURE_2D;return De(n,()=>n.bindTexture(a,i)),De(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_S,n.CLAMP_TO_EDGE)),De(n,()=>n.texParameteri(a,n.TEXTURE_WRAP_T,n.CLAMP_TO_EDGE)),De(n,()=>n.texParameteri(a,n.TEXTURE_MIN_FILTER,n.NEAREST)),De(n,()=>n.texParameteri(a,n.TEXTURE_MAG_FILTER,n.NEAREST)),ue().getNumber("WEBGL_VERSION")===1?De(n,()=>n.texImage2D(a,0,r,e,t,0,s,o,null)):De(n,()=>n.texStorage2D(a,1,r,e,t)),De(n,()=>n.bindTexture(n.TEXTURE_2D,null)),{texture:i,texShape:[t,e]}}function Vm(n){return n.internalFormatFloat}function _T(n,e,t,r){const[s,o]=aa(e,t);return ca(n,s,o,Vm(r),r.textureFormatFloat,n.FLOAT)}function Um(n){return n.internalFormatHalfFloat}function RT(n,e,t,r){const[s,o]=aa(e,t);return ca(n,s,o,Um(r),r.textureFormatFloat,r.textureTypeHalfFloat)}function Wm(n){return n.downloadTextureFormat}function AT(n,e,t,r){const[s,o]=aa(e,t);return ca(n,s,o,Wm(r),n.RGBA,n.UNSIGNED_BYTE)}function zm(n){return n.internalFormatPackedFloat}function OT(n,e,t,r){const[s,o]=$i(e,t);return ca(n,s,o,zm(r),n.RGBA,n.FLOAT)}function Gm(n){return n.internalFormatPackedHalfFloat}function DT(n,e,t,r){const[s,o]=$i(e,t);return ca(n,s,o,Gm(r),n.RGBA,r.textureTypeHalfFloat)}function FT(n,e,t){return De(n,()=>n.bindBuffer(n.ARRAY_BUFFER,t)),mh(n,e,"clipSpacePos",t,3,20,0)&&mh(n,e,"uv",t,2,20,12)}function PT(n,e,t,r,s,o){De(n,()=>n.bindTexture(n.TEXTURE_2D,e));let i,a,u;s instanceof Uint8Array?(i=new Uint8Array(t*r*4),a=n.UNSIGNED_BYTE,u=n.RGBA):(i=new Float32Array(t*r*4),a=n.FLOAT,u=o.internalFormatPackedFloat),i.set(s),ue().getNumber("WEBGL_VERSION")===2?De(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t,r,n.RGBA,a,i)):De(n,()=>n.texImage2D(n.TEXTURE_2D,0,u,t,r,0,n.RGBA,a,i)),De(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function LT(n,e,t){De(n,()=>n.bindTexture(n.TEXTURE_2D,e)),t.data instanceof Uint8Array?ue().getNumber("WEBGL_VERSION")===2?De(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,t.width,t.height,n.RGBA,n.UNSIGNED_BYTE,t.data)):De(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,t.width,t.height,0,n.RGBA,n.UNSIGNED_BYTE,t.data)):ue().getNumber("WEBGL_VERSION")===2?De(n,()=>n.texSubImage2D(n.TEXTURE_2D,0,0,0,n.RGBA,n.UNSIGNED_BYTE,t)):De(n,()=>n.texImage2D(n.TEXTURE_2D,0,n.RGBA,n.RGBA,n.UNSIGNED_BYTE,t)),De(n,()=>n.bindTexture(n.TEXTURE_2D,null))}function BT(n,e,t,r){const s=n.createBuffer();De(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,s));const a=4*4*e*t;return De(n,()=>n.bufferData(n.PIXEL_PACK_BUFFER,a,n.STREAM_READ)),De(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,0)),De(n,()=>n.bindBuffer(n.PIXEL_PACK_BUFFER,null)),s}function MT(n,e,t){const r=n,s=new Float32Array(t);return r.bindBuffer(r.PIXEL_PACK_BUFFER,e),r.getBufferSubData(r.PIXEL_PACK_BUFFER,0,s),r.bindBuffer(r.PIXEL_PACK_BUFFER,null),s}function VT(n,e,t,r){const[s,o]=aa(e,t),i=4,a=new Uint8Array(rC(e*t,i));return De(n,()=>n.readPixels(0,0,s,o,r.downloadTextureFormat,n.UNSIGNED_BYTE,a)),new Float32Array(a.buffer)}function UT(n,e,t,r,s,o,i,a){const u=n,c=new Float32Array(sC(o,i));return u.bindBuffer(u.PIXEL_PACK_BUFFER,e),u.getBufferSubData(u.PIXEL_PACK_BUFFER,0,c),u.bindBuffer(u.PIXEL_PACK_BUFFER,null),c}function WT(n,e,t){const r=new Float32Array(e*t*4);return De(n,()=>n.readPixels(0,0,t,e,n.RGBA,n.FLOAT,r)),r}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Vu{constructor(e){this.outputTexture=null,this.program=null,this.disposed=!1,this.vertexAttrsAreBound=!1,this.itemsToPoll=[];const t=ue().getNumber("WEBGL_VERSION");e!=null?(this.gl=e,eC(t,e)):this.gl=Br(t);let r="WEBGL_color_buffer_float";const s="EXT_color_buffer_half_float";if(this.parallelCompilationExtension=this.gl.getExtension("KHR_parallel_shader_compile"),ue().getNumber("WEBGL_VERSION")===1){const o="OES_texture_float",i="OES_texture_half_float";if(this.textureFloatExtension=Sa(this.gl,o),mr(this.gl,i))this.textureHalfFloatExtension=Sa(this.gl,i);else if(ue().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support half float textures, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.");if(this.colorBufferFloatExtension=this.gl.getExtension(r),mr(this.gl,s))this.colorBufferHalfFloatExtension=Sa(this.gl,s);else if(ue().get("WEBGL_FORCE_F16_TEXTURES"))throw new Error("GL context does not support color renderable half floats, yet the environment flag WEBGL_FORCE_F16_TEXTURES is set to true.")}else if(r="EXT_color_buffer_float",mr(this.gl,r))this.colorBufferFloatExtension=this.gl.getExtension(r);else if(mr(this.gl,s))this.colorBufferHalfFloatExtension=this.gl.getExtension(s);else throw new Error("GL context does not support color renderable floats");this.vertexBuffer=kT(this.gl),this.indexBuffer=IT(this.gl),this.framebuffer=bC(this.gl),this.textureConfig=Nl(this.gl,this.textureHalfFloatExtension)}get debug(){return ue().getBool("DEBUG")}dispose(){if(this.disposed)return;this.program!=null&&console.warn("Disposing a GPGPUContext that still has a bound WebGLProgram. This is probably a resource leak, delete the program with GPGPUContext.deleteProgram before disposing."),this.outputTexture!=null&&console.warn("Disposing a GPGPUContext that still has a bound output matrix texture.  This is probably a resource leak, delete the output matrix texture with GPGPUContext.deleteMatrixTexture before disposing.");const e=this.gl;De(e,()=>e.finish()),De(e,()=>e.bindFramebuffer(e.FRAMEBUFFER,null)),De(e,()=>e.deleteFramebuffer(this.framebuffer)),De(e,()=>e.bindBuffer(e.ARRAY_BUFFER,null)),De(e,()=>e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,null)),De(e,()=>e.deleteBuffer(this.indexBuffer)),this.disposed=!0}createFloat32MatrixTexture(e,t){return this.throwIfDisposed(),_T(this.gl,e,t,this.textureConfig)}createFloat16MatrixTexture(e,t){return this.throwIfDisposed(),RT(this.gl,e,t,this.textureConfig)}createUnsignedBytesMatrixTexture(e,t){return this.throwIfDisposed(),AT(this.gl,e,t,this.textureConfig)}uploadPixelDataToTexture(e,t){this.throwIfDisposed(),LT(this.gl,e,t)}uploadDenseMatrixToTexture(e,t,r,s){this.throwIfDisposed(),PT(this.gl,e,t,r,s,this.textureConfig)}createFloat16PackedMatrixTexture(e,t){return this.throwIfDisposed(),DT(this.gl,e,t,this.textureConfig)}createPackedMatrixTexture(e,t){return this.throwIfDisposed(),OT(this.gl,e,t,this.textureConfig)}deleteMatrixTexture(e){this.throwIfDisposed(),this.outputTexture===e&&(gh(this.gl,this.framebuffer),this.outputTexture=null),De(this.gl,()=>this.gl.deleteTexture(e))}downloadByteEncodedFloatMatrixFromOutputTexture(e,t,r){return this.downloadMatrixDriver(e,()=>VT(this.gl,t,r,this.textureConfig))}downloadPackedMatrixFromBuffer(e,t,r,s,o,i){return UT(this.gl,e,t,r,s,o,i,this.textureConfig)}downloadFloat32MatrixFromBuffer(e,t){return MT(this.gl,e,t)}createBufferFromTexture(e,t,r){this.bindTextureToFrameBuffer(e);const s=BT(this.gl,t,r,this.textureConfig);return this.unbindTextureToFrameBuffer(),s}createAndWaitForFence(){const e=this.createFence(this.gl);return this.pollFence(e)}createFence(e){let t,r;if(ue().getBool("WEBGL_FENCE_API_ENABLED")){const s=e,o=s.fenceSync(s.SYNC_GPU_COMMANDS_COMPLETE,0);e.flush(),r=()=>{const i=s.clientWaitSync(o,0,0);return i===s.ALREADY_SIGNALED||i===s.CONDITION_SATISFIED},t=o}else ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")>0?(t=this.beginQuery(),this.endQuery(),r=()=>this.isQueryAvailable(t,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))):r=()=>!0;return{query:t,isFencePassed:r}}downloadMatrixFromPackedTexture(e,t,r){return this.downloadMatrixDriver(e,()=>WT(this.gl,t,r))}createProgram(e){this.throwIfDisposed();const t=this.gl;this.vertexShader==null&&(this.vertexShader=ET(t));const r=dC(t);return De(t,()=>t.attachShader(r,this.vertexShader)),De(t,()=>t.attachShader(r,e)),pC(t,r),this.debug&&Fu(t,r),this.vertexAttrsAreBound||(this.setProgram(r),this.vertexAttrsAreBound=FT(t,this.program,this.vertexBuffer)),r}deleteProgram(e){this.throwIfDisposed(),e===this.program&&(this.program=null),e!=null&&De(this.gl,()=>this.gl.deleteProgram(e))}setProgram(e){this.throwIfDisposed(),this.program=e,this.program!=null&&this.debug&&Fu(this.gl,this.program),De(this.gl,()=>this.gl.useProgram(e))}getUniformLocation(e,t,r=!0){return this.throwIfDisposed(),r?wC(this.gl,e,t):CC(this.gl,e,t)}getAttributeLocation(e,t){return this.throwIfDisposed(),De(this.gl,()=>this.gl.getAttribLocation(e,t))}getUniformLocationNoThrow(e,t){return this.throwIfDisposed(),this.gl.getUniformLocation(e,t)}setInputMatrixTexture(e,t,r){this.throwIfDisposed(),this.throwIfNoProgram(),TC(this.gl,e,t,r)}setOutputMatrixTexture(e,t,r){this.setOutputMatrixTextureDriver(e,r,t)}setOutputPackedMatrixTexture(e,t,r){this.throwIfDisposed();const[s,o]=$i(t,r);this.setOutputMatrixTextureDriver(e,s,o)}setOutputMatrixWriteRegion(e,t,r,s){this.setOutputMatrixWriteRegionDriver(r,e,s,t)}setOutputPackedMatrixWriteRegion(e,t,r,s){throw new Error("setOutputPackedMatrixWriteRegion not implemented.")}debugValidate(){this.program!=null&&Fu(this.gl,this.program),Na(this.gl)}executeProgram(){this.throwIfDisposed(),this.throwIfNoProgram();const e=this.gl;this.debug&&this.debugValidate(),De(e,()=>e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0))}blockUntilAllProgramsCompleted(){this.throwIfDisposed(),De(this.gl,()=>this.gl.finish())}getQueryTimerExtension(){return this.disjointQueryTimerExtension==null&&(this.disjointQueryTimerExtension=Sa(this.gl,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2?"EXT_disjoint_timer_query_webgl2":"EXT_disjoint_timer_query")),this.disjointQueryTimerExtension}getQueryTimerExtensionWebGL2(){return this.getQueryTimerExtension()}getQueryTimerExtensionWebGL1(){return this.getQueryTimerExtension()}beginQuery(){if(ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),o=r.createQuery();return r.beginQuery(s.TIME_ELAPSED_EXT,o),o}const e=this.getQueryTimerExtensionWebGL1(),t=e.createQueryEXT();return e.beginQueryEXT(e.TIME_ELAPSED_EXT,t),t}endQuery(){if(ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION")===2){const t=this.gl,r=this.getQueryTimerExtensionWebGL2();t.endQuery(r.TIME_ELAPSED_EXT);return}const e=this.getQueryTimerExtensionWebGL1();e.endQueryEXT(e.TIME_ELAPSED_EXT)}async waitForQueryAndGetTime(e){return await jl(()=>this.disposed||this.isQueryAvailable(e,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))),this.getQueryTime(e,ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_VERSION"))}getQueryTime(e,t){if(t===0)return null;if(t===2){const r=this.gl;return r.getQueryParameter(e,r.QUERY_RESULT)/1e6}else{const r=this.getQueryTimerExtensionWebGL1();return r.getQueryObjectEXT(e,r.QUERY_RESULT_EXT)/1e6}}isQueryAvailable(e,t){if(t===0)return!0;if(t===2){const r=this.gl,s=this.getQueryTimerExtensionWebGL2(),o=r.getQueryParameter(e,r.QUERY_RESULT_AVAILABLE);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(s.GPU_DISJOINT_EXT)),o&&!this.disjoint}else{const r=this.getQueryTimerExtensionWebGL1(),s=r.getQueryObjectEXT(e,r.QUERY_RESULT_AVAILABLE_EXT);return this.disjoint==null&&(this.disjoint=this.gl.getParameter(r.GPU_DISJOINT_EXT)),s&&!this.disjoint}}pollFence(e){return new Promise(t=>{this.addItemToPoll(()=>e.isFencePassed(),()=>t())})}pollItems(){const e=zT(this.itemsToPoll.map(t=>t.isDoneFn));for(let t=0;t<=e;++t){const{resolveFn:r}=this.itemsToPoll[t];r()}this.itemsToPoll=this.itemsToPoll.slice(e+1)}addItemToPoll(e,t){if(this.itemsToPoll.push({isDoneFn:e,resolveFn:t}),this.itemsToPoll.length>1)return;let r;"setTimeoutCustom"in ue().platform&&(r=ue().platform.setTimeoutCustom.bind(ue().platform)),jl(()=>(this.pollItems(),this.itemsToPoll.length===0),()=>0,null,r)}bindTextureToFrameBuffer(e){this.throwIfDisposed(),Pu(this.gl,e,this.framebuffer),this.debug&&Na(this.gl)}unbindTextureToFrameBuffer(){this.outputTexture!=null?(Pu(this.gl,this.outputTexture,this.framebuffer),this.debug&&Na(this.gl)):gh(this.gl,this.framebuffer)}downloadMatrixDriver(e,t){this.bindTextureToFrameBuffer(e);const r=t();return this.unbindTextureToFrameBuffer(),r}setOutputMatrixTextureDriver(e,t,r){this.throwIfDisposed();const s=this.gl;Pu(s,e,this.framebuffer),this.debug&&Na(s),this.outputTexture=e,De(s,()=>s.viewport(0,0,t,r)),De(s,()=>s.scissor(0,0,t,r))}setOutputMatrixWriteRegionDriver(e,t,r,s){this.throwIfDisposed(),De(this.gl,()=>this.gl.scissor(e,t,r,s))}throwIfDisposed(){if(this.disposed)throw new Error("Attempted to use disposed GPGPUContext.")}throwIfNoProgram(){if(this.program==null)throw new Error("No GPU program is currently set.")}}function zT(n){let e=0;for(;e<n.length&&n[e]();++e);return e-1}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function GT(n){const e=new Float32Array(n.length);for(let t=0;t<n.length;++t)e[t]=Math.abs(n[t]);return e}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function er(n){return(e,t,r,s,o)=>{const i=ot(e,t),a=i.length,u=rn(i),c=Ce(i),l=vs(o,c),h=e.length,d=t.length,m=rn(e),g=rn(t),C=Va(e,i),$=Va(t,i);if(C.length+$.length===0)for(let T=0;T<l.length;++T)l[T]=n(r[T%r.length],s[T%s.length]);else for(let T=0;T<l.length;++T){const A=Hc(T,a,u),P=A.slice(-h);C.forEach(re=>P[re]=0);const B=nc(P,h,m),H=A.slice(-d);$.forEach(re=>H[re]=0);const x=nc(H,d,g);l[T]=n(r[B],s[x])}return[l,i]}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function jT(n,e,t,r){if(r==="int32"){const s=Int32Array.from(n);return[e,"int32",s]}if(r==="bool"){const s=nu([0],t),[o,i]=er((a,u)=>a!==u?1:0)(e,[],n,s,"bool");return[i,"bool",o]}throw new Error(`Error in Cast: failed to cast ${t} to ${r}`)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HT=er((n,e)=>n+e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qT(n,e,t,r,s){const o=Ce(r),i=zs(s,t);for(let a=0;a<n.length;a++){const u=n[a];if(u<0)throw new Error("Input x must be non-negative!");u>=s||(o>0?i[u]+=e[a]:i[u]+=1)}return i}function XT(n,e,t,r=!1){const s=n.shape[0],o=n.shape[1],i=Ot([s,t],e.dtype);for(let a=0;a<s;a++)for(let u=0;u<o;u++){const c=n.get(a,u);if(c<0)throw new Error("Input x must be non-negative!");c>=t||(r?i.set(1,a,c):e.size>0?i.set(i.get(a,c)+e.get(a,u),a,c):i.set(i.get(a,c)+1,a,c))}return i}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ks(n){return(e,t,r)=>{const s=vs(t,e.length);for(let o=0;o<e.length;++o)s[o]=n(e[o],r);return s}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KT=Ks(n=>Math.ceil(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function YT(n,e,t,r){const s=_n(t,Ce(e));if(r&&t!=="string"){let o=0;n.forEach(i=>{const a=Ce(i.shape);s.set(i.vals,o),o+=a})}else{let o=0;n.forEach(i=>{const a=t==="string"?Zi(i.vals):i.vals;let u=0;for(let c=0;c<i.shape[0];++c){const l=c*e[1]+o;for(let h=0;h<i.shape[1];++h)s[l+h]=a[u++]}o+=i.shape[1]})}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QT=er((n,e)=>n===e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZT=Ks(n=>Math.exp(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const JT=Ks(n=>Math.expm1(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const e$=Ks(n=>Math.floor(n));/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t$(n,e,t,r,s,o,i,a,u){const c=Ot([r,o],t);for(let l=0;l<r;l++){const h=[];let d=0;for(let m=0;m<s;m++){const g=n[l*s+m];d+=g*i[m],h.push(g)}if(d<0||d>=u/o)throw new Error(`Invalid indices: ${h} does not index into ${a}`);for(let m=0;m<o;m++)c.values[l*o+m]=e.get(...e.indexToLoc(d*o+m))}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function n$(n,e,t){const r=Ot(t,n.dtype);for(let s=0;s<r.size;++s){const i=r.indexToLoc(s).slice(),a=i[0],u=i[2],c=e.locToIndex([a,u]);i[2]=e.values[c];const l=n.locToIndex(i);0<=l&&l<n.values.length&&(r.values[s]=n.values[l])}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const r$=er((n,e)=>n>e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const s$=er((n,e)=>n>=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const o$=er((n,e)=>n<e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i$=er((n,e)=>n<=e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function a$(n,e,t){const r=(e-n)/(t-1),s=zs(t,"float32");s[0]=n;for(let o=1;o<s.length;o++)s[o]=s[o-1]+r;return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const u$=Ks(n=>Math.log(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c$(n,e,t,r){const s=vs(r,Ce(t));for(let o=0;o<s.length;++o){const i=o*e;let a=n[i];for(let u=0;u<e;++u){const c=n[i+u];(Number.isNaN(c)||c>a)&&(a=c)}s[o]=a}return s}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const l$=er((n,e)=>Math.max(n,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const h$=er((n,e)=>Math.min(n,e));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jm=er((n,e)=>n*e);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f$(n,e,t){const r=vi(-1,t);return jm([],e,r,n,t)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d$=er((n,e)=>n!==e?1:0);/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p$(n,e,t,r,s){const o=e.length,i=Ce(e),a=rn(e),u=rn(s),c=vs(t,Ce(s));for(let l=0;l<i;++l){const h=Hc(l,o,a),d=new Array(h.length);for(let g=0;g<d.length;g++)d[g]=h[r[g]];const m=nc(d,o,u);c[m]=n[l]}return c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m$(n,e,t,r){const[s,o]=ss(n,r),i=rs(e,"int32"),a=zs(Ce(s),i),u=Ce(o);for(let c=0;c<a.length;++c){const l=c*u;let h=1;for(let d=0;d<u;++d)h*=t[l+d];a[c]=h}return{outVals:a,outShape:s,outDtype:i}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g$(n,e,t){n.forEach((r,s)=>{if(r<0||r>=t){const o=Hc(s,e.length,rn(e)).join(",");throw new Error(`indices[${o}] = ${r} is not in [0, ${t})`)}})}function y$(n,e){for(let t=0;t<n.length;++t){const r=n[t],s=t===n.length-1?e:n[t+1].length;if(r.length===0)throw new Error("Ragged splits may not be empty");if(r[0]<0)throw new Error("Ragged splits must be non-negative");if(r[r.length-1]>s)throw new Error("Ragged splits must not point past values");for(let o=1;o<r.length;++o)if(r[o-1]>r[o])throw new Error("Ragged splits must be sorted in ascending order")}}function x$(n,e,t,r){const s=[];let o=0;const i=e.length-1+t.length,a=new Array(i).fill(null).map(()=>[0]);y$(t,r);let u=1;for(let c=0;c<e.length-1;++c){u*=e[c];const l=e[c+1];for(let h=1;h<u+1;++h)a[c].push(h*l)}for(let c=0;c<n.length;++c){let l=n[c],h=n[c]+1;for(let d=0;d<t.length;++d){const m=t[d],g=d+e.length-1;if(g>=0){const C=a[g],$=C[C.length-1]-m[l];for(let T=l;T<h;++T)a[g].push(m[T+1]+$)}l=m[l],h=m[h]}h!==l&&(s.push([l,h]),o+=h-l)}return{outSplits:a,valueSlices:s,numValues:o}}function b$(n){const e=[];for(let t=0;t<n.length;++t){const r=n[t].length,s=_n("int32",r);e.push(s),n[t].forEach((o,i)=>s[i]=o)}return e}function bh(n,e){const t=n.slice(0,e);for(;t.length<e;)t.push(1);for(let r=e;r<n.length;r++)t[e-1]*=n[r];return t}function v$(n,e,t,r,s,o){const i=bh(e,2)[1],a=bh(o,2)[1];let u=0;for(const c of t)for(let l=c[0];l<c[1];++l){for(let h=0;h<r;++h)s[u*a+h]=n[l*i+h];++u}}function w$(n,e,t,r,s){const o=e.slice();o[0]=s;const i=_n(t,Ce(o)),a=n.length,u=a===0?0:a/e[0];return v$(n,e,r,u,i,o),[i,o]}function C$(n,e,t,r,s,o,i,a){if(n.length===0)throw new Error("paramsNestedSplits must be non empty");if(e[0].length===0)throw new Error("Split tensors must not be scalars");const u=e[0][0]-1;if(g$(o,i,u),r.length===0)throw new Error("params.rank must be nonzero");const c=r[0],{outSplits:l,valueSlices:h,numValues:d}=x$(o,i,n,c),m=b$(l),g=w$(t,r,s,h,d);return[m,g[0],g[1]]}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */var ur=Dr;class Ha{constructor(e,t,r,s,o,i,a,u,c,l){this.shape=e,this.shapeShape=t,this.values=r,this.valuesShape=s,this.valuesDType=o,this.defaultValue=i,this.defaultValueShape=a,this.rowPartitionValues=u,this.rowPartitionValuesShapes=c,this.rowPartitionTypes=J2(l),this.raggedRank=em(this.rowPartitionTypes)}getRowPartitionTypeByDimension(e){return this.rowPartitionTypes[0]===ur.FIRST_DIM_SIZE?this.rowPartitionTypes[e+1]:this.rowPartitionTypes[e]}getRowPartitionTensor(e){return this.rowPartitionTypes[0]===ur.FIRST_DIM_SIZE?this.rowPartitionValues[e+1]:this.rowPartitionValues[e]}getMaxWidth(e){const t=this.getRowPartitionTensor(e-1);switch(this.getRowPartitionTypeByDimension(e-1)){case ur.VALUE_ROWIDS:return Ha.getMaxWidthValueRowID(t);case ur.ROW_SPLITS:return Ha.getMaxWidthRowSplit(t);default:throw new Error(`Cannot handle partition type ${ur[this.getRowPartitionTypeByDimension(e-1)]}`)}}static getMaxWidthRowSplit(e){const t=e.length;if(t===0||t===1)return 0;let r=0;for(let s=0;s<t-1;++s){const o=e[s+1]-e[s];o>r&&(r=o)}return r}static getMaxWidthValueRowID(e){const t=e.length;if(t===0)return 0;let r=0,s=e[0],o=0;for(let i=1;i<t;++i){const a=e[i];a!==s&&(s=a,o=Math.max(i-r,o),r=i)}return Math.max(t-r,o)}tensorShapeFromTensor(e,t,r=!0){if(t.length===0){if(e[0]===-1)return[];throw new Error("The only valid scalar shape tensor is the fully unknown shape specified as -1.")}return wh(e,r)}calculateOutputSize(e){const t=this.valuesShape,r=this.defaultValueShape;tm(r,t);const s=this.tensorShapeFromTensor(this.shape,this.shapeShape),i=Z2(this.raggedRank,s,t);i[0]<0&&(i[0]=e);for(let a=1;a<=this.raggedRank;++a)i[a]<0&&(i[a]=this.getMaxWidth(a));return i}calculateFirstParentOutputIndex(e,t,r){const s=Math.min(e,r),o=[];let i=0;for(let a=0;a<s;++a,i+=t)o.push(i);for(let a=s;a<e;++a)o.push(-1);return M(o.length===e,()=>"Final length of result must be equal to firstDimension."),o}calculateOutputIndexRowSplit(e,t,r,s){const o=e.length,i=[];for(let a=0;a<o-1;++a){const u=e[a+1]-e[a];let c=Math.min(s,u),l=t[a];l===-1&&(c=0);for(let h=0;h<c;++h)i.push(l),l+=r;for(let h=0;h<u-c;++h)i.push(-1)}if(o>0&&i.length!==e[o-1])throw new Error("Invalid row split size.");return i}calculateOutputIndexValueRowID(e,t,r,s){const o=e.length,i=[];if(o===0)return[];let a=0,u=e[0];if(u>=t.length)throw new Error(`Got currentValueRowId=${u}, which is not less than ${t.length}`);let c=t[u];i.push(c);for(let l=1;l<o;++l){const h=e[l];if(h===u)c>=0&&(++a,a<s?c+=r:c=-1);else{if(a=0,u=h,h>=t.length)throw new Error(`Got nextValueRowId=${h} which is not less than ${t.length}`);c=t[h]}i.push(c)}if(i.length!==e.length)throw new Error("Invalid row ids.");return i}calculateOutputIndex(e,t,r,s){const o=this.getRowPartitionTensor(e),i=this.getRowPartitionTypeByDimension(e);switch(i){case ur.VALUE_ROWIDS:return this.calculateOutputIndexValueRowID(o,t,r,s);case ur.ROW_SPLITS:if(o.length-1>t.length)throw new Error(`Row partition size is greater than output size: ${o.length-1} > ${t.length}`);return this.calculateOutputIndexRowSplit(o,t,r,s);default:throw new Error(`Unsupported partition type: ${ur[i]}`)}}getFirstDimensionSize(){const e=this.rowPartitionValues[0];if(this.rowPartitionTypes.length===0)throw new Error("No row_partition_types given.");const t=this.rowPartitionTypes[0];switch(t){case ur.FIRST_DIM_SIZE:return e[0];case ur.VALUE_ROWIDS:throw new Error("Cannot handle VALUE_ROWIDS in first dimension.");case ur.ROW_SPLITS:return this.rowPartitionValuesShapes[0][0]-1;default:throw new Error(`Cannot handle type ${ur[t]}`)}}compute(){if(this.rowPartitionValues[0].length<=0)throw new Error("Invalid first partition input. Tensor requires at least one element.");const t=this.getFirstDimensionSize(),r=this.calculateOutputSize(t),s=new Array(this.raggedRank+1);s[s.length-1]=1;for(let u=s.length-2;u>=0;--u)s[u]=s[u+1]*r[u+1];const o=wh(r,!1),i=_n(this.valuesDType,Ce(o));if(s[0]*r[0]>0){let u=this.calculateFirstParentOutputIndex(t,s[0],r[0]);for(let c=1;c<=this.raggedRank;++c)u=this.calculateOutputIndex(c-1,u,s[c],r[c]);this.setOutput(this.raggedRank,u,i,o)}return[o,i]}setOutput(e,t,r,s){if(r.length===0)return;const o=this.values,i=r;let a=s.slice();a=a.slice(e+1);const u=Ce(a),c=t.length;let l=this.defaultValue;if(l.length!==u&&l.length!==1){const g=this.defaultValueShape;Lt(()=>{const C=me(l,g);l=Gi(C,a).dataSync()})}let h=0,d=0,m=0;for(let g=0;g<=c;++g){let C=g<c?t[g]:-1;if(C===m){++m;continue}if(d<m){const $=o.subarray(h*u),T=i.subarray(d*u),A=(m-d)*u;vh(T,$,A)}if(g>=c){const $=r.length;C=Math.floor($/u)}if(C>m)if(this.defaultValue.length===1)i.subarray(m*u,C*u).fill(this.defaultValue[0]),m=C;else for(;C>m;){const $=i.slice(m*u);vh($,l,u),++m}C<0?(h=g+1,d=m):(h=g,d=m,m=d+1)}}}function vh(n,e,t){for(let r=0;r<t;r++)n[r]=e[r]}function wh(n,e){const t=[];for(let r of n){if(r<0){if(!e)throw new Error(`Dimension ${r} must be >= 0`);if(r<-1)throw new Error(`Dimension ${r} must be >= -1`);r=-1}t.push(r)}return t}function T$(n,e,t,r,s,o,i,a,u,c){return new Ha(n,e,t,r,s,o,i,a,u,c).compute()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $$(n,e,t,r){const s=n===e,o=n<e&&t<0,i=e<n&&t>1;if(s||o||i)return zs(0,r);const a=Math.abs(Math.ceil((e-n)/t)),u=zs(a,r);e<n&&t===1&&(t=-1),u[0]=n;for(let c=1;c<u.length;c++)u[c]=u[c-1]+t;return u}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S$=Ks(n=>1/Math.sqrt(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N$(n,e,t,r,s,o,i,a,u,c){const l=[r/s,s],h=n.values,d=e.values;if(r===0)return Ot(t,e.dtype);const m=Ot(l,e.dtype);typeof u=="string"||typeof u=="number"?m.values.fill(u):typeof u=="boolean"&&m.values.fill(+u);for(let g=0;g<o;g++){const C=[];let $=0;for(let T=0;T<i;T++){const A=h[g*i+T];C.push(A),$+=A*a[T]}if($<0||$>=r/s)throw new Error(`Invalid indices: ${C} does not index into ${t}`);for(let T=0;T<s;T++)c?m.values[$*s+T]+=d[g*s+T]:m.values[$*s+T]=e.rank===0?d[0]:d[g*s+T]}return m}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E$=Ks(n=>1/(1+Math.exp(-n)));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k$(n,e,t,r,s){const o=il(r,e,t),i=Ce(t),a=rn(r);if(o){const h=al(e,a);return s==="string"?n.slice(h,h+i):n.subarray(h,h+i)}const u=s==="string"?Zi(n):n,c=Ot(r,s,u),l=Ot(t,s);for(let h=0;h<l.size;++h){const d=l.indexToLoc(h),m=d.map((g,C)=>g+e[C]);l.set(c.get(...m),...d)}return s==="string"?Om(l.values):l.values}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I$(n,e,t,r,s,o,i){const a=e[0],u=o[0],c=new Array(u),l=new Array(a),h=e[1];if(u===0){if(a!==0)throw new Error(bm(a));const $=_n(t,0),T=_n(s,0);return[$,[0,h],T,c,l]}let d=!0,m=0;const g=new Array(u).fill(0);for(let $=0;$<a;++$){const T=n[$*h];if(T<0)throw new Error(vm($,T));if(T>=u)throw new Error(wm($,T,u));++g[T],d=d&&T>=m,m=T}let C=!0;for(let $=0;$<u;++$){const T=g[$]===0;c[$]=T,C=C&&!T,g[$]=Math.max(g[$],1),$>0&&(g[$]+=g[$-1])}if(C&&d){const $=n,T=r;for(let A=0;A<a;++A)l[A]=A;return[$,[a,h],T,c,l]}else{const $=g[u-1],T=_n(t,$*h),A=_n(s,$),P=new Array(u).fill(0);for(let B=0;B<a;++B){const H=n[B*h],x=P[H],re=(H===0?0:g[H-1])+x;P[H]++;for(let oe=0;oe<h;++oe)T[re*h+oe]=n[B*h+oe];A[re]=r[B],l[B]=re}for(let B=0;B<u;++B)if(P[B]===0){const x=B===0?0:g[B-1];T[x*h+0]=B;for(let re=1;re<h;++re)T[x*h+re]=0;A[x]=i}return[T,[$,h],A,c,l]}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function _$(n,e,t,r,s){const o=Ce(r),i=e[0],a=s.length,u=[];let c=1,l=-1;for(let $=0;$<a;++$){const T=s[$];if(T===-1){if(l!==-1)throw new Error(Cm(l,$));l=$,u.push(1)}else{if(T<0)throw new Error(Tm($,T));c*=T,u.push(T)}}if(l!==-1){if(c<=0)throw new Error($m());const $=Math.trunc(o/c);if(c*$!==o)throw new Error(Sm(r,u));u[l]=$}if(Ce(u)!==o)throw new Error(Nm(r,u));const d=r.length,m=[];if(d>0){m[d-1]=1;for(let $=d-2;$>=0;--$)m[$]=m[$+1]*r[$+1]}const g=[];if(a>0){g[a-1]=1;for(let $=a-2;$>=0;--$)g[$]=g[$+1]*u[$+1]}const C=_n(t,i*a);for(let $=0;$<i;++$){let T=0;for(let A=0;A<d;++A)T+=n[$*d+A]*m[A];for(let A=0;A<a;++A)C[$*a+A]=Math.trunc(T/g[A]),T%=g[A]}return[C,[i,a],u]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R$(n,e,t,r,s,o=!1,i=0){const a=r.length,u=[e[0],n.length/e[0]],c=u[1],h=a>0?s[a-1]+1:0;if(h<0)throw new Error(kc());const d=e.slice();d[0]=h;const m=d.reduce((P,B)=>P*B,1),g=_n(t,m);if(a===0)return h>0&&g.fill(i),[g,d];if(h<=0)throw new Error(kc());let C=0,$=1,T=0,A=s[C];for(;;){let P=0;if($<a){if(P=s[$],A===P){++$;continue}if(A>=P)throw new Error(Em())}if(A<0||A>=h)throw new Error(km(A,h));A>T&&g.fill(i,T*c,A*c);for(let B=C;B<$;++B){const H=r[B];if(H<0||H>=u[0])throw new Error(Im(B,r[B],u[0]));for(let x=0;x<c;x++)g[A*c+x]+=n[H*c+x]}if(o)for(let B=0;B<c;B++)g[A*c+B]/=$-C;if(C=$,++$,T=A+1,A=P,$>a)break}return T<h&&g.fill(i,T*c,h*c),[g,d]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const A$=Ks(n=>Math.sqrt(n));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const O$=er((n,e)=>{const t=n-e;return t*t});/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D$(n,e,t,r){const s=Ot(n,e.dtype);for(let o=0;o<s.size;o++){const i=s.indexToLoc(o),a=new Array(i.length);for(let u=0;u<a.length;u++)a[u]=i[u]*t[u]+r[u];s.set(e.get(...a),...i)}return s}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F${constructor(e,t,r,s,o,i){this.separator=To(e),this.nGramWidths=t,this.leftPad=To(r),this.rightPad=To(s),this.padWidth=o,this.preserveShort=i}getPadWidth(e){return Math.min(this.padWidth<0?e-1:this.padWidth,e-1)}getNumNGrams(e,t){const r=this.getPadWidth(t);return Math.max(0,e+2*r-t+1)}createNGrams(e,t,r,s,o,i){for(let a=0;a<o;++a){const u=this.getPadWidth(i),c=Math.max(0,u-a),l=Math.max(0,u-(o-(a+1))),h=i-(c+l),d=t+(c>0?0:a-u);let m=0;m+=c*this.leftPad.length;for(let A=0;A<h;++A)m+=e[d+A].length;m+=l*this.rightPad.length;const g=c+l+h-1;m+=g*this.separator.length,r[s+a]=new Uint8Array(m);const C=r[s+a];let $=0;const T=A=>A.forEach(P=>C[$++]=P);for(let A=0;A<c;++A)T(this.leftPad),T(this.separator);for(let A=0;A<h-1;++A)T(e[d+A]),T(this.separator);if(h>0){T(e[d+h-1]);for(let A=0;A<l;++A)T(this.separator),T(this.rightPad)}else{for(let A=0;A<l-1;++A)T(this.rightPad),T(this.separator);T(this.rightPad)}}}compute(e,t){const r=e.length,s=t.length;if(s>0){let u=t[0];if(u!==0)throw new Error(`First split value must be 0, got ${u}`);for(let c=1;c<s;++c){let l=t[c]>=u;if(l=l&&t[c]<=r,!l)throw new Error(`Invalid split value ${t[c]}, must be in [${u}, ${r}]`);u=t[c]}if(u!==r)throw new Error(`Last split value must be data size. Expected ${r}, got ${u}`)}const o=s-1,i=_n("int32",s);if(r===0||s===0){const u=new Array(r);for(let c=0;c<=o;++c)i[c]=0;return[u,i]}i[0]=0;for(let u=1;u<=o;++u){const c=t[u]-t[u-1];let l=0;this.nGramWidths.forEach(h=>{l+=this.getNumNGrams(c,h)}),this.preserveShort&&c>0&&l===0&&(l=1),i[u]=i[u-1]+l}const a=new Array(i[o]);for(let u=0;u<o;++u){const c=t[u];let l=i[u];if(this.nGramWidths.forEach(h=>{const d=t[u+1]-t[u],m=this.getNumNGrams(d,h);this.createNGrams(e,c,a,l,m,h),l+=m}),this.preserveShort&&l===i[u]){const h=t[u+1]-t[u];if(h===0)continue;const d=h+2*this.padWidth,m=1;this.createNGrams(e,c,a,l,m,d)}}return[a,i]}}function P$(n,e,t,r,s,o,i,a){return new F$(t,r,s,o,i,a).compute(n,e)}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L$(n,e,t,r){if(!n.length)return;if(e.length===0){for(let o=0;o<n.length;++o)r.push(n.subarray(o,o+1));return}if(e.length===1){const o=e[0];let i=n.indexOf(o);for(;i!==-1;){const a=n.subarray(0,i);(!t||a.length!==0)&&r.push(a),n=n.subarray(i+1),i=n.indexOf(o)}(!t||n.length!==0)&&r.push(n);return}let s=0;for(let o=0;o<n.length+1;o++)if(o===n.length||e.indexOf(n[o])!==-1){const i=n.subarray(s,o);(!t||i.length!==0)&&r.push(i),s=o+1}}function B$(n,e,t){const r=n.length,s=[];let o=0,i=0;const a=new Array(r);for(let d=0;d<r;++d){const m=s.length;L$(n[d],e,t,s);const g=s.length-m;a[d]=g,o+=g,i=Math.max(i,g)}const u=_n("int32",o*2),c=new Array(o),l=[r,i];let h=0;for(let d=0;d<r;++d)for(let m=0;m<a[d];++m)u[h*2]=d,u[h*2+1]=m,c[h]=s[h],++h;return[u,c,l]}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M$(n,e){const t=_n("int32",n.length);for(let r=0;r<n.length;++r)t[r]=z0(n[r]).modulo(e).getLowBitsUnsigned();return t}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const V$=er((n,e)=>n-e);/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function U$(n,e){const t=new Array(n.rank);for(let s=0;s<t.length;s++)t[s]=n.shape[s]*e[s];const r=Ot(t,n.dtype);for(let s=0;s<r.values.length;++s){const o=r.indexToLoc(s),i=new Array(n.rank);for(let u=0;u<i.length;u++)i[u]=o[u]%n.shape[u];const a=n.locToIndex(i);r.values[s]=n.values[a]}return r}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wi=(n,e)=>{const t=e.value-n.value;return t===0?n.index-e.index:t};function Hm(n,e,t=0,r=n.length-1){for(;r>t;){if(r-t>600){const a=r-t+1,u=e-t+1,c=Math.log(a),l=.5*Math.exp(2*c/3),h=.5*Math.sqrt(c*l*(a-l)/a)*Math.sign(u-a/2),d=Math.max(t,Math.floor(e-u*l/a+h)),m=Math.min(r,Math.floor(e+(a-u)*l/a+h));Hm(n,e,d,m)}const s=n[e];let o=t,i=r;for(Li(n,t,e),Wi(n[r],s)>0&&Li(n,t,r);o<i;){for(Li(n,o,i),o++,i--;Wi(n[o],s)<0;)o=o+1;for(;Wi(n[i],s)>0;)i=i-1}Wi(n[t],s)===0?Li(n,t,i):(i=i+1,Li(n,i,r)),i<=e&&(t=i+1),e<=i&&(r=i-1)}}function W$(n,e,t,r,s){const o=e[e.length-1],[i,a]=[n.length/o,o],u=vs(t,i*r),c=vs("int32",i*r);for(let h=0;h<i;h++){const d=h*a,m=n.subarray(d,d+a);let g=new Array(m.length);m.forEach((A,P)=>g[P]={value:A,index:P}),r<g.length&&(Hm(g,r),g=g.slice(0,r)),s&&g.sort(Wi);const C=h*r,$=u.subarray(C,C+r),T=c.subarray(C,C+r);for(let A=0;A<r;A++)$[A]=g[A].value,T[A]=g[A].index}const l=e.slice();return l[l.length-1]=r,[Ot(l,t,u),Ot(l,"int32",c)]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z$(n,e,t,r){const s=Zt(e,t)[0],o=[1,t[0],1];for(let g=0;g<s;g++)o[0]*=t[g];o[1]=t[s];for(let g=s+1;g<t.length;g++)o[2]*=t[g];const i={},a=new Int32Array(t[s]),u=new Hi(o,r,n),c=[],l=o[0]===1&&o[2]===1;for(let g=0;g<t[s];g++){let C;if(l)C=n[g].toString();else{const $=[];for(let T=0;T<o[0];T++)for(let A=0;A<o[2];A++)$.push(u.get(T,g,A));C=$.join(",")}if(i[C]!==void 0)a[g]=i[C];else{const $=Object.keys(i).length;i[C]=$,a[g]=$,c.push(g)}}const h=o.slice();h[1]=Object.keys(i).length;const d=new Hi(h,r);c.forEach((g,C)=>{for(let $=0;$<o[0];$++)for(let T=0;T<o[2];T++)d.set(u.get($,g,T),$,C,T)});const m=t.slice();return m[s]=h[1],{outputValues:d.values,outputShape:m,indices:a}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const G$=Object.freeze(Object.defineProperty({__proto__:null,simpleAbsImpl:GT,addImpl:HT,bincountImpl:qT,bincountReduceImpl:XT,castImpl:jT,ceilImpl:KT,concatImpl:YT,equalImpl:QT,expImpl:ZT,expm1Impl:JT,floorImpl:e$,gatherNdImpl:t$,gatherV2Impl:n$,greaterImpl:r$,greaterEqualImpl:s$,lessImpl:o$,lessEqualImpl:i$,linSpaceImpl:a$,logImpl:u$,maxImpl:c$,maximumImpl:l$,minimumImpl:h$,multiplyImpl:jm,negImpl:f$,notEqualImpl:d$,prodImpl:m$,raggedGatherImpl:C$,raggedTensorToTensorImpl:T$,rangeImpl:$$,rsqrtImpl:S$,scatterImpl:N$,sigmoidImpl:E$,sliceImpl:k$,sparseFillEmptyRowsImpl:I$,sparseReshapeImpl:_$,sparseSegmentReductionImpl:R$,sqrtImpl:A$,squaredDifferenceImpl:O$,stridedSliceImpl:D$,stringNGramsImpl:P$,stringSplitImpl:B$,stringToHashBucketFastImpl:M$,subImpl:V$,tileImpl:U$,topKImpl:W$,transposeImpl:p$,uniqueImpl:z$},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const{addImpl:j$,bincountImpl:qm,bincountReduceImpl:H$,castImpl:q$,ceilImpl:X$,concatImpl:K$,equalImpl:Y$,expImpl:Q$,expm1Impl:Z$,floorImpl:J$,gatherNdImpl:eS,gatherV2Impl:tS,greaterImpl:nS,greaterEqualImpl:rS,lessImpl:sS,lessEqualImpl:oS,linSpaceImpl:iS,logImpl:aS,maxImpl:uS,maximumImpl:cS,minimumImpl:lS,multiplyImpl:hS,negImpl:fS,notEqualImpl:dS,prodImpl:pS,raggedGatherImpl:mS,raggedTensorToTensorImpl:gS,rangeImpl:yS,rsqrtImpl:xS,scatterImpl:bS,sigmoidImpl:vS,simpleAbsImpl:Xm,sliceImpl:wS,sparseFillEmptyRowsImpl:CS,sparseReshapeImpl:TS,sparseSegmentReductionImpl:Km,sqrtImpl:$S,stridedSliceImpl:SS,stringNGramsImpl:NS,stringSplitImpl:ES,stringToHashBucketFastImpl:kS,subImpl:IS,tileImpl:_S,topKImpl:RS,transposeImpl:_l,uniqueImpl:AS}=G$;/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ym(n,e){return["x","y","z","w","u","v"].slice(0,e).map(t=>`${n}.${t}`)}function wn(n,e){return e===1?[n]:Ym(n,e)}function OS(n,e){if(n===1)return"rc";let t="";for(let r=0;r<n;r++)t+=e[r],r<n-1&&(t+=",");return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DS{constructor(e){if(this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.enableShapeUniforms=Nn(this.outputShape.length),this.rank===0)this.userCode=`
        void main() {
          setOutput(vec4(getA(), 0., 0., 0.));
        }
      `;else{const t=wn("rc",this.rank),r=Tt(this.rank),s=this.getOutOfBoundsCondition(t),o=this.getSetup(t),i=this.getOutput(t);this.userCode=`
        void main() {
          ${r} rc = getOutputCoords();

          if(${s}) {
            setOutput(vec4(0));
          } else {
            ${o}

            setOutput(vec4(${i}));
          }
        }
      `}}getSourceCoordsArr(e){const t=[];for(let r=0;r<=1;r++)for(let s=0;s<=1;s++){let o=`${r===0?"r":"rp1"}, ${s===0?"c":"cp1"}`;for(let i=2;i<this.rank;i++)o=`${e[e.length-1-i]},`+o;t.push(o)}return t}getOutOfBoundsCondition(e){if(this.rank===1)return`rc > ${this.enableShapeUniforms?"outShape":this.outputShape[0]}`;let t="";for(let r=this.rank-2;r<this.rank;r++)t+=`${e[r]} >= ${this.enableShapeUniforms?`outShape[${r}]`:this.outputShape[r]}`,r<this.rank-1&&(t+="||");return t}getSetup(e){if(this.rank===1)return"";const t=e.slice(-2),r=this.enableShapeUniforms?`outShape[${this.rank} - 1]`:this.outputShape[this.rank-1],s=this.enableShapeUniforms?`outShape[${this.rank} - 2]`:this.outputShape[this.rank-2];return`
      int r = ${t[0]};
      int c = ${t[1]};
      int rp1 = r + 1;
      int cp1 = c + 1;

      bool cEdge = cp1 >= ${r};
      bool rEdge = rp1 >= ${s};
    `}getOutput(e){const t=this.getSourceCoordsArr(e);return this.rank===1?`getA(rc), (rc + 1 >= ${this.enableShapeUniforms?"outShape":this.outputShape[0]} ? 0. : getA(rc + 1)), 0, 0`:`getA(${t[0]}),
            cEdge ? 0. : getA(${t[1]}),
            rEdge ? 0. : getA(${t[2]}),
            rEdge || cEdge ? 0. : getA(${t[3]})`}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qm{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec3"}],this.outputShape=e,this.enableShapeUniforms=Nn(this.outputShape.length);let r="";for(let s=0;s<4;s++){let o="thisRC = rc;";s%2===1&&(o+="thisRC.z += 1;"),s>1&&(o+="thisRC.y += 1;"),r+=`
        ${o}
        ${s>0?"if(thisRC.y < rows && thisRC.z < cols){":""}
          int flatIndex = getFlatIndex(thisRC);

          ivec3 inputRC = inputCoordsFromReshapedOutCoords(flatIndex);
          vec2 inputRCInnerDims = vec2(float(inputRC.y),float(inputRC.z));

          result[${s}] =
            getChannel(getA(inputRC.x, inputRC.y, inputRC.z), inputRCInnerDims);
        ${s>0?"}":""}
      `}this.userCode=`
      ${FS(t,this.enableShapeUniforms)}
      ${this.enableShapeUniforms?kl():El(e)}

      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0.);

        ivec3 thisRC;
        int rows = ${this.enableShapeUniforms?"outShape[1]":e[1]};
        int cols = ${this.enableShapeUniforms?"outShape[2]":e[2]};

        ${r}

        setOutput(result);
      }
    `}}function FS(n,e){return`
    ivec3 inputCoordsFromReshapedOutCoords(int index) {
      ${e?FC(["r","c","d"],"inputShape"):Lo(["r","c","d"],n)}
      return ivec3(r, c, d);
    }
  `}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class PS{constructor(e){this.gpgpu=e,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0,this.freeTextures={},this.logEnabled=!1,this.usedTextures={}}acquireTexture(e,t,r){const s=Th(t,r),o=$h(e,s,r);o in this.freeTextures||(this.freeTextures[o]=[]),o in this.usedTextures||(this.usedTextures[o]=[]);const i=Ch(e,s,this.gpgpu.gl,this.gpgpu.textureConfig,r);if(this.freeTextures[o].length>0){this.numFreeTextures--,this.numUsedTextures++,this._numBytesFree-=i,this.log();const u=this.freeTextures[o].shift();return this.usedTextures[o].push(u),u}let a;return s===nn.PACKED_2X2_FLOAT32?a=this.gpgpu.createPackedMatrixTexture(e[0],e[1]):s===nn.PACKED_2X2_FLOAT16?a=this.gpgpu.createFloat16PackedMatrixTexture(e[0],e[1]):s===nn.UNPACKED_FLOAT32?a=this.gpgpu.createFloat32MatrixTexture(e[0],e[1]):s===nn.UNPACKED_FLOAT16?a=this.gpgpu.createFloat16MatrixTexture(e[0],e[1]):s===nn.PACKED_4X1_UNSIGNED_BYTE&&(a=this.gpgpu.createUnsignedBytesMatrixTexture(e[0],e[1])),this.usedTextures[o].push(a),this.numUsedTextures++,this._numBytesAllocated+=i,this.log(),a}releaseTexture(e,t,r,s){if(this.freeTextures==null)return;const o=Th(r,s),i=$h(t,o,s);i in this.freeTextures||(this.freeTextures[i]=[]);const a=Ch(t,o,this.gpgpu.gl,this.gpgpu.textureConfig,s),u=ue().get("WEBGL_DELETE_TEXTURE_THRESHOLD");u!==-1&&this._numBytesAllocated>u?(this.gpgpu.deleteMatrixTexture(e.texture),this._numBytesAllocated-=a):(this.freeTextures[i].push(e),this.numFreeTextures++,this._numBytesFree+=a),this.numUsedTextures--;const c=this.usedTextures[i],l=c.indexOf(e);if(l<0)throw new Error("Cannot release a texture that was never provided by this texture manager");c.splice(l,1),this.log()}log(){if(!this.logEnabled)return;const e=this.numFreeTextures+this.numUsedTextures;console.log("Free/Used",`${this.numFreeTextures} / ${this.numUsedTextures}`,`(${e})`);const t=this._numBytesFree/this._numBytesAllocated;console.log(`Bytes allocated: ${this._numBytesAllocated}`),console.log(`Bytes unused: ${this._numBytesFree} (${Math.round(100*t)}%)`)}get numBytesAllocated(){return this._numBytesAllocated}get numBytesFree(){return this._numBytesFree}getNumUsedTextures(){return this.numUsedTextures}getNumFreeTextures(){return this.numFreeTextures}dispose(){if(this.freeTextures!=null){for(const e in this.freeTextures)this.freeTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});for(const e in this.usedTextures)this.usedTextures[e].forEach(t=>{this.gpgpu.deleteMatrixTexture(t.texture)});this.freeTextures=null,this.usedTextures=null,this.numUsedTextures=0,this.numFreeTextures=0,this._numBytesAllocated=0,this._numBytesFree=0}}}function LS(n,e){const t=n;if(e===t.R32F)return 4;if(e===t.R16F)return 2;if(e===t.RGBA32F)return 16;if(e===n.RGBA)return 16;if(e===t.RGBA16F)return 8;if(e===t.RGBA8)return 4;throw new Error(`Unknown internal format ${e}`)}function Ch(n,e,t,r,s){const o=BS(e,r);let i;if(s){const[u,c]=$i(n[0],n[1]);i=u*c}else{const[u,c]=aa(n[0],n[1]);i=u*c}const a=LS(t,o);return i*a}function BS(n,e){switch(n){case nn.PACKED_2X2_FLOAT32:return zm(e);case nn.PACKED_2X2_FLOAT16:return Gm(e);case nn.UNPACKED_FLOAT32:return Vm(e);case nn.UNPACKED_FLOAT16:return Um(e);case nn.PACKED_4X1_UNSIGNED_BYTE:return Wm(e);default:throw new Error(`Unknown physical texture type ${n}`)}}function MS(n){return ue().getBool("WEBGL_RENDER_FLOAT32_ENABLED")?n?nn.PACKED_2X2_FLOAT32:nn.UNPACKED_FLOAT32:n?nn.PACKED_2X2_FLOAT16:nn.UNPACKED_FLOAT16}function Th(n,e){if(n===Yn.UPLOAD)return nn.PACKED_2X2_FLOAT32;if(n===Yn.RENDER||n==null)return MS(e);if(n===Yn.DOWNLOAD||n===Yn.PIXELS)return nn.PACKED_4X1_UNSIGNED_BYTE;throw new Error(`Unknown logical texture type ${n}`)}function $h(n,e,t){return`${n[0]}_${n[1]}_${e}_${t}`}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gs{constructor(e,t){this.variableNames=["A"],this.outputShape=e,this.enableShapeUniforms=Nn(this.outputShape.length),this.userCode=`
      float unaryOperation(float x) {
        ${t}
      }

      void main() {
        float x = getAAtOutCoords();
        float y = unaryOperation(x);

        setOutput(y);
      }
    `}}const br="if (isnan(x)) return x;",VS="return x;",Sh="return abs(x);",US="return (x >= 0.0) ? x : (exp(x) - 1.0);",WS=br+`
  return (x < 0.0) ? 0.0 : x;
`,zS=br+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,Jo="return x;",GS="return 1.0 / (1.0 + exp(-1.0 * x));";/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jS="return x;",HS=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,qS=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,XS=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,KS="return 1.0 / (1.0 + exp(-1.0 * x));";class Co{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.enableShapeUniforms=Nn(this.outputShape.length),this.userCode=`
      vec4 unaryOperation(vec4 x) {
        ${t}
      }

      void main() {
        vec4 x = getAAtOutCoords();
        vec4 y = unaryOperation(x);

        setOutput(y);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class YS{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!1,this.outputShape=e,this.enableShapeUniforms=Nn(this.outputShape.length);const t=e.length,r=wn("rc",t),s=Tt(t),o=OS(t,r),i=r.slice(-2),a=t<=1?"rc":`vec2(${i.join(",")})`;this.userCode=`
      void main() {
        ${s} rc = getOutputCoords();
        vec4 packedInput = getA(${o});

        setOutput(getChannel(packedInput, ${a}));
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QS=z2,ZS=1e-7,JS=1e-4,ka={};function e7(n){return n in ka||(ka[n]={}),ka[n]}const t7=ue().getNumber("CPU_HANDOFF_SIZE_THRESHOLD"),n7=600;function r7(){return ue().global.screen==null?1024:ue().global.screen.height*ue().global.screen.width*window.devicePixelRatio*n7/1024/1024}class yu extends pf{constructor(e){if(super(),this.pendingRead=new WeakMap,this.pendingDisposal=new WeakSet,this.dataRefCount=new WeakMap,this.numBytesInGPU=0,this.uploadWaitMs=0,this.downloadWaitMs=0,this.lastGlFlushTime=0,this.warnedAboutMemory=!1,this.pendingDeletes=0,this.disposed=!1,!ue().getBool("HAS_WEBGL"))throw new Error("WebGL is not supported on this device");let t;if(e!=null){if(e instanceof Vu)t=e;else{const r=Br(ue().getNumber("WEBGL_VERSION"),e);t=new Vu(r)}this.binaryCache={},this.gpgpuCreatedLocally=!1}else{const r=Br(ue().getNumber("WEBGL_VERSION"));t=new Vu(r),this.binaryCache=e7(ue().getNumber("WEBGL_VERSION")),this.gpgpuCreatedLocally=!0}this.gpgpu=t,this.canvas=this.gpgpu.gl.canvas,this.textureManager=new PS(this.gpgpu),this.numMBBeforeWarning=r7(),this.texData=new c0(this,Zo())}nextDataId(){return yu.nextDataId++}numDataIds(){return this.texData.numDataIds()-this.pendingDeletes}write(e,t,r){if((ue().getBool("WEBGL_CHECK_NUMERICAL_PROBLEMS")||ue().getBool("DEBUG"))&&this.checkNumericalProblems(e),r==="complex64"&&e!=null)throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");const s={id:this.nextDataId()};return this.texData.set(s,{shape:t,dtype:r,values:e,usage:Yn.UPLOAD,refCount:1}),s}refCount(e){return this.texData.has(e)?this.texData.get(e).refCount:0}incRef(e){const t=this.texData.get(e);t.refCount++}decRef(e){if(this.texData.has(e)){const t=this.texData.get(e);t.refCount--}}move(e,t,r,s,o){if(ue().getBool("DEBUG")&&this.checkNumericalProblems(t),s==="complex64")throw new Error("Cannot write to a complex64 dtype. Please use tf.complex(real, imag).");this.texData.set(e,{shape:r,dtype:s,values:t,usage:Yn.UPLOAD,refCount:o})}disposeIntermediateTensorInfo(e){this.disposeData(e.dataId)}readSync(e){const t=this.texData.get(e),{values:r,dtype:s,complexTensorInfos:o,slice:i,shape:a,isPacked:u}=t;if(i!=null){let d;u?d=new Co(a,Jo):d=new gs(a,Jo);const m=this.runWebGLProgram(d,[{dataId:e,shape:a,dtype:s}],s),g=this.readSync(m.dataId);return this.disposeIntermediateTensorInfo(m),g}if(r!=null)return this.convertAndCacheOnCPU(e);if(s==="string")return r;const c=this.activeTimers!=null;let l;c&&(l=Rr());let h;if(s==="complex64"){const d=this.readSync(o.real.dataId),m=this.readSync(o.imag.dataId);h=Ec(d,m)}else h=this.getValuesFromTexture(e);return c&&(this.downloadWaitMs+=Rr()-l),this.convertAndCacheOnCPU(e,h)}async read(e){if(this.pendingRead.has(e)){const g=this.pendingRead.get(e);return new Promise(C=>g.push(C))}const t=this.texData.get(e),{values:r,shape:s,slice:o,dtype:i,complexTensorInfos:a,isPacked:u}=t;if(o!=null){let g;u?g=new Co(s,Jo):g=new gs(s,Jo);const C=this.runWebGLProgram(g,[{dataId:e,shape:s,dtype:i}],i),$=this.read(C.dataId);return this.disposeIntermediateTensorInfo(C),$}if(r!=null)return this.convertAndCacheOnCPU(e);if(ue().getBool("DEBUG")&&!ue().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")&&ue().getNumber("WEBGL_VERSION")===2)throw new Error("tensor.data() with WEBGL_DOWNLOAD_FLOAT_ENABLED=false and WEBGL_VERSION=2 not yet supported.");let c=null,l;if(i!=="complex64"&&ue().get("WEBGL_BUFFER_SUPPORTED")){l=this.decode(e);const g=this.texData.get(l.dataId);c=this.gpgpu.createBufferFromTexture(g.texture.texture,...$a(s))}this.pendingRead.set(e,[]),i!=="complex64"&&await this.gpgpu.createAndWaitForFence();let h;if(i==="complex64"){const g=await Promise.all([this.read(a.real.dataId),this.read(a.imag.dataId)]),C=g[0],$=g[1];h=Ec(C,$)}else if(c==null)h=this.getValuesFromTexture(e);else{const g=Ce(s);h=this.gpgpu.downloadFloat32MatrixFromBuffer(c,g)}if(l!=null&&this.disposeIntermediateTensorInfo(l),c!=null){const g=this.gpgpu.gl;De(g,()=>g.deleteBuffer(c))}const d=this.convertAndCacheOnCPU(e,h),m=this.pendingRead.get(e);return this.pendingRead.delete(e),m.forEach(g=>g(d)),this.pendingDisposal.has(e)&&(this.pendingDisposal.delete(e),this.disposeData(e)&&Zo().removeDataId(e,this),this.pendingDeletes--),d}readToGPU(e,t={}){const r=this.texData.get(e),{values:s,shape:o,slice:i,dtype:a,isPacked:u,texture:c}=r;if(a==="complex64")throw new Error("Does not support reading texture for complex64 dtype.");if(i!=null){let m;u?m=new Co(o,Jo):m=new gs(o,Jo);const g=this.runWebGLProgram(m,[{dataId:e,shape:o,dtype:a}],a),C=this.readToGPU(g,t);return this.disposeIntermediateTensorInfo(g),C}if(c==null)throw s!=null?new Error("Data is not on GPU but on CPU."):new Error("There is no data on GPU or CPU.");const l=this.decode(e,t.customTexShape),h=Zo().makeTensorFromTensorInfo(l),d=this.texData.get(l.dataId);return Object.assign({tensorRef:h},d.texture)}bufferSync(e){const t=this.readSync(e.dataId);if(e.dtype==="string")try{const r=t.map(s=>fi(s));return Ot(e.shape,e.dtype,r)}catch{throw new Error("Failed to decode encoded string bytes into utf-8")}return Ot(e.shape,e.dtype,t)}checkNumericalProblems(e){if(e!=null)for(let t=0;t<e.length;t++){const r=e[t];if(!uC(r))throw ue().getBool("WEBGL_RENDER_FLOAT32_CAPABLE")?Error(`The value ${r} cannot be represented with your current settings. Consider enabling float32 rendering: 'tf.env().set('WEBGL_RENDER_FLOAT32_ENABLED', true);'`):Error(`The value ${r} cannot be represented on this device.`)}}getValuesFromTexture(e){const{shape:t,dtype:r,isPacked:s}=this.texData.get(e),o=Ce(t);if(ue().getBool("WEBGL_DOWNLOAD_FLOAT_ENABLED")){const d=this.decode(e),m=this.texData.get(d.dataId),g=this.gpgpu.downloadMatrixFromPackedTexture(m.texture.texture,...$a(t)).subarray(0,o);return this.disposeIntermediateTensorInfo(d),g}const i=ue().getBool("WEBGL_PACK")&&s===!0,a=i?Lu(t):t,u=i?new $T(a):new TT(a),c=this.runWebGLProgram(u,[{shape:a,dtype:r,dataId:e}],"float32"),l=this.texData.get(c.dataId),h=this.gpgpu.downloadByteEncodedFloatMatrixFromOutputTexture(l.texture.texture,l.texShape[0],l.texShape[1]).subarray(0,o);return this.disposeIntermediateTensorInfo(c),h}timerAvailable(){return ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0}time(e){const t=this.activeTimers,r=[];let s=!1;this.programTimersStack==null?(this.programTimersStack=r,s=!0):this.activeTimers.push(r),this.activeTimers=r,e();const o=ui(this.activeTimers.map(u=>u.query)).filter(u=>u!=null),i=ui(this.activeTimers.map(u=>u.name)).filter(u=>u!=null);this.activeTimers=t,s&&(this.programTimersStack=null);const a={uploadWaitMs:this.uploadWaitMs,downloadWaitMs:this.downloadWaitMs,kernelMs:null,wallMs:null};return(async()=>{if(ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0){const u=await Promise.all(o);a.kernelMs=l0(u),a.getExtraProfileInfo=()=>u.map((c,l)=>({name:i[l],ms:c})).map(c=>`${c.name}: ${c.ms}`).join(", ")}else a.kernelMs={error:"WebGL query timers are not supported in this environment."};return this.uploadWaitMs=0,this.downloadWaitMs=0,a})()}memory(){return{unreliable:!1,numBytesInGPU:this.numBytesInGPU,numBytesInGPUAllocated:this.textureManager.numBytesAllocated,numBytesInGPUFree:this.textureManager.numBytesFree}}startTimer(){return ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?this.gpgpu.beginQuery():{startMs:Rr(),endMs:null}}endTimer(e){return ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0?(this.gpgpu.endQuery(),e):(e.endMs=Rr(),e)}async getQueryTime(e){if(ue().getNumber("WEBGL_DISJOINT_QUERY_TIMER_EXTENSION_RELIABLE")>0)return this.gpgpu.waitForQueryAndGetTime(e);const t=e;return t.endMs-t.startMs}disposeData(e,t=!1){if(this.pendingDisposal.has(e))return!1;if(!this.texData.has(e))return!0;if(t?this.texData.get(e).refCount=0:this.texData.get(e).refCount--,!t&&this.texData.get(e).refCount>0)return!1;if(this.pendingRead.has(e))return this.pendingDisposal.add(e),this.pendingDeletes++,!1;this.releaseGPUData(e);const{complexTensorInfos:r}=this.texData.get(e);return r!=null&&(this.disposeData(r.real.dataId,t),this.disposeData(r.imag.dataId,t)),this.texData.delete(e),!0}releaseGPUData(e){const{texture:t,dtype:r,texShape:s,usage:o,isPacked:i,slice:a}=this.texData.get(e),u=a&&a.origDataId||e,c=this.dataRefCount.get(u);c>1?this.dataRefCount.set(u,c-1):(this.dataRefCount.delete(u),t!=null&&(this.numBytesInGPU-=this.computeBytes(s,r),this.textureManager.releaseTexture(t,s,o,i)));const l=this.texData.get(e);l.texture=null,l.texShape=null,l.isPacked=!1,l.slice=null}getTexture(e){return this.uploadToGPU(e),this.texData.get(e).texture.texture}getDataInfo(e){return this.texData.get(e)}shouldExecuteOnCPU(e,t=t7){return ue().getBool("WEBGL_CPU_FORWARD")&&e.every(r=>this.texData.get(r.dataId).texture==null&&Ce(r.shape)<t)}getGPGPUContext(){return this.gpgpu}where(e){Fr("tf.where() in webgl locks the UI thread. Call tf.whereAsync() instead");const t=e.dataSync();return QS(e.shape,t)}packedUnaryOp(e,t,r){const s=new Co(e.shape,t),o=this.compileAndRun(s,[e],r);return Zo().makeTensorFromTensorInfo(o)}abs(e){if(this.shouldExecuteOnCPU([e])&&e.dtype!=="complex64"){const s=Xm(this.texData.get(e.dataId).values);return this.makeOutput(e.shape,e.dtype,s)}if(ue().getBool("WEBGL_PACK_UNARY_OPERATIONS"))return this.packedUnaryOp(e,Sh,e.dtype);const t=new gs(e.shape,Sh),r=this.compileAndRun(t,[e]);return Zo().makeTensorFromTensorInfo(r)}makeTensorInfo(e,t,r){let s;if(t==="string"&&r!=null&&r.length>0&&Ja(r[0])){const o=r.map(i=>To(i));s=this.write(o,e,t)}else s=this.write(r,e,t);return this.texData.get(s).usage=null,{dataId:s,shape:e,dtype:t}}makeOutput(e,t,r){return Zo().makeTensorFromTensorInfo(this.makeTensorInfo(e,t,r),this)}unpackTensor(e){const t=new YS(e.shape);return this.runWebGLProgram(t,[e],e.dtype)}packTensor(e){const t=new DS(e.shape),r=!0;return this.runWebGLProgram(t,[e],e.dtype,null,r)}packedReshape(e,t){const r=[mi(e.shape),...gi(e.shape)],s={dtype:e.dtype,shape:r,dataId:e.dataId},o=[mi(t),...gi(t)],i=new Qm(o,r),a=!0,u=[r],c=this.runWebGLProgram(i,[s],e.dtype,u,a);return{dataId:c.dataId,shape:t,dtype:c.dtype}}decode(e,t){const r=this.texData.get(e),{isPacked:s,shape:o,dtype:i}=r;if(t!=null){const d=Ce(o),m=t[0]*t[1]*4;M(d<=m,()=>"customTexShape is too small. Row * Column * 4 should be equal or larger than the size of the tensor data.")}const a=Lu(o);let u;s?u=new CT(a):u=new wT(a);const c=!0,l=[t!=null?t:$a(a)],h=this.runWebGLProgram(u,[{shape:a,dtype:i,dataId:e}],i,l,c,t);return{dtype:i,shape:o,dataId:h.dataId}}runWebGLProgram(e,t,r,s,o=!1,i){const a=this.makeTensorInfo(e.outputShape,r),u=this.texData.get(a.dataId);if(e.packedOutput&&(u.isPacked=!0),e.outPackingScheme===Ji.DENSE){const T=i!=null?i:$a(e.outputShape);u.texShape=T.map(A=>A*2)}if(e.outTexUsage!=null&&(u.usage=e.outTexUsage),Ce(a.shape)===0)return u.values=vs(a.dtype,0),a;const c=[],l=t.map(T=>{if(T.dtype==="complex64")throw new Error("GPGPUProgram does not support complex64 input. For complex64 dtypes, please separate the program into real and imaginary parts.");let A=this.texData.get(T.dataId);if(A.texture==null){if(!e.packedInputs&&Ce(T.shape)<=ue().getNumber("WEBGL_SIZE_UPLOAD_UNIFORM"))return{shape:T.shape,texData:null,isUniform:!0,uniformValues:A.values};e.packedInputs&&(A.isPacked=!0,A.shape=T.shape)}if(this.uploadToGPU(T.dataId),!!A.isPacked!=!!e.packedInputs)T=A.isPacked?this.unpackTensor(T):this.packTensor(T),c.push(T),A=this.texData.get(T.dataId);else if(A.isPacked&&!ja(A.shape,T.shape)){const P=T,B=T.shape;T.shape=A.shape,T=this.packedReshape(T,B),c.push(T),A=this.texData.get(T.dataId),P.shape=B}return{shape:T.shape,texData:A,isUniform:!1}});this.uploadToGPU(a.dataId);const h={shape:a.shape,texData:u,isUniform:!1},d=vT(e,l,h),m=this.getAndSaveBinary(d,()=>xT(this.gpgpu,e,l,h)),g=this.activeTimers!=null;let C;g&&(C=this.startTimer()),ue().get("ENGINE_COMPILE_ONLY")||bT(this.gpgpu,m,l,h,s),c.forEach(T=>this.disposeIntermediateTensorInfo(T)),g&&(C=this.endTimer(C),this.activeTimers.push({name:e.constructor.name,query:this.getQueryTime(C)}));const $=ue().get("WEBGL_FLUSH_THRESHOLD");if($>0){const T=Rr();T-this.lastGlFlushTime>$&&(this.gpgpu.gl.flush(),this.lastGlFlushTime=T)}if(!ue().getBool("WEBGL_LAZILY_UNPACK")&&u.isPacked&&o===!1){const T=this.unpackTensor(a);return this.disposeIntermediateTensorInfo(a),T}return a}compileAndRun(e,t,r,s,o=!1){return r=r||t[0].dtype,this.runWebGLProgram(e,t,r,s,o)}getAndSaveBinary(e,t){return e in this.binaryCache||(this.binaryCache[e]=t()),this.binaryCache[e]}getTextureManager(){return this.textureManager}dispose(){this.disposed||(ue().getBool("IS_TEST")||Object.keys(this.binaryCache).forEach(t=>{this.gpgpu.deleteProgram(this.binaryCache[t].webGLProgram),delete this.binaryCache[t]}),this.textureManager.dispose(),this.canvas!=null&&typeof HTMLCanvasElement<"u"&&this.canvas instanceof HTMLCanvasElement?this.canvas.remove():this.canvas=null,this.gpgpuCreatedLocally&&(this.gpgpu.program=null,this.gpgpu.dispose()),this.disposed=!0)}floatPrecision(){return this.floatPrecisionValue==null&&(this.floatPrecisionValue=Lt(()=>{if(!ue().get("WEBGL_RENDER_FLOAT32_ENABLED")){const e=ue().getBool("DEBUG");ue().set("DEBUG",!1);const t=this.abs(ct(1e-8)).dataSync()[0];if(ue().set("DEBUG",e),t>0)return 32}return 16})),this.floatPrecisionValue}epsilon(){return this.floatPrecision()===32?ZS:JS}uploadToGPU(e){const t=this.texData.get(e),{shape:r,dtype:s,values:o,texture:i,usage:a,isPacked:u}=t;if(i!=null)return;const c=this.activeTimers!=null;let l;c&&(l=Rr());let h=t.texShape;if(h==null&&(h=NC(r,u),t.texShape=h),o!=null){const d=Lu(r);let m,g=h[1],C=h[0];const $=o instanceof Uint8Array||o instanceof Uint8ClampedArray;(u||!$)&&([g,C]=$i(h[0],h[1])),u?m=new NT(d,$):m=new ST(d,$);const T=$?[C,g]:h,A=this.makeTensorInfo(T,s),P=this.texData.get(A.dataId);$?P.usage=Yn.PIXELS:P.usage=Yn.UPLOAD,P.texShape=T,this.gpgpu.uploadDenseMatrixToTexture(this.getTexture(A.dataId),g,C,o);const B=[[C,g]],H=!0,x=this.runWebGLProgram(m,[A],s,B,H),re=this.texData.get(x.dataId);t.texShape=re.texShape,t.isPacked=re.isPacked,t.usage=re.usage,ue().get("ENGINE_COMPILE_ONLY")?this.disposeData(x.dataId):(t.texture=re.texture,t.values=null,this.texData.delete(x.dataId)),this.disposeIntermediateTensorInfo(A),c&&(this.uploadWaitMs+=Rr()-l)}else{const d=this.acquireTexture(h,a,s,u);t.texture=d}}convertAndCacheOnCPU(e,t){const r=this.texData.get(e),{dtype:s}=r;return this.releaseGPUData(e),t!=null&&(r.values=s7(t,s)),r.values}acquireTexture(e,t,r,s){if(this.numBytesInGPU+=this.computeBytes(e,r),!this.warnedAboutMemory&&this.numBytesInGPU>this.numMBBeforeWarning*1024*1024){const o=(this.numBytesInGPU/1024/1024).toFixed(2);this.warnedAboutMemory=!0,console.warn(`High memory usage in GPU: ${o} MB, most likely due to a memory leak`)}return this.textureManager.acquireTexture(e,t,s)}computeBytes(e,t){return e[0]*e[1]*Ju(t)}checkCompileCompletion(){for(const[,e]of Object.entries(this.binaryCache))this.checkCompletion_(e)}async checkCompileCompletionAsync(){const e=[];if(this.gpgpu.parallelCompilationExtension){for(const[,t]of Object.entries(this.binaryCache))e.push(this.checkCompletionAsync_(t));return Promise.all(e)}else{for(const[,t]of Object.entries(this.binaryCache)){const r=new Promise(s=>{try{this.checkCompletion_(t),s(!0)}catch(o){throw o}});e.push(r)}return Promise.all(e)}}async checkCompletionAsync_(e){return this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.parallelCompilationExtension.COMPLETION_STATUS_KHR)?this.checkCompletion_(e):(await W5(),this.checkCompletionAsync_(e))}checkCompletion_(e){if(this.gpgpu.gl.getProgramParameter(e.webGLProgram,this.gpgpu.gl.LINK_STATUS)===!1)throw console.log(this.gpgpu.gl.getProgramInfoLog(e.webGLProgram)),this.gpgpu.gl.getShaderParameter(e.fragmentShader,this.gpgpu.gl.COMPILE_STATUS)===!1?(Dm(e.source,this.gpgpu.gl.getShaderInfoLog(e.fragmentShader)),new Error("Failed to compile fragment shader.")):new Error("Failed to link vertex and fragment shaders.");return!0}getUniformLocations(){for(const[,e]of Object.entries(this.binaryCache)){const{uniformLocations:t,customUniformLocations:r,infLoc:s,nanLoc:o,inShapesLocations:i,inTexShapesLocations:a,outShapeLocation:u,outShapeStridesLocation:c,outTexShapeLocation:l}=Mm(this.gpgpu,e.program,e.webGLProgram);e.uniformLocations=t,e.customUniformLocations=r,e.infLoc=s,e.nanLoc=o,e.inShapesLocations=i,e.inTexShapesLocations=a,e.outShapeLocation=u,e.outShapeStridesLocation=c,e.outTexShapeLocation=l}}}yu.nextDataId=0;function s7(n,e){if(e==="float32"||e==="complex64")return n;if(e==="int32"||e==="bool"){const t=e==="int32"?new Int32Array(n.length):new Uint8Array(n.length);for(let r=0;r<t.length;++r)t[r]=Math.round(n[r]);return t}else throw new Error(`Unknown dtype ${e}`)}/**
 * @license
 * Copyright 2020 Google Inc. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */y1()&&i4("webgl",()=>new yu,2);/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rl=`
  if (isnan(a)) return a;
  if (isnan(b)) return b;
`;class yi{constructor(e,t,r){this.variableNames=["A","B"],this.outputShape=ot(t,r),this.enableShapeUniforms=Nn(this.outputShape.length),this.userCode=`
      float binaryOperation(float a, float b) {
        ${e}
      }

      void main() {
        float a = getAAtOutCoords();
        float b = getBAtOutCoords();
        setOutput(binaryOperation(a, b));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const la=`
  result.r = isNaN.r ? NAN : result.r;
  result.g = isNaN.g ? NAN : result.g;
  result.b = isNaN.b ? NAN : result.b;
  result.a = isNaN.a ? NAN : result.a;
`;class ha{constructor(e,t,r,s=!1){this.variableNames=["A","B"],this.supportsBroadcasting=!0,this.packedInputs=!0,this.packedOutput=!0,this.outputShape=ot(t,r);const o=this.outputShape.length;this.enableShapeUniforms=Nn(o);let i="";if(s)if(o===0||Ce(this.outputShape)===1)i=`
          result.y = 0.;
          result.z = 0.;
          result.w = 0.;
        `;else if(i=`
          ${Tt(o)} coords = getOutputCoords();
        `,o===1)this.enableShapeUniforms?i+=`
            result.y = (coords + 1) >= outShape ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `:i+=`
            result.y = (coords + 1) >= ${this.outputShape[0]} ? 0. : result.y;
            result.z = 0.;
            result.w = 0.;
          `;else{const u=wn("coords",o);this.enableShapeUniforms?i+=`
            bool nextRowOutOfBounds =
              (${u[o-2]} + 1) >= outShape[${o} - 2];
            bool nextColOutOfBounds =
              (${u[o-1]} + 1) >= outShape[${o} - 1];
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `:i+=`
            bool nextRowOutOfBounds =
              (${u[o-2]} + 1) >= ${this.outputShape[o-2]};
            bool nextColOutOfBounds =
              (${u[o-1]} + 1) >= ${this.outputShape[o-1]};
            result.y = nextColOutOfBounds ? 0. : result.y;
            result.z = nextRowOutOfBounds ? 0. : result.z;
            result.w = nextColOutOfBounds || nextRowOutOfBounds ? 0. : result.w;
          `}this.userCode=`
      vec4 binaryOperation(vec4 a, vec4 b) {
        ${e}
      }

      void main() {
        vec4 a = getAAtOutCoords();
        vec4 b = getBAtOutCoords();

        vec4 result = binaryOperation(a, b);
        ${i}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ln(n){const{inputs:e,backend:t}=n,{x:r}=e;return t.incRef(r.dataId),{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}const o7={kernelName:Yc,backendName:"webgl",kernelFunc:Ln};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ys(n){const{inputs:e,backend:t}=n,{real:r,imag:s}=e,o=t.makeTensorInfo(r.shape,"complex64"),i=t.texData.get(o.dataId),a=Ln({inputs:{x:r},backend:t}),u=Ln({inputs:{x:s},backend:t});return i.complexTensorInfos={real:a,imag:u},o}const i7={kernelName:Uf,backendName:"webgl",kernelFunc:Ys};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Zm="return (a < 0.) ? b * a : a;",Jm=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function a7(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{alpha:o}=r,i=t.makeTensorInfo([],"float32",vi(o,"float32")),a=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ha(Jm,s.shape,i.shape):new yi(Zm,s.shape,i.shape),u=t.runWebGLProgram(a,[s,i],"float32");return t.disposeIntermediateTensorInfo(i),u}const u7={kernelName:_d,backendName:"webgl",kernelFunc:a7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eg="return (a < 0.) ? b * a : a;",tg=`
  vec4 aLessThanZero = vec4(lessThan(a, vec4(0.)));
  return (aLessThanZero * (b * a)) + ((vec4(1.0) - aLessThanZero) * a);
`;function c7(n){const{inputs:e,backend:t}=n,{x:r,alpha:s}=e,o=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ha(tg,r.shape,s.shape):new yi(eg,r.shape,s.shape);return t.runWebGLProgram(o,[r,s],"float32")}const l7={kernelName:up,backendName:"webgl",kernelFunc:c7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ii="if (isnan(x)) return x;";function rt({opSnippet:n,packedOpSnippet:e,cpuKernelImpl:t,dtype:r}){return({inputs:s,backend:o})=>{const{x:i}=s,a=o,u=r||i.dtype;if(a.shouldExecuteOnCPU([i])&&t!=null){const h=a.texData.get(i.dataId),d=t(h.values,u);return a.makeTensorInfo(i.shape,u,d)}const c=ue().getBool("WEBGL_PACK_UNARY_OPERATIONS")&&e!=null;let l;return c?l=new Co(i.shape,e):l=new gs(i.shape,n),a.runWebGLProgram(l,[i],u)}}function on({opSnippet:n,packedOpSnippet:e,checkOutOfBounds:t=!1,supportsComplex:r=!1,cpuKernelImpl:s,dtype:o}){return({inputs:i,backend:a})=>{const{a:u,b:c}=i,l=a;if(r&&u.dtype==="complex64"){const g=l.texData.get(u.dataId),C=l.texData.get(c.dataId),[$,T]=[[g.complexTensorInfos.real,C.complexTensorInfos.real],[g.complexTensorInfos.imag,C.complexTensorInfos.imag]].map(P=>{const[B,H]=P,x={dataId:B.dataId,dtype:B.dtype,shape:u.shape},re={dataId:H.dataId,dtype:H.dtype,shape:c.shape},oe=new yi(n,u.shape,c.shape);return l.runWebGLProgram(oe,[x,re],rs(B.dtype,H.dtype))}),A=Ys({inputs:{real:$,imag:T},backend:l});return l.disposeIntermediateTensorInfo($),l.disposeIntermediateTensorInfo(T),A}const h=o||rs(u.dtype,c.dtype);if((u.dtype==="string"||c.dtype==="string"||l.shouldExecuteOnCPU([u,c]))&&s!=null){const g=l.texData.get(u.dataId).values,C=l.texData.get(c.dataId).values,$=u.dtype==="string"?Zi(g):g,T=u.dtype==="string"?Zi(C):C,[A,P]=s(u.shape,c.shape,$,T,h),B=l.makeTensorInfo(P,h),H=l.texData.get(B.dataId);return H.values=A,B}const d=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")&&e!=null;let m;return d?m=new ha(e,u.shape,c.shape,t):m=new yi(n,u.shape,c.shape),l.runWebGLProgram(m,[u,c],h)}}function ea(n,e=!1){if(n==="linear")return e?jS:VS;if(n==="relu")return e?qS:WS;if(n==="elu")return e?HS:US;if(n==="relu6")return e?XS:zS;if(n==="prelu")return e?tg:eg;if(n==="leakyrelu")return e?Jm:Zm;if(n==="sigmoid")return e?KS:GS;throw new Error(`Activation ${n} has not been implemented for the WebGL backend.`)}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ng{constructor(e,t,r,s=!1,o=!1,i=!1,a=null,u=!1,c=!1){this.variableNames=["matrixA","matrixB"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=r,this.enableShapeUniforms=Nn(this.outputShape.length);const l=s?e[1]:e[2],h=Math.ceil(l/2),d=s?"i * 2, rc.y":"rc.y, i * 2",m=o?"rc.z, i * 2":"i * 2, rc.z",g=s?["a.xxyy","a.zzww"]:["a.xxzz","a.yyww"],C=o?["b.xzxz","b.ywyw"]:["b.xyxy","b.zwzw"];let $="",T="";a&&(u?$=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${a}
        }`:c?$=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${a}
        }`:$=`vec4 activation(vec4 x) {
          ${a}
        }`,T="result = activation(result);");const A=i?"result += getBiasAtOutCoords();":"";i&&this.variableNames.push("bias"),u&&this.variableNames.push("preluActivationWeights"),c&&this.variableNames.push("leakyreluAlpha");let P="rc.x",B="rc.x";e[0]<t[0]?P=`int(min(float(rc.x), ${e[0]-1}.))`:t[0]<e[0]&&(B=`int(min(float(rc.x), ${t[0]-1}.))`),this.userCode=`
      ${$}
      // Don't use uniform for sharedDimensionPacked for performance.
      const float sharedDimension = ${h}.0;

      vec4 dot2x2ARowBCol(ivec3 rc) {
        vec4 result = vec4(0);
        for (int i = 0; i < ${h}; i++) {
          int batchA = ${P};
          int batchB = ${B};
          vec4 a = getMatrixA(batchA, ${d});
          vec4 b = getMatrixB(batchB, ${m});

          // These swizzled products need to be separately added.
          // See: https://github.com/tensorflow/tfjs/issues/1735
          result += (${g[0]} * ${C[0]});
          result += (${g[1]} * ${C[1]});
        }
        return result;
      }

      void main() {
        ivec3 rc = getOutputCoords();
        vec4 result = dot2x2ARowBCol(rc);

        ${A}

        ${T}

        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Nh={REAL:"return areal * breal - aimag * bimag;",IMAG:"return areal * bimag + aimag * breal;"};class Eh{constructor(e,t,r){this.variableNames=["AReal","AImag","BReal","BImag"],this.outputShape=ot(t,r),this.userCode=`
      float binaryOpComplex(
          float areal, float aimag, float breal, float bimag) {
        ${e}
      }

      void main() {
        float areal = getARealAtOutCoords();
        float aimag = getAImagAtOutCoords();
        float breal = getBRealAtOutCoords();
        float bimag = getBImagAtOutCoords();
        setOutput(binaryOpComplex(areal, aimag, breal, bimag));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kh="return a * b;";function Al(n){const{inputs:e,backend:t}=n,{a:r,b:s}=e,o=rs(r.dtype,s.dtype);if(r.dtype==="complex64"){const a=t.texData.get(r.dataId),u=t.texData.get(s.dataId),c=new Eh(Nh.REAL,r.shape,s.shape),l=new Eh(Nh.IMAG,r.shape,s.shape),h=[{dataId:a.complexTensorInfos.real.dataId,dtype:a.complexTensorInfos.real.dtype,shape:r.shape},{dataId:a.complexTensorInfos.imag.dataId,dtype:a.complexTensorInfos.imag.dtype,shape:r.shape},{dataId:u.complexTensorInfos.real.dataId,dtype:u.complexTensorInfos.real.dtype,shape:s.shape},{dataId:u.complexTensorInfos.imag.dataId,dtype:u.complexTensorInfos.imag.dtype,shape:s.shape}],d=t.runWebGLProgram(c,h,"float32"),m=t.runWebGLProgram(l,h,"float32"),g=Ys({inputs:{real:d,imag:m},backend:t});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(m),g}if(t.shouldExecuteOnCPU([r,s])){const a=t.texData.get(r.dataId),u=t.texData.get(s.dataId),[c,l]=hS(r.shape,s.shape,a.values,u.values,o),h=t.makeTensorInfo(l,o),d=t.texData.get(h.dataId);return d.values=c,h}let i;return ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?i=new ha(kh,r.shape,s.shape):i=new yi(kh,r.shape,s.shape),t.runWebGLProgram(i,[r,s],o)}const h7={kernelName:Qd,backendName:"webgl",kernelFunc:Al};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f7(n,e,t){const r=[mi(n.shape),...gi(n.shape)],s={dtype:n.dtype,shape:r,dataId:n.dataId},o=[mi(e),...gi(e)],i=new Qm(o,r),a=!0,u=[r],c=t.runWebGLProgram(i,[s],n.dtype,u,a);return{dataId:c.dataId,shape:e,dtype:c.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ke(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{shape:o}=r,i=t,a=Ce(s.shape),u=h0(o,a),c=Ce(u);M(a===c,()=>`The new shape (${u}) has ${c} elements and the old shape (${s.shape}) has ${a} elements. The new shape and old shape must have the same number of elements.`);const l=i.texData.get(s.dataId);return l.isPacked&&!ja(s.shape,u)&&!(l.texture!==null&&ja(l.shape,u))?f7(s,u,i):(i.incRef(s.dataId),{dataId:s.dataId,shape:u,dtype:s.dtype})}const d7={kernelName:gp,backendName:"webgl",kernelFunc:ke};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ih{constructor(e,t){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:o,outSize:i}=e;this.outputShape=[s,i];const a=Math.floor(r/4)*4,u=r%4;let c="sumValue += dot(values, ones);";if(t!=null){const h=1/t;c=`sumValue += dot(values * ${ci(h)?h.toPrecision(2):h}, ones);`}let l="";o%r>0&&(l=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return 0.0;
        }
      `),this.userCode=`
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${l}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        float sumValue = 0.0;

        for (int i = 0; i < ${a}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${c}
        }

        int inIdx = inOffset + ${a};
        if (${u===1}) {
          vec4 values = vec4(getValue(batch, inIdx), 0.0, 0.0, 0.0);

          ${c}
        } else if (${u===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1), 0.0, 0.0);

          ${c}
        } else if (${u===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2), 0.0);

          ${c}
        }
        setOutput(sumValue);
      }
    `}}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class p7{constructor(e,t){this.variableNames=["x"];const{windowSize:r,batchSize:s,inSize:o,outSize:i}=e;this.outputShape=[s,i];let a="0.0",u="";t==="prod"?a="1.0":t==="min"?(a="1.0 / 1e-20",u="min"):t==="max"&&(a="-1.0 / 1e-20",u="max");let c=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="sum"?c="sumValue":t==="prod"?c="prodValue":t==="all"?c="allValue":t==="any"&&(c="anyValue");const l=Math.floor(r/4)*4,h=r%4;let d=`
      if (${t==="sum"}) {
        sumValue += dot(values, ones);
      } else if (${t==="prod"}) {
        vec2 tmp = vec2(values[0], values[1]) * vec2(values[2], values[3]);
        prodValue *= tmp[0] * tmp[1];
      } else {
        minMaxValue = ${u}(values, minMaxValue);
        if (${t==="min"} || ${t==="max"}) {
          minMaxValue = ${u}(values, minMaxValue);
          bvec4 isNaN = isnan(values);
          if (isNaN.r || isNaN.g || isNaN.b || isNaN.a) {
            minMaxValue = vec4(NAN);
          }
        }
      }
    `,m="vec4";t==="all"?(a="1.0",d=`
        bool reducedAllValue = all(values);
        float floatedReducedAllValue = float(reducedAllValue);
        allValue = float(allValue >= 1.0 && floatedReducedAllValue >= 1.0);
      `,m="bvec4"):t==="any"&&(a="0.0",d=`
        bool reducedAnyValue = any(values);
        float floatedReducedAnyValue = float(reducedAnyValue);
        anyValue = float(anyValue >= 1.0 || floatedReducedAnyValue >= 1.0);
      `,m="bvec4");let g="";o%r>0&&(g=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `),this.userCode=`
      const float initializationValue = ${a};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float getValue(int batch, int inIdx) {
        ${g}
        return getX(batch, inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${r};

        vec4 minMaxValue = vec4(${a});
        float prodValue = 1.0;
        float sumValue = 0.0;
        float allValue = 1.0;
        float anyValue = 0.0;

        for (int i = 0; i < ${l}; i += 4) {
          int inIdx = inOffset + i;
          ${m} values = ${m}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          ${d}
        }

        int inIdx = inOffset + ${l};
        if (${h===1}) {
          ${m} values = ${m}(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${h===2}) {
          ${m} values = ${m}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          ${d}
        } else if (${h===3}) {
          ${m} values = ${m}(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          ${d}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m7(n){const e=[];for(;e.length===0||e[e.length-1].outSize!==1;){const t=e.length?e[e.length-1].outSize:n[1],r=mu(t);e.push({inSize:t,windowSize:r,outSize:Math.ceil(t/r)})}return e}function Mo(n,e,t,r){const s=m7(n.shape);let o=n;for(let i=0;i<s.length;i++){const{inSize:a,windowSize:u,outSize:c}=s[i];let l,h;t==="mean"?l=i===0?new Ih({windowSize:u,inSize:a,batchSize:n.shape[0],outSize:c},a):new Ih({windowSize:u,inSize:a,batchSize:n.shape[0],outSize:c}):l=new p7({windowSize:u,inSize:a,batchSize:n.shape[0],outSize:c},t),h=o,o=r.runWebGLProgram(l,[o],e),h.dataId!==n.dataId&&r.disposeIntermediateTensorInfo(h)}return o}/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class g7{constructor(e,t){this.variableNames=["A"];const r=new Array(e.length);for(let i=0;i<r.length;i++)r[i]=e[t[i]];this.outputShape=r,this.rank=r.length;const s=Tt(this.rank),o=y7(t);this.userCode=`
    void main() {
      ${s} resRC = getOutputCoords();
      setOutput(getA(${o}));
    }
    `}}function y7(n){const e=n.length;if(e>6)throw Error(`Transpose for rank ${e} is not yet supported`);const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u","resRC.v"],r=new Array(e);for(let s=0;s<n.length;s++)r[n[s]]=t[s];return r.join()}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class x7{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0;const r=new Array(e.length);for(let l=0;l<r.length;l++)r[l]=e[t[l]];if(this.outputShape=r,this.rank=r.length,this.rank>6)throw Error(`Packed transpose for rank ${this.rank} is not yet supported.`);const s=Tt(this.rank),o=Ym("rc",this.rank),i=new Array(this.rank);for(let l=0;l<t.length;l++)i[t[l]]=o[l];const a=`vec2(${i.slice(-2).join()})`,u=`++${o[this.rank-1]} < ${r[this.rank-1]}`,c=`getChannel(getA(${i.join()}), ${a})`;this.userCode=`
    void main() {
      ${s} rc = getOutputCoords();
      vec4 result = vec4(0.);
      result[0] = ${c};
      if(${u}) {
        result[1] = ${c};
      }
      --${o[this.rank-1]};
      if(++${o[this.rank-2]} < ${r[this.rank-2]}) {
        result[2] = ${c};
        if(${u}) {
          result[3] = ${c};
        }
      }
      setOutput(result);
    }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xu(n,e,t){const r=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new x7(n.shape,e):new g7(n.shape,e);return t.runWebGLProgram(r,[n],n.dtype)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b7(n,e,t,r){const s=e,o=n.shape.length,i=Zt(s,n.shape);let a=i;const u=yr(a,o),c=u!=null;let l=n;c&&(l=xu(n,u,r),a=xr(a.length,o)),Vr("sum",a,o);const[h,d]=ss(l.shape,a);let m=h;t&&(m=Jn(h,i));const g=Ce(d),$=Ce(n.shape)/g,T=ke({inputs:{x:l},attrs:{shape:[$,g]},backend:r}),A=Jc(n.dtype),P=Mo(T,A,"sum",r),B=ke({inputs:{x:P},attrs:{shape:m},backend:r});return r.disposeIntermediateTensorInfo(T),r.disposeIntermediateTensorInfo(P),c&&r.disposeIntermediateTensorInfo(l),B}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bu(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:o,keepDims:i}=r;return b7(s,o,i,t)}const v7={kernelName:Dp,backendName:"webgl",kernelFunc:bu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $n(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{perm:o}=r,i=t,a=s.shape.length,u=new Array(a);for(let l=0;l<u.length;l++)u[l]=s.shape[o[l]];let c;if(i.shouldExecuteOnCPU([s])){const h=i.texData.get(s.dataId).values,d=_l(h,s.shape,s.dtype,o,u);c=i.makeTensorInfo(u,s.dtype);const m=i.texData.get(c.dataId);m.values=d}else c=xu(s,o,i);return c}const w7={kernelName:_a,backendName:"webgl",kernelFunc:$n};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rg=1e3;function qa({a:n,b:e,transposeA:t,transposeB:r,backend:s,bias:o=null,preluActivationWeights:i=null,leakyreluAlpha:a=0,activation:u=null}){const c=n.shape.length,l=e.shape.length,h=t?n.shape[c-2]:n.shape[c-1],d=r?e.shape[l-1]:e.shape[l-2],m=t?n.shape[c-1]:n.shape[c-2],g=r?e.shape[l-2]:e.shape[l-1],C=n.shape.slice(0,-2),$=e.shape.slice(0,-2),T=Ce(C),A=Ce($),B=ot(n.shape.slice(0,-2),e.shape.slice(0,-2)).concat([m,g]);M(h===d,()=>`Error in matMul: inner shapes (${h}) and (${d}) of Tensors with shapes ${n.shape} and ${e.shape} and transposeA=${t} and transposeB=${r} must match.`);const H=t?[T,h,m]:[T,m,h],x=r?[A,g,d]:[A,d,g],re=ke({inputs:{x:n},backend:s,attrs:{shape:H}}),oe=ke({inputs:{x:e},backend:s,attrs:{shape:x}}),ie=[re,oe],le=Math.max(T,A),$e=t?re.shape[1]:re.shape[2],Ie=o!=null,Ae=i!=null,Ge=u==="leakyrelu",Ye=u!=null?ea(u,!0):null,at=Ie||Ae||Ge||Ye!=null;let ut;if((m===1||g===1)&&$e>rg&&at===!1){let Dt=re,an=oe;t&&(Dt=$n({inputs:{x:re},backend:s,attrs:{perm:[0,2,1]}}),ie.push(Dt)),r&&(an=$n({inputs:{x:oe},backend:s,attrs:{perm:[0,2,1]}}),ie.push(an));const gt=g!==1,vr=g===1;let dn=Dt;gt&&(dn=ke({inputs:{x:Dt},backend:s,attrs:{shape:[le,$e,1]}}),ie.push(dn));const wr=g===1?2:1;let Cr=an;vr&&(Cr=ke({inputs:{x:an},backend:s,attrs:{shape:[le,1,$e]}}),ie.push(Cr));const En=Al({inputs:{a:dn,b:Cr},backend:s});ut=bu({inputs:{x:En},backend:s,attrs:{axis:wr,keepDims:!0}}),ie.push(En)}else{const Dt=rs(n.dtype,e.dtype),an=new ng(H,x,[le,m,g],t,r,Ie,Ye,Ae,Ge),gt=[re,oe];if(o!=null&&gt.push(o),Ae&&gt.push(i),Ge){const vr=s.makeTensorInfo([],"float32",vi(a,"float32"));gt.push(vr),ie.push(vr)}ut=s.runWebGLProgram(an,gt,Dt)}const lt=ke({inputs:{x:ut},backend:s,attrs:{shape:B}});ie.push(ut);for(const Dt of ie)s.disposeIntermediateTensorInfo(Dt);return lt}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function C7(n){const{inputs:e,backend:t,attrs:r}=n,{a:s,b:o,bias:i,preluActivationWeights:a}=e,{transposeA:u,transposeB:c,activation:l,leakyreluAlpha:h}=r;return qa({a:s,b:o,transposeA:u,transposeB:c,backend:t,bias:i,preluActivationWeights:a,leakyreluAlpha:h,activation:l})}const T7={kernelName:sc,backendName:"webgl",kernelFunc:C7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _h="return abs(x);";function $7(n){const{inputs:e,backend:t}=n,{x:r}=e;if(t.shouldExecuteOnCPU([r])&&r.dtype!=="complex64"){const o=t.texData.get(r.dataId),i=Xm(o.values);return t.makeTensorInfo(r.shape,r.dtype,i)}let s;return ue().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new Co(r.shape,_h):s=new gs(r.shape,_h),t.runWebGLProgram(s,[r],r.dtype)}const S7={kernelName:vf,backendName:"webgl",kernelFunc:$7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const N7=br+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return acos(x);
`,E7=rt({opSnippet:N7}),k7={kernelName:wf,backendName:"webgl",kernelFunc:E7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const I7=br+`
  if (x < 1.0) return NAN;
return log(x + sqrt(x * x - 1.0));`,_7=rt({opSnippet:I7}),R7={kernelName:Cf,backendName:"webgl",kernelFunc:_7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Rh="return a + b;",A7=on({opSnippet:Rh,packedOpSnippet:Rh,supportsComplex:!0,cpuKernelImpl:j$}),O7={kernelName:Xc,backendName:"webgl",kernelFunc:A7};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class D7{constructor(e,t){this.outputShape=[],this.outputShape=e,this.variableNames=t.map((o,i)=>`T${i}`);const r=[];this.variableNames.forEach(o=>{r.push(`float v${o} = get${o}AtOutCoords();`)});const s=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        float result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F7{constructor(e,t){this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.variableNames=t.map((o,i)=>`T${i}`);const r=[];this.variableNames.forEach(o=>{r.push(`vec4 v${o} = get${o}AtOutCoords();`)});const s=this.variableNames.map(o=>`v${o}`).join(" + ");this.userCode=`
      void main() {
        ${r.join(`
        `)}

        vec4 result = ${s};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oa(n){const{inputs:e,backend:t}=n,r=e;if(r.length===1)return Ln({inputs:{x:r[0]},backend:t});if(r.length>ue().get("WEBGL_MAX_TEXTURES_IN_SHADER")){const u=Math.floor(r.length/2),c=Oa({inputs:r.slice(0,u),backend:t}),l=Oa({inputs:r.slice(u),backend:t});return Oa({inputs:[c,l],backend:t})}const s=r.map(u=>u.dtype).reduce((u,c)=>rs(u,c)),o=r.map(u=>u.shape),a=ue().getBool("WEBGL_PACK")?new F7(r[0].shape,o):new D7(r[0].shape,o);return t.runWebGLProgram(a,r,s)}const P7={kernelName:Tf,backendName:"webgl",kernelFunc:Oa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L7(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,u=Zt(o,s.shape);let c=u;const l=yr(c,a);let h=s;l!=null&&(h=$n({inputs:{x:s},backend:t,attrs:{perm:l}}),c=xr(c.length,a)),Vr("all",c,a);const[d,m]=ss(h.shape,c),g=Ce(m),C=ke({inputs:{x:h},backend:t,attrs:{shape:[-1,g]}}),$=Mo(C,C.dtype,"all",t);let T;if(i){const A=Jn(d,u);T=ke({inputs:{x:$},backend:t,attrs:{shape:A}})}else T=ke({inputs:{x:$},backend:t,attrs:{shape:d}});return t.disposeIntermediateTensorInfo(C),t.disposeIntermediateTensorInfo($),l!=null&&t.disposeIntermediateTensorInfo(h),T}const B7={kernelName:$f,backendName:"webgl",kernelFunc:L7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function M7(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,u=Zt(o,s.shape);let c=u;const l=yr(c,a);let h=s;l!=null&&(h=$n({inputs:{x:s},backend:t,attrs:{perm:l}}),c=xr(c.length,a)),Vr("any",c,a);const[d,m]=ss(h.shape,c),g=Ce(m),C=ke({inputs:{x:h},backend:t,attrs:{shape:[-1,g]}}),$=Mo(C,C.dtype,"any",t);let T;if(i){const A=Jn(d,u);T=ke({inputs:{x:$},backend:t,attrs:{shape:A}})}else T=ke({inputs:{x:$},backend:t,attrs:{shape:d}});return t.disposeIntermediateTensorInfo(C),t.disposeIntermediateTensorInfo($),l!=null&&t.disposeIntermediateTensorInfo(h),T}const V7={kernelName:Sf,backendName:"webgl",kernelFunc:M7};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class U7{constructor(e,t,r){this.variableNames=["A"];const{windowSize:s,batchSize:o,outSize:i}=e;r||this.variableNames.push("bestIndicesA"),this.outputShape=[o,i];const a=t==="max"?">":"<",u=r?"inOffset + i;":"round(getBestIndicesA(batch, inOffset + i));";this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = outIdx * ${s};

        int bestIndex = inOffset;
        float bestValue = getA(batch, bestIndex);

        for (int i = 0; i < ${s}; i++) {
          int inIdx = ${u};
          float candidate = getA(batch, inIdx);
          if (candidate ${a} bestValue) {
            bestValue = candidate;
            bestIndex = inIdx;
          }
        }
        setOutput(float(bestIndex));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class W7{constructor(e,t,r,s){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,M(e.length>2,()=>`Packed arg${r.charAt(0).toUpperCase()+r.slice(1)} supports only inputs with rank above 2.`);const o=e[e.length-1],i=Math.ceil(o/t);this.outputShape=e.slice(0,-1),i>1&&this.outputShape.push(i),s||this.variableNames.push("bestIndicesA");const a=this.outputShape,u=a.length,c=Tt(u),l=wn("coords",u);let h,d;if(i===1){d=u+1;const oe=Tt(d);h=`
        ${oe} sourceLocR = ${oe}(${l.join()}, 0);
        ++${l[u-1]};
        ${oe} sourceLocG = ${oe}(${l.join()}, 0);
        ++${l[u-2]};
        ${oe} sourceLocA = ${oe}(${l.join()}, 0);
        --${l[u-1]};
        ${oe} sourceLocB = ${oe}(${l.join()}, 0);
        --${l[u-2]};`}else d=u,h=`
        ${c} sourceLocR = coords;
        ++${l[u-1]};
        ${c} sourceLocG = coords;
        ++${l[u-2]};
        ${c} sourceLocA = coords;
        --${l[u-1]};
        ${c} sourceLocB = coords;
        --${l[u-2]};`;const m=["x","y","z","w","u","v"].slice(0,d),g="."+m[d-1],C=m.map(oe=>"int "+oe),$=wn("sourceLocR",d-1).concat("inIdx.r"),T=wn("sourceLocG",d-1).concat("inIdx.g"),A=wn("sourceLocB",d-1).concat("inIdx.b"),P=wn("sourceLocA",d-1).concat("inIdx.a"),B=r==="max"?"greaterThan":"lessThan",H=s?"":`
          inIdx = round(vec4(getBestIndicesAChannel(${$.join()}),
                             getBestIndicesAChannel(${T.join()}),
                             getBestIndicesAChannel(${A.join()}),
                             getBestIndicesAChannel(${P.join()})));`,x=`vec4(
            getAChannel(${$.join()}),
            hasNextCol ? getAChannel(${T.join()}) : 0.,
            hasNextRow ? getAChannel(${A.join()}) : 0.,
            hasNextRow && hasNextCol ? getAChannel(${P.join()}) : 0.)`,re=s?"":`
      float getBestIndicesAChannel(${C.join()}) {
        return getChannel(getBestIndicesA(${m.join()}),
                                          vec2(${m.slice(-2).join()}));
      }`;this.userCode=`
      float getAChannel(${C.join()}) {
        return getChannel(getA(${m.join()}),
                               vec2(${m.slice(-2).join()}));
      }
      ${re}
      void main() {
        ${c} coords = getOutputCoords();
        bool hasNextCol = ${l[u-1]} < ${a[u-1]-1};
        bool hasNextRow = ${l[u-2]} < ${a[u-2]-1};
        ${h}
        ivec4 srcIdx = ivec4(sourceLocR${g}, sourceLocG${g},
          sourceLocB${g}, sourceLocA${g}) * ${t};
        ivec4 inIdx = srcIdx;
        vec4 bestIndex = vec4(inIdx);
        vec4 bestValue = ${x};

        for (int i = 0; i < ${t}; i++) {
          inIdx = srcIdx;
          ${H}
          vec4 candidate = ${x};
          bvec4 nan = isnan(candidate);
          bvec4 replace = bvec4(
            vec4(${B}(candidate, bestValue)) * (vec4(1.0) - vec4(nan)));

          bestValue = vec4(replace.x  ? candidate.x : bestValue.x,
                           replace.y  ? candidate.y : bestValue.y,
                           replace.z  ? candidate.z : bestValue.z,
                           replace.w  ? candidate.w : bestValue.w);
          bestIndex = mix(bestIndex, vec4(inIdx), vec4(replace));
          srcIdx++;
        }
        setOutput(bestIndex);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function sg(n,e,t,r=null){let s=e.shape[0],o=e.shape[1];r!=null&&(s=r.shape[0],o=r.shape[1]);const i=mu(o),a={windowSize:i,inSize:o,batchSize:s,outSize:Math.ceil(o/i)},u=new U7(a,t,r==null),c=[e];r!=null&&c.push(r);const l=n.runWebGLProgram(u,c,"int32");if(l.shape[1]===1)return l;const h=sg(n,e,t,l);return n.disposeIntermediateTensorInfo(l),h}function og(n,e,t,r=null){const s=r!=null?r.shape:e.shape,o=s[s.length-1],i=mu(o),a=new W7(s,i,t,r==null),u=r==null?[e]:[e,r],c=n.runWebGLProgram(a,u,"int32");if(c.shape.length===e.shape.length){const l=og(n,e,t,c);return n.disposeIntermediateTensorInfo(c),l}return c}function ig(n,e,t,r){const s=[t];if(Vr("arg"+r.charAt(0).toUpperCase()+r.slice(1),s,e.shape.length),!ue().getBool("WEBGL_PACK_REDUCE")||e.shape.length<=2){const o=[],i=n.texData.get(e.dataId),a=i!==null&&i.isPacked;let u=e;a&&(u=n.unpackTensor(e),o.push(u));const[c,l]=ss(u.shape,s),h=Ce(l),d=ke({inputs:{x:u},backend:n,attrs:{shape:[-1,h]}});o.push(d);const m=sg(n,d,r);o.push(m);const g=ke({inputs:{x:m},backend:n,attrs:{shape:c}});return o.forEach(C=>n.disposeIntermediateTensorInfo(C)),g}return og(n,e,r)}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function z7(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:o}=r;let i=Zt(o,s.shape);const a=yr(i,s.shape.length);let u=s;const c=[];a!=null&&(u=$n({inputs:{x:s},backend:t,attrs:{perm:a}}),c.push(u),i=xr(i.length,u.shape.length)),Vr("argMax",[i[0]],u.shape.length);const l=ig(t,u,i[0],"max");return c.forEach(h=>t.disposeIntermediateTensorInfo(h)),l}const G7={kernelName:Nf,backendName:"webgl",kernelFunc:z7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function j7(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:o}=r;let i=Zt(o,s.shape);const a=yr(i,s.shape.length);let u=s;const c=[];a!=null&&(u=$n({inputs:{x:s},backend:t,attrs:{perm:a}}),c.push(u),i=xr(i.length,u.shape.length)),Vr("argMin",[i[0]],u.shape.length);const l=ig(t,u,i[0],"min");return c.forEach(h=>t.disposeIntermediateTensorInfo(h)),l}const H7={kernelName:Ef,backendName:"webgl",kernelFunc:j7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const q7=br+`
  if (abs(x) > 1.) {
    return NAN;
  }
  return asin(x);
`,X7=rt({opSnippet:q7}),K7={kernelName:kf,backendName:"webgl",kernelFunc:X7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Y7=br+"return log(x + sqrt(x * x + 1.0));",Q7=rt({opSnippet:Y7}),Z7={kernelName:If,backendName:"webgl",kernelFunc:Q7};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const J7=br+`
  return atan(x);
`,e8=rt({opSnippet:J7}),t8={kernelName:_f,backendName:"webgl",kernelFunc:e8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const n8=Rl+`
  return atan(a, b);
`,r8=`
  vec4 result = atan(a, b);
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+la+`
  return result;
`,s8=on({opSnippet:n8,packedOpSnippet:r8}),o8={kernelName:Af,backendName:"webgl",kernelFunc:s8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i8=br+`
  if ((x < -1.0) || (x > 1.0)) return NAN;
return (log(1.0 + x) - log(1.0 - x)) / 2.0;`,a8=rt({opSnippet:i8}),u8={kernelName:Rf,backendName:"webgl",kernelFunc:a8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ta{constructor(e,t,r,s=!1,o=!1){if(this.variableNames=["x"],t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideHeight,u=e.strideWidth,c=e.dilationHeight,l=e.dilationWidth,h=e.effectiveFilterHeight,d=e.effectiveFilterWidth,m=e.padInfo.top,g=e.padInfo.left;this.outputShape=e.outShape;const C=t==="avg",$=`((batch  * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + d`,T=`(xR * ${e.inWidth} + xC) * ${e.inChannels} + d`;let A="0.0";if(C||(A="-1.0 / 1e-20"),r){const oe=">=";this.userCode=`
        const ivec2 strides = ivec2(${a}, ${u});
        const ivec2 pads = ivec2(${m}, ${g});

        void main() {
          ivec4 coords = getOutputCoords();
          int batch = coords[0];
          int d = coords[3];

          ivec2 xRCCorner = coords.yz * strides - pads;
          int xRCorner = xRCCorner.x;
          int xCCorner = xRCCorner.y;

          // max/min x(?, ?, d) to get y(yR, yC, d).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;
          float avgValue = 0.0;

          for (int wR = 0; wR < ${h};
              wR += ${c}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${d};
                wC += ${l}) {
              int xC = xCCorner + wC;

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float value = getX(batch, xR, xC, d);

              // If a min / max value has already been found, use it. If not,
              // use the current value.
              float currMinMaxValue = mix(
                  value, minMaxValue, minMaxValueFound);
              if (value ${oe} currMinMaxValue) {
                minMaxValue = value;
                minMaxValueFound = 1.0;
                minMaxPosition = ${s?o?$:T:`wR * ${d} + wC`};
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const P="max";let B=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(B="avgValue / count");const H=Math.floor(i/4)*4,x=i%4,re=`
      if (${C}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${P}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec2 strides = ivec2(${a}, ${u});
      const ivec2 pads = ivec2(${m}, ${g});
      const float initializationValue = ${A};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xR, int xC, int d) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xR, xC, d);
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d = coords[3];

        ivec2 xRCCorner = coords.yz * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // max/min x(?, ?, d) to get y(yR, yC, d).
        // ? = to be determined
        vec4 minMaxValue = vec4(${A});
        float avgValue = 0.0;
        count = 0.0;

        for (int wR = 0; wR < ${h};
            wR += ${c}) {
          int xR = xRCorner + wR;

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${H}; wC += 4) {
            int xC = xCCorner + wC * ${l};

            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${l}, d),
              getValue(batch, xR, xC + 2 * ${l}, d),
              getValue(batch, xR, xC + 3 * ${l}, d)
            );

            ${re}
          }

          int xC = xCCorner + ${H};
          if (${x===1}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              initializationValue,
              initializationValue,
              initializationValue
            );

            ${re}
          } else if (${x===2}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${l}, d),
              initializationValue,
              initializationValue
            );

            ${re}
          } else if (${x===3}) {
            vec4 values = vec4(
              getValue(batch, xR, xC, d),
              getValue(batch, xR, xC + ${l}, d),
              getValue(batch, xR, xC + 2 * ${l}, d),
              initializationValue
            );

            ${re}
          }
        }
        setOutput(${B});
      }
    `}}class Ol{constructor(e,t,r,s=!1,o=!1){if(this.variableNames=["x"],t==="avg"&&r)throw new Error("Cannot compute positions for average pool.");const i=e.filterWidth,a=e.strideDepth,u=e.strideHeight,c=e.strideWidth,l=e.dilationDepth,h=e.dilationHeight,d=e.dilationWidth,m=e.effectiveFilterDepth,g=e.effectiveFilterHeight,C=e.effectiveFilterWidth,$=e.padInfo.front,T=e.padInfo.top,A=e.padInfo.left;this.outputShape=e.outShape;const P=t==="avg";let B="0.0";if(P||(B="-1.0 / 1e-20"),r){const le=">=";this.userCode=`
        const ivec3 strides =
            ivec3(${a}, ${u}, ${c});
        const ivec3 pads = ivec3(${$}, ${T}, ${A});

        void main() {
          ivec5 coords = getOutputCoords();
          int batch = coords.x;
          int ch = coords.u;

          ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
          int xDCorner = xCorner.x;
          int xRCorner = xCorner.y;
          int xCCorner = xCorner.z;

          // max/min x(?, ?, ?, ch) to get y(yD, yR, yC, ch).
          // ? = to be determined
          float minMaxValue = 0.0;
          float minMaxValueFound = 0.0;
          int minMaxPosition = 0;

          for (int wD = 0; wD < ${m};
              wD += ${l}) {
            int xD = xDCorner + wD;

            if (xD < 0 || xD >= ${e.inDepth}) {
              continue;
            }

            for (int wR = 0; wR < ${g};
                wR += ${h}) {
              int xR = xRCorner + wR;

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int wC = 0; wC < ${C};
                  wC += ${d}) {
                int xC = xCCorner + wC;

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float value = getX(batch, xD, xR, xC, ch);

                // If a min / max value has already been found, use it. If not,
                // use the current value.
                float currMinMaxValue = mix(
                    value, minMaxValue, minMaxValueFound);
                if (value ${le} currMinMaxValue) {
                  minMaxValue = value;
                  minMaxValueFound = 1.0;
                  minMaxPosition = ${s?o?`(((batch * ${e.inDepth} + xD) * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`((xD * ${e.inHeight} + xR) * ${e.inWidth} + xC) * ${e.inChannels} + ch`:`wD * ${g} * ${C} +
                      wR * ${C} + wC`};
                }
              }
            }
          }
          setOutput(float(minMaxPosition));
        }
      `;return}const H="max";let x=`${t}(${t}(${t}(minMaxValue[0], minMaxValue[1]), minMaxValue[2]), minMaxValue[3])`;t==="avg"&&(x="avgValue / count");const re=Math.floor(i/4)*4,oe=i%4,ie=`
      if (${P}) {
        avgValue += dot(values, ones);
      } else {
        minMaxValue = ${H}(values, minMaxValue);
      }
    `;this.userCode=`
      const ivec3 strides =
        ivec3(${a}, ${u}, ${c});
      const ivec3 pads = ivec3(${$}, ${T}, ${A});
      const float initializationValue = ${B};
      const vec4 ones = vec4(1.0, 1.0, 1.0, 1.0);

      float count = 0.0;

      float getValue(int batch, int xD, int xR, int xC, int ch) {
        if (xC < 0 || xC >= ${e.inWidth}) {
          return initializationValue;
        }
        count += 1.0;
        return getX(batch, xD, xR, xC, ch);
      }

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 xCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xDCorner = xCorner.x;
        int xRCorner = xCorner.y;
        int xCCorner = xCorner.z;

        // max/min x(?, ?, ?, d) to get y(yD, yR, yC, ch).
        // ? = to be determined
        vec4 minMaxValue = vec4(${B});
        float avgValue = 0.0;
        count = 0.0;

        for (int wD = 0; wD < ${m};
            wD += ${l}) {
          int xD = xDCorner + wD;

          if (xD < 0 || xD >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${g};
            wR += ${h}) {
            int xR = xRCorner + wR;

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${re}; wC += 4) {
              int xC = xCCorner + wC * ${d};

              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                getValue(batch, xD, xR, xC + 3 * ${d}, ch)
              );

              ${ie}
            }

            int xC = xCCorner + ${re};
            if (${oe===1}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                initializationValue,
                initializationValue,
                initializationValue
              );

              ${ie}
            } else if (${oe===2}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                initializationValue,
                initializationValue
              );

              ${ie}
            } else if (${oe===3}) {
              vec4 values = vec4(
                getValue(batch, xD, xR, xC, ch),
                getValue(batch, xD, xR, xC + ${d}, ch),
                getValue(batch, xD, xR, xC + 2 * ${d}, ch),
                initializationValue
              );

              ${ie}
            }
          }
          setOutput(${x});
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function c8(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;ua(s,"avgPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:u}=r,c=1;M(Mn(i,c),()=>`Error in avgPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const l=Do(s.shape,o,i,c,a,u);if(l.filterWidth===1&&l.filterHeight===1&&Bt(l.inShape,l.outShape))return Ln({inputs:{x:s},backend:t});const h=new ta(l,"avg",!1);return t.runWebGLProgram(h,[s],"float32")}const l8={kernelName:Of,backendName:"webgl",kernelFunc:c8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function h8(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{filterSize:o,strides:i,pad:a,dimRoundingMode:u,dataFormat:c}=r,l=[1,1,1],h=sa(s.shape,o,i,l,a,u,c),d=new Ol(h,"avg",!1);return t.runWebGLProgram(d,[s],"float32")}const f8={kernelName:Df,backendName:"webgl",kernelFunc:h8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class d8{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,i=e.dilationHeight,a=e.dilationWidth,u=e.effectiveFilterHeight,c=e.effectiveFilterWidth,l=u-1-e.padInfo.top,h=c-1-e.padInfo.left,d=1/(t*r);this.userCode=`
      const ivec2 pads = ivec2(${l}, ${h});
      const float avgMultiplier = float(${d});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${u};
            wR += ${i}) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${c};
            wC+= ${a}) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);

            dotProd += dyValue * avgMultiplier;
          }
        }
        setOutput(dotProd);
      }
    `}}class p8{constructor(e){this.variableNames=["dy"],this.outputShape=e.inShape;const t=e.filterDepth,r=e.filterHeight,s=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,u=e.dilationDepth,c=e.dilationHeight,l=e.dilationWidth,h=e.effectiveFilterDepth,d=e.effectiveFilterHeight,m=e.effectiveFilterWidth,g=h-1-e.padInfo.front,C=d-1-e.padInfo.top,$=m-1-e.padInfo.left,T=1/(t*r*s);this.userCode=`
      const ivec3 pads = ivec3(${g}, ${C}, ${$});
      const float avgMultiplier = float(${T});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, d) with pos mask(:, :, :, ch) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${h};
            wD += ${u}) {
          float dyD = float(dyDCorner + wD) / ${o}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${d};
              wR += ${c}) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${m};
                wC += ${l}) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);

              dotProd += dyValue * avgMultiplier;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function m8(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:o}=e,i=o,{filterSize:a,strides:u,pad:c,dimRoundingMode:l}=r,h=[1,1,1],d=sa(i.shape,a,u,h,c,l),m=new p8(d);return t.runWebGLProgram(m,[s],i.dtype)}const g8={kernelName:S0,backendName:"webgl",kernelFunc:m8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function y8(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:o}=e,i=o;ua([s,o],"avgPoolGrad");const{filterSize:a,strides:u,pad:c}=r,l=Do(i.shape,a,u,1,c),h=new d8(l);return t.runWebGLProgram(h,[s],i.dtype)}const x8={kernelName:$0,backendName:"webgl",kernelFunc:y8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function b8(n){const{inputs:e,backend:t,attrs:r}=n,{a:s,b:o}=e,{transposeA:i,transposeB:a}=r;return qa({a:s,b:o,transposeA:i,transposeB:a,backend:t})}const v8={kernelName:Ff,backendName:"webgl",kernelFunc:b8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class w8{constructor(e,t,r,s,o,i){this.outputShape=[],this.variableNames=["x","mean","variance"],ot(e,t),ot(e,r);let a="0.0";s!=null&&(ot(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let u="1.0";o!=null&&(ot(e,o),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        float x = getXAtOutCoords();
        float mean = getMeanAtOutCoords();
        float variance = getVarianceAtOutCoords();
        float offset = ${a};
        float scale = ${u};
        float inv = scale * inversesqrt(variance + float(${i}));
        setOutput(dot(vec3(x, -mean, offset), vec3(inv, inv, 1)));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class C8{constructor(e,t,r,s,o,i){this.packedInputs=!0,this.packedOutput=!0,this.variableNames=["x","mean","variance"],ot(e,t),ot(e,r);let a="vec4(0.0)";s!=null&&(ot(e,s),this.variableNames.push("offset"),a="getOffsetAtOutCoords()");let u="vec4(1.0)";o!=null&&(ot(e,o),this.variableNames.push("scale"),u="getScaleAtOutCoords()"),this.outputShape=e,this.userCode=`
      void main() {
        vec4 offset = ${a};
        vec4 scale = ${u};

        vec4 x = getXAtOutCoords();
        vec4 mean = getMeanAtOutCoords();
        vec4 variance = getVarianceAtOutCoords();

        vec4 inv = scale * inversesqrt(variance + vec4(${i}));

        setOutput((x - mean) * inv + offset);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T8=({inputs:n,backend:e,attrs:t})=>{const{x:r,mean:s,variance:o,offset:i,scale:a}=n;M(s.shape.length===o.shape.length,()=>"Batch normalization gradient requires mean and variance to have equal ranks."),M(i==null||s.shape.length===i.shape.length,()=>"Batch normalization gradient requires mean and offset to have equal ranks."),M(a==null||s.shape.length===a.shape.length,()=>"Batch normalization gradient requires mean and scale to have equal ranks.");let{varianceEpsilon:u}=t;u==null&&(u=.001);const c=[r,s,o];let l=null;i!=null&&(l=i.shape,c.push(i));let h=null;a!=null&&(h=a.shape,c.push(a));const d=ue().getBool("WEBGL_PACK_NORMALIZATION")?new C8(r.shape,s.shape,o.shape,l,h,u):new w8(r.shape,s.shape,o.shape,l,h,u);return e.runWebGLProgram(d,c,c[0].dtype)},$8={kernelName:vd,backendName:"webgl",kernelFunc:T8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class S8{constructor(e){this.variableNames=["source"],this.outputShape=e,this.rank=e.length;const t=Tt(this.rank);this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const r=N8(this.rank);let s;const o=e.map((i,a)=>`sourceLoc.${_c[a]} = start[${a}] + coords.${_c[a]};`);s=`
        ${t} sourceLoc;
        ${t} coords = getOutputCoords();
        ${o.join(`
`)}
      `,this.userCode=`
      void main() {
        ${s}
        setOutput(getSource(${r}));
      }
    `}}const _c=["x","y","z","w","u","v"];function N8(n){if(n===1)return"sourceLoc";if(n<=6)return _c.slice(0,n).map(e=>"sourceLoc."+e).join(",");throw Error(`Slicing for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class E8{constructor(e){this.variableNames=["source"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=e,this.rank=e.length,this.customUniforms=[{name:"start",arrayIndex:this.rank,type:"int"}];const t=Tt(this.rank),r=wn("coords",this.rank),s=wn("sourceLoc",this.rank),o=this.rank===1?"sourceLoc":`vec2(${s.slice(-2).join()})`,i=`getChannel(getSource(${s.join()}), ${o})`,a=`
      result.x = ${i};
      if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
        ++${s[this.rank-1]};
        result.y = ${i};
        --${s[this.rank-1]};
      }
    `,u=this.rank===1?"":`
      --${r[this.rank-1]};
      if (++${r[this.rank-2]} < ${e[this.rank-2]}) {
        ++${s[this.rank-2]};
        result.z = ${i};
        if (++${r[this.rank-1]} < ${e[this.rank-1]}) {
          ++${s[this.rank-1]};
          result.w = ${i};
        }
      }
    `,c=this.rank<=4?`sourceLoc = coords +
            ${t}(${e.map((l,h)=>`start[${h}]`).join()});`:e.map((l,h)=>`${s[h]} = ${r[h]} + start[${h}];`).join(`
`);this.userCode=`
      void main() {
        ${t} coords = getOutputCoords();
        ${t} sourceLoc;
        ${c}
        vec4 result = vec4(0.);
        ${a}
        ${u}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function k8(n,e,t,r){const s=r.texData.get(n.dataId),o=r.makeTensorInfo(t,n.dtype),i=r.texData.get(o.dataId);Object.assign(i,s),i.refCount=1,i.shape=t,i.dtype=n.dtype;let a=al(e,rn(n.shape));s.slice&&(a+=s.slice.flatOffset),i.slice={flatOffset:a,origDataId:s.slice&&s.slice.origDataId||n.dataId};const u=r.dataRefCount.get(i.slice.origDataId)||1;return r.dataRefCount.set(i.slice.origDataId,u+1),o}function _i(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{begin:o,size:i}=r,[a,u]=t2(s,o,i);if(j1(s,a,u),Ce(u)===0)return t.makeTensorInfo(u,s.dtype,[]);if(t.shouldExecuteOnCPU([s])||s.dtype==="string"){const h=t.texData.get(s.dataId),d=wS(h.values,a,u,s.shape,s.dtype);return t.makeTensorInfo(u,s.dtype,d)}const{isPacked:c}=t.texData.get(s.dataId),l=il(s.shape,a,u);if(c||!l){const h=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new E8(u):new S8(u),d=[a];return t.runWebGLProgram(h,[s],s.dtype,d)}return t.uploadToGPU(s.dataId),k8(s,a,u,t)}const I8={kernelName:Ep,backendName:"webgl",kernelFunc:_i};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _8=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockShape:o,crops:i}=r;M(s.shape.length<=4,()=>"batchToSpaceND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((A,P)=>A*P),u=Tl(s.shape,o,a),c=$l(u.length,o.length),l=Sl(s.shape,o,a),h=rm(i,o.length),d=sm(l,i,o.length),m=[],g=ke({inputs:{x:s},backend:t,attrs:{shape:u}}),C=$n({inputs:{x:g},backend:t,attrs:{perm:c}}),$=ke({inputs:{x:C},backend:t,attrs:{shape:l}}),T=_i({inputs:{x:$},backend:t,attrs:{begin:h,size:d}});return m.push(g),m.push(C),m.push($),m.forEach(A=>t.disposeIntermediateTensorInfo(A)),T},R8={kernelName:Pf,backendName:"webgl",kernelFunc:_8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function A8(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,weights:o}=e,{size:i}=r,a=t.readSync(s.dataId),u=t.readSync(o.dataId),c=qm(a,u,o.dtype,o.shape,i);return t.makeTensorInfo([i],o.dtype,c)}const O8={kernelName:Lf,backendName:"webgl",kernelFunc:A8};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function D8(n){const{inputs:e,backend:t}=n,{s0:r,s1:s}=e,o=t.readSync(r.dataId),i=t.readSync(s.dataId),a=ot(Array.from(o),Array.from(i));return t.makeTensorInfo([a.length],"int32",Int32Array.from(a))}const F8={kernelName:Bf,backendName:"webgl",kernelFunc:D8};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const P8="return float(a != b);",ag=on({opSnippet:P8,cpuKernelImpl:dS,dtype:"bool"}),L8={kernelName:Jd,backendName:"webgl",kernelFunc:ag};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fa(n){const{inputs:e,backend:t}=n,{input:r}=e,s=t.texData.get(r.dataId);return Ln({inputs:{x:s.complexTensorInfos.real},backend:t})}const B8={kernelName:dp,backendName:"webgl",kernelFunc:fa};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const M8="return float(int(x));";function V8(n,e){const t=new gs(n.shape,M8),r=e.runWebGLProgram(t,[n],"int32");return{dataId:r.dataId,shape:r.shape,dtype:r.dtype}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Rc(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{dtype:o}=r;if(o==="complex64"){if(s.dtype==="complex64")return Ln({inputs:{x:s},backend:t});const i=Io(s.shape),a=Rc({inputs:{x:s},backend:t,attrs:{dtype:"float32"}}),u=Ys({inputs:{real:a,imag:i},backend:t});return i.dispose(),t.disposeIntermediateTensorInfo(a),u}if(s.dtype==="complex64"){const i=fa({inputs:{input:s},backend:t}),a=Rc({inputs:{x:i},backend:t,attrs:{dtype:o}});return t.disposeIntermediateTensorInfo(i),a}if(!p0(s.dtype,o)){const i=Ln({inputs:{x:s},backend:t});return{dataId:i.dataId,shape:i.shape,dtype:o}}if(t.shouldExecuteOnCPU([s])){const i=t.texData.get(s.dataId).values,[a,u,c]=q$(i,s.shape,s.dtype,o);return t.makeTensorInfo(a,u,c)}if(o==="int32")return V8(s,t);if(o==="bool"){const i=t.makeTensorInfo([],"bool",vs("bool",1)),u=ag({inputs:{a:s,b:i},backend:t});return t.disposeIntermediateTensorInfo(i),u}throw new Error(`Error in Cast: failed to cast ${s.dtype} to ${o}`)}const U8={kernelName:Kc,backendName:"webgl",kernelFunc:Rc};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Ah="return ceil(x);",W8=rt({opSnippet:Ah,packedOpSnippet:Ah,cpuKernelImpl:X$}),z8={kernelName:Mf,backendName:"webgl",kernelFunc:W8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class G8{constructor(e){this.variableNames=["A"],this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`

      void main() {
        float value = getAAtOutCoords();
        if (isnan(value)) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, minVal, maxVal));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class j8{constructor(e){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"minVal",type:"float"},{name:"maxVal",type:"float"}],this.outputShape=e,this.userCode=`
      void main() {
        vec4 value = getAAtOutCoords();

        if (any(isnan(value))) {
          setOutput(value);
          return;
        }

        setOutput(clamp(value, vec4(minVal), vec4(maxVal)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H8(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{clipValueMin:o,clipValueMax:i}=r;let a;ue().getBool("WEBGL_PACK_CLIP")?a=new j8(s.shape):a=new G8(s.shape);const u=[[o],[i]];return t.runWebGLProgram(a,[s],s.dtype,u)}const q8={kernelName:Vf,backendName:"webgl",kernelFunc:H8};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class X8{constructor(e){this.variableNames=["real","imag"],this.outputShape=e,this.userCode=`
      void main() {
        float re = abs(getRealAtOutCoords());
        float im = abs(getImagAtOutCoords());
        float mx = max(re, im);

        // sadly the length function in glsl is not underflow-safe
        // (at least not on Intel GPUs). So the safe solution is
        // to ensure underflow-safety in all cases.
        setOutput(
          mx == 0.0 ? 0.0 : mx * length(vec2(1, min(re, im)/mx))
        );
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Oh(n,e){return{dataId:e.dataId,dtype:e.dtype,shape:n.shape}}function K8(n){const{inputs:e,backend:t}=n,{x:r}=e,s=t.texData.get(r.dataId),o=new X8(r.shape),i=[Oh(r,s.complexTensorInfos.real),Oh(r,s.complexTensorInfos.imag)];return t.runWebGLProgram(o,i,i[0].dtype)}const Y8={kernelName:Wf,backendName:"webgl",kernelFunc:K8};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Q8{constructor(e){this.outputShape=[],this.outputShape=Ro(e,1),this.variableNames=e.map((i,a)=>`T${a}`);const t=new Array(e.length-1);t[0]=e[0][1];for(let i=1;i<t.length;i++)t[i]=t[i-1]+e[i][1];const r=[`if (yC < ${t[0]}) setOutput(getT0(yR, yC));`];for(let i=1;i<t.length;i++){const a=t[i-1];r.push(`else if (yC < ${t[i]}) setOutput(getT${i}(yR, yC-${a}));`)}const s=t.length,o=t[t.length-1];r.push(`else setOutput(getT${s}(yR, yC-${o}));`),this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int yR = coords.x;
        int yC = coords.y;

        ${r.join(`
        `)}
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Z8{constructor(e,t){this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[],this.outputShape=Ro(e,t);const r=this.outputShape,s=r.length,o=Tt(s),i=wn("coords",s),a=["x","y","z","w","u","v"].slice(0,s);this.variableNames=e.map((C,$)=>`T${$}`);const u=new Array(e.length-1);u[0]=e[0][t];for(let C=1;C<u.length;C++)u[C]=u[C-1]+e[C][t];const c=a[t],l=a.slice(-2),h=a.join();let d=`if (${c} < ${u[0]}) {
        return getChannel(
            getT0(${h}), vec2(${l.join()}));
        }`;for(let C=1;C<u.length;C++){const $=u[C-1];d+=`
        if (${c} < ${u[C]}  && ${c} >= ${u[C-1]}) {
          return getChannel(
            getT${C}(${Ia(a,c,$)}),
            vec2(${Ia(l,c,$)}));
        }`}const m=u.length,g=u[u.length-1];d+=`
        return getChannel(
          getT${m}(${Ia(a,c,g)}),
          vec2(${Ia(l,c,g)}));`,this.userCode=`
      float getValue(${a.map(C=>"int "+C)}) {
        ${d}
      }

      void main() {
        ${o} coords = getOutputCoords();
        vec4 result = vec4(getValue(${i}), 0., 0., 0.);

        ${i[s-1]} = ${i[s-1]} + 1;
        if (${i[s-1]} < ${r[s-1]}) {
          result.g = getValue(${i});
        }

        ${i[s-2]} = ${i[s-2]} + 1;
        if (${i[s-2]} < ${r[s-2]}) {
          result.a = getValue(${i});
        }

        ${i[s-1]} = ${i[s-1]} - 1;
        if (${i[s-2]} < ${r[s-2]} &&
            ${i[s-1]} < ${r[s-1]}) {
          result.b = getValue(${i});
        }
        setOutput(result);
      }
    `}}function Ia(n,e,t){const r=n.indexOf(e);return n.map((o,i)=>i===r?`${o} - ${t}`:o).join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vu(n){const{inputs:e,backend:t}=n,{input:r}=e,s=t.texData.get(r.dataId);return Ln({inputs:{x:s.complexTensorInfos.imag},backend:t})}const J8={kernelName:Nd,backendName:"webgl",kernelFunc:vu};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function zi(n,e,t){const r=n[0].dtype;if(r==="complex64"){const h=n.map($=>fa({inputs:{input:$},backend:t})),d=n.map($=>vu({inputs:{input:$},backend:t})),m=zi(h,e,t),g=zi(d,e,t),C=Ys({inputs:{real:m,imag:g},backend:t});return h.forEach($=>t.disposeIntermediateTensorInfo($)),d.forEach($=>t.disposeIntermediateTensorInfo($)),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(g),C}let s=t.shouldExecuteOnCPU(n);if(r==="string"&&(s=!0),s){const h=n.map(A=>{const B=[-1,Ce(A.shape.slice(e))];return ke({inputs:{x:A},backend:t,attrs:{shape:B}})}),d=h.map(A=>({vals:t.readSync(A.dataId),shape:A.shape})),m=Ro(h.map(A=>A.shape),1),g=h[0].shape[0]===1,C=K$(d,m,r,g),$=Ro(n.map(A=>A.shape),e),T=t.makeTensorInfo($,r,C);return h.forEach(A=>t.disposeIntermediateTensorInfo(A)),T}const o=ue().getNumber("WEBGL_MAX_TEXTURES_IN_SHADER");if(n.length>o){const h=[];for(let m=0;m<n.length;m+=o){const g=n.slice(m,m+o);h.push(zi(g,e,t))}const d=zi(h,e,t);for(const m of h)t.disposeIntermediateTensorInfo(m);return d}if(ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")&&n[0].shape.length>1){const h=new Z8(n.map(d=>d.shape),e);return t.runWebGLProgram(h,n,r)}const{tensors2D:i,outShape:a}=e9(n,e,t),u=new Q8(i.map(h=>h.shape)),c=t.runWebGLProgram(u,i,r);i.forEach(h=>t.disposeIntermediateTensorInfo(h));const l=ke({inputs:{x:c},attrs:{shape:a},backend:t});return t.disposeIntermediateTensorInfo(c),l}function e9(n,e,t){const r=Ro(n.map(o=>o.shape),e);return{tensors2D:n.map(o=>ke({inputs:{x:o},attrs:{shape:[-1,Ce(o.shape.slice(e))]},backend:t})),outShape:r}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ug(n){const{inputs:e,backend:t,attrs:r}=n,{axis:s}=r,o=Zt(s,e[0].shape)[0],i=e.map(c=>c.shape);Q2(i,o);const a=Ro(e.map(c=>c.shape),o);if(Ce(a)===0)return t.makeTensorInfo(a,e[0].dtype,[]);const u=e.filter(c=>Ce(c.shape)>0);return u.length===1?Ln({inputs:{x:u[0]},backend:t}):zi(u,o,t)}const t9={kernelName:zf,backendName:"webgl",kernelFunc:ug};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cg{constructor(e,t=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.outputShape=e.outShape;const i=e.padInfo.top,a=e.padInfo.left,u=e.strideHeight,c=e.strideWidth,l=e.dilationHeight,h=e.dilationWidth,d=e.filterHeight,m=e.filterWidth,g=Math.floor(e.inChannels/4)*4,C=e.inChannels%4,$=e.dataFormat==="channelsLast",T=$?1:2,A=$?2:3,P=$?3:1;let B="",H="";r&&(s?B=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?B=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:B=`
          float activation(float x) {
            ${r}
          }
        `,H="result = activation(result);");const x=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${B}

      const ivec2 strides = ivec2(${u}, ${c});
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d2 = coords[${P}];

        ivec2 xRCCorner =
            ivec2(coords[${T}], coords[${A}]) * strides - pads;
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, d2) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${d}; wR++) {
          int xR = xRCorner + wR * ${l};

          if (xR < 0 || xR >= ${e.inHeight}) {
            continue;
          }

          for (int wC = 0; wC < ${m}; wC++) {
            int xC = xCCorner + wC * ${h};

            if (xC < 0 || xC >= ${e.inWidth}) {
              continue;
            }

            for (int d1 = 0; d1 < ${g}; d1 += 4) {
              vec4 wValues = vec4(
                getW(wR, wC, d1, d2),
                getW(wR, wC, d1 + 1, d2),
                getW(wR, wC, d1 + 2, d2),
                getW(wR, wC, d1 + 3, d2)
              );

              if (${$}) {
                vec4 xValues = vec4(
                  getX(batch, xR, xC, d1),
                  getX(batch, xR, xC, d1 + 1),
                  getX(batch, xR, xC, d1 + 2),
                  getX(batch, xR, xC, d1 + 3)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec4 xValues = vec4(
                  getX(batch, d1, xR, xC),
                  getX(batch, d1 + 1, xR, xC),
                  getX(batch, d1 + 2, xR, xC),
                  getX(batch, d1 + 3, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }
            }

            if (${C===1}) {

              if (${$}) {
                dotProd +=
                    getX(batch, xR, xC, ${g}) *
                    getW(wR, wC, ${g}, d2);
              } else {
                dotProd +=
                    getX(batch, ${g}, xR, xC) *
                    getW(wR, wC, ${g}, d2);
              }

            } else if (${C===2}) {
              vec2 wValues = vec2(
                getW(wR, wC, ${g}, d2),
                getW(wR, wC, ${g} + 1, d2)
              );

              if (${$}) {
                vec2 xValues = vec2(
                  getX(batch, xR, xC, ${g}),
                  getX(batch, xR, xC, ${g} + 1)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec2 xValues = vec2(
                  getX(batch, ${g}, xR, xC),
                  getX(batch, ${g} + 1, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            } else if (${C===3}) {
              vec3 wValues = vec3(
                getW(wR, wC, ${g}, d2),
                getW(wR, wC, ${g} + 1, d2),
                getW(wR, wC, ${g} + 2, d2)
              );

              if (${$}) {
                vec3 xValues = vec3(
                  getX(batch, xR, xC, ${g}),
                  getX(batch, xR, xC, ${g} + 1),
                  getX(batch, xR, xC, ${g} + 2)
                );
                dotProd += dot(xValues, wValues);
              } else {
                vec3 xValues = vec3(
                  getX(batch, ${g}, xR, xC),
                  getX(batch, ${g} + 1, xR, xC),
                  getX(batch, ${g} + 2, xR, xC)
                );
                dotProd += dot(xValues, wValues);
              }

            }
          }
        }

        float result = dotProd;
        ${x}
        ${H}
        setOutput(result);
      }
    `}}class n9{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const t=e.padInfo.front,r=e.padInfo.top,s=e.padInfo.left,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,u=e.dilationDepth,c=e.dilationHeight,l=e.dilationWidth,h=e.filterDepth,d=e.filterHeight,m=e.filterWidth,g=Math.floor(e.inChannels/4)*4,C=e.inChannels%4;this.userCode=`
      const ivec3 strides = ivec3(${o}, ${i}, ${a});
      const ivec3 pads = ivec3(${t}, ${r}, ${s});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d2 = coords.u;

        ivec3 xFRCCorner = ivec3(coords.y, coords.z, coords.w) * strides - pads;
        int xFCorner = xFRCCorner.x;
        int xRCorner = xFRCCorner.y;
        int xCCorner = xFRCCorner.z;

        // Convolve x(?, ?, ?, d1) with w(:, :, :, d1, d2) to get
        // y(yF, yR, yC, d2). ? = to be determined. : = across all
        // values in that axis.
        float dotProd = 0.0;
        for (int wF = 0; wF < ${h}; wF++) {
          int xF = xFCorner + wF * ${u};

          if (xF < 0 || xF >= ${e.inDepth}) {
            continue;
          }

          for (int wR = 0; wR < ${d}; wR++) {
            int xR = xRCorner + wR * ${c};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int wC = 0; wC < ${m}; wC++) {
              int xC = xCCorner + wC * ${l};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              for (int d1 = 0; d1 < ${g}; d1 += 4) {
                vec4 xValues = vec4(
                  getX(batch, xF, xR, xC, d1),
                  getX(batch, xF, xR, xC, d1 + 1),
                  getX(batch, xF, xR, xC, d1 + 2),
                  getX(batch, xF, xR, xC, d1 + 3)
                );
                vec4 wValues = vec4(
                  getW(wF, wR, wC, d1, d2),
                  getW(wF, wR, wC, d1 + 1, d2),
                  getW(wF, wR, wC, d1 + 2, d2),
                  getW(wF, wR, wC, d1 + 3, d2)
                );

                dotProd += dot(xValues, wValues);
              }

              if (${C===1}) {
                dotProd +=
                  getX(batch, xF, xR, xC, ${g}) *
                  getW(wF, wR, wC, ${g}, d2);
              } else if (${C===2}) {
                vec2 xValues = vec2(
                  getX(batch, xF, xR, xC, ${g}),
                  getX(batch, xF, xR, xC, ${g} + 1)
                );
                vec2 wValues = vec2(
                  getW(wF, wR, wC, ${g}, d2),
                  getW(wF, wR, wC, ${g} + 1, d2)
                );
                dotProd += dot(xValues, wValues);
              } else if (${C===3}) {
                vec3 xValues = vec3(
                  getX(batch, xF, xR, xC, ${g}),
                  getX(batch, xF, xR, xC, ${g} + 1),
                  getX(batch, xF, xR, xC, ${g} + 2)
                );
                vec3 wValues = vec3(
                  getW(wF, wR, wC, ${g}, d2),
                  getW(wF, wR, wC, ${g} + 1, d2),
                  getW(wF, wR, wC, ${g} + 2, d2)
                );
                dotProd += dot(xValues, wValues);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class lg{constructor(e,t=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Nn(this.outputShape.length);const i=e.padInfo.left,a=e.strideWidth,u=e.dilationWidth,c=e.filterHeight,l=e.filterWidth,h=l;let d=`
       int xR; int xC; int xCOffset;
       vec4 wTexel; vec4 previous; vec4 final;`;for(let $=0;$<l;$++)d+=`
           vec4 xTexelC${$*2};
           int xTexelC${$*2}Ready;
           vec4 xTexelC${$*2+1};
           int xTexelC${$*2+1}Ready;
           vec4 xC${$};`;d+=`
     for (int r = 0; r < ${c}; r++) {
      for (int d1 = 0; d1 < ${e.inChannels}; d1 += 2) {
       `;for(let $=0;$<l;$++)d+=`
           xTexelC${$*2} = vec4(0.0);
           xTexelC${$*2}Ready = 0;
           xTexelC${$*2+1} = vec4(0.0);
           xTexelC${$*2+1}Ready = 0;
           xC${$} = vec4(0.0);`;d+=`
         xR = xRCorner + r * dilations[0];
         if (xR >=0 && xR < inDims[0]) {
       `;for(let $=0;$<(h+1)/2;$++){const T=$*2;if(d+=`
           xC = xCCorner + ${T*u};
           `,a===1){if(T<l&&(i%2===1?(d+=`
                 xCOffset = xC + 1;
                 if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T}Ready == 0) {
                   xTexelC${T} = getX(batch, xR, xCOffset, d1);

                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${T}.zw = vec2(0.0);
                   }
                   xTexelC${T}Ready = 1;
                 }
               `,u===1&&T>0?d+=`
                 xC${T} = vec4(xTexelC${T-2}.zw, xTexelC${T}.xy);
                 `:d+=`
                   xCOffset = xC + 1 - 2;

                   if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       previous.zw = vec2(0.0);
                     }

                     xC${T} = vec4(previous.zw, xTexelC${T}.xy);
                   } else {
                     xC${T} = vec4(0.0, 0.0, xTexelC${T}.xy);
                   }
                   `):d+=`
                 if (xC >= 0 && xC < inDims[1] && xTexelC${T}Ready == 0) {
                   xTexelC${T} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${T}.zw = vec2(0.0);
                   }
                   xTexelC${T}Ready = 1;
                 }

                 xC${T} = xTexelC${T};
                 `,T+1<l)){const A=i%2===0?jc(u):u;u%2===0&&i%2===1||u%2!==0&&i%2!==1?(d+=`
                   xCOffset = xC + imod(pads[1], 2) + ${A};

                   if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T+1}Ready == 0) {
                     xTexelC${T+1} = getX(batch, xR, xCOffset, d1);

                     // Need to manually clear unused channels in case
                     // we're reading from recycled texture.
                     if (xCOffset + 1 >= inDims[1]) {
                       xTexelC${T+1}.zw = vec2(0.0);
                     }
                     xTexelC${T+1}Ready = 1;
                   }
                   `,u>1?d+=`
                     xCOffset -= 2;
                     if (xCOffset >= 0 && xCOffset < inDims[1]) {
                      previous = getX(batch, xR, xCOffset, d1);
                      xC${T+1} = vec4(previous.zw, xTexelC${T+1}.xy);
                     } else {
                      xC${T+1} = vec4(0.0, 0.0, xTexelC${T+1}.xy);
                     }
                     `:d+=`
                     xC${T+1} = vec4(xTexelC${T}.zw, xTexelC${T+1}.xy);
                     `):A===1?d+=`
                     xC${T+1} = xTexelC${T};
                     `:d+=`
                     xCOffset = xC + ${A};

                     if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T+1}Ready == 0) {
                       xTexelC${T+1} = getX(batch, xR, xCOffset, d1);
                       if (xCOffset + 1 >= inDims[1]) {
                         xTexelC${T+1}.zw = vec2(0.0);
                       }
                       xTexelC${T+1}Ready = 1;
                     }

                     xC${T+1} = xTexelC${T+1};
                     `}}else T<l&&(i%2===1?(d+=`
                 xCOffset = xC + 1 - strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T}Ready == 0) {
                   xTexelC${T} = getX(batch, xR, xCOffset, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${T}.zw = vec2(0.0);
                   }
                   xTexelC${T}Ready = 1;
                 }

                 if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${T+1}Ready == 0) {
                   xTexelC${T+1} = getX(batch, xR, xC + 1, d1);
                   // Need to manually clear unused channels in case
                   // we're reading from recycled texture.
                   if (xC + 2 >= inDims[1]) {
                     xTexelC${T+1}.zw = vec2(0.0);
                   }
                   xTexelC${T+1}Ready = 1;
                 }

                 xC${T} = vec4(xTexelC${T}.zw, xTexelC${T+1}.zw);
               `,T+1<l&&(d+=`
                   final = vec4(0.0);
                   xCOffset = xC + 1 + strides[1];
                   if(xCOffset >= 0 && xCOffset < inDims[1]) {
                     final = getX(batch, xR, xCOffset, d1);
                   }
                   xC${T+1} = vec4(xTexelC${T+1}.xy, final.xy);
                 `)):(d+=`
                 if(xC >= 0 && xC < inDims[1] && xTexelC${T}Ready == 0) {
                   xTexelC${T} = getX(batch, xR, xC, d1);
                   if (xC + 1 >= inDims[1]) {
                     xTexelC${T}.zw = vec2(0.0);
                   }
                   xTexelC${T}Ready = 1;
                 }

                 xCOffset = xC + strides[1];
                 if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${T+1}Ready == 0) {
                   xTexelC${T+1} = getX(batch, xR, xCOffset, d1);
                   if (xCOffset + 1 >= inDims[1]) {
                     xTexelC${T+1}.zw = vec2(0.);
                   }
                   xTexelC${T+1}Ready = 1;
                 }

                 xC${T} = vec4(
                   xTexelC${T}.xy, xTexelC${T+1}.xy);
               `,T+1<l&&(d+=`
                   xC${T+1} = vec4(xTexelC${T}.zw, xTexelC${T+1}.zw);
                 `)));T<l&&(d+=`
             wTexel = getW(r, ${T}, d1, d2);
             dotProd += xC${T}.xxzz * vec4(wTexel.xy, wTexel.xy);
             if(d1 + 1 < ${e.inChannels}) {
               dotProd += xC${T}.yyww * vec4(wTexel.zw, wTexel.zw);
             }
           `,T+1<l&&(d+=`
               wTexel = getW(r, ${T+1}, d1, d2);
               dotProd += xC${T+1}.xxzz * vec4(wTexel.xy, wTexel.xy);
               if(d1 + 1 < ${e.inChannels}) {
                 dotProd += xC${T+1}.yyww * vec4(wTexel.zw, wTexel.zw);
               }
             `))}d+=`
     }
   `,d+=`
     }
   `,d+=`
     }
   `;let m="",g="";r&&(s?m=`vec4 activation(vec4 a) {
           vec4 b = getPreluActivationWeightsAtOutCoords();
           ${r}
         }`:o?m=`vec4 activation(vec4 a) {
           vec4 b = getLeakyreluAlphaAtOutCoords();
           ${r}
         }`:m=`vec4 activation(vec4 x) {
           ${r}
         }`,g="result = activation(result);");const C=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
       ${m}

       void main() {
         ivec4 coords = getOutputCoords();
         int batch = coords.x;
         ivec2 xRCCorner = coords.yz * strides - pads;
         int d2 = coords.w;
         int xRCorner = xRCCorner.x;
         int xCCorner = xRCCorner.y;

         //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
         vec4 dotProd = vec4(0.000000000000001);

         ${d}

         vec4 result = dotProd - vec4(0.000000000000001);
         ${C}
         ${g}
         setOutput(result);
       }
     `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class r9{constructor(e,t){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"inputShape",type:"ivec4"},{name:"pad",type:"ivec2"},{name:"stride",type:"ivec2"},{name:"dilation",type:"ivec2"},{name:"inChannels",type:"int"},{name:"itemsPerBlockRow",type:"int"},{name:"outWidth",type:"int"}],this.outputShape=e,this.enableShapeUniforms=Nn(this.outputShape.length);const{dataFormat:r}=t,s=Sn(),o=r==="channelsLast",i=o?1:2,a=o?2:3,u=this.enableShapeUniforms?"if(blockIndex < outShape[2] && pos < outShape[1]) {":`if(blockIndex < ${e[2]} && pos < ${e[1]}) {`;let c="";for(let l=0;l<=1;l++)for(let h=0;h<=1;h++)c+=`
          blockIndex = rc.z + ${h};
          pos = rc.y + ${l};

          ${u}
            offsetY = int(blockIndex / outWidth) * stride[0] - pad[0];
            d0 = offsetY + dilation[0] * (pos / itemsPerBlockRow);

            if(d0 < inputShape[${i}] && d0 >= 0) {
              // Use custom imod instead mod. On Intel GPU, mod may generate
              // unexpected value.
              // https://github.com/tensorflow/tfjs/issues/5447
              offsetX = imod(blockIndex, outWidth) * stride[1] - pad[1];
              d1 = offsetX + dilation[1] * (imod(pos, itemsPerBlockRow) /
                  inChannels);

              if(d1 < inputShape[${a}] && d1 >= 0) {

                ch = imod(pos, inChannels);

                if (${o}) {
                  innerDims = vec2(d1, ch);
                  result[${l*2+h}] = getChannel(
                    getA(rc.x, d0, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                } else {
                  innerDims = vec2(d0, d1);
                  result[${l*2+h}] = getChannel(
                    getA(rc.x, ch, int(innerDims.x),
                    int(innerDims.y)), innerDims);
                }
              }
            }
          }
        `;this.userCode=`
      void main() {
        ivec3 rc = getOutputCoords();

        vec4 result = vec4(0);

        int blockIndex, pos, offsetY, d0, offsetX, d1, ch;
        vec2 innerDims;

        ${c}

        ${s.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xa(n,e){const t=n.length;return t>=3?e?[...n.slice(0,-3),n[t-3]*n[t-2],n[t-1]]:[...n.slice(0,-3),n[t-3],n[t-2]*n[t-1]]:!e&&t===1&&n[0]>1?[n[0],1]:null}function hg({x:n,filter:e,convInfo:t,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const u=n.shape,c=r.texData.get(n.dataId),l=t.inChannels,h=u[0]*u[1]*u[2],d=t.outChannels,m=t.dataFormat==="channelsLast",g=!1,C=!1;let $;const T=[];if(o!=null){const B=Xa(o.shape,m);B!=null&&(o=ke({inputs:{x:o},backend:r,attrs:{shape:B}}),T.push(o))}if(s!=null){const B=Xa(s.shape,m);B!=null&&(s=ke({inputs:{x:s},backend:r,attrs:{shape:B}}),T.push(s))}if(!((h===1||d===1)&&l>rg)&&c.isPacked&&m&&c.texture!=null&&u[2]%2!==0&&Bt(c.shape.slice(-3),u.slice(-3))){const B=u[0]*u[1]*(u[2]+1),H={dataId:n.dataId,shape:[1,B,t.inChannels],dtype:n.dtype},x=c.shape;c.shape=c.shape.slice(),c.shape[c.shape.length-2]++,M(ja(c.shape,H.shape),()=>`packed reshape ${c.shape} to ${H.shape} isn't free`);const re=ke({inputs:{x:e},backend:r,attrs:{shape:[1,t.inChannels,t.outChannels]}});T.push(re);const oe=qa({a:H,b:re,backend:r,transposeA:g,transposeB:C,bias:s,activation:a,preluActivationWeights:o,leakyreluAlpha:i}),ie=r.texData.get(oe.dataId);M(ie.isPacked,()=>"batchMatMul result is expected to be packed"),c.shape=x,ie.shape=t.outShape,$=Ln({inputs:{x:oe},backend:r}),$.shape=t.outShape,T.push(oe)}else{const B=t.outHeight*t.outWidth,H=ke({inputs:{x:n},backend:r,attrs:{shape:m?[t.batchSize,B,t.inChannels]:[t.batchSize,t.inChannels,B]}}),x=ke({inputs:{x:e},backend:r,attrs:{shape:[1,t.inChannels,t.outChannels]}}),re=qa({a:m?H:x,b:m?x:H,transposeA:!m,transposeB:C,backend:r,bias:s,activation:a,preluActivationWeights:o,leakyreluAlpha:i});$=ke({inputs:{x:re},backend:r,attrs:{shape:t.outShape}}),T.push(H),T.push(x),T.push(re)}for(const B of T)r.disposeIntermediateTensorInfo(B);return $}function fg({x:n,filter:e,convInfo:t,backend:r,bias:s=null,preluActivationWeights:o=null,leakyreluAlpha:i=0,activation:a=null}){const{filterWidth:u,filterHeight:c,inChannels:l,outWidth:h,outHeight:d,dataFormat:m}=t,g=m==="channelsLast",C=u*c*l,$=d*h,T=[t.batchSize,C,$],A=!0,P=!1,B=[];if(o!=null){const lt=Xa(o.shape,g);lt!=null&&(o=ke({inputs:{x:o},backend:r,attrs:{shape:lt}}),B.push(o))}if(s!=null){const lt=Xa(s.shape,g);lt!=null&&(s=ke({inputs:{x:s},backend:r,attrs:{shape:lt}}),B.push(s))}const H=ke({inputs:{x:e},backend:r,attrs:{shape:[1,C,Ce(e.shape)/C]}});B.push(H);const x=new r9(T,t),re=[n.shape,[t.padInfo.top,t.padInfo.left],[t.strideHeight,t.strideWidth],[t.dilationHeight,t.dilationWidth],[t.inChannels],[t.filterWidth*t.inChannels],[t.outWidth]],oe=r.runWebGLProgram(x,[n],"float32",re),ie=ke({inputs:{x:oe},backend:r,attrs:{shape:T}});B.push(oe),B.push(ie);const le=s!=null,$e=o!=null,Ie=a==="leakyrelu",Ae=a?ea(a,!0):null,Ge=new ng(g?ie.shape:H.shape,g?H.shape:ie.shape,g?[t.batchSize,$,t.outChannels]:[t.batchSize,t.outChannels,$],A,P,le,Ae,$e,Ie),Ye=g?[ie,H]:[H,ie];if(s&&Ye.push(s),$e&&Ye.push(o),Ie){const lt=r.makeTensorInfo([],"float32",vi(i,"float32"));Ye.push(lt),B.push(lt)}const at=r.runWebGLProgram(Ge,Ye,"float32"),ut=ke({inputs:{x:at},backend:r,attrs:{shape:t.outShape}});B.push(at);for(const lt of B)r.disposeIntermediateTensorInfo(lt);return ut}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s9(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:o}=e,{strides:i,pad:a,dataFormat:u,dilations:c,dimRoundingMode:l}=r,h=wi(u),d=Zn(s.shape,o.shape,i,c,a,l,!1,h);let m;if(d.filterHeight===1&&d.filterWidth===1&&d.dilationHeight===1&&d.dilationWidth===1&&d.strideHeight===1&&d.strideWidth===1&&(d.padInfo.type==="SAME"||d.padInfo.type==="VALID"))m=hg({x:s,filter:o,convInfo:d,backend:t});else if(d.strideWidth<=2&&h==="channelsLast"&&ue().getBool("WEBGL_EXP_CONV")){const C=new lg(d),$=[[d.padInfo.top,d.padInfo.left],[d.strideHeight,d.strideWidth],[d.dilationHeight,d.dilationWidth],[d.inHeight,d.inWidth]];m=t.runWebGLProgram(C,[s,o],"float32",$)}else if(ue().getBool("WEBGL_CONV_IM2COL"))m=fg({x:s,filter:o,convInfo:d,backend:t});else{const C=new cg(d);m=t.runWebGLProgram(C,[s,o],"float32")}const g=ke({inputs:{x:m},backend:t,attrs:{shape:d.outShape}});return t.disposeIntermediateTensorInfo(m),g}const o9={kernelName:Gf,backendName:"webgl",kernelFunc:s9};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class i9{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,o=e.padInfo.left,i=e.dataFormat==="channelsLast";this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int d2 = coords.w;

        // Convolve x(?, ?, d1) with dy(:, :, d2) to get dw(wR, wC, d1, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              if (${i}) {
                float dyValue = getDy(b, yR, yC, d2);
                float xValue = getX(b, xR, xC, d1);
                dotProd += (xValue * dyValue);
              } else {
                float dyValue = getDy(b, d2, yR, yC);
                float xValue = getX(b, d1, xR, xC);
                dotProd += (xValue * dyValue);
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class a9{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,i=e.dataFormat==="channelsLast",a=t-1-e.padInfo.top,u=r-1-e.padInfo.left,c=i?1:2,l=i?2:3,h=i?3:1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[${h}];

        ivec2 dyCorner = ivec2(coords[${c}], coords[${l}]) - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        // Convolve dy(?, ?, d2) with w(:, :, d1, d2) to compute dx(xR, xC, d1).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            for (int d2 = 0; d2 < ${e.outChannels}; d2++) {

              if (${i}) {
                float xValue = getDy(batch, idyR, idyC, d2);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              } else {
                float xValue = getDy(batch, d2, idyR, idyC);
                float wValue = getW(wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }

            }
          }
        }
        setOutput(dotProd);
      }
    `}}class u9{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideDepth,r=e.strideHeight,s=e.strideWidth,o=e.padInfo.front,i=e.padInfo.top,a=e.padInfo.left;this.userCode=`
      void main() {
        ivec5 coords = getOutputCoords();
        int wF = coords.x;
        int wR = coords.y;
        int wC = coords.z;
        int d1 = coords.w;
        int d2 = coords.u;

        float dotProd = 0.0;

        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yF = 0; yF < ${e.outDepth}; yF++) {
            int xF = wF + yF * ${t} - ${o};

            if (xF < 0 || xF >= ${e.inDepth}) {
              continue;
            }

            for (int yR = 0; yR < ${e.outHeight}; yR++) {
              int xR = wR + yR * ${r} - ${i};

              if (xR < 0 || xR >= ${e.inHeight}) {
                continue;
              }

              for (int yC = 0; yC < ${e.outWidth}; yC++) {
                int xC = wC + yC * ${s} - ${a};

                if (xC < 0 || xC >= ${e.inWidth}) {
                  continue;
                }

                float dyValue = getDy(b, yF, yR, yC, d2);
                float xValue = getX(b, xF, xR, xC, d1);
                dotProd += (xValue * dyValue);
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class c9{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterDepth,r=e.filterHeight,s=e.filterWidth,o=e.strideDepth,i=e.strideHeight,a=e.strideWidth,u=t-1-e.padInfo.front,c=r-1-e.padInfo.top,l=s-1-e.padInfo.left;this.userCode=`
      const ivec3 pads = ivec3(${u}, ${c}, ${l});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.u;


        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyFCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        float dotProd = 0.0;
        for (int wF = 0; wF < ${t}; wF++) {
          float dyF = float(dyFCorner + wF) / ${o}.0;

          if (dyF < 0.0 || dyF >= ${e.outDepth}.0 || fract(dyF) > 0.0) {
            continue;
          }
          int idyF = int(dyF);

          int wFPerm = ${t} - 1 - wF;

          for (int wR = 0; wR < ${r}; wR++) {
            float dyR = float(dyRCorner + wR) / ${i}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
              fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            int wRPerm = ${r} - 1 - wR;

            for (int wC = 0; wC < ${s}; wC++) {
              float dyC = float(dyCCorner + wC) / ${a}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              int wCPerm = ${s} - 1 - wC;

              for (int d2 = 0; d2 < ${e.outChannels}; d2++) {
                float xValue = getDy(batch, idyF, idyR, idyC, d2);
                float wValue = getW(wFPerm, wRPerm, wCPerm, d1, d2);
                dotProd += xValue * wValue;
              }
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function l9(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:o}=e,{strides:i,pad:a,dataFormat:u,dimRoundingMode:c,filterShape:l}=r,h=wi(u),d=Zn(s.shape,l,i,1,a,c,!1,h),m=new i9(d);return t.runWebGLProgram(m,[s,o],"float32")}const h9={kernelName:jf,backendName:"webgl",kernelFunc:l9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function f9(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:o}=e,{inputShape:i,strides:a,pad:u,dataFormat:c,dimRoundingMode:l}=r,h=wi(c),d=Zn(i,o.shape,a,1,u,l,!1,h),m=new a9(d);return t.runWebGLProgram(m,[s,o],"float32")}const d9={kernelName:Hf,backendName:"webgl",kernelFunc:f9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function p9(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:o}=e,{strides:i,pad:a,dilations:u}=r,c=oa(s.shape,o.shape,i,u,a),l=new n9(c);return t.runWebGLProgram(l,[s,o],"float32")}const m9={kernelName:qf,backendName:"webgl",kernelFunc:p9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function g9(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:o}=e,{strides:i,pad:a,filterShape:u}=r,c=oa(s.shape,u,i,1,a),l=new u9(c);return t.runWebGLProgram(l,[s,o],"float32")}const y9={kernelName:N0,backendName:"webgl",kernelFunc:g9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function x9(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:o}=e,{pad:i,strides:a,inputShape:u}=r,c=oa(u,o.shape,a,1,i),l=new c9(c);return t.runWebGLProgram(l,[s,o],"float32")}const b9={kernelName:Xf,backendName:"webgl",kernelFunc:x9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const v9=Ii+`
  return cos(x);
`,w9=rt({opSnippet:v9}),C9={kernelName:Kf,backendName:"webgl",kernelFunc:w9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const T9=`
  float e2x = exp(-x);
  return (e2x + 1.0 / e2x) / 2.0;
`,$9=rt({opSnippet:T9}),S9={kernelName:Yf,backendName:"webgl",kernelFunc:$9};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class N9{constructor(e,t,r,s,o){this.variableNames=["Image","Boxes","BoxInd"],this.outputShape=[];const[i,a,u,c]=e,[l]=t,[h,d]=r;this.outputShape=[l,h,d,c];const m=s==="bilinear"?1:0,[g,C]=[`${a-1}.0`,`${u-1}.0`],[$,T,A]=h>1?[`${(a-1)/(h-1)}`,"(y2-y1) * height_ratio",`y1*${g} + float(y)*(height_scale)`]:["0.0","0.0",`0.5 * (y1+y2) * ${g}`],[P,B,H]=d>1?[`${(u-1)/(d-1)}`,"(x2-x1) * width_ratio",`x1*${C} + float(x)*(width_scale)`]:["0.0","0.0",`0.5 * (x1+x2) * ${C}`];this.userCode=`
      const float height_ratio = float(${$});
      const float width_ratio = float(${P});
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int y = coords[1];
        int x = coords[2];
        int d = coords[3];

        // get box vals
        float y1 = getBoxes(b,0);
        float x1 = getBoxes(b,1);
        float y2 = getBoxes(b,2);
        float x2 = getBoxes(b,3);

        // get image in batch index
        int bInd = round(getBoxInd(b));
        if(bInd < 0 || bInd >= ${i}) {
          return;
        }

        float height_scale = ${T};
        float width_scale = ${B};

        float in_y = ${A};
        if( in_y < 0.0 || in_y > ${g} ) {
          setOutput(float(${o}));
          return;
        }
        float in_x = ${H};
        if( in_x < 0.0 || in_x > ${C} ) {
          setOutput(float(${o}));
          return;
        }

        vec2 sourceFracIndexCR = vec2(in_x,in_y);
        if(${m} == 1) {
          // Compute the four integer indices.
          ivec2 sourceFloorCR = ivec2(sourceFracIndexCR);
          ivec2 sourceCeilCR = ivec2(ceil(sourceFracIndexCR));

          float topLeft = getImage(b, sourceFloorCR.y, sourceFloorCR.x, d);
          float bottomLeft = getImage(b, sourceCeilCR.y, sourceFloorCR.x, d);
          float topRight = getImage(b, sourceFloorCR.y, sourceCeilCR.x, d);
          float bottomRight = getImage(b, sourceCeilCR.y, sourceCeilCR.x, d);

          vec2 fracCR = sourceFracIndexCR - vec2(sourceFloorCR);

          float top = topLeft + (topRight - topLeft) * fracCR.x;
          float bottom = bottomLeft + (bottomRight - bottomLeft) * fracCR.x;
          float newValue = top + (bottom - top) * fracCR.y;
          setOutput(newValue);
        } else {
          // Compute the coordinators of nearest neighbor point.
          ivec2 sourceNearestCR = ivec2(floor(
            sourceFracIndexCR + vec2(0.5,0.5)));
          float newValue = getImage(b, sourceNearestCR.y, sourceNearestCR.x, d);
          setOutput(newValue);
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const E9=n=>{const{inputs:e,backend:t,attrs:r}=n,{image:s,boxes:o,boxInd:i}=e,{cropSize:a,method:u,extrapolationValue:c}=r,l=new N9(s.shape,o.shape,a,u,c);return t.runWebGLProgram(l,[s,o,i],"float32")},k9={kernelName:Jf,backendName:"webgl",kernelFunc:E9};var na;(function(n){n.Prod="*",n.Sum="+"})(na||(na={}));class Dh{constructor(e,t,r,s){this.op=e,this.outputShape=t,this.variableNames=["x"],this.customUniforms=[{name:"index",type:"float"}];const o=this.outputShape.length,i=this.op===na.Prod?"1.0":"0.0",a=r?i:`getX(${Fh(o,"coords",this.op)})`,u=this.outputShape[this.outputShape.length-1];let c="",l="";r?(c=s?`end != ${u-1}`:"end != 0",l=s?"end + 1":"end - 1"):(c=s?`end + pow2 < ${u}`:"end >= pow2",l=s?"end + pow2":"end - pow2"),this.userCode=`
      void main() {
        ${Tt(o)} coords = getOutputCoords();
        int end = ${Ph(o,"coords",this.op)};
        float val = ${a};
        int pow2 = int(pow(2.0, index));
        if (${c}) {
          int idx = ${l};
          ${Ph(o,"coords",this.op)} = idx;
          val ${this.op}= getX(${Fh(o,"coords",this.op)});
        }
        setOutput(val);
      }
    `}}function Fh(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.x, ${e}.y`;if(n===3)return`${e}.x, ${e}.y, ${e}.z`;if(n===4)return`${e}.x, ${e}.y, ${e}.z, ${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}function Ph(n,e,t){if(n===1)return`${e}`;if(n===2)return`${e}.y`;if(n===3)return`${e}.z`;if(n===4)return`${e}.w`;throw new Error(`Cumulative ${t} for rank ${n} is not yet supported`)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dg(n,e,t,r,s,o){const i=e.shape.length,a=yr([r],i);let u=e;a!=null&&(u=$n({inputs:{x:e},backend:t,attrs:{perm:a}}));const c=xr(1,i)[0];if(c!==i-1)throw new Error(`WebGL cumprod shader expects an inner-most axis=${e.shape.length-1} but got axis=${r}`);const l=u.shape[c];let h=Ln({inputs:{x:u},backend:t});for(let d=0;d<=Math.ceil(Math.log2(l))-1;d++){const m=new Dh(n,u.shape,!1,o),g=[[d]],C=h;h=t.runWebGLProgram(m,[h],h.dtype,g),t.disposeIntermediateTensorInfo(C)}if(s){const d=new Dh(n,u.shape,s,o),m=h;h=t.runWebGLProgram(d,[h],h.dtype),t.disposeIntermediateTensorInfo(m)}if(a!=null){const d=fl(a),m=$n({inputs:{x:h},backend:t,attrs:{perm:d}});return t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(u),m}return h}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I9(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;return dg(na.Prod,s,t,o,i,a)}const _9={kernelName:Qf,backendName:"webgl",kernelFunc:I9};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R9(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:o,exclusive:i,reverse:a}=r;return dg(na.Sum,s,t,o,i,a)}const A9={kernelName:Zf,backendName:"webgl",kernelFunc:R9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O9(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,weights:o}=e,{size:i,binaryOutput:a}=r;if(s.shape.length===1){const u=t.readSync(s.dataId),c=t.readSync(o.dataId),l=qm(u,c,o.dtype,o.shape,i);return t.makeTensorInfo([i],o.dtype,l)}else if(s.shape.length===2){const u=t.bufferSync(s),c=t.bufferSync(o),l=H$(u,c,i,a);return t.makeTensorInfo(l.shape,o.dtype,l.values)}throw new Error(`Error in denseBincount: input must be at most rank 2, but got rank${s.shape.length}.`)}const D9={kernelName:ed,backendName:"webgl",kernelFunc:O9};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class F9{constructor(e,t,r){this.variableNames=["x"],this.outputShape=[],this.outputShape=e,this.blockSize=t,this.dataFormat=r,this.userCode=`
    void main() {
      ivec4 coords = getOutputCoords();
      int b = coords[0];
      int h = ${this.getHeightCoordString()};
      int w = ${this.getWidthCoordString()};
      int d = ${this.getDepthCoordString()};

      int in_h = h / ${t};
      int offset_h = imod(h, ${t});
      int in_w = w / ${t};
      int offset_w = imod(w, ${t});
      int offset_d = (offset_h * ${t} + offset_w) *
        ${this.getOutputDepthSize()};
      int in_d = d + offset_d;

      float result = ${this.getInputSamplingString()};
      setOutput(result);
    }
  `}getHeightCoordString(){return this.dataFormat==="NHWC"?"coords[1]":"coords[2]"}getWidthCoordString(){return this.dataFormat==="NHWC"?"coords[2]":"coords[3]"}getDepthCoordString(){return this.dataFormat==="NHWC"?"coords[3]":"coords[1]"}getOutputDepthSize(){return this.dataFormat==="NHWC"?this.outputShape[3]:this.outputShape[1]}getInputSamplingString(){return this.dataFormat==="NHWC"?"getX(b, in_h, in_w, in_d)":"getX(b, in_d, in_h, in_w)"}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function P9(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockSize:o,dataFormat:i}=r,a=s.shape[0],u=i==="NHWC"?s.shape[1]:s.shape[2],c=i==="NHWC"?s.shape[2]:s.shape[3],l=i==="NHWC"?s.shape[3]:s.shape[1],h=u*o,d=c*o,m=l/(o*o),g=i==="NHWC"?[a,h,d,m]:[a,m,h,d],C=new F9(g,o,i);return t.runWebGLProgram(C,[s],s.dtype)}const L9={kernelName:td,backendName:"webgl",kernelFunc:P9};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class pg{constructor(e,t=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Nn(this.outputShape.length);const i=e.filterHeight,a=e.filterWidth,u=e.outChannels/e.inChannels;let c="",l="";r&&(s?c=`float activation(float a) {
          float b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?c=`float activation(float a) {
          float b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:c=`
          float activation(float x) {
            ${r}
          }
        `,l="result = activation(result);");const h=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${c}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${u};
        int q = d2 - d1 * ${u};

        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        // Convolve x(?, ?, d1) with w(:, :, d1, q) to get y(yR, yC, d2).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        // TO DO(dsmilkov): Flatten the two for loops and vec4 the operations.
        for (int wR = 0; wR < ${i}; wR++) {
          int xR = xRCorner + wR * dilations[0];

          if (xR < 0 || xR >= inDims[0]) {
            continue;
          }

          for (int wC = 0; wC < ${a}; wC++) {
            int xC = xCCorner + wC * dilations[1];

            if (xC < 0 || xC >= inDims[1]) {
              continue;
            }

            float xVal = getX(batch, xR, xC, d1);
            float wVal = getW(wR, wC, d1, q);
            dotProd += xVal * wVal;
          }
        }

        float result = dotProd;
        ${h}
        ${l}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mg{constructor(e,t=!1,r=null,s=!1,o=!1){this.variableNames=["x","W"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"pads",type:"ivec2"},{name:"strides",type:"ivec2"},{name:"dilations",type:"ivec2"},{name:"inDims",type:"ivec2"}],this.outputShape=e.outShape,this.enableShapeUniforms=Nn(this.outputShape.length);const i=e.outChannels/e.inChannels,a=e.padInfo.left,u=e.strideWidth,c=e.dilationWidth,l=e.filterHeight,h=e.filterWidth,d=h;let m=`
      int xR; int xC; int xCOffset;
      vec4 wTexel; vec4 previous; vec4 final;`;for(let T=0;T<h;T++)m+=`
          vec4 xTexelC${T*2};
          int xTexelC${T*2}Ready;
          vec4 xTexelC${T*2+1};
          int xTexelC${T*2+1}Ready;
          vec4 xC${T};`;m+=`
    for (int r = 0; r < ${l}; r++) {
      `;for(let T=0;T<h;T++)m+=`
          xTexelC${T*2} = vec4(0.0);
          xTexelC${T*2}Ready = 0;
          xTexelC${T*2+1} = vec4(0.0);
          xTexelC${T*2+1}Ready = 0;
          xC${T} = vec4(0.0);`;m+=`
        xR = xRCorner + r * dilations[0];
        if (xR >=0 && xR < inDims[0]) {
      `;for(let T=0;T<(d+1)/2;T++){const A=T*2;if(m+=`
          xC = xCCorner + ${A*c};
          `,u===1){if(A<h&&(a%2===1?(m+=`
                xCOffset = xC + 1;
                if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${A}Ready == 0) {
                  xTexelC${A} = getX(batch, xR, xCOffset, d1);

                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${A}.zw = vec2(0.0);
                  }
                  xTexelC${A}Ready = 1;
                }
              `,c===1&&A>0?m+=`
                xC${A} = vec4(xTexelC${A-2}.zw, xTexelC${A}.xy);
                `:m+=`
                  xCOffset = xC + 1 - 2;

                  if (xCOffset >= 0 && xCOffset < inDims[1]) {
                    previous = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      previous.zw = vec2(0.0);
                    }

                    xC${A} = vec4(previous.zw, xTexelC${A}.xy);
                  } else {
                    xC${A} = vec4(0.0, 0.0, xTexelC${A}.xy);
                  }
                  `):m+=`
                if (xC >= 0 && xC < inDims[1] && xTexelC${A}Ready == 0) {
                  xTexelC${A} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${A}.zw = vec2(0.0);
                  }
                  xTexelC${A}Ready = 1;
                }

                xC${A} = xTexelC${A};
                `,A+1<h)){const P=a%2===0?jc(c):c;c%2===0&&a%2===1||c%2!==0&&a%2!==1?(m+=`
                  xCOffset = xC + imod(pads[1], 2) + ${P};

                  if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${A+1}Ready == 0) {
                    xTexelC${A+1} = getX(batch, xR, xCOffset, d1);

                    // Need to manually clear unused channels in case
                    // we're reading from recycled texture.
                    if (xCOffset + 1 >= inDims[1]) {
                      xTexelC${A+1}.zw = vec2(0.0);
                    }
                    xTexelC${A+1}Ready = 1;
                  }
                  `,c>1?m+=`
                    xCOffset -= 2;
                    if (xCOffset >= 0 && xCOffset < inDims[1]) {
                     previous = getX(batch, xR, xCOffset, d1);
                     xC${A+1} = vec4(previous.zw, xTexelC${A+1}.xy);
                    } else {
                     xC${A+1} = vec4(0.0, 0.0, xTexelC${A+1}.xy);
                    }
                    `:m+=`
                    xC${A+1} = vec4(xTexelC${A}.zw, xTexelC${A+1}.xy);
                    `):P===1?m+=`
                    xC${A+1} = xTexelC${A};
                    `:m+=`
                    xCOffset = xC + ${P};

                    if (xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${A+1}Ready == 0) {
                      xTexelC${A+1} = getX(batch, xR, xCOffset, d1);
                      if (xCOffset + 1 >= inDims[1]) {
                        xTexelC${A+1}.zw = vec2(0.0);
                      }
                      xTexelC${A+1}Ready = 1;
                    }

                    xC${A+1} = xTexelC${A+1};
                    `}}else A<h&&(a%2===1?(m+=`
                xCOffset = xC + 1 - strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${A}Ready == 0) {
                  xTexelC${A} = getX(batch, xR, xCOffset, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${A}.zw = vec2(0.0);
                  }
                  xTexelC${A}Ready = 1;
                }

                if(xC + 1 >= 0 && xC + 1 < inDims[1] && xTexelC${A+1}Ready == 0) {
                  xTexelC${A+1} = getX(batch, xR, xC + 1, d1);
                  // Need to manually clear unused channels in case
                  // we're reading from recycled texture.
                  if (xC + 2 >= inDims[1]) {
                    xTexelC${A+1}.zw = vec2(0.0);
                  }
                  xTexelC${A+1}Ready = 1;
                }

                xC${A} = vec4(xTexelC${A}.zw, xTexelC${A+1}.zw);
              `,A+1<h&&(m+=`
                  final = vec4(0.0);
                  xCOffset = xC + 1 + strides[1];
                  if(xCOffset >= 0 && xCOffset < inDims[1]) {
                    final = getX(batch, xR, xCOffset, d1);
                  }
                  xC${A+1} = vec4(xTexelC${A+1}.xy, final.xy);
                `)):(m+=`
                if(xC >= 0 && xC < inDims[1] && xTexelC${A}Ready == 0) {
                  xTexelC${A} = getX(batch, xR, xC, d1);
                  if (xC + 1 >= inDims[1]) {
                    xTexelC${A}.zw = vec2(0.0);
                  }
                  xTexelC${A}Ready = 1;
                }

                xCOffset = xC + strides[1];
                if(xCOffset >= 0 && xCOffset < inDims[1] && xTexelC${A+1}Ready == 0) {
                  xTexelC${A+1} = getX(batch, xR, xCOffset, d1);
                  if (xCOffset + 1 >= inDims[1]) {
                    xTexelC${A+1}.zw = vec2(0.);
                  }
                  xTexelC${A+1}Ready = 1;
                }

                xC${A} = vec4(
                  xTexelC${A}.xy, xTexelC${A+1}.xy);
              `,A+1<h&&(m+=`
                  xC${A+1} = vec4(xTexelC${A}.zw, xTexelC${A+1}.zw);
                `)));A<h&&(m+=`
            wTexel = getW(r, ${A}, d1, q);
            dotProd += xC${A} * vec4(wTexel.xz, wTexel.xz);
          `,A+1<h&&(m+=`
              wTexel = getW(r, ${A+1}, d1, q);
              dotProd += xC${A+1} * vec4(wTexel.xz, wTexel.xz);
            `))}m+=`
    }
  `,m+=`
      }
    `;let g="",C="";r&&(s?g=`vec4 activation(vec4 a) {
          vec4 b = getPreluActivationWeightsAtOutCoords();
          ${r}
        }`:o?g=`vec4 activation(vec4 a) {
          vec4 b = getLeakyreluAlphaAtOutCoords();
          ${r}
        }`:g=`vec4 activation(vec4 x) {
          ${r}
        }`,C="result = activation(result);");const $=t?"result += getBiasAtOutCoords();":"";t&&this.variableNames.push("bias"),s&&this.variableNames.push("preluActivationWeights"),o&&this.variableNames.push("leakyreluAlpha"),this.userCode=`
      ${g}

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        ivec2 xRCCorner = coords.yz * strides - pads;
        int d2 = coords.w;
        int d1 = d2 / ${i};
        int q = d2 - d1 * ${i};
        int xRCorner = xRCCorner.x;
        int xCCorner = xRCCorner.y;

        //intialize dotProd with a small epsilon seems to reduce GPU accuracy loss.
        vec4 dotProd = vec4(0.000000000000001);

        ${m}

        vec4 result = dotProd - vec4(0.000000000000001);
        ${$}
        ${C}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function B9(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:o}=e,{strides:i,pad:a,dilations:u,dimRoundingMode:c}=r;let l=u;l==null&&(l=[1,1]),M(Mn(i,l),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${i} and dilations '${l}'`);const h=Zn(s.shape,o.shape,i,l,a,c,!0);let d;ue().getBool("WEBGL_PACK_DEPTHWISECONV")&&h.strideWidth<=2&&h.outChannels/h.inChannels===1?d=new mg(h):d=new pg(h);const m=[[h.padInfo.top,h.padInfo.left],[h.strideHeight,h.strideWidth],[h.dilationHeight,h.dilationWidth],[h.inHeight,h.inWidth]];return t.runWebGLProgram(d,[s,o],"float32",m)}const M9={kernelName:nd,backendName:"webgl",kernelFunc:B9};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class V9{constructor(e){this.variableNames=["x","dy"],this.outputShape=e.filterShape;const t=e.strideHeight,r=e.strideWidth,s=e.padInfo.top,o=e.padInfo.left,i=e.outChannels/e.inChannels;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int wR = coords.x;
        int wC = coords.y;
        int d1 = coords.z;
        int dm = coords.w;
        int d2 = d1 * ${i} + dm;

        float dotProd = 0.0;

        // TO DO: Vec4 over the batch size
        for (int b = 0; b < ${e.batchSize}; b++) {
          for (int yR = 0; yR < ${e.outHeight}; yR++) {
            int xR = wR + yR * ${t} - ${s};

            if (xR < 0 || xR >= ${e.inHeight}) {
              continue;
            }

            for (int yC = 0; yC < ${e.outWidth}; yC++) {
              int xC = wC + yC * ${r} - ${o};

              if (xC < 0 || xC >= ${e.inWidth}) {
                continue;
              }

              float dyValue = getDy(b, yR, yC, d2);
              float xValue = getX(b, xR, xC, d1);
              dotProd += (xValue * dyValue);
            }
          }
        }
        setOutput(dotProd);
      }
    `}}class U9{constructor(e){this.variableNames=["dy","W"],this.outputShape=e.inShape;const t=e.filterHeight,r=e.filterWidth,s=e.strideHeight,o=e.strideWidth,i=t-1-e.padInfo.top,a=r-1-e.padInfo.left,u=e.outChannels/e.inChannels;this.userCode=`
      const ivec2 pads = ivec2(${i}, ${a});

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords[0];
        int d1 = coords[3];
        ivec2 dyCorner = coords.yz - pads;
        int dyRCorner = dyCorner.x;
        int dyCCorner = dyCorner.y;

        float dotProd = 0.0;

        for (int wR = 0; wR < ${t}; wR++) {
          float dyR = float(dyRCorner + wR) / ${s}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          int wRPerm = ${t} - 1 - wR;

          for (int wC = 0; wC < ${r}; wC++) {
            float dyC = float(dyCCorner + wC) / ${o}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            int wCPerm = ${r} - 1 - wC;

            // TO DO: Vec4 over the channelMul
            for (int dm = 0; dm < ${u}; dm++) {
              int d2 = d1 * ${u} + dm;
              float xValue = getDy(batch, idyR, idyC, d2);
              float wValue = getW(wRPerm, wCPerm, d1, dm);
              dotProd += xValue * wValue;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function W9(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,dy:o}=e,{strides:i,dilations:a,pad:u,dimRoundingMode:c,filterShape:l}=r,h=Zn(s.shape,l,i,a,u,c,!0),d=new V9(h);return t.runWebGLProgram(d,[s,o],"float32")}const z9={kernelName:rd,backendName:"webgl",kernelFunc:W9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function G9(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,filter:o}=e,{strides:i,dilations:a,pad:u,dimRoundingMode:c,inputShape:l}=r,h=Zn(l,o.shape,i,a,u,c,!0),d=new U9(h);return t.runWebGLProgram(d,[s,o],"float32")}const j9={kernelName:sd,backendName:"webgl",kernelFunc:G9};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class H9{constructor(e){this.variableNames=["X"],this.outputShape=[e,e],this.userCode=`
      void main() {
          ivec2 coords = getOutputCoords();
          float val = coords[0] == coords[1] ? getX(coords[0]) : 0.0;
          setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function q9(n){const{inputs:e,backend:t}=n,{x:r}=e,s=[...r.shape,...r.shape],o=Ce(r.shape),i=ke({inputs:{x:r},backend:t,attrs:{shape:[o]}}),a=new H9(o),u=t.runWebGLProgram(a,[i],i.dtype),c=ke({inputs:{x:u},backend:t,attrs:{shape:s}});return t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(u),c}const X9={kernelName:od,backendName:"webgl",kernelFunc:q9};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class K9{constructor(e){this.variableNames=["x","W"],this.outputShape=e.outShape;const{inHeight:t,inWidth:r,padInfo:s,strideHeight:o,strideWidth:i,filterHeight:a,filterWidth:u,dilationHeight:c,dilationWidth:l}=e,{top:h,left:d}=s;this.userCode=`
      const ivec2 strides = ivec2(${o}, ${i});
      const ivec2 pads = ivec2(${h}, ${d});
      const float neg_infinity = -3.4e38;

      void main() {
        ivec4 coords = getOutputCoords();
        int batch = coords.x;
        int d1 = coords.w;
        ivec2 outTopLeftCorner =
            coords.yz * strides - pads;
        int hBeg = outTopLeftCorner.x;
        int wBeg = outTopLeftCorner.y;

        float curVal = neg_infinity;
        for (int h = 0; h < ${a}; h++) {
          int hIn = hBeg + h * ${c};

          if (hIn >= 0 && hIn < ${t}) {
            for (int w = 0; w < ${u}; w++) {
              int wIn = wBeg + w * ${l};

              if (wIn >= 0 && wIn < ${r}) {
                float xVal = getX(batch, hIn, wIn, d1);
                float wVal = getW(h, w, d1);

                float val = xVal + wVal;
                if (val > curVal) {
                  curVal = val;
                }
              }
            }
          }
        }

        float result = curVal;
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Y9(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:o}=e,{strides:i,pad:a,dilations:u}=r,c=s2(s.shape,o.shape,i,a,"NHWC",u);let l;const h=new K9(c);l=t.runWebGLProgram(h,[s,o],"float32");const d=ke({inputs:{x:l},backend:t,attrs:{shape:c.outShape}});return t.disposeIntermediateTensorInfo(l),d}const Q9={kernelName:id,backendName:"webgl",kernelFunc:Y9};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Z9(n){const{inputs:e,backend:t,attrs:r}=n,{equation:s}=r,o=e,{allDims:i,summedDims:a,idDims:u}=dm(s,o.length);mm(i.length,u,o);const{path:c,steps:l}=gm(a,u),h=l.length;let d=null,m=i.length;const g=[];for(let C=0;C<h;++C){for(const $ of l[C]){const{permutationIndices:T,expandDims:A}=pm(m,u[$]);let P;ym(T)?P=o[$]:(P=$n({inputs:{x:o[$]},backend:t,attrs:{perm:T}}),g.push(P));const B=P.shape.slice();for(let H=0;H<A.length;++H)B.splice(A[H],0,1);Bt(P.shape,B)||(P=ke({inputs:{x:P},backend:t,attrs:{shape:B}}),g.push(P)),d===null?d=P:(d=Al({inputs:{a:P,b:d},backend:t}),g.push(d))}C<h-1&&(c[C]>=0&&(d=bu({inputs:{x:d},backend:t,attrs:{axis:c[C]-(i.length-m),keepDims:!1}}),g.push(d)),m--)}for(const C of g)C!==d&&t.disposeIntermediateTensorInfo(C);return d}const J9={kernelName:ud,backendName:"webgl",kernelFunc:Z9};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eN="return (x >= 0.0) ? x : (exp(x) - 1.0);",tN=`
  vec4 result;

  result.r = (x.r >= 0.0) ? x.r : (exp(x.r) - 1.0);
  result.g = (x.g >= 0.0) ? x.g : (exp(x.g) - 1.0);
  result.b = (x.b >= 0.0) ? x.b : (exp(x.b) - 1.0);
  result.a = (x.a >= 0.0) ? x.a : (exp(x.a) - 1.0);

  return result;
`,nN=rt({opSnippet:eN,packedOpSnippet:tN}),rN={kernelName:cd,backendName:"webgl",kernelFunc:nN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sN="return (b >= 1.0) ? a : a * (b + 1.0);",oN=`
  vec4 bGTEZero = vec4(greaterThanEqual(b, vec4(0.)));
  return (bGTEZero * a) + ((vec4(1.0) - bGTEZero) * (a * (b + vec4(1.0))));
`,iN=n=>{const{inputs:e,backend:t}=n,{dy:r,y:s}=e,o=ue().getBool("WEBGL_PACK_BINARY_OPERATIONS")?new ha(oN,r.shape,s.shape):new yi(sN,r.shape,s.shape);return t.runWebGLProgram(o,[r,s],r.dtype)},aN={kernelName:E0,backendName:"webgl",kernelFunc:iN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uN=`
  return vec4(equal(a, b));
`,cN="return float(a == b);",lN=on({opSnippet:cN,packedOpSnippet:uN,dtype:"bool",cpuKernelImpl:Y$}),hN={kernelName:hd,backendName:"webgl",kernelFunc:lN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fN=`
  // Error function is calculated approximately with elementary function.
  // See "Handbook of Mathematical Functions with Formulas,
  // Graphs, and Mathematical Tables", Abramowitz and Stegun.
  float p = ${am};
  float a1 = ${um};
  float a2 = ${cm};
  float a3 = ${lm};
  float a4 = ${hm};
  float a5 = ${fm};

  float sign = sign(x);
  x = abs(x);
  float t = 1.0 / (1.0 + p * x);
  return sign * (1.0 - (((((a5*t + a4)*t) + a3)*t + a2)*t + a1)*t*exp(-x*x));
`,dN=rt({opSnippet:fN}),pN={kernelName:ld,backendName:"webgl",kernelFunc:dN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mN=Ii+`
  return exp(x);
`,gN=`
  vec4 result = exp(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,gg=rt({opSnippet:mN,packedOpSnippet:gN,cpuKernelImpl:Q$,dtype:"float32"}),yN={kernelName:fd,backendName:"webgl",kernelFunc:gg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ac(n){const{inputs:e,attrs:t,backend:r}=n,{dim:s}=t,{input:o}=e,i=o.shape.length,a=o.shape.slice();let u=s;return s<0&&(M(-(i+1)<=s,()=>`Axis must be in the interval [${-(i+1)}, ${i}]`),u=i+s+1),a.splice(u,0,1),ke({inputs:{x:o},backend:r,attrs:{shape:a}})}const xN={kernelName:dd,backendName:"webgl",kernelFunc:Ac};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Lh="return exp(x) - 1.0;",bN=rt({opSnippet:Lh,packedOpSnippet:Lh,cpuKernelImpl:Z$}),vN={kernelName:pd,backendName:"webgl",kernelFunc:bN};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Bh{constructor(e,t,r){this.variableNames=["real","imag"];const s=t[1];this.outputShape=t;const o=r?`2.0 * ${Math.PI}`:`-2.0 * ${Math.PI}`,i=r?`${s}.0`:"1.0";let a;if(e==="real")a="return real * expR - imag * expI;";else if(e==="imag")a="return real * expI + imag * expR;";else throw new Error(`FFT component must be either "real" or "imag", got ${e}.`);this.userCode=`
      const float exponentMultiplier = ${o};

      float unaryOpComplex(float real, float expR, float imag, float expI) {
        ${a}
      }

      float mulMatDFT(int batch, int index) {
        float indexRatio = float(index) / float(${s});
        float exponentMultiplierTimesIndexRatio =
            exponentMultiplier * indexRatio;

        float result = 0.0;

        for (int i = 0; i < ${s}; i++) {
          // x = (-2|2 * PI / N) * index * i;
          float x = exponentMultiplierTimesIndexRatio * float(i);
          float expR = cos(x);
          float expI = sin(x);
          float real = getReal(batch, i);
          float imag = getImag(batch, i);

          result +=
              unaryOpComplex(real, expR, imag, expI) / ${i};
        }

        return result;
      }

      void main() {
        ivec2 coords = getOutputCoords();
        setOutput(mulMatDFT(coords[0], coords[1]));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yg(n,e,t){const r=t.texData.get(n.dataId),s=Ce(n.shape),o=n.shape[n.shape.length-1],i=s/o,a=ke({inputs:{x:n},backend:t,attrs:{shape:[i,o]}}),u=a.shape,c=new Bh("real",u,e),l=new Bh("imag",u,e),h=[{dataId:r.complexTensorInfos.real.dataId,dtype:r.complexTensorInfos.real.dtype,shape:u},{dataId:r.complexTensorInfos.imag.dataId,dtype:r.complexTensorInfos.imag.dtype,shape:u}],d=t.runWebGLProgram(c,h,"float32"),m=t.runWebGLProgram(l,h,"float32"),g=Ys({inputs:{real:d,imag:m},backend:t});t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(m);const C=ke({inputs:{x:g},backend:t,attrs:{shape:n.shape}});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(g),C}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wN(n){const{inputs:e,backend:t}=n,{input:r}=e;return yg(r,!1,t)}const CN={kernelName:md,backendName:"webgl",kernelFunc:wN};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TN{constructor(e,t){this.outputShape=[],this.customUniforms=[{name:"value",type:"float"}],this.variableNames=["x"],this.outputShape=e,this.userCode=`
      void main() {
        // Input can be obtained from uniform value.
        setOutput(value);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function da(n){const{backend:e,attrs:t}=n,{shape:r,value:s}=t;let{dtype:o}=t;if(o=o||eu(s),o==="string"){const i=_n(o,Ce(r));return i.fill(s),e.makeTensorInfo(r,o,i)}else{const i=new TN(r,s),a=[[s]];return e.runWebGLProgram(i,[],o,a)}}const $N={kernelName:gd,backendName:"webgl",kernelFunc:da};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class SN{constructor(e){this.variableNames=["Image"],this.outputShape=[];const t=e[2];this.outputShape=e,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];

          int coordX = ${t} - x - 1;
          float outputValue;
          if(coordX >= 0 && coordX < ${t}) {
            outputValue = getImage(coords[0], coords[1], coordX, coords[3]);
          } else {
            outputValue = getImage(coords[0], coords[1], coords[2], coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NN={kernelName:yd,backendName:"webgl",kernelFunc:({inputs:n,backend:e})=>{const{image:t}=n,r=e,s=new SN(t.shape);return r.runWebGLProgram(s,[t],t.dtype)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mh="return floor(x);",EN=rt({opSnippet:Mh,packedOpSnippet:Mh,cpuKernelImpl:J$}),kN={kernelName:xd,backendName:"webgl",kernelFunc:EN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IN=`
  float s = sign(a) * sign(b);
  int ia = round(a);
  int ib = round(b);
  if (ib != 0) {
    // Windows (D3D) wants guaranteed non-zero int division at compile-time.
    return float(idiv(ia, ib, s));
  } else {
    return NAN;
  }
`,_N=`
  ivec4 ia = round(a);
  ivec4 ib = round(b);
  bvec4 cond = notEqual(ib, ivec4(0));
  ivec4 result = ivec4(0);
  vec4 s = sign(a) * sign(b);

  // Windows (D3D) wants guaranteed non-zero int division at compile-time.
  if (cond[0]) {
    result[0] = idiv(ia[0], ib[0], s[0]);
  }
  if (cond[1]) {
    result[1] = idiv(ia[1], ib[1], s[1]);
  }
  if (cond[2]) {
    result[2] = idiv(ia[2], ib[2], s[2]);
  }
  if (cond[3]) {
    result[3] = idiv(ia[3], ib[3], s[3]);
  }
  return vec4(result);
`,RN=on({opSnippet:IN,packedOpSnippet:_N,dtype:"int32"}),AN={kernelName:bd,backendName:"webgl",kernelFunc:RN};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class ON{constructor(e){this.variableNames=["A"];const t=Sn(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];
        vec2 uv = (vec2(texC, texR) + halfCR) / vec2(${s}.0, ${r}.0);

        vec4 values = ${t.texture2D}(A, uv);
        float value;
        if (depth == 0) {
          value = values.r;
        } else if (depth == 1) {
          value = values.g;
        } else if (depth == 2) {
          value = values.b;
        } else if (depth == 3) {
          value = values.a;
        }

        setOutput(floor(value * 255.0 + 0.5));
      }
    `}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DN{constructor(e){this.variableNames=["A"],this.packedInputs=!1,this.packedOutput=!0;const t=Sn(),[r,s]=e;this.outputShape=e,this.userCode=`
      void main() {
        ivec3 coords = getOutputCoords();
        int texR = coords[0];
        int texC = coords[1];
        int depth = coords[2];

        vec4 result = vec4(0.);

        for(int row=0; row<=1; row++) {
          for(int col=0; col<=1; col++) {
            texC = coords[1] + row;
            depth = coords[2] + col;

            vec2 uv = (vec2(texC, texR) + halfCR) /
                       vec2(${s}.0, ${r}.0);
            vec4 values = ${t.texture2D}(A, uv);
            float value;
            if (depth == 0) {
              value = values.r;
            } else if (depth == 1) {
              value = values.g;
            } else if (depth == 2) {
              value = values.b;
            } else if (depth == 3) {
              value = values.a;
            }

            result[row * 2 + col] = floor(value * 255.0 + 0.5);
          }
        }

        ${t.output} = result;
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FN={kernelName:rc,backendName:"webgl",kernelFunc:PN};let ei,Uu=ue().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");function PN(n){const{inputs:e,backend:t,attrs:r}=n;let{pixels:s}=e;const{numChannels:o}=r,i=typeof HTMLVideoElement<"u"&&s instanceof HTMLVideoElement,a=typeof HTMLImageElement<"u"&&s instanceof HTMLImageElement,[u,c]=i?[s.videoWidth,s.videoHeight]:[s.width,s.height],l=[c,u],h=[c,u,o];if(a||i){const C=ue().getBool("CANVAS2D_WILL_READ_FREQUENTLY_FOR_GPU");(ei==null||C!==Uu)&&(Uu=C,ei=document.createElement("canvas").getContext("2d",{willReadFrequently:Uu})),ei.canvas.width=u,ei.canvas.height=c,ei.drawImage(s,0,0,u,c),s=ei.canvas}const d=t.makeTensorInfo(l,"int32");t.texData.get(d.dataId).usage=Yn.PIXELS,t.gpgpu.uploadPixelDataToTexture(t.getTexture(d.dataId),s);const m=ue().getBool("WEBGL_PACK")?new DN(h):new ON(h),g=t.runWebGLProgram(m,[d],"int32");return t.disposeData(d.dataId),g}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function LN(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:u,pad:c,dataFormat:l,dilations:h,dimRoundingMode:d,activation:m,leakyreluAlpha:g}=r,C=wi(l),$=Zn(s.shape,o.shape,u,h,c,d,!1,C);let T;const A=[],P=i!=null,B=a!=null,H=m==="leakyrelu",x=()=>{const oe=[s,o],ie=(le,$e)=>{if($e==="NCHW"&&le.shape.length===1&&le.shape[0]!==1){const Ie=ke({inputs:{x:le},backend:t,attrs:{shape:[le.shape[0],1,1]}});return A.push(Ie),Ie}return le};if(P&&oe.push(ie(i,l)),B&&oe.push(ie(a,l)),H){const le=t.makeTensorInfo([],"float32",vi(g,"float32"));oe.push(le),A.push(le)}return oe};if($.filterHeight===1&&$.filterWidth===1&&$.dilationHeight===1&&$.dilationWidth===1&&$.strideHeight===1&&$.strideWidth===1&&($.padInfo.type==="SAME"||$.padInfo.type==="VALID"))T=hg({x:s,filter:o,convInfo:$,backend:t,bias:i,activation:m,preluActivationWeights:a,leakyreluAlpha:g});else if($.strideWidth<=2&&C==="channelsLast"&&ue().getBool("WEBGL_EXP_CONV")){const oe=m?ea(m,!0):null,ie=new lg($,P,oe,B,H),le=[[$.padInfo.top,$.padInfo.left],[$.strideHeight,$.strideWidth],[$.dilationHeight,$.dilationWidth],[$.inHeight,$.inWidth]],$e=x();T=t.runWebGLProgram(ie,$e,"float32",le)}else if(ue().getBool("WEBGL_CONV_IM2COL"))T=fg({x:s,filter:o,convInfo:$,backend:t,bias:i,activation:m,preluActivationWeights:a,leakyreluAlpha:g});else{const oe=m?ea(m,!1):null,ie=new cg($,P,oe,B,H),le=x();T=t.runWebGLProgram(ie,le,"float32")}const re=ke({inputs:{x:T},backend:t,attrs:{shape:$.outShape}});return A.push(T),A.forEach(oe=>t.disposeIntermediateTensorInfo(oe)),re}const BN={kernelName:oc,backendName:"webgl",kernelFunc:LN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function MN(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,filter:o,bias:i,preluActivationWeights:a}=e,{strides:u,pad:c,dilations:l,dimRoundingMode:h,activation:d,leakyreluAlpha:m}=r,g=[];let C=l;C==null&&(C=[1,1]),M(Mn(u,C),()=>`Error in depthwiseConv2d: Either strides or dilations must be 1. Got strides ${u} and dilations '${C}'`);const $=Zn(s.shape,o.shape,u,C,c,h,!0),T=ue().getBool("WEBGL_PACK_DEPTHWISECONV")&&$.strideWidth<=2&&$.outChannels/$.inChannels===1,A=d?ea(d,T):null,P=[s,o],B=i!=null,H=a!=null,x=d==="leakyrelu";if(B&&P.push(i),H&&P.push(a),x){const le=t.makeTensorInfo([],"float32",vi(m,"float32"));P.push(le),g.push(le)}let re;T?re=new mg($,B,A,H,x):re=new pg($,B,A,H,x);const oe=[[$.padInfo.top,$.padInfo.left],[$.strideHeight,$.strideWidth],[$.dilationHeight,$.dilationWidth],[$.inHeight,$.inWidth]],ie=t.runWebGLProgram(re,P,"float32",oe);return g.forEach(le=>t.disposeIntermediateTensorInfo(le)),ie}const VN={kernelName:ic,backendName:"webgl",kernelFunc:MN};class UN{constructor(e,t,r,s){this.sliceDim=e,this.strides=t,this.paramsShape=s,this.variableNames=["x","indices"],this.outputShape=r;const o=Tt(r.length);let i=`
    int index;`;for(let a=0;a<this.sliceDim;a++)i+=`
          index = round(getIndices(coords[0], ${a}));
          out_of_bounds = out_of_bounds || index < 0;
          out_of_bounds = out_of_bounds || index >= ${this.paramsShape[a]};
          flattenIndex += index * ${this.strides[a]};`;this.userCode=`
         void main() {
          ${o} coords = getOutputCoords();
          int flattenIndex = 0;
          bool out_of_bounds = false;

          ${i}

          setOutput(out_of_bounds ? 0.0 : getX(flattenIndex, coords[1]));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WN(n){const{inputs:e,backend:t}=n,{params:r,indices:s}=e,o=s.shape,i=o[o.length-1],a=Ce(r.shape),[u,c,l,h]=W1(r,s),d=ke({inputs:{x:s},backend:t,attrs:{shape:[c,i]}}),m=ke({inputs:{x:r},backend:t,attrs:{shape:[Ce(r.shape)/l,l]}});if(t.shouldExecuteOnCPU([r,s])||r.dtype==="string"){const T=t.readSync(s.dataId),A=t.bufferSync(r),P=eS(T,A,r.dtype,c,i,l,h,r.shape,a);return t.makeTensorInfo(u,r.dtype,P.values)}const g=new UN(i,h,[c,l],r.shape),C=t.runWebGLProgram(g,[m,d],m.dtype),$=ke({inputs:{x:C},backend:t,attrs:{shape:u}});return t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(C),$}const zN={kernelName:Cd,backendName:"webgl",kernelFunc:WN};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GN{constructor(e,t){this.variableNames=["A","indices"],this.outputShape=t,this.rank=t.length;const r=Tt(this.rank),s=jN(e);this.userCode=`
      void main() {
        ${r} resRC = getOutputCoords();
        int index = int(getIndices(resRC.x, resRC.z));
        float inBounds = (index >= 0) && (index < ${e[2]}) ? 1.0 : 0.0;
        setOutput(inBounds * getA(${s}));
      }
    `}}function jN(n,e){const t=["resRC.x","resRC.y","resRC.z","resRC.w"],r=[];for(let s=0;s<n.length;s++)s===2?r.push("index"):r.push(`${t[s]}`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function xg(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,indices:o}=e,{axis:i,batchDims:a}=r,u=Zt(i,s.shape)[0];if(ue().get("DEBUG")){const A=t.readSync(o.dataId),P=s.shape[u];for(let B=0;B<A.length;++B){const H=A[B];M(H<=P-1&&H>=0,()=>`GatherV2: the index value ${H} is not in [0, ${P-1}]`)}}const c=Am(s,o,u,a),l=Ce(o.shape),h=[],d=ke({inputs:{x:s},backend:t,attrs:{shape:[c.batchSize,c.outerSize,c.dimSize,c.sliceSize]}}),m=ke({inputs:{x:o},backend:t,attrs:{shape:[c.batchSize,l/c.batchSize]}});h.push(d),h.push(m);const g=[c.batchSize,c.outerSize,l/c.batchSize,c.sliceSize];if(t.shouldExecuteOnCPU([s,o])||s.dtype==="string"){const A=t.bufferSync(m),P=t.bufferSync(d),B=tS(P,A,g);return h.forEach(H=>t.disposeIntermediateTensorInfo(H)),t.makeTensorInfo(c.outputShape,B.dtype,B.values)}const C=new GN(d.shape,g),$=t.runWebGLProgram(C,[d,m],d.dtype);h.push($);const T=ke({inputs:{x:$},backend:t,attrs:{shape:c.outputShape}});return h.forEach(A=>t.disposeIntermediateTensorInfo(A)),T}const HN={kernelName:wd,backendName:"webgl",kernelFunc:xg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const qN="return float(a > b);",XN=`
  return vec4(greaterThan(a, b));
`,KN=on({opSnippet:qN,packedOpSnippet:XN,cpuKernelImpl:nS,dtype:"bool"}),YN={kernelName:Td,backendName:"webgl",kernelFunc:KN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const QN="return float(a >= b);",ZN=`
  return vec4(greaterThanEqual(a, b));
`,JN=on({opSnippet:QN,packedOpSnippet:ZN,dtype:"bool",cpuKernelImpl:rS}),eE={kernelName:$d,backendName:"webgl",kernelFunc:JN};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tE(n){const{inputs:e,backend:t}=n,{input:r}=e;return yg(r,!0,t)}const nE={kernelName:Sd,backendName:"webgl",kernelFunc:tE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rE="return float(!isnan(x) && !isinf(x));",sE=rt({opSnippet:rE,dtype:"bool"}),oE={kernelName:Ed,backendName:"webgl",kernelFunc:sE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iE="return float(isinf(x));",aE=rt({opSnippet:iE,dtype:"bool"}),uE={kernelName:kd,backendName:"webgl",kernelFunc:aE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const cE="return float(isnan(x));",lE=rt({opSnippet:cE,dtype:"bool"}),hE={kernelName:Id,backendName:"webgl",kernelFunc:lE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fE="return float(a < b);",dE=`
  return vec4(lessThan(a, b));
`,pE=on({opSnippet:fE,packedOpSnippet:dE,cpuKernelImpl:sS,dtype:"bool"}),mE={kernelName:Rd,backendName:"webgl",kernelFunc:pE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gE="return float(a <= b);",yE=`
  return vec4(lessThanEqual(a, b));
`,xE=on({opSnippet:gE,packedOpSnippet:yE,cpuKernelImpl:oS,dtype:"bool"}),bE={kernelName:Ad,backendName:"webgl",kernelFunc:xE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function vE(n){const{backend:e,attrs:t}=n,{start:r,stop:s,num:o}=t,i=iS(r,s,o);return e.makeTensorInfo([i.length],"float32",i)}const wE={kernelName:Od,backendName:"webgl",kernelFunc:vE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CE=Ii+`
  return x < 0.0 ? 0./0. : log(x);
`,TE=`
  vec4 result = log(x);
  bvec4 isNaN = isnan(x);
  result.r = isNaN.r ? x.r : (x.r < 0.0 ? 0./0. : result.r);
  result.g = isNaN.g ? x.g : (x.g < 0.0 ? 0./0. : result.g);
  result.b = isNaN.b ? x.b : (x.b < 0.0 ? 0./0. : result.b);
  result.a = isNaN.a ? x.a : (x.a < 0.0 ? 0./0. : result.a);
  return result;
`,$E=rt({opSnippet:CE,packedOpSnippet:TE,cpuKernelImpl:aS}),SE={kernelName:Dd,backendName:"webgl",kernelFunc:$E};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NE=Ii+`
  return log(1.0 + x);
`,EE=rt({opSnippet:NE}),kE={kernelName:Fd,backendName:"webgl",kernelFunc:EE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const IE="return float(a >= 1.0 && b >= 1.0);",_E=`
  return vec4(
    vec4(greaterThanEqual(a, vec4(1.0))) *
    vec4(greaterThanEqual(b, vec4(1.0))));
`,RE=on({opSnippet:IE,packedOpSnippet:_E,dtype:"bool"}),AE={kernelName:Pd,backendName:"webgl",kernelFunc:RE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OE="return float(!(x >= 1.0));",DE=rt({opSnippet:OE}),FE={kernelName:Ld,backendName:"webgl",kernelFunc:DE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PE="return float(a >= 1.0 || b >= 1.0);",LE=`
  return min(
    vec4(greaterThanEqual(a, vec4(1.0))) +
    vec4(greaterThanEqual(b, vec4(1.0))),
    vec4(1.0));
`,BE=on({opSnippet:PE,packedOpSnippet:LE,dtype:"bool"}),ME={kernelName:Bd,backendName:"webgl",kernelFunc:BE};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VE{constructor(e,t,r,s,o){this.variableNames=["x"],this.outputShape=[];const i=t,a=e[3]-1;this.outputShape=e;let u;const c=`float(${r}) + float(${s}) * sum`;o===.5?u=`inversesqrt(${c})`:o===1?u=`1.0/(${c})`:u=`exp(log(${c}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];
        int d = coords[3];
        float x = getX(b, r, c, d);
        float sum = 0.0;
        for (int j = -${i}; j <= ${i}; j++) {
          int idx = d + j;
          if (idx >= 0 && idx <=  ${a}) {
            float z = getX(b, r, c, idx);
            sum += z * z;
          }
        }
        float val = x * ${u};
        setOutput(val);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UE{constructor(e,t,r,s,o){this.variableNames=["x"],this.outputShape=[],this.packedInputs=!0,this.packedOutput=!0;const i=t,a=e[3]-1;this.outputShape=e;let u;const c=`float(${r}) + float(${s}) * sum`;o===.5?u=`inversesqrt(${c})`:o===1?u=`1.0/(${c})`:u=`exp(log(${c}) * float(-${o}));`,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords.x;
        int r = coords.y;
        int c = coords.z;
        int d = coords.w;

        bool hasNextCol = d < ${this.outputShape[3]};
        bool hasNextRow = c < ${this.outputShape[2]};

        vec4 sum = vec4(0.);
        vec4 xFragAtOutputCoords = getX(b, r, c, d);

        vec4 xAtOutputCoords = vec4(
          getChannel(xFragAtOutputCoords, vec2(c, d)),
          hasNextCol ?
            getChannel(xFragAtOutputCoords, vec2(c, d + 1)) : 0.0,
          hasNextRow ?
            getChannel(xFragAtOutputCoords , vec2(c + 1, d)) : 0.0,
          (hasNextRow && hasNextCol) ?
            getChannel(xFragAtOutputCoords, vec2(c + 1, d + 1)) : 0.0
        );

        int firstChannel = d - ${i};
        vec2 cache = vec2(0.);
        if(firstChannel >= 0){
          vec4 firstChannelFrag = getX(b, r, c, firstChannel);
          cache.x = getChannel(firstChannelFrag, vec2(c, firstChannel));
            if(hasNextRow){
              cache.y = getChannel(firstChannelFrag, vec2(c + 1, firstChannel));
            }
        }

        ivec2 depth = ivec2(d, d + 1);
        for (int j = - ${i}; j <= ${i}; j++) {
          ivec2 idx = depth + j;
          bvec2 aboveLowerBound = greaterThanEqual(idx, ivec2(0));
          bvec2 belowUpperBound = lessThanEqual(idx, ivec2(${a}));

          bool depthInRange = aboveLowerBound.x && belowUpperBound.x;
          bool depthPlusOneInRange = aboveLowerBound.y && belowUpperBound.y;

          if(depthInRange || depthPlusOneInRange){
            vec4 z = vec4(0.);
            vec4 xFragAtCurrentDepth;
            z.xz = cache.xy;
            if(depthPlusOneInRange && hasNextCol){
              xFragAtCurrentDepth = idx.y != d ?
                getX(b, r, c, idx.y) : xFragAtOutputCoords;
              z.y = getChannel(xFragAtCurrentDepth, vec2(c, idx.y));
              if(hasNextRow){
                z.w = getChannel(xFragAtCurrentDepth, vec2(c + 1, idx.y));
              }
            }
            cache.xy = z.yw;
            sum += z * z;
          }
        }
        vec4 result = xAtOutputCoords * ${u};
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WE=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{depthRadius:o,bias:i,alpha:a,beta:u}=r,c=ue().getBool("WEBGL_PACK_NORMALIZATION")?new UE(s.shape,o,i,a,u):new VE(s.shape,o,i,a,u);return t.runWebGLProgram(c,[s],s.dtype)},zE={kernelName:Md,backendName:"webgl",kernelFunc:WE};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GE{constructor(e,t,r,s,o){this.variableNames=["inputImage","outputImage","dy"],this.outputShape=[],this.outputShape=e,this.depth=e[3],this.depthRadius=t,this.bias=r,this.alpha=s,this.beta=o,this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int r = coords[1];
        int c = coords[2];

        float result = 0.0;
        for (int d = 0; d < ${this.depth}; ++d) {
          int depthBegin = int(max(0.0, float(d - ${t})));
          int depthEnd = int(min(float(${this.depth}),
              float(d + ${t} + 1)));

          const int MIN_DEPTH_BEGIN = 0;
          const int MAX_DEPTH_END = ${this.depth};

          float norm = 0.0;
          for (int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k) {
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd) {
              norm += getInputImage(b, r, c, k) * getInputImage(b, r, c, k);
            }
            else {
              break;
            }
          }

          norm = float(${s}) * norm + float(${r});

          for(int k = MIN_DEPTH_BEGIN; k < MAX_DEPTH_END; ++k){
            if (k < depthBegin){
              continue;
            }
            else if (k >= depthBegin && k < depthEnd){
              float dyi = -2.0 * float(${s})
                * float(${o})
                * getInputImage(b ,r ,c, k) * getOutputImage(b, r, c, d)
                / norm;
              if (k == d) {
                dyi += pow(norm, -1.0 * ${o});
              }
              if (k == coords[3]) {
                dyi *= getDy(b, r, c, d);
                result += dyi;
              }
            }
            else {
              break;
            }
          }
      }
      setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jE=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s,y:o,dy:i}=e,{depthRadius:a,bias:u,alpha:c,beta:l}=r,h=new GE(s.shape,a,u,c,l);return t.runWebGLProgram(h,[s,o,i],s.dtype)},HE={kernelName:k0,backendName:"webgl",kernelFunc:jE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function qE(n,e,t,r){const s=Ce(e),i=Ce(n.shape)/s,a=ke({inputs:{x:n},attrs:{shape:[i,s]},backend:r}),u=Mo(a,n.dtype,"max",r),c=ke({inputs:{x:u},attrs:{shape:t},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(u),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bg(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{reductionIndices:o,keepDims:i}=r,a=s.shape.length,u=Zt(o,s.shape);let c=u;const l=yr(c,a),h=l!=null,d=t.shouldExecuteOnCPU([s]);let m=s;if(h){if(d){const P=t.texData.get(m.dataId).values,B=new Array(a);for(let re=0;re<B.length;re++)B[re]=s.shape[l[re]];const H=_l(P,s.shape,s.dtype,l,B);m=t.makeTensorInfo(B,s.dtype);const x=t.texData.get(m.dataId);x.values=H}else m=xu(s,l,t);c=xr(c.length,a)}Vr("max",c,a);const[g,C]=ss(m.shape,c);let $=g;i&&($=Jn(g,u));let T;if(d){const P=t.texData.get(m.dataId).values,B=uS(P,Ce(C),$,s.dtype);T=t.makeTensorInfo($,s.dtype);const H=t.texData.get(T.dataId);H.values=B}else T=qE(m,C,$,t);return h&&t.disposeIntermediateTensorInfo(m),T}const XE={kernelName:Vd,backendName:"webgl",kernelFunc:bg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KE=Rl+`
  return max(a, b);
`,YE=`
  vec4 result = vec4(max(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+la+`
  return result;
`,QE=on({opSnippet:KE,packedOpSnippet:YE,cpuKernelImpl:cS}),ZE={kernelName:Ud,backendName:"webgl",kernelFunc:QE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function JE(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e;ua(s,"maxPool");const{filterSize:o,strides:i,pad:a,dimRoundingMode:u}=r,c=1;M(Mn(i,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${i} and dilations '${c}'`);const l=Do(s.shape,o,i,c,a,u);if(l.filterWidth===1&&l.filterHeight===1&&Bt(l.inShape,l.outShape))return Ln({inputs:{x:s},backend:t});const h=new ta(l,"max",!1);return t.runWebGLProgram(h,[s],s.dtype)}const ek={kernelName:Wd,backendName:"webgl",kernelFunc:JE};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tk(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{filterSize:o,strides:i,pad:a,dataFormat:u,dimRoundingMode:c}=r,l=[1,1,1],h=sa(s.shape,o,i,l,a,c,u),d=new Ol(h,"max",!1);return t.runWebGLProgram(d,[s],s.dtype)}const nk={kernelName:zd,backendName:"webgl",kernelFunc:tk};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class rk{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideHeight,r=e.strideWidth,s=e.dilationHeight,o=e.effectiveFilterHeight,i=e.effectiveFilterWidth,a=o-1-e.padInfo.top,u=i-1-e.padInfo.left,c=o*i-1;this.userCode=`
      const ivec2 pads = ivec2(${a}, ${u});

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];

        ivec2 dyRCCorner = coords.yz - pads;
        int dyRCorner = dyRCCorner.x;
        int dyCCorner = dyRCCorner.y;

        // Convolve dy(?, ?, d) with pos mask(:, :, d) to get dx(xR, xC, d).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;
        for (int wR = 0; wR < ${o};
          wR += ${s}) {
          float dyR = float(dyRCorner + wR) / ${t}.0;

          if (dyR < 0.0 || dyR >= ${e.outHeight}.0 || fract(dyR) > 0.0) {
            continue;
          }
          int idyR = int(dyR);

          for (int wC = 0; wC < ${i}; wC++) {
            float dyC = float(dyCCorner + wC) / ${r}.0;

            if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                fract(dyC) > 0.0) {
              continue;
            }
            int idyC = int(dyC);

            float dyValue = getDy(b, idyR, idyC, d);
            int maxPosValue = ${c} - int(getMaxPos(b, idyR, idyC, d));

            // Get the current value, check it against the value from the
            // position matrix.
            int curPosValue = wR * ${i} + wC;
            float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

            dotProd += dyValue * mask;
          }
        }
        setOutput(dotProd);
      }
    `}}class sk{constructor(e){this.variableNames=["dy","maxPos"],this.outputShape=e.inShape;const t=e.strideDepth,r=e.strideHeight,s=e.strideWidth,o=e.dilationDepth,i=e.dilationHeight,a=e.dilationWidth,u=e.effectiveFilterDepth,c=e.effectiveFilterHeight,l=e.effectiveFilterWidth,h=u-1-e.padInfo.front,d=c-1-e.padInfo.top,m=l-1-e.padInfo.left,g=u*c*l-1;this.userCode=`
      const ivec3 pads = ivec3(${h}, ${d}, ${m});

      void main() {
        ivec5 coords = getOutputCoords();
        int batch = coords.x;
        int ch = coords.u;

        ivec3 dyCorner = ivec3(coords.y, coords.z, coords.w) - pads;
        int dyDCorner = dyCorner.x;
        int dyRCorner = dyCorner.y;
        int dyCCorner = dyCorner.z;

        // Convolve dy(?, ?, ?, ch) with pos mask(:, :, :, d) to get
        // dx(xD, xR, xC, ch).
        // ? = to be determined. : = across all values in that axis.
        float dotProd = 0.0;

        for (int wD = 0; wD < ${u};
           wD += ${o}) {
          float dyD = float(dyDCorner + wD) / ${t}.0;

          if (dyD < 0.0 || dyD >= ${e.outDepth}.0 || fract(dyD) > 0.0) {
            continue;
          }
          int idyD = int(dyD);

          for (int wR = 0; wR < ${c};
              wR += ${i}) {
            float dyR = float(dyRCorner + wR) / ${r}.0;

            if (dyR < 0.0 || dyR >= ${e.outHeight}.0 ||
                fract(dyR) > 0.0) {
              continue;
            }
            int idyR = int(dyR);

            for (int wC = 0; wC < ${l};
                wC += ${a}) {
              float dyC = float(dyCCorner + wC) / ${s}.0;

              if (dyC < 0.0 || dyC >= ${e.outWidth}.0 ||
                  fract(dyC) > 0.0) {
                continue;
              }
              int idyC = int(dyC);

              float dyValue = getDy(batch, idyD, idyR, idyC, ch);
              int maxPosValue = ${g} -
                  int(getMaxPos(batch, idyD, idyR, idyC, ch));

              // Get the current value, check it against the value from the
              // position matrix.
              int curPosValue =
                  wD * ${c} * ${l} +
                  wR * ${l} + wC;
              float mask = float(maxPosValue == curPosValue ? 1.0 : 0.0);

              dotProd += dyValue * mask;
            }
          }
        }
        setOutput(dotProd);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ok(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:o}=e,i=o,{filterSize:a,strides:u,pad:c,dimRoundingMode:l}=r,h=[1,1,1],d=sa(i.shape,a,u,h,c,l),m=new Ol(d,"max",!0),g=t.runWebGLProgram(m,[i],i.dtype),C=new sk(d),$=t.runWebGLProgram(C,[s,g],i.dtype);return t.disposeIntermediateTensorInfo(g),$}const ik={kernelName:_0,backendName:"webgl",kernelFunc:ok};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ak(n){const{inputs:e,backend:t,attrs:r}=n,{dy:s,input:o,output:i}=e,a=o;ua([o,i],"maxPoolGrad");const{filterSize:u,strides:c,pad:l,dimRoundingMode:h}=r,d=Do(a.shape,u,c,1,l,h),m=!0,g=new ta(d,"max",m),C=t.runWebGLProgram(g,[a],a.dtype),$=new rk(d),T=t.runWebGLProgram($,[s,C],a.dtype);return t.disposeIntermediateTensorInfo(C),T}const uk={kernelName:I0,backendName:"webgl",kernelFunc:ak};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ck(n,e,t,r){let s=new ta(t,"max",!1);const o=r.runWebGLProgram(s,[n],"float32");s=new ta(t,"max",!0,!0,e);const i=r.runWebGLProgram(s,[n],"float32");return[o,i]}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lk={kernelName:Gd,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{filterSize:s,strides:o,pad:i,includeBatchInIndex:a}=e,u=t;M(r.shape.length===4,()=>`Error in maxPool: input must be rank 4 but got rank ${r.shape.length}.`);const c=[1,1];M(Mn(o,c),()=>`Error in maxPool: Either strides or dilations must be 1. Got strides ${o} and dilations '${c}'`);const l=Do(r.shape,s,o,c,i),[h,d]=ck(r,a,l,u);return[h,d]}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hk(n,e,t,r){const s=Ce(e),i=Ce(n.shape)/s,a=ke({inputs:{x:n},attrs:{shape:[i,s]},backend:r}),u=Mo(a,"float32","mean",r),c=ke({inputs:{x:u},attrs:{shape:t},backend:r});return r.disposeIntermediateTensorInfo(a),r.disposeIntermediateTensorInfo(u),c}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fk={kernelName:jd,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{x:r}=n,{keepDims:s,axis:o}=e,i=t,a=r.shape.length,u=Zt(o,r.shape);let c=u;const l=yr(c,a),h=l!=null,d=i.shouldExecuteOnCPU([r]),m=[];let g=r;if(h){if(d){const B=i.texData.get(g.dataId).values,H=new Array(a);for(let oe=0;oe<H.length;oe++)H[oe]=r.shape[l[oe]];const x=_l(B,r.shape,r.dtype,l,H);g=i.makeTensorInfo(H,r.dtype);const re=i.texData.get(g.dataId);re.values=x}else g=xu(r,l,i);m.push(g),c=xr(c.length,a)}Vr("sum",c,a);const[C,$]=ss(g.shape,c);let T=C;s&&(T=Jn(C,u));const A=hk(g,$,T,i);for(const P of m)i.disposeIntermediateTensorInfo(P);return A}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function dk(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,u=Zt(o,s.shape);let c=u;const l=yr(c,a);let h=s;l!=null&&(h=$n({inputs:{x:s},backend:t,attrs:{perm:l}}),c=xr(c.length,s.shape.length)),Vr("min",c,a);const[d,m]=ss(h.shape,c),g=Ce(m),C=ke({inputs:{x:h},backend:t,attrs:{shape:[-1,g]}}),$=Mo(C,C.dtype,"min",t);let T;if(i){const A=Jn(d,u);T=ke({inputs:{x:$},backend:t,attrs:{shape:A}})}else T=ke({inputs:{x:$},backend:t,attrs:{shape:d}});return t.disposeIntermediateTensorInfo(C),t.disposeIntermediateTensorInfo($),l!=null&&t.disposeIntermediateTensorInfo(h),T}const pk={kernelName:Hd,backendName:"webgl",kernelFunc:dk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mk=Rl+`
  return min(a, b);
`,gk=`
  vec4 result = vec4(min(a, b));
  bvec4 isNaNA = isnan(a);
  bvec4 isNaNB = isnan(b);
  bvec4 isNaN = bvec4(isNaNA.x || isNaNB.x, isNaNA.y || isNaNB.y, isNaNA.z || isNaNB.z, isNaNA.w || isNaNB.w);
  `+la+`
  return result;
`,yk=on({opSnippet:mk,packedOpSnippet:gk,cpuKernelImpl:lS}),xk={kernelName:qd,backendName:"webgl",kernelFunc:yk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class bk{constructor(e,t,r){this.variableNames=["x"],this.outputShape=t.map((l,h)=>l[0]+e[h]+l[1]);const s=e.length,o=Tt(s),i=t.map(l=>l[0]).join(","),a=t.map((l,h)=>l[0]+e[h]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s),c=r==="reflect"?0:1;if(s===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start) {
            outC = start * 2 - outC - ${c};
          } else if(outC >= end) {
            outC = (end - 1) * 2 - outC + ${c};
          }
          setOutput(getX(outC - start));
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        for (int i = 0; i < ${s}; i++) {
          if (outC[i] < start[i]) {
            outC[i] = start[i] * 2 - outC[i] - ${c};
          } else if(outC[i] >= end[i]) {
            outC[i] = (end[i] - 1) * 2 - outC[i] + ${c};
          }
        }
        ${o} coords = outC - start;
        setOutput(getX(${u}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class vk{constructor(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=t.map((g,C)=>g[0]+e[C]+g[1]);const s=e.length,o=Tt(s),i=t.map(g=>g[0]).join(","),a=t.map((g,C)=>g[0]+e[C]).join(","),u=wn("rc",s),c=wn("source",s),l=`${u[s-1]} < ${this.outputShape[s-1]}`,h=s===1?"source":`vec2(${c.slice(-2).join()})`,d=r==="reflect"?0:1;let m="";if(s===1){const g=`
        ${o} source = rc;
        if (source < start) {
          source = start * 2 - source - ${d};
        } else if (source >= end) {
          source = (end - 1) * 2 - source + ${d};
        }
        source -= start;
      `;m=`
        ${o} rc = outputLoc;
        ${g}
        result[0] = getChannel(getX(${c.join()}), ${h});
        ${u[s-1]} += 1;
        if(${l}) {
          ${g}
          result[1] = getChannel(getX(${c.join()}), ${h});
        }
      `}else{const g=`
        ${o} source = rc;
        ${o} lt = ${o}(lessThan(source, start));
        ${o} gte = ${o}(greaterThanEqual(source, end));
        ${o} orig = 1 - (lt + gte);
        source = orig * source +
                lt * (start * 2 - source - ${d}) +
                gte * ((end - 1) * 2 - source + ${d});
        source -= start;
      `;m=`
        ${o} rc = outputLoc;
        ${g}
        result[0] = getChannel(getX(${c.join()}), ${h});
        ${u[s-1]} += 1;
        if(${l}) {
          ${g}
          result[1] = getChannel(getX(${c.join()}), ${h});
        }
        rc = outputLoc;
        ${u[s-2]} += 1;
        if(${u[s-2]} < ${this.outputShape[s-2]}) {
          ${g}
          result[2] = getChannel(getX(${c.join()}), ${h});
          ${u[s-1]} += 1;
          if(${l}) {
            ${g}
            result[3] = getChannel(getX(${c.join()}), ${h});
          }
        }
      `}this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${m}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const wk=({inputs:n,backend:e,attrs:t})=>{const{x:r}=n,{paddings:s,mode:o}=t,i=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new vk(r.shape,s,o):new bk(r.shape,s,o);return e.runWebGLProgram(i,[r],r.dtype)},Ck={kernelName:Xd,backendName:"webgl",kernelFunc:wk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Tk=`if (b == 0.0) return NAN;
  return mod(a, b);`,$k=`
  vec4 result = mod(a, b);
  bvec4 isNaN = equal(b, vec4(0.0));
  `+la+`
  return result;
`,Sk=on({opSnippet:Tk,packedOpSnippet:$k}),Nk={kernelName:Kd,backendName:"webgl",kernelFunc:Sk};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ek{constructor(e,t,r){this.variableNames=["probs"],this.customUniforms=[{name:"seed",type:"float"}],this.outputShape=[e,r],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];

        float r = random(seed);
        float cdf = 0.0;

        for (int i = 0; i < ${t-1}; i++) {
          cdf += getProbs(batch, i);

          if (r < cdf) {
            setOutput(float(i));
            return;
          }
        }

        // If no other event happened, last event happened.
        setOutput(float(${t-1}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kk=`
if (a == b) {
  return 1.0;
};
return a / b;`,Ik=`
  // vec4 one = vec4(equal(a, b));
  // return one + (vec4(1.0) - one) * a / b;
  vec4 result = a / b;
  if(a.x == b.x) {
    result.x = 1.;
  }
  if(a.y == b.y) {
    result.y = 1.;
  }
  if(a.z == b.z) {
    result.z = 1.;
  }
  if(a.w == b.w) {
    result.w = 1.;
  }

  return result;
`,vg=on({opSnippet:kk,packedOpSnippet:Ik,checkOutOfBounds:!0}),_k={kernelName:ad,backendName:"webgl",kernelFunc:vg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Vh="return a - b;",wg=on({opSnippet:Vh,packedOpSnippet:Vh,supportsComplex:!0,cpuKernelImpl:IS}),Rk={kernelName:Xp,backendName:"webgl",kernelFunc:wg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Cg(n){const{inputs:e,backend:t,attrs:r}=n,{logits:s}=e,{dim:o}=r,i=Zt([o],s.shape),a=bg({inputs:{x:s},backend:t,attrs:{reductionIndices:i,keepDims:!1}}),u=Jn(a.shape,i),c=ke({inputs:{x:a},backend:t,attrs:{shape:u}}),l=wg({inputs:{a:s,b:c},backend:t}),h=gg({inputs:{x:l},backend:t}),d=bu({inputs:{x:h},backend:t,attrs:{axis:i,keepDims:!1}}),m=ke({inputs:{x:d},backend:t,attrs:{shape:u}}),g=vg({inputs:{a:h,b:m},backend:t});return t.disposeIntermediateTensorInfo(a),t.disposeIntermediateTensorInfo(c),t.disposeIntermediateTensorInfo(l),t.disposeIntermediateTensorInfo(h),t.disposeIntermediateTensorInfo(d),t.disposeIntermediateTensorInfo(m),g}const Ak={kernelName:Lp,backendName:"webgl",kernelFunc:Cg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ok(n){const{inputs:e,backend:t,attrs:r}=n,{logits:s}=e,{numSamples:o,seed:i,normalized:a}=r,u=a?s:Cg({inputs:{logits:s},backend:t,attrs:{dim:s.shape.length-1}}),c=u.shape[0],l=u.shape[1],h=new Ek(c,l,o),d=[[i]],m=t.runWebGLProgram(h,[u],"int32",d);return a||t.disposeIntermediateTensorInfo(u),m}const Dk={kernelName:Yd,backendName:"webgl",kernelFunc:Ok};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Fk=br+`
  return -x;
`,Pk=`
  vec4 result = -x;
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`;function Lk(n){const{inputs:e,backend:t}=n,{x:r}=e;if(t.shouldExecuteOnCPU([r])){const o=t.texData.get(r.dataId),[i,a]=fS(o.values,r.shape,r.dtype);return t.makeTensorInfo(a,r.dtype,i)}let s;return ue().getBool("WEBGL_PACK_UNARY_OPERATIONS")?s=new Co(r.shape,Pk):s=new gs(r.shape,Fk),t.runWebGLProgram(s,[r],r.dtype)}const Bk={kernelName:Zd,backendName:"webgl",kernelFunc:Lk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Mk=X2;function Vk(n){Fr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:u}=r,c=t.readSync(s.dataId),l=t.readSync(o.dataId),{selectedIndices:h}=Mk(c,l,i,a,u);return t.makeTensorInfo([h.length],"int32",new Int32Array(h))}const Uk={kernelName:ep,backendName:"webgl",kernelFunc:Vk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wk=K2;function zk(n){Fr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:u,padToMaxOutputSize:c}=r,l=t.readSync(s.dataId),h=t.readSync(o.dataId),{selectedIndices:d,validOutputs:m}=Wk(l,h,i,a,u,c);return[t.makeTensorInfo([d.length],"int32",new Int32Array(d)),t.makeTensorInfo([],"int32",new Int32Array([m]))]}const Gk={kernelName:tp,backendName:"webgl",kernelFunc:zk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jk=Y2;function Hk(n){Fr("tf.nonMaxSuppression() in webgl locks the UI thread. Call tf.nonMaxSuppressionAsync() instead");const{inputs:e,backend:t,attrs:r}=n,{boxes:s,scores:o}=e,{maxOutputSize:i,iouThreshold:a,scoreThreshold:u,softNmsSigma:c}=r,l=t.readSync(s.dataId),h=t.readSync(o.dataId),d=i,m=a,g=u,C=c,{selectedIndices:$,selectedScores:T}=jk(l,h,d,m,g,C);return[t.makeTensorInfo([$.length],"int32",new Int32Array($)),t.makeTensorInfo([T.length],"float32",new Float32Array(T))]}const qk={kernelName:np,backendName:"webgl",kernelFunc:Hk};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Xk{constructor(e,t,r,s){this.variableNames=["indices"],this.outputShape=[e,t],this.userCode=`
      void main() {
        ivec2 coords = getOutputCoords();
        int index = round(getIndices(coords.x));
        setOutput(mix(float(${s}), float(${r}),
                      float(index == coords.y)));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Kk=n=>{const{inputs:e,backend:t,attrs:r}=n,{indices:s}=e,{dtype:o,depth:i,onValue:a,offValue:u}=r,c=Ce(s.shape),l=new Xk(c,i,a,u),h=ke({inputs:{x:s},backend:t,attrs:{shape:[c]}}),d=t.runWebGLProgram(l,[h],o);t.disposeIntermediateTensorInfo(h);const m=[...s.shape,i],g=ke({inputs:{x:d},backend:t,attrs:{shape:m}});return t.disposeIntermediateTensorInfo(d),g},Yk={kernelName:sp,backendName:"webgl",kernelFunc:Kk};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Ka(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="complex64"){const s=fa({inputs:{input:r},backend:t}),o=Ka({inputs:{x:s},backend:t}),i=vu({inputs:{input:r},backend:t}),a=Ka({inputs:{x:i},backend:t}),u=Ys({inputs:{real:o,imag:a},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),u}else return da({attrs:{shape:r.shape,dtype:r.dtype,value:r.dtype==="string"?"":0},backend:t})}const Qk={kernelName:n1,backendName:"webgl",kernelFunc:Ka};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Tg(n){const{inputs:e,backend:t}=n,{x:r}=e;if(r.dtype==="string")throw new Error("onesLike is not supported under string dtype");if(r.dtype==="complex64"){const s=fa({inputs:{input:r},backend:t}),o=Tg({inputs:{x:s},backend:t}),i=vu({inputs:{input:r},backend:t}),a=Ka({inputs:{x:i},backend:t}),u=Ys({inputs:{real:o,imag:a},backend:t});return t.disposeIntermediateTensorInfo(s),t.disposeIntermediateTensorInfo(o),t.disposeIntermediateTensorInfo(i),t.disposeIntermediateTensorInfo(a),u}else return da({attrs:{shape:r.shape,dtype:r.dtype,value:1},backend:t})}const Zk={kernelName:rp,backendName:"webgl",kernelFunc:Tg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Jk(n){const{inputs:e,backend:t,attrs:r}=n,{axis:s}=r;if(e.length===1)return Ac({inputs:{input:e[0]},backend:t,attrs:{dim:s}});const o=e[0].shape,i=e[0].dtype;e.forEach(l=>{Qn(o,l.shape,"All tensors passed to stack must have matching shapes"),M(i===l.dtype,()=>"All tensors passed to stack must have matching dtypes")});const a=[],u=e.map(l=>{const h=Ac({inputs:{input:l},backend:t,attrs:{dim:s}});return a.push(h),h}),c=ug({inputs:u,backend:t,attrs:{axis:s}});return a.forEach(l=>t.disposeIntermediateTensorInfo(l)),c}const eI={kernelName:op,backendName:"webgl",kernelFunc:Jk};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class tI{constructor(e,t,r){this.variableNames=["x"],this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((c,l)=>c[0]+e[l]+c[1]);const s=e.length,o=Tt(s),i=t.map(c=>c[0]).join(","),a=t.map((c,l)=>c[0]+e[l]).join(","),u=["coords[0]","coords[1]","coords[2]","coords[3]"].slice(0,s);if(s===1){this.userCode=`
        int start = ${i};
        int end = ${a};

        void main() {
          int outC = getOutputCoords();
          if (outC < start || outC >= end) {
            setOutput(value);
          } else {
            setOutput(getX(outC - start));
          }
        }
      `;return}this.userCode=`
      ${o} start = ${o}(${i});
      ${o} end = ${o}(${a});

      void main() {
        ${o} outC = getOutputCoords();
        if (any(lessThan(outC, start)) || any(greaterThanEqual(outC, end))) {
          setOutput(value);
        } else {
          ${o} coords = outC - start;
          setOutput(getX(${u}));
        }
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class nI{constructor(e,t,r){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0,this.customUniforms=[{name:"value",type:"float"}],this.outputShape=t.map((C,$)=>C[0]+e[$]+C[1]);const s=e.length,o=Tt(s),i=t.map(C=>C[0]).join(","),a=t.map((C,$)=>C[0]+e[$]).join(","),u=wn("rc",s),c=wn("source",s),l=`${u[s-1]} < ${this.outputShape[s-1]}`,h=s===1?"source":`vec2(${c.slice(-2).join()})`,d=[`${o} rc = outputLoc;`,`${u[s-1]} += 1;
       if(${l}) {
      `,s===1?"":`}
       rc = outputLoc;
       ${u[s-2]} += 1;
       if(${u[s-2]} < ${this.outputShape[s-2]}) {`,s===1?"":`  ${u[s-1]} += 1;
         if(${l}) {`],m=s===1?"rc < start || rc >= end":"any(lessThan(rc, start)) || any(greaterThanEqual(rc, end))";let g="";for(let C=0,$=s===1?2:4;C<$;C++)g+=`
        ${d[C]}
        if (${m}) {
          result[${C}] = float(value);
        } else {
          ${o} source = rc - start;
          result[${C}] = getChannel(getX(${c.join()}), ${h});
        }
      `;g+=s===1?"} ":"}}",this.userCode=`
      const ${o} start = ${o}(${i});
      const ${o} end = ${o}(${a});

      void main() {
        ${o} outputLoc = getOutputCoords();
        vec4 result = vec4(0.);
        ${g}
        setOutput(result);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const $g=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{paddings:o,constantValue:i}=r;if(Ce(s.shape)===0){const c=o.map((l,h)=>l[0]+s.shape[h]+l[1]);return da({backend:t,attrs:{shape:c,value:i,dtype:s.dtype}})}const a=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new nI(s.shape,o,i):new tI(s.shape,o,i),u=[[i]];return t.runWebGLProgram(a,[s],s.dtype,u)},rI={kernelName:ip,backendName:"webgl",kernelFunc:$g};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sI=`
  if(a < 0.0 && floor(b) < b){
    return NAN;
  }
  if (b == 0.0) {
    return 1.0;
  }
  return (round(mod(b, 2.0)) != 1) ?
      pow(abs(a), b) : sign(a) * pow(abs(a), b);
`,oI=`
  // isModRound1 has 1 for components with round(mod(b, 2.0)) == 1, 0 otherwise.
  vec4 isModRound1 = vec4(equal(round(mod(b, 2.0)), ivec4(1)));
  vec4 multiplier = sign(a) * isModRound1 + (vec4(1.0) - isModRound1);
  vec4 result = multiplier * pow(abs(a), b);

  // Ensure that a^0 = 1, including 0^0 = 1 as this correspond to TF and JS
  bvec4 isExpZero = equal(b, vec4(0.0));
  result.r = isExpZero.r ? 1.0 : result.r;
  result.g = isExpZero.g ? 1.0 : result.g;
  result.b = isExpZero.b ? 1.0 : result.b;
  result.a = isExpZero.a ? 1.0 : result.a;

  bvec4 isNaN1 = lessThan(a, vec4(0.0));
  bvec4 isNaN2 = lessThan(floor(b), b);
  bvec4 isNaN = bvec4(isNaN1.x && isNaN2.x, isNaN1.y && isNaN2.y, isNaN1.z && isNaN2.z, isNaN1.w && isNaN2.w);
  `+la+`
  return result;
`,iI=on({opSnippet:sI,packedOpSnippet:oI}),aI={kernelName:ap,backendName:"webgl",kernelFunc:iI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function uI(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{axis:o,keepDims:i}=r,a=s.shape.length,u=[],c=Zt(o,s.shape);let l=c;const h=yr(l,a);let d=s;h!=null&&(d=$n({inputs:{x:s},backend:t,attrs:{perm:h}}),l=xr(l.length,a),u.push(d)),Vr("prod",l,a);let m;if(t.shouldExecuteOnCPU([d])){const g=t.texData.get(d.dataId).values,{outVals:C,outShape:$,outDtype:T}=pS(d.shape,d.dtype,g,l);m=t.makeTensorInfo($,T,C)}else{const[g,C]=ss(d.shape,l),$=Ce(C),T=ke({inputs:{x:d},backend:t,attrs:{shape:[-1,$]}}),A=Jc(s.dtype),P=Mo(T,A,"prod",t);m=ke({inputs:{x:P},backend:t,attrs:{shape:g}}),u.push(T),u.push(P)}if(i){u.push(m);const g=Jn(m.shape,c);m=ke({inputs:{x:m},backend:t,attrs:{shape:g}})}return u.forEach(g=>t.disposeIntermediateTensorInfo(g)),m}const cI={kernelName:cp,backendName:"webgl",kernelFunc:uI};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function lI(n){const{inputs:e,backend:t,attrs:r}=n,{paramsNestedSplits:s,paramsDenseValues:o,indices:i}=e,{outputRaggedRank:a}=r,u=s.map(T=>t.readSync(T.dataId)),c=s.map(T=>T.shape),l=t.readSync(o.dataId),h=t.readSync(i.dataId),[d,m,g]=mS(u,c,l,o.shape,o.dtype,h,i.shape,a),C=d.map(T=>t.makeTensorInfo([T.length],"int32",T)),$=t.makeTensorInfo(g,o.dtype,m);return C.concat([$])}const hI={kernelName:lp,backendName:"webgl",kernelFunc:lI};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function fI(n){const{inputs:e,backend:t,attrs:r}=n,{shape:s,values:o,defaultValue:i,rowPartitionTensors:a}=e,{rowPartitionTypes:u}=r,c=t.readSync(s.dataId),l=t.readSync(o.dataId),h=t.readSync(i.dataId),d=a.map($=>t.readSync($.dataId)),m=a.map($=>$.shape),[g,C]=gS(c,s.shape,l,o.shape,o.dtype,h,i.shape,d,m,u);return t.makeTensorInfo(g,o.dtype,C)}const dI={kernelName:hp,backendName:"webgl",kernelFunc:fI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Sg=n=>{const{backend:e,attrs:t}=n,{start:r,stop:s,step:o,dtype:i}=t,a=yS(r,s,o,i);return e.makeTensorInfo([a.length],i,a)},pI={kernelName:fp,backendName:"webgl",kernelFunc:Sg};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const mI="return 1.0 / x;",gI=rt({opSnippet:mI}),yI={kernelName:pp,backendName:"webgl",kernelFunc:gI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const xI=br+`
  return (x < 0.0) ? 0.0 : x;
`,bI=`
  vec4 result = x * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,vI=rt({opSnippet:xI,packedOpSnippet:bI}),wI={kernelName:mp,backendName:"webgl",kernelFunc:vI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const CI=br+`
  return (x < 0.0) ? 0.0 : min(6.0, x);
`,TI=`
  vec4 result = min(x, vec4(6.)) * vec4(greaterThanEqual(x, vec4(0.0)));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,$I=rt({opSnippet:CI,packedOpSnippet:TI}),SI={kernelName:bp,backendName:"webgl",kernelFunc:$I};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class NI{constructor(e,t,r,s,o){this.variableNames=["A"],this.outputShape=[];const[i,a,u,c]=e;this.outputShape=[i,t,r,c];const l=[s&&t>1?a-1:a,s&&r>1?u-1:u],h=[s&&t>1?t-1:t,s&&r>1?r-1:r];let d;o?d="(vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC - vec2(0.5)":d="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${l[0]/h[0]},
          ${l[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${u}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec2 sourceFloorRC = ivec2(max(sourceFracIndexRC, vec2(0.0)));
        ivec2 sourceCeilRC = ivec2(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        float topLeft = getA(b, sourceFloorRC.x, sourceFloorRC.y, d);
        float bottomLeft = getA(b, sourceCeilRC.x, sourceFloorRC.y, d);
        float topRight = getA(b, sourceFloorRC.x, sourceCeilRC.y, d);
        float bottomRight = getA(b, sourceCeilRC.x, sourceCeilRC.y, d);

        vec2 fracRC = sourceFracIndexRC - vec2(sourceFloorRC);

        float top = topLeft + (topRight - topLeft) * fracRC.y;
        float bottom = bottomLeft + (bottomRight - bottomLeft) * fracRC.y;
        float newValue = top + (bottom - top) * fracRC.x;

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class EI{constructor(e,t,r,s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,u,c]=e;this.outputShape=[i,t,r,c];const l=[s&&t>1?a-1:a,s&&r>1?u-1:u],h=[s&&t>1?t-1:t,s&&r>1?r-1:r];let d;o?d="(vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC - vec3(0.5)":d="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${l[0]/h[0]},
          ${l[1]/h[1]},
          ${l[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${u}.0,
                                     ${u}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${d};

        // Compute the four integer indices.
        ivec3 sourceFloorRC = ivec3(max(sourceFracIndexRC, vec3(0.0)));
        ivec3 sourceCeilRC = ivec3(
          min(inputShapeRC - 1.0, ceil(sourceFracIndexRC)));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        // In parallel, construct four corners for all four components in
        // packed 2x2 cell.
        vec4 topLeft = vec4(
          getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 bottomLeft = vec4(
          getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceFloorRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceFloorRC.z, d + 1) : 0.0);

        vec4 topRight = vec4(
          getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceFloorRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceFloorRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec4 bottomRight = vec4(
          getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d),
          hasNextCol ? getAValue(b, sourceCeilRC.x, sourceCeilRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceCeilRC.x, sourceCeilRC.z, d + 1) : 0.0);

        vec3 fracRC = sourceFracIndexRC - vec3(sourceFloorRC);

        vec4 top = mix(topLeft, topRight, fracRC.yyzz);
        vec4 bottom = mix(bottomLeft, bottomRight, fracRC.yyzz);
        vec4 newValue = mix(top, bottom, fracRC.x);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function kI(n){const{inputs:e,backend:t,attrs:r}=n,{images:s}=e,{alignCorners:o,halfPixelCenters:i,size:a}=r,[u,c]=a,l=ue().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new EI(s.shape,u,c,o,i):new NI(s.shape,u,c,o,i);return t.runWebGLProgram(l,[s],"float32")}const II={kernelName:xp,backendName:"webgl",kernelFunc:kI};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class _I{constructor(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,s,o]=t,[,i,a]=e,u=[r&&i>1?s-1:s,r&&a>1?o-1:o],c=[r&&i>1?i-1:i,r&&a>1?a-1:a],l=u[0]/c[0],h=u[1]/c[1],d=1/l,m=1/h,g=Math.ceil(d)*2+2,C=Math.ceil(m)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${l});
        const float widthScale = float(${h});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${m});

        const int winHeight = int(${g});
        const int winWidth = int(${C});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(startRLerp - float(winHeight / 2));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(startCLerp - float(winWidth / 2));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float dxR = float(dyR) * heightScale;
            int topDxRIndex = int(floor(dxR));
            int bottomDxRIndex = int(min(ceil(dxR), ${s-1}.0));
            float dxRLerp = dxR - float(topDxRIndex);
            float inverseDxRLerp = 1.0 - dxRLerp;

            float dxC = float(dyC) * widthScale;
            int leftDxCIndex = int(floor(dxC));
            int rightDxCIndex = int(min(ceil(dxC), ${o-1}.0));
            float dxCLerp = dxC - float(leftDxCIndex);
            float inverseDxCLerp = 1.0 - dxCLerp;

            if (r == topDxRIndex && c == leftDxCIndex) {
              // topLeft
              accumulator +=
                getDy(b, dyR, dyC, d) * inverseDxRLerp * inverseDxCLerp;
            }

            if (r == topDxRIndex && c == rightDxCIndex) {
              // topRight
              accumulator += getDy(b, dyR, dyC, d) * inverseDxRLerp * dxCLerp;
            }

            if (r == bottomDxRIndex && c == leftDxCIndex) {
              // bottomLeft
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * inverseDxCLerp;
            }

            if (r == bottomDxRIndex && c == rightDxCIndex) {
              // bottomRight
              accumulator += getDy(b, dyR, dyC, d) * dxRLerp * dxCLerp;
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function RI(n){const{inputs:e,backend:t,attrs:r}=n,{images:s,dy:o}=e,{alignCorners:i}=r,a=new _I(o.shape,s.shape,i);return t.runWebGLProgram(a,[o],o.dtype)}const AI={kernelName:A0,backendName:"webgl",kernelFunc:RI};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class OI{constructor(e,t,r,s,o){this.variableNames=["A"],this.outputShape=[];const[i,a,u,c]=e;this.outputShape=[i,t,r,c];const l=[s&&t>1?a-1:a,s&&r>1?u-1:u],h=[s&&t>1?t-1:t,s&&r>1?r-1:r],d=s?"0.5":"0.0";let m;o?m="max((vec2(yRC) + vec2(0.5)) * effectiveInputOverOutputRatioRC, vec2(0.0))":m="vec2(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec2 effectiveInputOverOutputRatioRC = vec2(
          ${l[0]/h[0]},
          ${l[1]/h[1]});
      const vec2 inputShapeRC = vec2(${a}.0, ${u}.0);

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        ivec2 yRC = coords.yz;

        // Fractional source index.
        vec2 sourceFracIndexRC = ${m};

        // Compute the coordinators of nearest neighbor point.
        ivec2 sourceNearestRC = ivec2(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));
        float newValue = getA(b, sourceNearestRC.x, sourceNearestRC.y, d);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class DI{constructor(e,t,r,s,o){this.variableNames=["A"],this.packedInputs=!0,this.packedOutput=!0,this.outputShape=[];const[i,a,u,c]=e;this.outputShape=[i,t,r,c];const l=[s&&t>1?a-1:a,s&&r>1?u-1:u],h=[s&&t>1?t-1:t,s&&r>1?r-1:r],d=s?"0.5":"0.0";let m;o?m="max((vec3(yRC) + vec3(0.5)) * effectiveInputOverOutputRatioRC, vec3(0.0))":m="vec3(yRC) * effectiveInputOverOutputRatioRC",this.userCode=`
      const vec3 effectiveInputOverOutputRatioRC = vec3(
          ${l[0]/h[0]},
          ${l[1]/h[1]},
          ${l[1]/h[1]});
      const vec3 inputShapeRC = vec3(${a}.0, ${u}.0,
                                     ${u}.0);

      float getAValue(int b, int r, int c, int d) {
        return getChannel(getA(b, r, c, d), vec2(c, d));
      }

      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        // Calculate values for next column in yRC.z.
        ivec3 yRC = coords.yzz + ivec3(0, 0, 1);

        // Fractional source index.
        vec3 sourceFracIndexRC = ${m};

        // Compute the coordinators of nearest neighbor point.
        ivec3 sourceNearestRC = ivec3(
          min(inputShapeRC - 1.0, floor(sourceFracIndexRC + ${d})));

        // Should we calculate next column and row elements in 2x2 packed cell.
        bool hasNextCol = d < ${c-1};
        bool hasNextRow = coords.z < ${r-1};

        vec4 newValue = vec4(
          getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d),
          hasNextCol ? getAValue(b, sourceNearestRC.x, sourceNearestRC.y, d + 1)
                     : 0.0,
          hasNextRow ? getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d)
                     : 0.0,
          (hasNextRow && hasNextCol) ?
            getAValue(b, sourceNearestRC.x, sourceNearestRC.z, d + 1) : 0.0);

        setOutput(newValue);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function FI(n){const{inputs:e,backend:t,attrs:r}=n,{images:s}=e,{alignCorners:o,halfPixelCenters:i,size:a}=r,[u,c]=a,l=ue().getBool("WEBGL_PACK_IMAGE_OPERATIONS")?new DI(s.shape,u,c,o,i):new OI(s.shape,u,c,o,i);return t.runWebGLProgram(l,[s],s.dtype)}const PI={kernelName:yp,backendName:"webgl",kernelFunc:FI};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class LI{constructor(e,t,r){this.variableNames=["dy"],this.outputShape=[],this.outputShape=t;const[,s,o]=t,[,i,a]=e,u=[r&&i>1?s-1:s,r&&a>1?o-1:o],c=[r&&i>1?i-1:i,r&&a>1?a-1:a],l=u[0]/c[0],h=u[1]/c[1],d=1/l,m=1/h,g=Math.ceil(d)*2+2,C=Math.ceil(m)*2+2;this.userCode=`
      void main() {
        ivec4 coords = getOutputCoords();
        int b = coords[0];
        int d = coords[3];
        int r = coords[1];
        int c = coords[2];

        float accumulator = 0.0;

        const float heightScale = float(${l});
        const float widthScale = float(${h});

        const float invHeightScale = float(${d});
        const float invWidthScale = float(${m});

        const int winHeight = int(${g});
        const int winWidth = int(${C});

        // Compute bounds for where in dy we will look
        float startRLerp = floor(float(r) * invHeightScale);
        int startDyR = int(floor(startRLerp - float(winHeight / 2)));

        float startCLerp = floor(float(c) * invWidthScale);
        int startDyC = int(floor(startCLerp - float(winWidth / 2)));

        // Loop over dy
        for (int dyROffset = 0; dyROffset < winHeight; dyROffset++) {
          int dyR = dyROffset + startDyR;

          // Guard against the window exceeding the bounds of dy
          if (dyR < 0 || dyR >= ${i}) {
            continue;
          }

          for (int dyCOffset = 0; dyCOffset < winWidth; dyCOffset++) {
            int dyC = dyCOffset + startDyC;

            // Guard against the window exceeding the bounds of dy
            if (dyC < 0 || dyC >= ${a}) {
              continue;
            }

            float sourceFracRow =
              float(${u[0]}) *
                (float(dyR) / float(${c[0]}));

            float sourceFracCol =
                float(${u[1]}) *
                  (float(dyC) / float(${c[1]}));

            int sourceNearestRow = int(min(
                float(int(${s}) - 1),
                ${r} ? float(round(sourceFracRow)) :
                                  float(floor(sourceFracRow))));

            int sourceNearestCol = int(min(
                float(int(${o}) - 1),
                ${r} ? float(round(sourceFracCol)) :
                                  float(floor(sourceFracCol))));

            if (r == sourceNearestRow && c == sourceNearestCol) {
              accumulator += getDy(b, dyR, dyC, d);
            }
          }
        }
        // End loop over dy

        setOutput(accumulator);
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function BI(n){const{inputs:e,backend:t,attrs:r}=n,{images:s,dy:o}=e,{alignCorners:i}=r,a=new LI(o.shape,s.shape,i);return t.runWebGLProgram(a,[o],o.dtype)}const MI={kernelName:R0,backendName:"webgl",kernelFunc:BI};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class VI{constructor(e,t){this.variableNames=["x"];const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);if(this.outputShape=e,r===1){this.userCode=`
        void main() {
          int coord = getOutputCoords();
          setOutput(getX(${e[0]} - coord - 1));
        }
      `;return}const s=a=>t.indexOf(a)!==-1&&e[a]!==1?`${e[a]} - coords[${a}] - 1`:`coords[${a}]`,o=e.map((a,u)=>s(u)).join(","),i=Tt(r);this.userCode=`
      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${o}));
      }
    `}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class UI{constructor(e,t){this.variableNames=["x"],this.packedInputs=!0,this.packedOutput=!0;const r=e.length;if(r>4)throw new Error(`WebGL backend: Reverse of rank-${r} tensor is not yet supported`);this.outputShape=e;const s=wn("rc",r),o=`${s[r-1]} + 1 < ${this.outputShape[r-1]}`,i=`${s[r-2]} + 1 < ${this.outputShape[r-2]}`,a=Tt(r);r===1?this.userCode=`
        void main(){
          int rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = getChannel(getX(${e[0]} - rc - 1),
            ${e[0]} - rc - 1);
          if(${o}){
              result.g = getChannel(getX(${e[0]} - (rc  + 1) - 1),
                ${e[0]} - (rc  + 1) - 1);
          }
          setOutput(result);
        }
      `:this.userCode=`
        void main() {
          ${a} rc = getOutputCoords();
          vec4 result = vec4(0.);
          result.r = ${u(s.slice())};
          if(${o}){
            result.g = ${c(s.slice())};
          }
          if(${i}) {
            result.b = ${l(s.slice())};
            if(${o}) {
              result.a = ${h(s.slice())};
            }
          }
          setOutput(result);
        }
    `;function u(g){return d(g)}function c(g){return g[r-1]="("+g[r-1]+" + 1)",d(g)}function l(g){return g[r-2]="("+g[r-2]+" + 1)",d(g)}function h(g){return g[r-1]="("+g[r-1]+" + 1)",g[r-2]="("+g[r-2]+" + 1)",d(g)}function d(g){const C=e.map((A,P)=>m(P,g)),$=C.join(","),T=C.slice(-2).join(",");return`getChannel(getX(${$}), vec2(${T}))`}function m(g,C){return t.indexOf(g)!==-1&&e[g]!==1?`${e[g]} - ${C[g]} - 1`:`${C[g]}`}}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function WI(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{dims:o}=r,i=s.shape.length,a=Zt(o,s.shape);if(i===0)return Ln({inputs:{x:s},backend:t});const u=ue().getBool("WEBGL_PACK_ARRAY_OPERATIONS")?new UI(s.shape,a):new VI(s.shape,a);return t.runWebGLProgram(u,[s],s.dtype)}const zI={kernelName:vp,backendName:"webgl",kernelFunc:WI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class GI{constructor(e,t){this.variableNames=["Image"],this.outputShape=[],this.customUniforms=[{name:"params",type:"vec4"}];const r=e[1],s=e[2];this.outputShape=e;let o="";typeof t=="number"?o=`float outputValue = ${t.toFixed(2)};`:o=`
        vec3 fill = vec3(${t.join(",")});
        float outputValue = fill[coords[3]];`,this.userCode=`
        void main() {
          ivec4 coords = getOutputCoords();
          int x = coords[2];
          int y = coords[1];
          float coordXFloat = (float(x) - params[0]) * params[3] -
            (float(y) - params[1]) * params[2];
          float coordYFloat = (float(x) - params[0]) * params[2] +
            (float(y) - params[1]) * params[3];
          int coordX = int(round(coordXFloat + params[0]));
          int coordY = int(round(coordYFloat + params[1]));
          ${o}
          if(coordX >= 0 && coordX < ${s} && coordY >= 0 && coordY < ${r}) {
            outputValue = getImage(coords[0], coordY, coordX, coords[3]);
          }
          setOutput(outputValue);
        }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const jI={kernelName:s1,backendName:"webgl",kernelFunc:({inputs:n,attrs:e,backend:t})=>{const{image:r}=n,{radians:s,fillValue:o,center:i}=e,a=t,u=new GI(r.shape,o),[c,l]=nm(i,r.shape[1],r.shape[2]),h=[[c,l,Math.sin(s),Math.cos(s)]];return a.runWebGLProgram(u,[r],r.dtype,h)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HI=`
  // OpenGL ES does not support round function.
  // The algorithm is based on banker's rounding.
  float base = floor(x);
  if ((x - base) < 0.5) {
    return floor(x);
  } else if ((x - base) > 0.5) {
    return ceil(x);
  } else {
    if (mod(base, 2.0) == 0.0) {
      return base;
    } else {
      return base + 1.0;
    }
  }
`,qI=rt({opSnippet:HI}),XI={kernelName:wp,backendName:"webgl",kernelFunc:qI};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const KI="return inversesqrt(x);",YI=rt({opSnippet:KI,cpuKernelImpl:xS}),QI={kernelName:Cp,backendName:"webgl",kernelFunc:YI};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ng{constructor(e,t,r,s,o,i,a=!0){this.variableNames=["updates","indices","defaultValue"],this.outputShape=i;const u=Tt(o.length),c=Tt(i.length);let l="";r===1?l="i":r===2&&(l="i, j");const h=`getIndices(${l})`;let d="";s===1?d="i":s===2&&(d="i, coords[1]");const m=`getUpdates(${d})`,g=t>1?"strides[j]":"strides";this.userCode=`
        ${u} strides = ${u}(${o});

        void main() {
          ${c} coords = getOutputCoords();
          float sum = 0.0;
          bool found = false;
          for (int i = 0; i < ${e}; i++) {
            int flattenedIndex = 0;
            for (int j = 0; j < ${t}; j++) {
              int index = round(${h});
              flattenedIndex += index * ${g};
            }
            if (flattenedIndex == coords[0]) {
              sum += ${m};
              found = true;
            }
          }
          setOutput(mix(getDefaultValue(), sum, float(found)));
        }
      `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function ZI(n){const{inputs:e,backend:t,attrs:r}=n,{indices:s,updates:o}=e,{shape:i}=r,{sliceRank:a,numUpdates:u,sliceSize:c,strides:l,outputSize:h}=ol(o,s,i),d=[h/c,c];if(h===0)return t.makeTensorInfo(i,s.dtype);const m=ke({inputs:{x:s},backend:t,attrs:{shape:[u,a]}}),g=ke({inputs:{x:o},backend:t,attrs:{shape:[u,c]}}),C=t.makeTensorInfo([],"float32",new Float32Array([0])),$=new Ng(u,a,m.shape.length,g.shape.length,l,d),T=t.runWebGLProgram($,[g,m,C],g.dtype),A=ke({inputs:{x:T},backend:t,attrs:{shape:i}});return t.disposeIntermediateTensorInfo(m),t.disposeIntermediateTensorInfo(g),t.disposeIntermediateTensorInfo(T),t.disposeIntermediateTensorInfo(C),A}const JI={kernelName:Tp,backendName:"webgl",kernelFunc:ZI};/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class e_{constructor(e,t,r,s){this.variableNames=["sortedSequence","values"],this.customUniforms=[{name:"numInputs",type:"int"}],this.outputShape=[e,r];const o="while (left < right) {",i=`for (int i = 0; i < ${Math.ceil(Math.log2(t+1))}; ++i) { if (left >= right) break;`,a=ue().getNumber("WEBGL_VERSION")===2?o:i,u=s==="left"?"<":"<=";this.userCode=`
       int findBound(int batch, float value) {
         int left = 0;
         int right = numInputs;
         int mid;
         ${a}
           mid = (left + right) / 2;
           if (getSortedSequence(batch, mid) ${u} value) {
             left = mid + 1;
           } else {
             right = mid;
           }
         }
         return right;
       }

       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int valueIndex = coords[1];

         float value = getValues(batch, valueIndex);

         setOutput(float(findBound(batch, value)));
       }
     `}}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function t_(n){const{inputs:e,backend:t,attrs:r}=n,{sortedSequence:s,values:o}=e,{side:i}=r,a=new e_(s.shape[0],s.shape[1],o.shape[1],i),u=[[s.shape[1]]];return t.runWebGLProgram(a,[s,o],"int32",u)}const n_={kernelName:$p,backendName:"webgl",kernelFunc:t_};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class r_{constructor(e,t,r){this.variableNames=["c","a","b"],this.outputShape=t;let s,o;if(r>4)throw Error(`Where for rank ${r} is not yet supported`);if(r===1)o="resRC",s="resRC";else{const a=["resRC.x","resRC.y","resRC.z","resRC.w"],u=[],c=[];for(let l=0;l<t.length;l++)c.push(`${a[l]}`),l<e&&u.push(`${a[l]}`);s=u.join(),o=c.join()}const i=Tt(r);this.userCode=`
      void main() {
        ${i} resRC = getOutputCoords();
        float cVal = getC(${s});
        if (cVal >= 1.0) {
          setOutput(getA(${o}));
        } else {
          setOutput(getB(${o}));
        }
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function s_(n){const{inputs:e,backend:t}=n,{condition:r,t:s,e:o}=e,i=new r_(r.shape.length,s.shape,s.shape.length);return t.runWebGLProgram(i,[r,s,o],rs(s.dtype,o.dtype))}const o_={kernelName:Sp,backendName:"webgl",kernelFunc:s_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const i_=`
  // Stable and Attracting Fixed Point (0, 1) for Normalized Weights.
  // see: https://arxiv.org/abs/1706.02515
  float scaleAlpha = ${om};
  float scale = ${im};
  return (x >= 0.0) ? scale * x : scaleAlpha * (exp(x) - 1.0);
`,a_=rt({opSnippet:i_}),u_={kernelName:Np,backendName:"webgl",kernelFunc:a_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const c_=Ii+`
  return 1.0 / (1.0 + exp(-1.0 * x));
`,l_=`
  vec4 result = 1.0 / (1.0 + exp(-1.0 * x));
  bvec4 isNaN = isnan(x);

  result.r = isNaN.r ? x.r : result.r;
  result.g = isNaN.g ? x.g : result.g;
  result.b = isNaN.b ? x.b : result.b;
  result.a = isNaN.a ? x.a : result.a;

  return result;
`,h_=rt({opSnippet:c_,packedOpSnippet:l_,cpuKernelImpl:vS}),f_={kernelName:Rp,backendName:"webgl",kernelFunc:h_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const d_=`
  if (isnan(x)) { return 0.0; }
  return sign(x);
`,p_=rt({opSnippet:d_}),m_={kernelName:_p,backendName:"webgl",kernelFunc:p_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const g_=Ii+`
  return sin(x);
`,y_=rt({opSnippet:g_}),x_={kernelName:kp,backendName:"webgl",kernelFunc:y_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const b_=`
  float e2x = exp(x);
  return (e2x - 1.0 / e2x) / 2.0;
`,v_=rt({opSnippet:b_}),w_={kernelName:Ip,backendName:"webgl",kernelFunc:v_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const C_=`
  float epsilon = 1.1920928955078125e-7;
  float threshold = log(epsilon) + 2.0;

  bool too_large = x > -threshold;
  bool too_small = x < threshold;

  float result;
  float exp_x = exp(x);

  if (too_large){
    result = x;
  }
  else if (too_small){
    result = exp_x;
  }
  else{
    result = log(exp_x + 1.0);
  }
  return result;
`,T_=rt({opSnippet:C_}),$_={kernelName:Ap,backendName:"webgl",kernelFunc:T_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const S_=n=>{const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{blockShape:o,paddings:i}=r;M(s.shape.length<=4,()=>"spaceToBatchND for rank > 4 with a WebGL backend not implemented yet");const a=o.reduce((T,A)=>T*A),u=[[0,0]];u.push(...i);for(let T=1+o.length;T<s.shape.length;++T)u.push([0,0]);const c=[],l=$g({inputs:{x:s},backend:t,attrs:{paddings:u,constantValue:0}}),h=Tl(l.shape,o,a,!1),d=$l(h.length,o.length,!1),m=Sl(l.shape,o,a,!1),g=ke({inputs:{x:l},backend:t,attrs:{shape:h}}),C=$n({inputs:{x:g},backend:t,attrs:{perm:d}}),$=ke({inputs:{x:C},backend:t,attrs:{shape:m}});return c.push(l),c.push(g),c.push(C),c.forEach(T=>t.disposeIntermediateTensorInfo(T)),$},N_={kernelName:Fp,backendName:"webgl",kernelFunc:S_};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function E_(n){const{inputs:e,backend:t}=n,{indices:r,values:s,denseShape:o,defaultValue:i}=e;if(o.shape.length!==1)throw new Error(`Dense shape must be a vector, saw:
         ${o.shape}`);if(r.shape.length!==2)throw new Error(`Indices must be a matrix, saw:
         ${r.shape}`);if(s.shape.length!==1)throw new Error(`Values must be a vector, saw:
         ${s.shape}`);if(i.shape.length!==0)throw new Error(`Default value must be a scalar, saw:
        ${i.shape}`);const a=t.readSync(r.dataId),u=t.readSync(s.dataId),c=t.readSync(o.dataId),l=t.readSync(i.dataId)[0],[h,d,m,g,C]=CS(a,r.shape,r.dtype,u,s.dtype,c,l);return[t.makeTensorInfo(d,r.dtype,h),t.makeTensorInfo([d[0]],s.dtype,m),t.makeTensorInfo([g.length],"bool",new Uint8Array(g.map($=>Number($)))),t.makeTensorInfo([C.length],r.dtype,new Int32Array(C))]}const k_={kernelName:Bp,backendName:"webgl",kernelFunc:E_};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function I_(n){const{inputs:e,backend:t}=n,{inputIndices:r,inputShape:s,newShape:o}=e;if(r.shape.length!==2)throw new Error(`Input indices should be a matrix but received shape ${r.shape}`);if(s.shape.length!==1)throw new Error(`Input shape should be a vector but received shape ${s.shape}`);if(o.shape.length!==1)throw new Error(`Target shape should be a vector but received shape ${o.shape}`);const i=Array.from(t.readSync(s.dataId)),a=t.readSync(r.dataId),u=Array.from(t.readSync(o.dataId)),[c,l,h]=TS(a,r.shape,r.dtype,i,u);return[t.makeTensorInfo(l,r.dtype,c),t.makeTensorInfo([h.length],o.dtype,new Int32Array(h))]}const __={kernelName:Mp,backendName:"webgl",kernelFunc:I_};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function R_(n){const{inputs:e,backend:t}=n,{data:r,indices:s,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
              ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
              ${o.shape}`);const i=t.readSync(r.dataId),a=t.readSync(s.dataId),u=t.readSync(o.dataId),[c,l]=Km(i,r.shape,r.dtype,a,u,!0);return t.makeTensorInfo(l,r.dtype,c)}const A_={kernelName:Vp,backendName:"webgl",kernelFunc:R_};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function O_(n){const{inputs:e,backend:t}=n,{data:r,indices:s,segmentIds:o}=e;if(r.shape.length<1)throw new Error("Data should be at least 1 dimensional but received scalar");if(s.shape.length!==1)throw new Error(`Indices should be a vector but received shape
             ${s.shape}`);if(o.shape.length!==1)throw new Error(`Segment ids should be a vector but received shape
             ${o.shape}`);const i=t.readSync(r.dataId),a=t.readSync(s.dataId),u=t.readSync(o.dataId),[c,l]=Km(i,r.shape,r.dtype,a,u);return t.makeTensorInfo(l,r.dtype,c)}const D_={kernelName:Up,backendName:"webgl",kernelFunc:O_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function F_(n){const{inputs:e,backend:t,attrs:r}=n,{sparseIndices:s,sparseValues:o,defaultValue:i}=e,{outputShape:a}=r,{sliceRank:u,numUpdates:c,sliceSize:l,strides:h,outputSize:d}=ol(o,s,a),m=!1;if(o.dtype==="string"){const T=t.bufferSync(s),A=t.bufferSync(o),P=fi(t.readSync(i.dataId)[0]),B=bS(T,A,a,d,l,c,u,h,P,m);return t.makeTensorInfo(a,B.dtype,B.values)}const g=new Ng(c,u,s.shape.length,o.shape.length,h,[d,1],m),C=t.runWebGLProgram(g,[o,s,i],o.dtype),$=ke({inputs:{x:C},backend:t,attrs:{shape:a}});return t.disposeIntermediateTensorInfo(C),$}const P_={kernelName:Wp,backendName:"webgl",kernelFunc:F_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function L_(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{numOrSizeSplits:o,axis:i}=r,a=Zt(i,s.shape)[0],u=xm(s,o,a),c=s.shape.length,l=new Array(c).fill(0),h=s.shape.slice();return u.map(d=>{const m=[...h];m[a]=d;const g=_i({inputs:{x:s},backend:t,attrs:{begin:l,size:m}});return l[a]+=d,g})}const B_={kernelName:Pp,backendName:"webgl",kernelFunc:L_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Uh="return sqrt(x);",M_=rt({opSnippet:Uh,packedOpSnippet:Uh,cpuKernelImpl:$S}),V_={kernelName:Op,backendName:"webgl",kernelFunc:M_};/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const U_="return x * x;",W_=rt({opSnippet:U_}),z_={kernelName:O0,backendName:"webgl",kernelFunc:W_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const Wh="return (a - b) * (a - b);",G_=on({opSnippet:Wh,packedOpSnippet:Wh}),j_={kernelName:zp,backendName:"webgl",kernelFunc:G_};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function H_({inputs:n,attrs:e,backend:t}){const{x:r}=n,s=br+`
    return x > 0.0 ? 1.0 : float(${e.alpha});
  `,o=new gs(r.shape,s);return t.runWebGLProgram(o,[r],r.dtype)}const q_={kernelName:r1,backendName:"webgl",kernelFunc:H_};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class X_{constructor(e,t,r){this.variableNames=["x"],this.outputShape=r;const s=r.length,o=Tt(r.length),i=Tt(r.length);let a="";if(s===1)a="coords * strides + begin";else{let u=0;a=r.map((c,l)=>(u++,r.length===1?`coords * strides[${l}] + begin[${l}]`:`coords[${u-1}] * strides[${l}] + begin[${l}]`)).join(",")}this.userCode=`
      ${o} begin = ${o}(${e});
      ${o} strides = ${o}(${t});

      void main() {
        ${i} coords = getOutputCoords();
        setOutput(getX(${a}));
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function K_(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{begin:o,end:i,strides:a,beginMask:u,endMask:c,ellipsisMask:l,newAxisMask:h,shrinkAxisMask:d}=r,{finalShapeSparse:m,finalShape:g,isIdentity:C,sliceDim0:$,isSimpleSlice:T,begin:A,end:P,strides:B}=n2(s.shape,o,i,a,u,c,l,h,d);let H;if(C)H=ke({inputs:{x:s},backend:t,attrs:{shape:g}});else if($||T){M(s.shape.length>=1,()=>`Input must have rank at least 1, got: ${s.shape.length}`);const re=H1(A,P,B),oe=_i({inputs:{x:s},backend:t,attrs:{begin:A,size:re}});H=ke({inputs:{x:oe},backend:t,attrs:{shape:g}}),t.disposeIntermediateTensorInfo(oe)}else if(t.shouldExecuteOnCPU([s])){const oe=t.readSync(s.dataId),ie=Ot(s.shape,s.dtype,oe),le=SS(m,ie,B,A);H=t.makeTensorInfo(g,s.dtype,le.values)}else{const oe=new X_(A,B,m);H=t.runWebGLProgram(oe,[s],s.dtype)}const x=ke({inputs:{x:H},backend:t,attrs:{shape:g}});return t.disposeIntermediateTensorInfo(H),x}const Y_={kernelName:Gp,backendName:"webgl",kernelFunc:K_};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Q_(n){const{inputs:e,backend:t,attrs:r}=n,{separator:s,nGramWidths:o,leftPad:i,rightPad:a,padWidth:u,preserveShortSequences:c}=r,{data:l,dataSplits:h}=e,d=t.readSync(l.dataId),m=t.readSync(h.dataId),[g,C]=NS(d,m,s,o,i,a,u,c);return[t.makeTensorInfo([g.length],"string",g),t.makeTensorInfo(h.shape,"int32",C)]}const Z_={kernelName:jp,backendName:"webgl",kernelFunc:Q_};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function J_(n){const{inputs:e,backend:t,attrs:r}=n,{skipEmpty:s}=r,{input:o,delimiter:i}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(o.shape.length!==1)throw new Error(`Input must be a vector, got shape: ${o.shape}`);if(i.shape.length!==0)throw new Error(`Delimiter must be a scalar, got shape: ${i.shape}`);const a=t.readSync(o.dataId),u=t.readSync(i.dataId)[0],[c,l,h]=ES(a,u,s),d=l.length;return[t.makeTensorInfo([d,2],"int32",c),t.makeTensorInfo([d],"string",l),t.makeTensorInfo([2],"int32",new Int32Array(h))]}const eR={kernelName:Hp,backendName:"webgl",kernelFunc:J_};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function tR(n){const{inputs:e,backend:t,attrs:r}=n,{numBuckets:s}=r,{input:o}=e;if(o.dtype!=="string")throw new Error("Input must be of datatype string");if(s<=0)throw new Error("Number of buckets must be at least 1");const i=t.readSync(o.dataId),a=kS(i,s);return t.makeTensorInfo(o.shape,"int32",a)}const nR={kernelName:qp,backendName:"webgl",kernelFunc:tR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const rR="return tan(x);",sR=rt({opSnippet:rR}),oR={kernelName:Kp,backendName:"webgl",kernelFunc:sR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iR=`
  float e2x = exp(-2.0 * abs(x));
  return sign(x) * (1.0 - e2x) / (1.0 + e2x);
`,aR=rt({opSnippet:iR}),uR={kernelName:Yp,backendName:"webgl",kernelFunc:aR};/**
 * @license
 * Copyright 2017 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class cR{constructor(e,t){this.variableNames=["A"];const r=new Array(e.length);for(let i=0;i<r.length;i++)r[i]=e[i]*t[i];this.outputShape=r,this.rank=r.length;const s=Tt(this.rank),o=lR(e);this.userCode=`
      void main() {
        ${s} resRC = getOutputCoords();
        setOutput(getA(${o}));
      }
    `}}function lR(n){const e=n.length;if(e>5)throw Error(`Tile for rank ${e} is not yet supported`);if(e===1)return`imod(resRC, ${n[0]})`;const t=["resRC.x","resRC.y","resRC.z","resRC.w","resRC.u"],r=[];for(let s=0;s<n.length;s++)r.push(`imod(${t[s]}, ${n[s]})`);return r.join()}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Eg(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{reps:o}=r;if(s.dtype==="string"||s.shape.length>5){const u=t.readSync(s.dataId),c=s.dtype==="string"?u.map(d=>fi(d)):u,l=Ot(s.shape,s.dtype,c),h=_S(l,o);return t.makeTensorInfo(h.shape,h.dtype,h.values)}const i=new cR(s.shape,o);return t.runWebGLProgram(i,[s],s.dtype)}const hR={kernelName:Qc,backendName:"webgl",kernelFunc:Eg};class fR{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"negativeInf",type:"float"},{name:"dir",type:"int"},{name:"inc",type:"int"}],this.outputShape=e,this.userCode=`
       void main() {
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // We compare elements pair-wise within a group of size 2 * inc.
         // The comparing rule for each group alternates between ascending
         // and descending. Within each group, we compare each pair at
         // positions i and i+inc. To decide whether an element at position i
         // is x0 or x1, we mod it by 2 * inc, if the result is smaller than
         // inc, it is in the first half of the group, we denote it as x0,
         // otherwise we denote it as x1.
         // For example, as shown in the Bitonic top K paper referenced above,
         // Figure5(a) shows that element[1] is in the
         // second half of the group when group size is 2, but it is in the
         // first half of the group when group size is 4.

         bool isFirstInPair = imod(elemIdx, 2 * inc) < inc;
         int i = isFirstInPair ? elemIdx : elemIdx - inc;

         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + inc : int(getIndices(batch, i + inc));
         float x0 = i0 < n ? getX(batch, i0) : negativeInf;
         float x1 = i1 < n ? getX(batch, i1) : negativeInf;

         // Denotes which direction indices are in (ascending or descending).
         bool reverse = imod(elemIdx, 2 * dir) >= dir;
         bool isGreater = x0 > x1 || (x0 == x1 && i1 > i0);
         if (reverse == isGreater) { // Elements in opposite order of direction
           int iTemp = i0;
           i0 = i1;
           i1 = iTemp;
         }
         if (isFirstInPair) {
            setOutput(float(i0));
         } else {
            setOutput(float(i1));
         }
       }
     `}}class dR{constructor(e){this.variableNames=["x","indices"],this.customUniforms=[{name:"n",type:"int"},{name:"firstPass",type:"int"},{name:"k",type:"int"}],this.outputShape=e,this.userCode=`
    void main() {
         // Takes max of indices (0, k), (1, k + 1), (2, k + 2) ...
         ivec2 coords = getOutputCoords();
         int batch = coords[0];
         int elemIdx = coords[1];

         // The output size is half of the previous size.
         // If the previous sequence is | | | | _ _ _ _  | | | |  _ _ _ _ (k=4),
         // we only need to output the indices at positions |, the indices at
         // positions _ can be thrown away, see Figure5(b) After Phase 2
         // (Merge phase) in the Bitonic Top K paper referenced above.
         // For example, the paper shows we only need to output the orange bars.
         // The output sequence should look like this | | | | | | | |.
         // Because the sequence is halved, to map the output index back
         // to the previous sequence to find the corresponding value,
         // we need to double the index. When we double the index,
         // we basically interpolate a position, so 2i looks like
         // | _ | _ | _ | _ | _ | _ | _. We move the | to the first k position
         // of each 2k positions by - elemIdx % k. E.g. for output at
         // index 4,5,6,7, we want to get the corresponding element at
         // original index 8,9,10,11, for output at index 8,9,10,11,
         // we want to get the corresponding element at original index
         // 16,17,18,19, so on and so forth.

         int i = elemIdx < k ? elemIdx : (elemIdx * 2 - imod(elemIdx, k));
         int i0 = firstPass == 1 ? i : int(getIndices(batch, i));
         int i1 = firstPass == 1 ? i + k : int(getIndices(batch, i + k));

         float x0 = getX(batch, i0);
         float x1 = i1 < n ? getX(batch, i1) : x0;

         setOutput(x0 >= x1 ? float(i0) : float(i1));
       }
     `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function po(n,e){e!==null&&n.disposeIntermediateTensorInfo(e)}function zh(n){let e=1;for(;e<n;)e*=2;return e}function pR(n){const{inputs:e,backend:t,attrs:r}=n,{x:s}=e,{k:o,sorted:i}=r,a=ue().getNumber("TOPK_LAST_DIM_CPU_HANDOFF_SIZE_THRESHOLD"),u=ue().getNumber("TOPK_K_CPU_HANDOFF_THRESHOLD"),c=s.shape,l=c[c.length-1];if(t.shouldExecuteOnCPU([s])||l<a||o>u){const le=t.readSync(s.dataId),[$e,Ie]=RS(le,c,s.dtype,o,i);return[t.makeTensorInfo($e.shape,$e.dtype,$e.values),t.makeTensorInfo(Ie.shape,Ie.dtype,Ie.values)]}if(o===0)return c[c.length-1]=0,[t.makeTensorInfo(c,s.dtype,[]),t.makeTensorInfo(c,"int32",[])];if(l===1)return[s,da({attrs:{shape:c,dtype:"int32",value:0},backend:t})];const h=t.texData.get(s.dataId),d=h!==null&&h.isPacked,m=d?t.unpackTensor(s):s,C=Ce(c)/l,$=ke({inputs:{x:m},attrs:{shape:[C,l]},backend:t});d&&po(t,m);const T=zh(o),A=zh(l);let P=null;const B=()=>P===null?[$,$]:[$,P],H=(le,$e,Ie)=>{const Ae=B(),Ge=new fR(Ie),at=[[l],[P===null?1:0],[Number.NEGATIVE_INFINITY],[le],[$e]],ut=P;P=t.runWebGLProgram(Ge,Ae,"int32",at),po(t,ut)};for(let le=1;le<T;le*=2){const $e=le*2;for(let Ie=le;Ie>=1;Ie/=2)H($e,Ie,[C,A])}for(let le=A;le>T;le/=2){const $e=B(),Ie=new dR([C,le/2]),Ge=[[l],[P===null?1:0],[T]],Ye=P;P=t.runWebGLProgram(Ie,$e,"int32",Ge),po(t,Ye);const at=T/2,ut=at*2;for(let lt=at;lt>=1;lt/=2)H(ut,lt,P.shape)}let x=P;P=_i({inputs:{x:P},backend:t,attrs:{begin:0,size:[C,o]}}),po(t,x);let re=xg({inputs:{x:$,indices:P},backend:t,attrs:{axis:1,batchDims:1}});po(t,$);const oe=c.slice(0,-1);oe.push(o),x=P,P=ke({inputs:{x:P},attrs:{shape:oe},backend:t}),po(t,x);const ie=re;return re=ke({inputs:{x:re},attrs:{shape:oe},backend:t}),po(t,ie),[re,P]}const mR={kernelName:Qp,backendName:"webgl",kernelFunc:pR};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class gR{constructor(e,t,r,s,o,i){this.variableNames=["Image","Transforms"],this.outputShape=i;const a=r==="nearest"?1:2;let u;switch(s){case"constant":u=1;break;case"reflect":u=2;break;case"wrap":u=3;break;case"nearest":u=4;break;default:u=1;break}this.userCode=`
            float mapCoord(float outCoord, float len) {
              float inCoord = outCoord;
              if(${u} == 2) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    if (inCoord < sz2) {
                      inCoord = sz2 * float(int(float(-inCoord / sz2))) +
                      inCoord;
                    }
                    inCoord = inCoord < -len ? inCoord + sz2 : -inCoord - 1.0;
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz2 = 2.0 * len;
                    inCoord -= sz2 * float(int(float(inCoord / sz2)));
                    if (inCoord >= len) {
                      inCoord = sz2 - inCoord - 1.0;
                    }
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${u} == 3) {
                if (inCoord < 0.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord += len * (float(int(float(-inCoord / sz))) + 1.0);
                  }
                } else if (inCoord > len - 1.0) {
                  if (len <= 1.0) {
                    inCoord = 0.0;
                  } else {
                    float sz = len - 1.0;
                    inCoord -= len * float(int(float(inCoord / sz)));
                  }
                }
                return clamp(inCoord, 0.0, len - 1.0);
              } else if (${u} == 4) {
                return clamp(outCoord, 0.0, len - 1.0);
              } else {
                return outCoord;
              }
            }

            float readWithFillValue(int batch, int coordY, int coordX,
              int channel) {
              float outputValue;
              if (0 <= coordY && coordY < ${e} && 0 <= coordX && coordX < ${t}) {
                  outputValue = getImage(batch, coordY, coordX, channel);
              } else {
                outputValue = float(${o});
              }
              return outputValue;
            }

            void main() {
              ivec4 coords = getOutputCoords();
              float outputValue;
              int batch = coords[0];
              int x = coords[2];
              int y = coords[1];
              int channel = coords[3];
              float xf = float(x);
              float yf = float(y);
              float a1 = getTransforms(batch, 0);
              float a2 = getTransforms(batch, 1);
              float a3 = getTransforms(batch, 2);
              float b1 = getTransforms(batch, 3);
              float b2 = getTransforms(batch, 4);
              float b3 = getTransforms(batch, 5);
              float c1 = getTransforms(batch, 6);
              float c2 = getTransforms(batch, 7);
              float projection = c1 * xf + c2 * yf + 1.0;
              if (projection == 0.0) {
                outputValue = float(${o});
              } else {
                float inX = (a1 * xf + a2 * yf + a3) / projection;
                float inY = (b1 * xf + b2 * yf + b3) / projection;
                float mapX = mapCoord(inX, float(${t}));
                float mapY = mapCoord(inY, float(${e}));

                if (${a} == 1) {
                  int coordY = int(round(mapY));
                  int coordX = int(round(mapX));
                  outputValue = readWithFillValue(batch, coordY, coordX,
                    channel);
                } else {
                  float yFloor = floor(mapY);
                  float xFloor = floor(mapX);
                  float yCeil = yFloor + 1.0;
                  float xCeil = xFloor + 1.0;
                  float valueYFloor = (xCeil - mapX) *
                  readWithFillValue(batch, int(yFloor), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yFloor), int(xCeil), channel);
                  float valueYCeil = (xCeil - mapX) *
                  readWithFillValue(batch, int(yCeil), int(xFloor), channel) +
                  (mapX - xFloor) *
                  readWithFillValue(batch, int(yCeil), int(xCeil), channel);
                  outputValue = (yCeil - mapY) * valueYFloor +
                  (mapY - yFloor) * valueYCeil;
                }
              }
              setOutput(outputValue);
            }
        `}}/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function yR(n){const{inputs:e,backend:t,attrs:r}=n,{image:s,transforms:o}=e,{interpolation:i,fillMode:a,fillValue:u,outputShape:c}=r,[l,h,d,m]=s.shape,[g,C]=c!=null?c:[h,d],$=[l,g,C,m],T=new gR(h,d,i,a,u,$);return t.runWebGLProgram(T,[s,o],"float32")}const xR={kernelName:Zp,backendName:"webgl",kernelFunc:yR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the License);
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an AS IS BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function bR(n){const{inputs:e,attrs:t,backend:r}=n,{axis:s}=t,{x:o}=e;ua(o,"unique"),console.warn("WARNING: ","UI might be locked temporarily as data is being downloaded");const i=r.readSync(o.dataId),{outputValues:a,outputShape:u,indices:c}=AS(i,s,o.shape,o.dtype);return[r.makeTensorInfo(u,o.dtype,a),r.makeTensorInfo([c.length],"int32",c)]}const vR={kernelName:Jp,backendName:"webgl",kernelFunc:bR};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function wR(n){const{inputs:e,backend:t,attrs:r}=n,{value:s}=e;let{axis:o}=r;o<0&&(o+=s.shape.length);const i=s,a=i.shape.length,u=s.shape[o],c=new Array(a-1);let l=0;for(let C=0;C<a;C++)C!==o&&(c[l++]=i.shape[C]);const h=[],d=new Array(a).fill(0),m=i.shape.slice();m[o]=1;const g=new Array(u);for(let C=0;C<g.length;C++){d[o]=C;const $=_i({inputs:{x:i},backend:t,attrs:{begin:d,size:m}}),T=ke({inputs:{x:$},backend:t,attrs:{shape:c}});g[C]=T,h.push($)}return h.forEach(C=>t.disposeIntermediateTensorInfo(C)),g}const CR={kernelName:e1,backendName:"webgl",kernelFunc:wR};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class TR{constructor(e,t){this.variableNames=["x","segmentIds"];const r=e.windowSize,s=e.batchSize,o=e.inSize,i=e.numSegments,a=i*Math.ceil(o/r);this.outputShape=[s,a];const u="0.0",c="sumValue",l=Math.floor(r/4)*4,h=r%4,d=`
        sumValue += dot(values, segFilter);
    `;let m="";o%r>0&&(m=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return initializationValue;
        }
      `);let g="";o%r>0&&(g=`
        if (inIdx < 0 || inIdx >= ${o}) {
          return -1.0;
        }
      `),this.userCode=`
      const float initializationValue = ${u};

      float getValue(int batch, int inIdx) {
        ${m}
        return getX(batch, inIdx);
      }

      float getSegmentIdAtIndex(int inIdx) {
        ${g}
        return getSegmentIds(inIdx);
      }

      void main() {
        ivec2 coords = getOutputCoords();
        int batch = coords[0];
        int outIdx = coords[1];
        int inOffset = int(floor(float(outIdx) / float(
          ${i})) * float(${r}));
        int currentSeg = int(mod(float(outIdx), float(${i})));

        float sumValue = 0.0;

        for (int i = 0; i < ${l}; i += 4) {
          int inIdx = inOffset + i;
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            getValue(batch, inIdx + 3)
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 3)) == currentSeg ? 1 : 0
          );

          ${d}
        }

        int inIdx = inOffset + ${l};
        if (${h===1}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            initializationValue,
            initializationValue,
            initializationValue
          );

          int inIdxSeg = int(getSegmentIdAtIndex(inIdx));

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            0,
            0,
            0
          );

          ${d}
        } else if (${h===2}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            initializationValue,
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
              0,
              0
          );

          ${d}
        } else if (${h===3}) {
          vec4 values = vec4(
            getValue(batch, inIdx),
            getValue(batch, inIdx + 1),
            getValue(batch, inIdx + 2),
            initializationValue
          );

          vec4 segFilter = vec4(
            int(getSegmentIdAtIndex(inIdx)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 1)) == currentSeg ? 1 : 0,
            int(getSegmentIdAtIndex(inIdx + 2)) == currentSeg ? 1 : 0,
            0
          );

          ${d}
        }
        setOutput(${c});
      }
    `}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function $R(n){const{inputs:e,backend:t,attrs:r}=n,{x:s,segmentIds:o}=e,{numSegments:i}=r,a=s.shape.length,u=[];let c=0;const l=yr([c],a);let h=s;l!=null&&(h=$n({inputs:{x:s},backend:t,attrs:{perm:l}}),u.push(h),c=xr(1,a)[0]);const d=Rm(h.shape,c,i),m=Ce([h.shape[c]]),g=ke({inputs:{x:h},backend:t,attrs:{shape:[-1,m]}});u.push(g);const C=Jc(s.dtype),$=(B,H,x,re,oe)=>{const ie=B.shape[0],le=B.shape[1],$e=_m(le,oe),Ie={windowSize:$e,inSize:le,batchSize:ie,numSegments:oe},Ae=new TR(Ie,H),Ge=t.compileAndRun(Ae,[B,x],re);if(u.push(Ge),Ge.shape[1]===oe)return Ge;const Ye=Sg({backend:t,attrs:{start:0,stop:oe,step:1,dtype:"float32"}}),at=Eg({inputs:{x:Ye},backend:t,attrs:{reps:[le/$e]}});return u.push(Ye),u.push(at),$(Ge,H,at,re,oe)},T=$(g,"unsortedSegmentSum",o,C,i),A=ke({inputs:{x:T},backend:t,attrs:{shape:d}});let P=A;if(l!=null){u.push(A);const B=fl(l);P=$n({inputs:{x:P},backend:t,attrs:{perm:B}})}return u.forEach(B=>t.disposeIntermediateTensorInfo(B)),P}const SR={kernelName:t1,backendName:"webgl",kernelFunc:$R};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const NR=[T7,S7,k7,R7,O7,P7,B7,V7,G7,H7,K7,Z7,t8,o8,u8,l8,f8,g8,x8,v8,$8,R8,O8,F8,U8,z8,q8,i7,Y8,t9,o9,h9,d9,m9,y9,b9,C9,S9,k9,_9,A9,D9,L9,M9,z9,j9,X9,Q9,J9,rN,aN,hN,pN,yN,xN,vN,CN,$N,NN,kN,AN,FN,BN,VN,zN,HN,YN,eE,o7,nE,J8,oE,uE,hE,u7,mE,bE,wE,SE,kE,AE,FE,ME,zE,HE,XE,ZE,ek,nk,ik,uk,lk,fk,pk,xk,Ck,Nk,Dk,h7,Bk,Uk,Gk,qk,L8,Yk,Zk,eI,rI,aI,l7,cI,hI,dI,pI,B8,_k,yI,wI,SI,d7,II,AI,PI,MI,zI,jI,XI,QI,JI,n_,o_,u_,f_,m_,x_,w_,I8,Ak,$_,N_,k_,__,A_,D_,P_,B_,V_,z_,j_,q_,Y_,Z_,eR,nR,Rk,v7,oR,uR,hR,mR,xR,w7,vR,CR,SR,Qk];for(const n of NR)P0(n);/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ER=ue();ER.registerFlag("KEEP_INTERMEDIATE_TENSORS",()=>!1,n=>{n&&console.warn("Keep intermediate tensors is ON. This will print the values of all intermediate tensors during model inference. Not all models support this mode. For details, check e2e/benchmarks/ model_config.js. This significantly impacts performance.")});/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *
 * =============================================================================
 */var cr;(function(n){n[n.DT_INVALID=0]="DT_INVALID",n[n.DT_FLOAT=1]="DT_FLOAT",n[n.DT_DOUBLE=2]="DT_DOUBLE",n[n.DT_INT32=3]="DT_INT32",n[n.DT_UINT8=4]="DT_UINT8",n[n.DT_INT16=5]="DT_INT16",n[n.DT_INT8=6]="DT_INT8",n[n.DT_STRING=7]="DT_STRING",n[n.DT_COMPLEX64=8]="DT_COMPLEX64",n[n.DT_INT64=9]="DT_INT64",n[n.DT_BOOL=10]="DT_BOOL",n[n.DT_QINT8=11]="DT_QINT8",n[n.DT_QUINT8=12]="DT_QUINT8",n[n.DT_QINT32=13]="DT_QINT32",n[n.DT_BFLOAT16=14]="DT_BFLOAT16",n[n.DT_QINT16=15]="DT_QINT16",n[n.DT_QUINT16=16]="DT_QUINT16",n[n.DT_UINT16=17]="DT_UINT16",n[n.DT_COMPLEX128=18]="DT_COMPLEX128",n[n.DT_HALF=19]="DT_HALF",n[n.DT_RESOURCE=20]="DT_RESOURCE",n[n.DT_VARIANT=21]="DT_VARIANT",n[n.DT_UINT32=22]="DT_UINT32",n[n.DT_UINT64=23]="DT_UINT64",n[n.DT_FLOAT_REF=101]="DT_FLOAT_REF",n[n.DT_DOUBLE_REF=102]="DT_DOUBLE_REF",n[n.DT_INT32_REF=103]="DT_INT32_REF",n[n.DT_UINT8_REF=104]="DT_UINT8_REF",n[n.DT_INT16_REF=105]="DT_INT16_REF",n[n.DT_INT8_REF=106]="DT_INT8_REF",n[n.DT_STRING_REF=107]="DT_STRING_REF",n[n.DT_COMPLEX64_REF=108]="DT_COMPLEX64_REF",n[n.DT_INT64_REF=109]="DT_INT64_REF",n[n.DT_BOOL_REF=110]="DT_BOOL_REF",n[n.DT_QINT8_REF=111]="DT_QINT8_REF",n[n.DT_QUINT8_REF=112]="DT_QUINT8_REF",n[n.DT_QINT32_REF=113]="DT_QINT32_REF",n[n.DT_BFLOAT16_REF=114]="DT_BFLOAT16_REF",n[n.DT_QINT16_REF=115]="DT_QINT16_REF",n[n.DT_QUINT16_REF=116]="DT_QUINT16_REF",n[n.DT_UINT16_REF=117]="DT_UINT16_REF",n[n.DT_COMPLEX128_REF=118]="DT_COMPLEX128_REF",n[n.DT_HALF_REF=119]="DT_HALF_REF",n[n.DT_RESOURCE_REF=120]="DT_RESOURCE_REF",n[n.DT_VARIANT_REF=121]="DT_VARIANT_REF",n[n.DT_UINT32_REF=122]="DT_UINT32_REF",n[n.DT_UINT64_REF=123]="DT_UINT64_REF"})(cr||(cr={}));var Gh;(function(n){(function(e){e[e.LEGACY=0]="LEGACY",e[e.V1=1]="V1",e[e.V2=2]="V2"})(n.CheckpointFormatVersion||(n.CheckpointFormatVersion={}))})(Gh||(Gh={}));/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kR={};function kg(n){return kR[n]}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function N(n,e,t,r,s){const o=e.inputParams[n];if(o&&o.inputIndexStart!==void 0){const a=o.inputIndexStart,u=o.inputIndexEnd===0?void 0:o.inputIndexEnd===void 0?a+1:o.inputIndexEnd;if(o.type==="tensor")return Cn(e.inputNames[o.inputIndexStart],t,r,s);if(o.type==="tensors")return e.inputNames.slice(a,u).map(d=>Cn(d,t,r,s));const c=Cn(e.inputNames.slice(a)[0],t,r,s),l=c.dataSync();return o.type==="number"?l[0]:tc(c.shape,l)}const i=e.attrParams[n];return i&&i.value}function Cn(n,e,t,r){const[s,o]=Dn(n);if(r!=null){const a=r.getHashTableHandleByName(s);if(a!=null)return a}const i=t.currentContextIds.find(a=>!!e[Ya(s,a)]);return i!==void 0?e[Ya(s,i)][o]:void 0}function IR(n,e,t){return e[Ya(n,t.currentContextId)]}function Jr(n,e){const[t,r,s]=Dn(n);return[Ya(t,e&&e.currentContextId),r,s]}function Ya(n,e){return e?`${n}-${e}`:n}function Dn(n){const e=n.split(":");if(e.length===1)return[n,0,void 0];const t=e[0],r=e.length===3?e[1]:void 0,s=Number(e[e.length-1]);return[t,s,r]}function Da(n,e,t){let r=N("pad",n,e,t);if(r==="explicit"){r=N("explicitPaddings",n,e,t);const s=[[0,0],[0,0],[0,0],[0,0]];for(let o=0;o<4;o++)s[o][0]=r[o*2],s[o][1]=r[o*2+1];return s}return r}function ps(n){return n.kept?n:Us(n)}/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _R=[{tfOpName:"Add",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddV2",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AddN",category:"arithmetic",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"BiasAdd",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"Sub",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"RealDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Div",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"DivNoNan",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorDiv",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mul",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Maximum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Minimum",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Pow",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SquaredDifference",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Mod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"FloorMod",category:"arithmetic",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],RR=Object.freeze(Object.defineProperty({__proto__:null,json:_R},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AR=[{tfOpName:"Abs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atan2",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Ceil",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ClipByValue",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"clipValueMin",type:"number"},{start:2,name:"clipValueMax",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Complex",category:"basic_math",inputs:[{start:0,name:"real",type:"tensor"},{start:1,name:"imag",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ComplexAbs",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cos",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Cosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Elu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Exp",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Floor",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Imag",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Neg",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Real",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"Tout",name:"outputType",type:"dtype",notSupported:!0}]},{tfOpName:"Prelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"alpha",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Relu6",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Selu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sigmoid",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sin",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Rsqrt",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Square",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Tanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Sign",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Round",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Expm1",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Log1p",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Reciprocal",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Softplus",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Asinh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Acosh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Atanh",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Erf",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Prod",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axes",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LeakyRelu",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"alpha",name:"alpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"IsNan",category:"basic_math",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],OR=Object.freeze(Object.defineProperty({__proto__:null,json:AR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DR=[{tfOpName:"EmptyTensorList",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"maxNumElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"LoopCond",category:"control",inputs:[{start:0,name:"pred",type:"tensor"}]},{tfOpName:"Switch",category:"control",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"pred",type:"tensor"}]},{tfOpName:"Merge",category:"control",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}]},{tfOpName:"Enter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"frame_name",name:"frameName",type:"string"},{tfName:"is_constant",name:"isConstant",type:"bool"}]},{tfOpName:"Exit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NextIteration",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayV3",category:"control",inputs:[{start:0,name:"size",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"dynamic_size",name:"dynamicSize",type:"bool"},{tfName:"clear_after_read",name:"clearAfterRead",type:"bool"},{tfName:"identical_element_shapes",name:"identicalElementShapes",type:"bool"},{tfName:"tensor_array_name",name:"name",type:"string"}]},{tfOpName:"TensorArrayWriteV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayReadV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"TensorArrayGatherV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape",name:"elementShape",type:"shape"}]},{tfOpName:"TensorArrayScatterV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"tensor",type:"tensor"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArrayConcatV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"element_shape_except0",name:"elementShapeExcept0",type:"shape",notSupported:!0}]},{tfOpName:"TensorArraySplitV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"tensor",type:"tensor"},{start:2,name:"lengths",type:"number[]"},{start:3,name:"flowIn",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"TensorArraySizeV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"},{start:1,name:"flowIn",type:"number"}]},{tfOpName:"TensorArrayCloseV3",category:"control",inputs:[{start:0,name:"tensorArrayId",type:"tensor"}]},{tfOpName:"StatelessIf",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"If",category:"control",inputs:[{start:0,name:"cond",type:"tensor"},{start:1,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"then_branch",name:"thenBranch",type:"func"},{tfName:"else_branch",name:"elseBranch",type:"func"}]},{tfOpName:"StatelessWhile",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"While",category:"control",inputs:[{start:0,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"cond",name:"cond",type:"func"},{tfName:"body",name:"body",type:"func"}]},{tfOpName:"TensorListScatter",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListScatterV2",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"},{start:3,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGather",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"indices",type:"number[]"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListGetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListSetItem",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"index",type:"number"},{start:2,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListReserve",category:"control",inputs:[{start:0,name:"elementShape",type:"shape"},{start:1,name:"numElements",type:"number"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListFromTensor",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListStack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"},{tfName:"num_elements",name:"numElements",type:"dtype"}]},{tfOpName:"TensorListSplit",category:"control",inputs:[{start:0,name:"tensor",type:"tensor"},{start:1,name:"elementShape",type:"shape"},{start:2,name:"lengths",type:"number[]"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcat",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListConcatV2",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}],attrs:[{tfName:"element_shape",name:"elementShape",type:"shape"},{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPopBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"elementShape",type:"shape"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListPushBack",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"tensor",type:"tensor"}],attrs:[{tfName:"element_dtype",name:"elementDType",type:"dtype"}]},{tfOpName:"TensorListLength",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"}]},{tfOpName:"TensorListResize",category:"control",inputs:[{start:0,name:"tensorListId",type:"tensor"},{start:1,name:"size",type:"number"}]}],FR=Object.freeze(Object.defineProperty({__proto__:null,json:DR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PR=[{tfOpName:"AvgPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[],notSupported:!0},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPoolWithArgmax",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"include_batch_in_index",name:"includeBatchInIndex",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"AvgPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MaxPool3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"ksize",name:"kernelSize",type:"number[]"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Conv1D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"stride",name:"stride",type:"number"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NWC"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"dilation",name:"dilation",type:"number",defaultValue:1}]},{tfOpName:"Conv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"useCudnnOnGpu",name:"useCudnnOnGpu",type:"bool"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"_FusedConv2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"use_cudnn_on_gpu",name:"useCudnnOnGpu",type:"bool",defaultValue:!0},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2}]},{tfOpName:"Conv2DBackpropInput",category:"convolution",inputs:[{start:2,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:0,name:"outputShape",type:"number[]"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]",notSupported:!0}]},{tfOpName:"DepthwiseConv2d",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"DepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"FusedDepthwiseConv2dNative",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]",defaultValue:[1,1,1,1]},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"explicit_paddings",name:"explicitPaddings",type:"number[]",defaultValue:[]}]},{tfOpName:"Conv3D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"padding",name:"pad",type:"string"},{tfName:"data_format",name:"dataFormat",type:"string",defaultValue:"NHWC"},{tfName:"dilations",name:"dilations",type:"number[]"}]},{tfOpName:"Dilation2D",category:"convolution",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"filter",type:"tensor"}],attrs:[{tfName:"strides",name:"strides",type:"number[]"},{tfName:"rates",name:"dilations",type:"number[]"},{tfName:"padding",name:"pad",type:"string"}]}],LR=Object.freeze(Object.defineProperty({__proto__:null,json:PR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BR=[{tfOpName:"Fill",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"},{start:1,name:"value",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"LinSpace",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"num",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"OneHot",category:"creation",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"depth",type:"number"},{start:2,name:"onValue",type:"number",defaultValue:1},{start:3,name:"offValue",type:"number",defaultValue:0}],attrs:[{tfName:"axis",name:"axis",type:"number",notSupported:!0},{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Ones",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"OnesLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"RandomStandardNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"RandomUniform",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"minval",name:"minval",type:"number",defaultValue:0},{tfName:"maxval",name:"maxval",type:"number",defaultValue:1},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"seed",name:"seed",type:"number",defaultValue:0},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Range",category:"creation",inputs:[{start:0,name:"start",type:"number"},{start:1,name:"stop",type:"number"},{start:2,name:"step",type:"number",defaultValue:0}],attrs:[{tfName:"Tidx",name:"dtype",type:"dtype"}]},{tfOpName:"TruncatedNormal",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"means",name:"mean",type:"number",defaultValue:0},{tfName:"stddev",name:"stdDev",type:"number",defaultValue:1},{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number",defaultValue:0,notSupported:!0},{tfName:"dtype",name:"dtype",type:"dtype"},{tfName:"T",name:"T",type:"number",notSupported:!0}]},{tfOpName:"Zeros",category:"creation",inputs:[{start:0,name:"shape",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"ZerosLike",category:"creation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype"}]},{tfOpName:"Multinomial",category:"creation",inputs:[{start:0,name:"logits",type:"tensor"},{start:1,name:"numSamples",type:"number"}],attrs:[{tfName:"seed",name:"seed",type:"number"},{tfName:"seed2",name:"seed2",type:"number"},{tfName:"T",name:"dtype",type:"dtype"},{tfName:"output_dtype",name:"output_dtype",type:"dtype"}]}],MR=Object.freeze(Object.defineProperty({__proto__:null,json:BR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VR=[{tfOpName:"NonMaxSuppressionV2",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV3",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}]},{tfOpName:"NonMaxSuppressionV4",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0},{tfName:"T_threshold",name:"threshold",type:"dtype",notSupported:!0},{tfName:"pad_to_max_output_size",name:"padToMaxOutputSize",type:"bool"}]},{tfOpName:"NonMaxSuppressionV5",category:"dynamic",inputs:[{start:0,name:"boxes",type:"tensor"},{start:1,name:"scores",type:"tensor"},{start:2,name:"maxOutputSize",type:"number"},{start:3,name:"iouThreshold",type:"number"},{start:4,name:"scoreThreshold",type:"number"},{start:5,name:"softNmsSigma",type:"number"}]},{tfOpName:"Where",category:"dynamic",inputs:[{start:0,name:"condition",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ListDiff",category:"dynamic",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"y",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],UR=Object.freeze(Object.defineProperty({__proto__:null,json:VR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const WR=[{tfOpName:"LowerBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"TopKV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"k",type:"number"}],attrs:[{tfName:"sorted",name:"sorted",type:"bool"}]},{tfOpName:"UpperBound",category:"evaluation",inputs:[{start:0,name:"sortedSequence",type:"tensor"},{start:1,name:"values",type:"tensor"}]},{tfOpName:"Unique",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"UniqueV2",category:"evaluation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]}],zR=Object.freeze(Object.defineProperty({__proto__:null,json:WR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const GR=[{tfOpName:"PlaceholderWithDefault",category:"graph",inputs:[{start:0,name:"default",type:"tensor"}],attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Placeholder",category:"graph",attrs:[{tfName:"shape",name:"shape",type:"shape"},{tfName:"dtype",name:"dtype",type:"dtype"}]},{tfOpName:"Const",category:"graph"},{tfOpName:"Identity",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IdentityN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Snapshot",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Rank",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Size",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"Shape",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"ShapeN",category:"graph",inputs:[{start:0,end:0,name:"x",type:"tensors"}]},{tfOpName:"Print",category:"graph",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"data",type:"tensors"}],attrs:[{tfName:"message",name:"message",type:"string"},{tfName:"first_n",name:"firstN",type:"number",notSupported:!0},{tfName:"summarize",name:"summarize",type:"number",defaultValue:3}]},{tfOpName:"NoOp",category:"graph",inputs:[]},{tfOpName:"StopGradient",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"FakeQuantWithMinMaxVars",category:"graph",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"min",name:"min",type:"number"},{tfName:"max",name:"max",type:"number"}]}],jR=Object.freeze(Object.defineProperty({__proto__:null,json:GR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const HR=[{tfOpName:"HashTable",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"HashTableV2",category:"hash_table",inputs:[],attrs:[{tfName:"shared_name",name:"sharedName",type:"string"},{tfName:"use_node_name_sharing",name:"useNodeNameSharing",type:"bool"},{tfName:"key_dtype",name:"keyDType",type:"dtype"},{tfName:"value_dtype",name:"valueDType",type:"dtype"}]},{tfOpName:"LookupTableImport",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableImportV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"values",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFind",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableFindV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"},{start:1,name:"keys",type:"tensor"},{start:2,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"Tin",name:"tIn",type:"dtype",notSupported:!0},{tfName:"Tout",name:"tOut",type:"dtype",notSupported:!0}]},{tfOpName:"LookupTableSize",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]},{tfOpName:"LookupTableSizeV2",category:"hash_table",inputs:[{start:0,name:"tableHandle",type:"tensor"}]}],qR=Object.freeze(Object.defineProperty({__proto__:null,json:HR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XR=[{tfOpName:"ResizeBilinear",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"ResizeNearestNeighbor",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"size",type:"number[]"}],attrs:[{tfName:"align_corners",name:"alignCorners",type:"bool"},{tfName:"half_pixel_centers",name:"halfPixelCenters",type:"bool"},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"CropAndResize",category:"image",inputs:[{start:0,name:"image",type:"tensor"},{start:1,name:"boxes",type:"tensor"},{start:2,name:"boxInd",type:"tensor"},{start:3,name:"cropSize",type:"number[]"}],attrs:[{tfName:"method",name:"method",type:"string"},{tfName:"extrapolation_value",name:"extrapolationValue",type:"number"}]},{tfOpName:"ImageProjectiveTransformV3",category:"image",inputs:[{start:0,name:"images",type:"tensor"},{start:1,name:"transforms",type:"tensor"},{start:2,name:"outputShape",type:"number[]"},{start:3,name:"fillValue",type:"number"}],attrs:[{tfName:"interpolation",name:"interpolation",type:"string"},{tfName:"fill_mode",name:"fillMode",type:"string"}]}],KR=Object.freeze(Object.defineProperty({__proto__:null,json:XR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const YR=[{tfOpName:"Equal",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"NotEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Greater",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"GreaterEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Less",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LessEqual",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalAnd",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalNot",category:"logical",inputs:[{start:0,name:"a",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"LogicalOr",category:"logical",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Select",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SelectV2",category:"logical",inputs:[{start:0,name:"condition",type:"tensor"},{start:1,name:"a",type:"tensor"},{start:2,name:"b",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]}],QR=Object.freeze(Object.defineProperty({__proto__:null,json:YR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const ZR=[{tfOpName:"_FusedMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"},{start:2,end:0,name:"args",type:"tensors"}],attrs:[{tfName:"num_args",name:"numArgs",type:"number"},{tfName:"fused_ops",name:"fusedOps",type:"string[]",defaultValue:[]},{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:1e-4},{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"leakyrelu_alpha",name:"leakyreluAlpha",type:"number",defaultValue:.2},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"MatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"transpose_a",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"transpose_b",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMul",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"BatchMatMulV2",category:"matrices",inputs:[{start:0,name:"a",type:"tensor"},{start:1,name:"b",type:"tensor"}],attrs:[{tfName:"adj_x",name:"transposeA",type:"bool",defaultValue:!1},{tfName:"adj_y",name:"transposeB",type:"bool",defaultValue:!1},{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Transpose",category:"matrices",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"perm",type:"number[]"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"Einsum",category:"matrices",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"equation",name:"equation",type:"string"},{tfName:"N",name:"n",type:"number",defaultValue:2},{tfName:"T",name:"dtype",type:"dtype"}]}],JR=Object.freeze(Object.defineProperty({__proto__:null,json:ZR},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const eA=[{tfOpName:"EuclideanNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool",defaultValue:!1}]},{tfOpName:"FusedBatchNorm",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV2",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"FusedBatchNormV3",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"scale",type:"tensor"},{start:2,name:"offset",type:"tensor"},{start:3,name:"mean",type:"tensor"},{start:4,name:"variance",type:"tensor"}],attrs:[{tfName:"epsilon",name:"epsilon",type:"number",defaultValue:.001},{tfName:"data_format",name:"dataFormat",type:"string",notSupported:!0}]},{tfOpName:"LRN",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"depth_radius",name:"radius",type:"number",defaultValue:5},{tfName:"bias",name:"bias",type:"number",defaultValue:1},{tfName:"alpha",name:"alpha",type:"number",defaultValue:1},{tfName:"beta",name:"beta",type:"number",defaultValue:.5}]},{tfOpName:"Softmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"LogSoftmax",category:"normalization",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"SparseToDense",category:"normalization",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!0,notSupported:!0}]}],tA=Object.freeze(Object.defineProperty({__proto__:null,json:eA},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const nA=[{tfOpName:"Bincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}]},{tfOpName:"DenseBincount",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"size",type:"number"},{start:2,name:"weights",type:"tensor"}],attrs:[{tfName:"binary_output",name:"binaryOutput",type:"bool"}]},{tfOpName:"Max",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Mean",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Min",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Sum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"All",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Any",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"ArgMax",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"ArgMin",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"Prod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}],attrs:[{tfName:"keep_dims",name:"keepDims",type:"bool"}]},{tfOpName:"Cumprod",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]},{tfOpName:"Cumsum",category:"reduction",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}],attrs:[{tfName:"exclusive",name:"exclusive",type:"bool"},{tfName:"reverse",name:"reverse",type:"bool"}]}],rA=Object.freeze(Object.defineProperty({__proto__:null,json:nA},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const sA=[{tfOpName:"ConcatV2",category:"slice_join",inputs:[{start:0,end:-1,name:"tensors",type:"tensors"},{start:-1,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"Concat",category:"slice_join",inputs:[{start:1,end:0,name:"tensors",type:"tensors"},{start:0,name:"axis",type:"number"}],attrs:[{tfName:"N",name:"n",type:"number",defaultValue:2}]},{tfOpName:"GatherV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"axis",type:"number",defaultValue:0}],attrs:[{tfName:"batch_dims",name:"batchDims",type:"number",defaultValue:0}]},{tfOpName:"Gather",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",notSupported:!0}]},{tfOpName:"Reverse",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"dims",type:"bool[]"}]},{tfOpName:"ReverseV2",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number[]"}]},{tfOpName:"Slice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"size",type:"number[]"}]},{tfOpName:"StridedSlice",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"begin",type:"number[]"},{start:2,name:"end",type:"number[]"},{start:3,name:"strides",type:"number[]"}],attrs:[{tfName:"begin_mask",name:"beginMask",type:"number",defaultValue:0},{tfName:"end_mask",name:"endMask",type:"number",defaultValue:0},{tfName:"new_axis_mask",name:"newAxisMask",type:"number",defaultValue:0},{tfName:"ellipsis_mask",name:"ellipsisMask",type:"number",defaultValue:0},{tfName:"shrink_axis_mask",name:"shrinkAxisMask",type:"number",defaultValue:0}]},{tfOpName:"Pack",category:"slice_join",inputs:[{start:0,end:0,name:"tensors",type:"tensors"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0}]},{tfOpName:"Unpack",category:"slice_join",inputs:[{start:0,name:"tensor",type:"tensor"}],attrs:[{tfName:"axis",name:"axis",type:"number",defaultValue:0},{tfName:"num",name:"num",type:"number",defaultValue:0,notSupported:!0}]},{tfOpName:"Tile",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"reps",type:"number[]"}]},{tfOpName:"Split",category:"slice_join",inputs:[{start:0,name:"axis",type:"number",defaultValue:0},{start:1,name:"x",type:"tensor"}],attrs:[{tfName:"num_split",name:"numOrSizeSplits",type:"number",defaultValue:1}]},{tfOpName:"SplitV",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"numOrSizeSplits",type:"number[]"},{start:2,name:"axis",type:"number",defaultValue:0}]},{tfOpName:"ScatterNd",category:"slice_join",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"shape",type:"number[]"}]},{tfOpName:"GatherNd",category:"slice_join",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"indices",type:"tensor"}]},{tfOpName:"SparseToDense",category:"slice_join",inputs:[{start:0,name:"sparseIndices",type:"tensor"},{start:1,name:"outputShape",type:"number[]"},{start:2,name:"sparseValues",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}],attrs:[{tfName:"validate_indices",name:"validateIndices",type:"bool",defaultValue:!1,notSupported:!0}]}],oA=Object.freeze(Object.defineProperty({__proto__:null,json:sA},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const iA=[{tfOpName:"SparseFillEmptyRows",category:"sparse",inputs:[{start:0,name:"indices",type:"tensor"},{start:1,name:"values",type:"tensor"},{start:2,name:"denseShape",type:"tensor"},{start:3,name:"defaultValue",type:"tensor"}]},{tfOpName:"SparseReshape",category:"sparse",inputs:[{start:0,name:"inputIndices",type:"tensor"},{start:1,name:"inputShape",type:"tensor"},{start:2,name:"newShape",type:"tensor"}],attrs:[{tfName:"T",name:"dtype",type:"dtype",notSupported:!0}]},{tfOpName:"SparseSegmentMean",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]},{tfOpName:"SparseSegmentSum",category:"sparse",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"indices",type:"tensor"},{start:2,name:"segmentIds",type:"tensor"}]}],aA=Object.freeze(Object.defineProperty({__proto__:null,json:iA},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const uA=[{tfOpName:"FFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"IFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"}]},{tfOpName:"RFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]},{tfOpName:"IRFFT",category:"spectral",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"fft_length",type:"number",notSupported:!0}]}],cA=Object.freeze(Object.defineProperty({__proto__:null,json:uA},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const lA=[{tfOpName:"StringNGrams",category:"string",inputs:[{start:0,name:"data",type:"tensor"},{start:1,name:"dataSplits",type:"tensor"}],attrs:[{tfName:"separator",name:"separator",type:"string"},{tfName:"ngram_widths",name:"nGramWidths",type:"number[]"},{tfName:"left_pad",name:"leftPad",type:"string"},{tfName:"right_pad",name:"rightPad",type:"string"},{tfName:"pad_width",name:"padWidth",type:"number"},{tfName:"preserve_short_sequences",name:"preserveShortSequences",type:"bool"}],outputs:["ngrams","ngrams_splits"]},{tfOpName:"StringSplit",category:"string",inputs:[{start:0,name:"input",type:"tensor"},{start:1,name:"delimiter",type:"tensor"}],attrs:[{tfName:"skip_empty",name:"skipEmpty",type:"bool"}],outputs:["indices","values","shape"]},{tfOpName:"StringToHashBucketFast",category:"string",inputs:[{start:0,name:"input",type:"tensor"}],attrs:[{tfName:"num_buckets",name:"numBuckets",type:"number"}]}],hA=Object.freeze(Object.defineProperty({__proto__:null,json:lA},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2022 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fA=[{tfOpName:"Cast",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"SrcT",name:"sdtype",type:"dtype",notSupported:!0},{tfName:"DstT",name:"dtype",type:"dtype"}]},{tfOpName:"ExpandDims",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"axis",type:"number"}]},{tfOpName:"MirrorPad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"mode",name:"mode",type:"string"}]},{tfOpName:"Pad",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"}],attrs:[{tfName:"constant_value",name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"PadV2",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"padding",type:"number[]"},{start:2,name:"constantValue",type:"number",defaultValue:0}]},{tfOpName:"Reshape",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}]},{tfOpName:"Squeeze",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"axis",tfDeprecatedName:"squeeze_dims",name:"axis",type:"number[]"}]},{tfOpName:"SpaceToBatchND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"paddings",type:"number[]"}]},{tfOpName:"BatchToSpaceND",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"blockShape",type:"number[]"},{start:2,name:"crops",type:"number[]"}]},{tfOpName:"DepthToSpace",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"}],attrs:[{tfName:"block_size",name:"blockSize",type:"number"},{tfName:"data_format",name:"dataFormat",type:"string"}]},{tfOpName:"BroadcastTo",category:"transformation",inputs:[{start:0,name:"x",type:"tensor"},{start:1,name:"shape",type:"number[]"}],attrs:[]},{tfOpName:"BroadcastArgs",category:"transformation",inputs:[{start:0,name:"s0",type:"tensor"},{start:1,name:"s1",type:"tensor"}],attrs:[]}],dA=Object.freeze(Object.defineProperty({__proto__:null,json:fA},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class jh{static get Instance(){return this._instance||(this._instance=new this)}constructor(){const e=[RR,OR,FR,LR,MR,UR,zR,jR,qR,KR,QR,JR,tA,rA,oA,aA,cA,hA,dA],t=[].concat(...e.map(r=>r.json));this.opMappers=t.reduce((r,s)=>(r[s.tfOpName]=s,r),{})}transformGraph(e,t={}){const r=e.node,s=[],o=[],i=[],a=r.reduce((C,$)=>(C[$.name]=this.mapNode($),$.op.startsWith("Placeholder")?s.push(C[$.name]):$.op==="Const"?o.push(C[$.name]):($.input==null||$.input.length===0)&&i.push(C[$.name]),C),{});let u=[];const c=[];let l={},h={};t!=null&&(l=this.mapSignatureEntries(t.inputs),h=this.mapSignatureEntries(t.outputs));const d=Object.keys(a);d.forEach(C=>{const $=a[C];$.inputNames.forEach((T,A)=>{const[P,,B]=Jr(T),H=a[P];if(H.outputs!=null){const x=H.outputs.indexOf(B);if(x!==-1){const re=`${P}:${x}`;$.inputNames[A]=re}}$.inputs.push(H),H.children.push($)})}),Object.keys(h).length===0?d.forEach(C=>{const $=a[C];$.children.length===0&&c.push($)}):Object.keys(h).forEach(C=>{const[$]=Jr(C),T=a[$];T!=null&&(T.signatureKey=h[C],c.push(T))}),Object.keys(l).length>0?Object.keys(l).forEach(C=>{const[$]=Jr(C),T=a[$];T&&(T.signatureKey=l[C],u.push(T))}):u=s;let m={};e.library!=null&&e.library.function!=null&&(m=e.library.function.reduce((C,$)=>(C[$.signature.name]=this.mapFunction($),C),{}));const g={nodes:a,inputs:u,outputs:c,weights:o,placeholders:s,signature:t,functions:m};return i.length>0&&(g.initNodes=i),g}mapSignatureEntries(e){return Object.keys(e||{}).reduce((t,r)=>(t[e[r].name]=r,t),{})}mapNode(e){const t=kg(e.op)||this.opMappers[e.op]||{};e.attr==null&&(e.attr={});const r={name:e.name,op:e.op,category:t.category,inputNames:(e.input||[]).map(s=>s.startsWith("^")?s.slice(1):s),inputs:[],children:[],inputParams:{},attrParams:{},rawAttrs:e.attr,outputs:t.outputs};return t.inputs!=null&&(r.inputParams=t.inputs.reduce((s,o)=>(s[o.name]={type:o.type,inputIndexStart:o.start,inputIndexEnd:o.end},s),{})),t.attrs!=null&&(r.attrParams=t.attrs.reduce((s,o)=>{const i=o.type;let a;switch(o.type){case"string":a=Oc(e.attr,o.tfName,o.defaultValue),a===void 0&&!!o.tfDeprecatedName&&(a=Oc(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"string[]":a=Vc(e.attr,o.tfName,o.defaultValue),a===void 0&&!!o.tfDeprecatedName&&(a=Vc(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number":a=Fc(e.attr,o.tfName,o.defaultValue||0),a===void 0&&!!o.tfDeprecatedName&&(a=Fc(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"number[]":a=Mc(e.attr,o.tfName,o.defaultValue),a===void 0&&!!o.tfDeprecatedName&&(a=Mc(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool":a=Dc(e.attr,o.tfName,o.defaultValue),a===void 0&&!!o.tfDeprecatedName&&(a=Dc(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"bool[]":a=Wc(e.attr,o.tfName,o.defaultValue),a===void 0&&!!o.tfDeprecatedName&&(a=Wc(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape":a=Bc(e.attr,o.tfName,o.defaultValue),a===void 0&&!!o.tfDeprecatedName&&(a=Bc(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"shape[]":a=Uc(e.attr,o.tfName,o.defaultValue),a===void 0&&!!o.tfDeprecatedName&&(a=Uc(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype":a=Pc(e.attr,o.tfName,o.defaultValue),a===void 0&&!!o.tfDeprecatedName&&(a=Pc(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"dtype[]":a=Lc(e.attr,o.tfName,o.defaultValue),a===void 0&&!!o.tfDeprecatedName&&(a=Lc(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"func":a=Hh(e.attr,o.tfName,o.defaultValue),a===void 0&&!!o.tfDeprecatedName&&(a=Hh(e.attr,o.tfDeprecatedName,o.defaultValue));break;case"tensor":case"tensors":break;default:throw new Error(`Unsupported param type: ${o.type} for op: ${e.op}`)}return s[o.name]={value:a,type:i},s},{})),r}mapFunction(e){const t=e.nodeDef,r=[],s=[];let o={};t!=null&&(o=t.reduce((h,d)=>(h[d.name]=this.mapNode(d),d.op==="Const"&&s.push(h[d.name]),h),{}));const i=[],a=[];e.signature.inputArg.forEach(h=>{const[d]=Jr(h.name),m={name:d,op:"Placeholder",inputs:[],inputNames:[],category:"graph",inputParams:{},attrParams:{dtype:{value:Dl(h.type),type:"dtype"}},children:[]};m.signatureKey=h.name,i.push(m),o[d]=m}),Object.keys(o).forEach(h=>{const d=o[h];d.inputNames.forEach((m,g)=>{const[C,,$]=Jr(m),T=o[C];if(T.outputs!=null){const A=T.outputs.indexOf($);if(A!==-1){const P=`${C}:${A}`;d.inputNames[g]=P}}d.inputs.push(T),T.children.push(d)})});const c=e.ret;e.signature.outputArg.forEach(h=>{const[d,m]=Jr(c[h.name]),g=o[d];g!=null&&(g.defaultOutput=m,a.push(g))});const l=this.mapArgsToSignature(e);return{nodes:o,inputs:i,outputs:a,weights:s,placeholders:r,signature:l}}mapArgsToSignature(e){return{methodName:e.signature.name,inputs:e.signature.inputArg.reduce((t,r)=>(t[r.name]=this.mapArgToTensorInfo(r),t),{}),outputs:e.signature.outputArg.reduce((t,r)=>(t[r.name]=this.mapArgToTensorInfo(r,e.ret),t),{})}}mapArgToTensorInfo(e,t){let r=e.name;return t!=null&&(r=t[r]),{name:r,dtype:e.type}}}function pA(n){const e=ue().global;if(typeof e.atob<"u")return e.atob(n);if(typeof Buffer<"u")return new Buffer(n,"base64").toString();throw new Error("Unable to decode base64 in this environment. Missing built-in atob() or Buffer()")}function Ig(n,e){const t=Array.isArray(n)?String.fromCharCode.apply(null,n):pA(n);return e?t:t.toLowerCase()}function Oc(n,e,t,r=!1){const s=n[e];return s!=null?Ig(s.s,r):t}function Dc(n,e,t){const r=n[e];return r?r.b:t}function Fc(n,e,t){const r=n[e]||{},s=r.i!=null?r.i:r.f!=null?r.f:t;return typeof s=="number"?s:parseInt(s,10)}function Dl(n){switch(typeof n=="string"&&(n=cr[n]),n){case cr.DT_FLOAT:case cr.DT_HALF:return"float32";case cr.DT_INT32:case cr.DT_INT64:case cr.DT_INT8:case cr.DT_UINT8:return"int32";case cr.DT_BOOL:return"bool";case cr.DT_DOUBLE:return"float32";case cr.DT_STRING:return"string";default:return null}}function Hh(n,e,t){const r=n[e];return r&&r.func?r.func.name:t}function Pc(n,e,t){const r=n[e];return r&&r.type?Dl(r.type):t}function Lc(n,e,t){const r=n[e];return r&&r.list&&r.list.type?r.list.type.map(s=>Dl(s)):t}function _g(n){if(!n.unknownRank)return n.dim!=null?n.dim.map(e=>typeof e.size=="number"?e.size:parseInt(e.size,10)):[]}function Bc(n,e,t){const r=n[e];return r&&r.shape?_g(r.shape):t}function Mc(n,e,t){const r=n[e];return r?((r.list.f&&r.list.f.length?r.list.f:r.list.i)||[]).map(s=>typeof s=="number"?s:parseInt(s,10)):t}function Vc(n,e,t,r=!1){const s=n[e];return s&&s.list&&s.list.s?s.list.s.map(o=>Ig(o,r)):t}function Uc(n,e,t){const r=n[e];return r&&r.list&&r.list.shape?r.list.shape.map(s=>_g(s)):t}function Wc(n,e,t){const r=n[e];return r&&r.list&&r.list.b?r.list.b:t}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class mA{constructor(e,t,r){this.node=e,this.tensorMap=t,this.context=r,this.inputs=[],this.attrs={},this.inputs=e.inputNames.map(s=>this.getInput(s)),e.rawAttrs!=null&&(this.attrs=Object.keys(e.rawAttrs).reduce((s,o)=>(s[o]=this.getAttr(o),s),{}))}getInput(e){return Cn(e,this.tensorMap,this.context)}getAttr(e,t){const r=this.node.rawAttrs[e];if(r.tensor!=null)return Cn(e,this.tensorMap,this.context);if(r.i!=null||r.f!=null)return Fc(this.node.rawAttrs,e,t);if(r.s!=null)return Oc(this.node.rawAttrs,e,t);if(r.b!=null)return Dc(this.node.rawAttrs,e,t);if(r.shape!=null)return Bc(this.node.rawAttrs,e,t);if(r.type!=null)return Pc(this.node.rawAttrs,e,t);if(r.list!=null){if(r.list.i!=null||r.list.f!=null)return Mc(this.node.rawAttrs,e,t);if(r.list.s!=null)return Vc(this.node.rawAttrs,e,t);if(r.list.shape!=null)return Uc(this.node.rawAttrs,e,t);if(r.list.b!=null)return Wc(this.node.rawAttrs,e,t);if(r.list.type!=null)return Lc(this.node.rawAttrs,e,t)}return t}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const fn=Object.freeze(Object.defineProperty({__proto__:null,abs:lr,acos:T4,acosh:S4,add:Ct,addN:E4,all:I4,any:R4,argMax:O4,argMin:F4,asin:L4,asinh:M4,atan:U4,atan2:z4,atanh:j4,avgPool:o2,avgPool3d:J4,basicLSTMCell:oy,batchToSpaceND:i2,batchNorm:su,batchNorm2d:ly,batchNorm3d:fy,batchNorm4d:py,bincount:a2,broadcastArgs:yy,broadcastTo:Gi,buffer:Ot,cast:At,ceil:vy,clipByValue:u2,clone:Us,complex:Gs,concat:sn,concat1d:Ty,concat2d:Sy,concat3d:Ey,concat4d:Iy,conv1d:Ay,conv2d:iu,conv2dTranspose:Fy,conv3d:Ly,conv3dTranspose:Uy,cos:zy,cosh:jy,cumprod:qy,cumsum:Ky,denseBincount:Qy,depthToSpace:Jy,depthwiseConv2d:cl,diag:nx,dilation2d:sx,div:xt,divNoNan:cx,dot:hx,einsum:dx,elu:h2,equal:l2,erf:gx,euclideanNorm:Sx,exp:ws,expandDims:Or,expm1:Ix,eye:p2,fill:ou,floor:m2,floorDiv:r2,gather:g2,greater:cu,greaterEqual:y2,imag:ru,isFinite:Lx,isInf:Mx,isNaN:Ux,leakyRelu:x2,less:Gx,lessEqual:pl,linspace:Hx,localResponseNormalization:Xx,log:Ki,log1p:b2,logSigmoid:Jx,logSoftmax:nb,logSumExp:w2,logicalAnd:Wa,logicalNot:C2,logicalOr:T2,logicalXor:ub,lowerBound:lb,matMul:mt,max:ai,maxPool:$2,maxPool3d:db,maxPoolWithArgmax:mb,maximum:yb,mean:za,meshgrid:bb,min:Sc,minimum:S2,mirrorPad:Cb,mod:$b,moments:Nb,mul:We,multiRNNCell:kb,multinomial:_b,neg:bs,notEqual:N2,oneHot:o4,ones:wo,onesLike:Ob,outerProduct:Fb,pad:ia,pad1d:Bb,pad2d:Vb,pad3d:Wb,pad4d:Gb,pool:Kb,pow:dl,prelu:k2,print:R1,prod:Zb,raggedGather:ev,raggedTensorToTensor:nv,rand:sv,randomGamma:yv,randomNormal:P2,randomStandardNormal:vv,randomUniform:L2,range:Yi,real:qi,reciprocal:Tv,relu:lu,relu6:B2,reshape:me,reverse:_o,reverse1d:kv,reverse2d:_v,reverse3d:Av,reverse4d:Dv,round:M2,rsqrt:Lv,scalar:ct,selu:Mv,separableConv2d:Uv,setdiff1dAsync:zv,sigmoid:So,sign:jv,sin:qv,sinh:Kv,slice:Ze,slice1d:Qv,slice2d:Jv,slice3d:tw,slice4d:rw,softmax:ow,softplus:v2,spaceToBatchND:E2,fft:xl,ifft:Ga,irfft:V2,rfft:bl,split:Qi,sqrt:Nc,square:au,squaredDifference:U2,squeeze:Yt,stack:Ts,step:W2,stridedSlice:gw,sub:nt,sum:$t,tan:xw,tanh:$c,tensor:ts,tensor1d:Tn,tensor2d:Ws,tensor3d:M1,tensor4d:bw,tensor5d:vw,tensor6d:ww,tile:ji,topk:Tw,truncatedNormal:Sw,unique:Ew,unsortedSegmentSum:Iw,unstack:Po,upperBound:Rw,variable:Aw,where:pi,whereAsync:G2,zeros:Io,zerosLike:ll,op:X,OP_SCOPE_SUFFIX:b1,booleanMaskAsync:Fw,transpose:wc,norm:uu,movingAverage:Lw,scatterND:Mw,searchSorted:ml,sparseToDense:Ww,gatherND:Gw,dropout:qw,enclosingPowerOfTwo:j2,cosineWindow:vl,inTopKAsync:Kw,image:Ti,linalg:L5,losses:B5,spectral:F5,fused:u6,signal:P5,sparse:M5,string:V5},Symbol.toStringTag,{value:"Module"}));/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const gA=(n,e,t,r=fn)=>{switch(n.op){case"BiasAdd":case"AddV2":case"Add":return[r.add(N("a",n,e,t),N("b",n,e,t))];case"AddN":return[r.addN(N("tensors",n,e,t))];case"FloorMod":case"Mod":return[r.mod(N("a",n,e,t),N("b",n,e,t))];case"Mul":return[r.mul(N("a",n,e,t),N("b",n,e,t))];case"RealDiv":case"Div":return[r.div(N("a",n,e,t),N("b",n,e,t))];case"DivNoNan":return[r.divNoNan(N("a",n,e,t),N("b",n,e,t))];case"FloorDiv":return[r.floorDiv(N("a",n,e,t),N("b",n,e,t))];case"Sub":return[r.sub(N("a",n,e,t),N("b",n,e,t))];case"Minimum":return[r.minimum(N("a",n,e,t),N("b",n,e,t))];case"Maximum":return[r.maximum(N("a",n,e,t),N("b",n,e,t))];case"Pow":return[r.pow(N("a",n,e,t),N("b",n,e,t))];case"SquaredDifference":return[r.squaredDifference(N("a",n,e,t),N("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const yA=(n,e,t,r=fn)=>{switch(n.op){case"Abs":case"ComplexAbs":return[r.abs(N("x",n,e,t))];case"Acos":return[r.acos(N("x",n,e,t))];case"Acosh":return[r.acosh(N("x",n,e,t))];case"Asin":return[r.asin(N("x",n,e,t))];case"Asinh":return[r.asinh(N("x",n,e,t))];case"Atan":return[r.atan(N("x",n,e,t))];case"Atan2":return[r.atan2(N("x",n,e,t),N("y",n,e,t))];case"Atanh":return[r.atanh(N("x",n,e,t))];case"Ceil":return[r.ceil(N("x",n,e,t))];case"Complex":return[r.complex(N("real",n,e,t),N("imag",n,e,t))];case"Cos":return[r.cos(N("x",n,e,t))];case"Cosh":return[r.cosh(N("x",n,e,t))];case"Elu":return[r.elu(N("x",n,e,t))];case"Erf":return[r.erf(N("x",n,e,t))];case"Exp":return[r.exp(N("x",n,e,t))];case"Expm1":return[r.expm1(N("x",n,e,t))];case"Floor":return[r.floor(N("x",n,e,t))];case"Log":return[r.log(N("x",n,e,t))];case"Log1p":return[r.log1p(N("x",n,e,t))];case"Imag":return[r.imag(N("x",n,e,t))];case"Neg":return[r.neg(N("x",n,e,t))];case"Reciprocal":return[r.reciprocal(N("x",n,e,t))];case"Real":return[r.real(N("x",n,e,t))];case"Relu":return[r.relu(N("x",n,e,t))];case"Round":return[r.round(N("x",n,e,t))];case"Selu":return[r.selu(N("x",n,e,t))];case"Sigmoid":return[r.sigmoid(N("x",n,e,t))];case"Sin":return[r.sin(N("x",n,e,t))];case"Sign":return[r.sign(N("x",n,e,t))];case"Sinh":return[r.sinh(N("x",n,e,t))];case"Softplus":return[r.softplus(N("x",n,e,t))];case"Sqrt":return[r.sqrt(N("x",n,e,t))];case"Square":return[r.square(N("x",n,e,t))];case"Tanh":return[r.tanh(N("x",n,e,t))];case"Tan":return[r.tan(N("x",n,e,t))];case"ClipByValue":return[r.clipByValue(N("x",n,e,t),N("clipValueMin",n,e,t),N("clipValueMax",n,e,t))];case"Relu6":return[r.relu6(N("x",n,e,t))];case"Rsqrt":return[r.rsqrt(Cn(n.inputNames[0],e,t))];case"Prod":return[r.prod(N("x",n,e,t),N("axes",n,e,t))];case"LeakyRelu":return[r.leakyRelu(N("x",n,e,t),N("alpha",n,e,t))];case"Prelu":return[r.prelu(N("x",n,e,t),N("alpha",n,e,t))];case"IsNan":return[r.isNaN(Cn(n.inputNames[0],e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function hr(n,e,t=""){if(!(typeof n=="number"||typeof e=="number")){M(n.length===e.length,()=>t+` Shapes ${n} and ${e} must match`);for(let r=0;r<n.length;r++){const s=n[r],o=e[r];M(s<0||o<0||s===o,()=>t+` Shapes ${n} and ${e} must match`)}}}function qh(n){return!(typeof n=="number"||n.some(e=>e<0))}function Mi(n,e,t){let r=zc(n,t);const s=!qh(r);if(s&&e.length===0)throw new Error(`Tried to calculate elements of an empty list with non-fully-defined elementShape: ${r}`);if(s&&e.forEach(o=>{r=zc(o.shape,r)}),!qh(r))throw new Error(`Non-fully-defined elementShape: ${r}`);return r}function zc(n,e){if(typeof n=="number")return e;if(typeof e=="number")return n;if(n.length!==e.length)throw new Error(`Incompatible ranks during merge: ${n} vs. ${e}`);const t=[];for(let r=0;r<n.length;++r){const s=n[r],o=e[r];if(s>=0&&o>=0&&s!==o)throw new Error(`Incompatible shape during merge: ${n} vs. ${e}`);t[r]=s>=0?s:o}return t}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class xA{constructor(e,t,r,s,o,i,a){this.name=e,this.dtype=t,this.maxSize=r,this.elementShape=s,this.identicalElementShapes=o,this.dynamicSize=i,this.clearAfterRead=a,this.tensors=[],this.closed_=!1,this.idTensor=ct(0),Ms(this.idTensor)}get id(){return this.idTensor.id}get closed(){return this.closed_}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.tensor.id))&&t.tensor.dispose()}),this.tensors=[],this.closed_=!0,this.idTensor.dispose()}size(){return this.tensors.length}read(e){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||e>=this.size())throw new Error(`Tried to read from index ${e}, but array size is: ${this.size()}`);const t=this.tensors[e];if(t.cleared)throw new Error(`TensorArray ${this.name}: Could not read index ${e} twice because it was cleared after a previous read (perhaps try setting clear_after_read = false?).`);return this.clearAfterRead&&(t.cleared=!0),t.read=!0,t.tensor}readMany(e){return e.map(t=>this.read(t))}write(e,t){if(this.closed_)throw new Error(`TensorArray ${this.name} has already been closed.`);if(e<0||!this.dynamicSize&&e>=this.maxSize)throw new Error(`Tried to write to index ${e}, but array is not resizeable and size is: ${this.maxSize}`);const r=this.tensors[e]||{};if(t.dtype!==this.dtype)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e},
          because the value dtype is ${t.dtype}, but TensorArray dtype is ${this.dtype}.`);if(this.size()===0&&(this.elementShape==null||this.elementShape.length===0)&&(this.elementShape=t.shape),hr(this.elementShape,t.shape,`TensorArray ${this.name}: Could not write to TensorArray index ${e}.`),r.read)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been read.`);if(r.written)throw new Error(`TensorArray ${this.name}: Could not write to TensorArray index ${e}, because it has already been written.`);r.tensor=t,Ms(t),r.written=!0,this.tensors[e]=r}writeMany(e,t){if(e.length!==t.length)throw new Error(`TensorArray ${this.name}: could not write multiple tensors,because the index size: ${e.length} is not the same as tensors size: ${t.length}.`);e.forEach((r,s)=>this.write(r,t[s]))}gather(e,t){if(!!t&&t!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but gather requested dtype ${t}`);if(e)e=e.slice(0,this.size());else{e=[];for(let s=0;s<this.size();s++)e.push(s)}if(e.length===0)return ts([],[0].concat(this.elementShape));const r=this.readMany(e);return hr(this.elementShape,r[0].shape,"TensorArray shape mismatch: "),Ts(r,0)}concat(e){if(!!e&&e!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but concat requested dtype ${e}`);if(this.size()===0)return ts([],[0].concat(this.elementShape));const t=[];for(let s=0;s<this.size();s++)t.push(s);const r=this.readMany(t);return hr(this.elementShape,r[0].shape,`TensorArray shape mismatch: tensor array shape (${this.elementShape}) vs first tensor shape (${r[0].shape})`),sn(r,0)}scatter(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);if(e.length!==t.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${t.shape[0]}`);const r=Math.max(...e);if(!this.dynamicSize&&r>=this.maxSize)throw new Error(`Max index must be < array size (${r}  vs. ${this.maxSize})`);this.writeMany(e,Po(t,0))}split(e,t){if(t.dtype!==this.dtype)throw new Error(`TensorArray dtype is ${this.dtype} but tensor has dtype ${t.dtype}`);let r=0;const s=e.map(u=>(r+=u,r));if(r!==t.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${t.shape}`);if(!this.dynamicSize&&e.length!==this.maxSize)throw new Error(`TensorArray's size is not equal to the size of lengths (${this.maxSize} vs. ${e.length}), and the TensorArray is not marked as dynamically resizeable`);const o=r===0?0:t.size/r,i=[];Lt(()=>{t=me(t,[1,r,o]);for(let u=0;u<e.length;++u){const l=[0,u===0?0:s[u-1],0],h=[1,e[u],o];i[u]=me(Ze(t,l,h),this.elementShape)}return i});const a=[];for(let u=0;u<e.length;u++)a[u]=u;this.writeMany(a,i)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Ao{constructor(e,t,r,s=-1){this.tensors=e,this.elementShape=t,this.elementDtype=r,e!=null&&e.forEach(o=>{if(r!==o.dtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${o.dtype}`);hr(t,o.shape,"TensorList shape mismatch: "),Ms(o)}),this.idTensor=ct(0),this.maxNumElements=s,Ms(this.idTensor)}get id(){return this.idTensor.id}copy(){return new Ao([...this.tensors],this.elementShape,this.elementDtype)}clearAndClose(e){this.tensors.forEach(t=>{(e==null||!e.has(t.id))&&t.dispose()}),this.tensors.length=0,this.idTensor.dispose()}size(){return this.tensors.length}stack(e,t,r=-1){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(r!==-1&&this.tensors.length!==r)throw new Error(`Operation expected a list with ${r} elements but got a list with ${this.tensors.length} elements.`);hr(e,this.elementShape,"TensorList shape mismatch: ");const s=Mi(this.elementShape,this.tensors,e);return Lt(()=>{const o=this.tensors.map(i=>me(i,s));return Ts(o,0)})}popBack(e,t){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);if(this.size()===0)throw new Error("Trying to pop from an empty list.");const r=Mi(this.elementShape,this.tensors,e),s=this.tensors.pop();return s.kept=!1,hr(s.shape,e,"TensorList shape mismatch: "),me(s,r)}pushBack(e){if(e.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${e.dtype}, but list elements ${this.elementDtype}`);if(hr(e.shape,this.elementShape,"TensorList shape mismatch: "),this.maxNumElements===this.size())throw new Error("Trying to push element into a full list.");Ms(e),this.tensors.push(e)}resize(e){if(e<0)throw new Error(`TensorListResize expects size to be non-negative. Got: ${e}`);if(this.maxNumElements!==-1&&e>this.maxNumElements)throw new Error(`TensorListResize input size ${e} is greater maxNumElement ${this.maxNumElements}.`);const t=new Ao([],this.elementShape,this.elementDtype,this.maxNumElements);t.tensors.length=e;for(let r=0;r<Math.min(this.tensors.length,e);++r)t.tensors[r]=this.tensors[r];return t}getItem(e,t,r){if(r!==this.elementDtype)throw new Error(`Invalid data types; op elements ${r}, but list elements ${this.elementDtype}`);if(e<0||e>this.tensors.length)throw new Error(`Trying to access element ${e} in a list with ${this.tensors.length} elements.`);if(this.tensors[e]==null)throw new Error(`element at index ${e} is null.`);hr(this.tensors[e].shape,t,"TensorList shape mismatch: ");const s=Mi(this.elementShape,this.tensors,t);return me(this.tensors[e],s)}setItem(e,t){if(t.dtype!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t.dtype}, but list elements ${this.elementDtype}`);if(e<0||this.maxNumElements!==-1&&e>=this.maxNumElements)throw new Error(`Trying to set element ${e} in a list with max ${this.maxNumElements} elements.`);hr(this.elementShape,t.shape,"TensorList shape mismatch: "),Ms(t),this.tensors[e]!=null&&(this.tensors[e].kept=!1),this.tensors[e]=t}gather(e,t,r){if(t!==this.elementDtype)throw new Error(`Invalid data types; op elements ${t}, but list elements ${this.elementDtype}`);hr(this.elementShape,r,"TensorList shape mismatch: "),e=e.slice(0,this.size());const s=Mi(this.elementShape,this.tensors,r);return e.length===0?ts([],[0].concat(s)):Lt(()=>{const o=e.map(i=>me(this.tensors[i],s));return Ts(o,0)})}concat(e,t){if(!!e&&e!==this.elementDtype)throw new Error(`TensorList dtype is ${this.elementDtype} but concat requested dtype ${e}`);hr(this.elementShape,t,"TensorList shape mismatch: ");const r=Mi(this.elementShape,this.tensors,t);return this.size()===0?ts([],[0].concat(r)):Lt(()=>{const s=this.tensors.map(o=>me(o,r));return sn(s,0)})}}function bA(n,e,t){const r=n.dtype;if(n.shape.length<1)throw new Error(`Tensor must be at least a vector, but saw shape: ${n.shape}`);if(n.dtype!==t)throw new Error(`Invalid data types; op elements ${n.dtype}, but list elements ${t}`);const s=n.shape.slice(1);hr(s,e,"TensorList shape mismatch: ");const o=Po(n);return new Ao(o,e,r)}function vA(n,e,t,r){return new Ao([],n,e,r)}function wA(n,e,t,r){if(e.length!==n.shape[0])throw new Error(`Expected len(indices) == tensor.shape[0], but saw: ${e.length} vs. ${n.shape[0]}`);const s=Math.max(...e);if(r!=null&&r!==-1&&s>=r)throw new Error(`Max index must be < array size (${s}  vs. ${r})`);const o=new Ao([],t,n.dtype,r),i=Po(n,0);return e.forEach((a,u)=>{o.setItem(a,i[u])}),o}function CA(n,e,t){let r=0;const s=e.map(l=>(r+=l,r));if(r!==n.shape[0])throw new Error(`Expected sum of lengths to be equal to
          tensor.shape[0], but sum of lengths is
        ${r}, and tensor's shape is: ${n.shape}`);const o=n.shape.slice(1),i=zc(o,t),a=r===0?0:n.size/r,u=Lt(()=>{const l=[];n=me(n,[1,r,a]);for(let h=0;h<e.length;++h){const m=[0,h===0?0:s[h-1],0],g=[1,e[h],a];l[h]=me(Ze(n,m,g),i)}return n.dispose(),l}),c=new Ao([],t,n.dtype,e.length);for(let l=0;l<u.length;l++)c.setItem(l,u[l]);return c}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const TA=async(n,e,t)=>{switch(n.op){case"If":case"StatelessIf":{const r=N("thenBranch",n,e,t),s=N("elseBranch",n,e,t),o=N("cond",n,e,t),i=N("args",n,e,t);return(await o.data())[0]?t.functionMap[r].executeFunctionAsync(i,t.tensorArrayMap,t.tensorListMap):t.functionMap[s].executeFunctionAsync(i,t.tensorArrayMap,t.tensorListMap)}case"While":case"StatelessWhile":{const r=N("body",n,e,t),s=N("cond",n,e,t),o=N("args",n,e,t),i=await t.functionMap[s].executeFunctionAsync(o,t.tensorArrayMap,t.tensorListMap),a=o.map(l=>l.id);let u=await i[0].data();i.forEach(l=>{!l.kept&&a.indexOf(l.id)===-1&&l.dispose()});let c=o;for(;u[0];){const l=c;c=await t.functionMap[r].executeFunctionAsync(c,t.tensorArrayMap,t.tensorListMap);const h=c.map(m=>m.id);l.forEach(m=>{!m.kept&&a.indexOf(m.id)===-1&&h.indexOf(m.id)===-1&&m.dispose()});const d=await t.functionMap[s].executeFunctionAsync(c,t.tensorArrayMap,t.tensorListMap);u=await d[0].data(),d.forEach(m=>{!m.kept&&a.indexOf(m.id)===-1&&h.indexOf(m.id)===-1&&m.dispose()})}return c}case"LoopCond":{const r=N("pred",n,e,t);return[ps(r)]}case"Switch":{const r=N("pred",n,e,t);let s=N("data",n,e,t);return s.kept||(s=ps(s)),(await r.data())[0]?[void 0,s]:[s,void 0]}case"Merge":{const r=n.inputNames.find(s=>Cn(s,e,t)!==void 0);if(r){const s=Cn(r,e,t);return[ps(s)]}return}case"Enter":{const r=N("frameName",n,e,t),s=N("tensor",n,e,t);return t.enterFrame(r),[ps(s)]}case"Exit":{const r=N("tensor",n,e,t);return t.exitFrame(),[ps(r)]}case"NextIteration":{const r=N("tensor",n,e,t);return t.nextIteration(),[ps(r)]}case"TensorArrayV3":{const r=N("size",n,e,t),s=N("dtype",n,e,t),o=N("elementShape",n,e,t),i=N("dynamicSize",n,e,t),a=N("clearAfterRead",n,e,t),u=N("identicalElementShapes",n,e,t),c=N("name",n,e,t),l=new xA(c,s,r,o,u,i,a);return t.addTensorArray(l),[l.idTensor,ct(1)]}case"TensorArrayWriteV3":{const r=N("tensorArrayId",n,e,t),s=N("index",n,e,t),o=N("tensor",n,e,t),i=t.getTensorArray(r.id);return i.write(s,o),[i.idTensor]}case"TensorArrayReadV3":{const r=N("tensorArrayId",n,e,t),s=N("index",n,e,t);return[t.getTensorArray(r.id).read(s)]}case"TensorArrayGatherV3":{const r=N("tensorArrayId",n,e,t),s=N("indices",n,e,t),o=N("dtype",n,e,t);return[t.getTensorArray(r.id).gather(s,o)]}case"TensorArrayScatterV3":{const r=N("tensorArrayId",n,e,t),s=N("indices",n,e,t),o=N("tensor",n,e,t),i=t.getTensorArray(r.id);return i.scatter(s,o),[i.idTensor]}case"TensorArrayConcatV3":{const r=N("tensorArrayId",n,e,t),s=t.getTensorArray(r.id),o=N("dtype",n,e,t);return[s.concat(o)]}case"TensorArraySplitV3":{const r=N("tensorArrayId",n,e,t),s=N("tensor",n,e,t),o=N("lengths",n,e,t),i=t.getTensorArray(r.id);return i.split(o,s),[i.idTensor]}case"TensorArraySizeV3":{const r=N("tensorArrayId",n,e,t),s=t.getTensorArray(r.id);return[ct(s.size(),"int32")]}case"TensorArrayCloseV3":{const r=N("tensorArrayId",n,e,t),s=t.getTensorArray(r.id);return s.clearAndClose(),[s.idTensor]}case"TensorListSetItem":{const r=N("tensorListId",n,e,t),s=N("index",n,e,t),o=N("tensor",n,e,t),i=t.getTensorList(r.id);return i.setItem(s,o),[i.idTensor]}case"TensorListGetItem":{const r=N("tensorListId",n,e,t),s=N("index",n,e,t),o=N("elementShape",n,e,t),i=N("elementDType",n,e,t);return[t.getTensorList(r.id).getItem(s,o,i)]}case"TensorListScatterV2":case"TensorListScatter":{const r=N("indices",n,e,t),s=N("tensor",n,e,t),o=N("elementShape",n,e,t),i=N("numElements",n,e,t),a=wA(s,r,o,i);return t.addTensorList(a),[a.idTensor]}case"TensorListReserve":case"EmptyTensorList":{const r=N("elementShape",n,e,t),s=N("elementDType",n,e,t);let o;n.op==="TensorListReserve"?o="numElements":o="maxNumElements";const i=N(o,n,e,t),a=n.op==="TensorListReserve"?-1:i,u=vA(r,s,i,a);return t.addTensorList(u),[u.idTensor]}case"TensorListGather":{const r=N("tensorListId",n,e,t),s=N("indices",n,e,t),o=N("elementShape",n,e,t),i=N("elementDType",n,e,t);return[t.getTensorList(r.id).gather(s,i,o)]}case"TensorListStack":{const r=N("tensorListId",n,e,t),s=N("elementShape",n,e,t),o=N("elementDType",n,e,t),i=N("numElements",n,e,t);return[t.getTensorList(r.id).stack(s,o,i)]}case"TensorListFromTensor":{const r=N("tensor",n,e,t),s=N("elementShape",n,e,t),o=N("elementDType",n,e,t),i=bA(r,s,o);return t.addTensorList(i),[i.idTensor]}case"TensorListConcat":case"TensorListConcatV2":{const r=N("tensorListId",n,e,t),s=t.getTensorList(r.id),o=N("dtype",n,e,t),i=N("elementShape",n,e,t);return[s.concat(o,i)]}case"TensorListPushBack":{const r=N("tensorListId",n,e,t),s=N("tensor",n,e,t),o=t.getTensorList(r.id);return o.pushBack(s),[o.idTensor]}case"TensorListPopBack":{const r=N("tensorListId",n,e,t),s=N("elementShape",n,e,t),o=N("elementDType",n,e,t);return[t.getTensorList(r.id).popBack(s,o)]}case"TensorListSplit":{const r=N("tensor",n,e,t),s=N("elementShape",n,e,t),o=N("lengths",n,e,t),i=CA(r,o,s);return t.addTensorList(i),[i.idTensor]}case"TensorListLength":{const r=N("tensorListId",n,e,t),s=t.getTensorList(r.id);return[ct(s.size(),"int32")]}case"TensorListResize":{const r=N("tensorListId",n,e,t),s=N("size",n,e,t),i=t.getTensorList(r.id).resize(s);return t.addTensorList(i),[i.idTensor]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Xh(n,e,t){const[r,s]=N("fusedOps",n,e,t),o=r==="biasadd",i=!o,a=s==="prelu",u=r==="fusedbatchnorm",c=N("numArgs",n,e,t);if(o){if(a&&c!==2)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&o&&c!==1)throw new Error("FusedConv2d and DepthwiseConv2d with BiasAdd must have one extra argument: bias.")}if(u)throw new Error("FusedConv2d and DepthwiseConv2d with FusedBatchNorm is not supported");const l=N("strides",n,e,t),h=Da(n,e,t),d=N("dataFormat",n,e,t).toUpperCase(),m=N("dilations",n,e,t);let[g,C]=N("args",n,e,t);i&&(C=g,g=void 0);const $=N("leakyreluAlpha",n,e,t);return{stride:l,pad:h,dataFormat:d,dilations:m,biasArg:g,preluArg:C,activationFunc:s,leakyreluAlpha:$}}const $A=(n,e,t,r=fn)=>{switch(n.op){case"Conv1D":{const s=N("stride",n,e,t),o=N("pad",n,e,t),i=N("dataFormat",n,e,t).toUpperCase(),a=N("dilation",n,e,t);return[r.conv1d(N("x",n,e,t),N("filter",n,e,t),s,o,i,a)]}case"Conv2D":{const s=N("strides",n,e,t),o=Da(n,e,t),i=N("dataFormat",n,e,t).toUpperCase(),a=N("dilations",n,e,t);return[r.conv2d(N("x",n,e,t),N("filter",n,e,t),[s[1],s[2]],o,i,[a[1],a[2]])]}case"_FusedConv2D":{const{stride:s,pad:o,dataFormat:i,dilations:a,biasArg:u,preluArg:c,activationFunc:l,leakyreluAlpha:h}=Xh(n,e,t);return[r.fused.conv2d({x:N("x",n,e,t),filter:N("filter",n,e,t),strides:[s[1],s[2]],pad:o,dataFormat:i,dilations:[a[1],a[2]],bias:u,activation:l,preluActivationWeights:c,leakyreluAlpha:h})]}case"FusedDepthwiseConv2dNative":{const{stride:s,pad:o,dataFormat:i,dilations:a,biasArg:u,preluArg:c,activationFunc:l,leakyreluAlpha:h}=Xh(n,e,t);return[r.fused.depthwiseConv2d({x:N("x",n,e,t),filter:N("filter",n,e,t),strides:[s[1],s[2]],pad:o,dataFormat:i,dilations:[a[1],a[2]],bias:u,activation:l,preluActivationWeights:c,leakyreluAlpha:h})]}case"Conv2DBackpropInput":case"Conv2dTranspose":{const s=N("outputShape",n,e,t),o=N("strides",n,e,t),i=Da(n,e,t);return[r.conv2dTranspose(N("x",n,e,t),N("filter",n,e,t),s,[o[1],o[2]],i)]}case"DepthwiseConv2dNative":case"DepthwiseConv2d":{const s=N("strides",n,e,t),o=Da(n,e,t),i=N("dilations",n,e,t),a=N("dataFormat",n,e,t).toUpperCase();return[r.depthwiseConv2d(N("input",n,e,t),N("filter",n,e,t),[s[1],s[2]],o,a,[i[1],i[2]])]}case"Conv3D":{const s=N("strides",n,e,t),o=N("pad",n,e,t),i=N("dataFormat",n,e,t).toUpperCase(),a=N("dilations",n,e,t);return[r.conv3d(N("x",n,e,t),N("filter",n,e,t),[s[1],s[2],s[3]],o,i,[a[1],a[2],a[3]])]}case"AvgPool":{const s=N("strides",n,e,t),o=N("pad",n,e,t),i=N("kernelSize",n,e,t);return[r.avgPool(N("x",n,e,t),[i[1],i[2]],[s[1],s[2]],o)]}case"MaxPool":{const s=N("strides",n,e,t),o=N("pad",n,e,t),i=N("kernelSize",n,e,t);return[r.maxPool(N("x",n,e,t),[i[1],i[2]],[s[1],s[2]],o)]}case"MaxPoolWithArgmax":{const s=N("strides",n,e,t),o=N("pad",n,e,t),i=N("kernelSize",n,e,t),a=N("includeBatchInIndex",n,e,t),{result:u,indexes:c}=r.maxPoolWithArgmax(N("x",n,e,t),[i[1],i[2]],[s[1],s[2]],o,a);return[u,c]}case"AvgPool3D":{const s=N("strides",n,e,t),o=N("pad",n,e,t),i=N("kernelSize",n,e,t);return[r.avgPool3d(N("x",n,e,t),[i[1],i[2],i[3]],[s[1],s[2],s[3]],o)]}case"MaxPool3D":{const s=N("strides",n,e,t),o=N("pad",n,e,t),i=N("kernelSize",n,e,t);return[r.maxPool3d(N("x",n,e,t),[i[1],i[2],i[3]],[s[1],s[2],s[3]],o)]}case"Dilation2D":{const s=N("strides",n,e,t),o=N("pad",n,e,t),i=N("dilations",n,e,t),a=s[1],u=s[2],c=i[1],l=i[2];return[r.dilation2d(N("x",n,e,t),N("filter",n,e,t),[a,u],o,[c,l],"NHWC")]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const SA=(n,e,t,r=fn)=>{switch(n.op){case"Fill":{const s=N("shape",n,e,t),o=N("dtype",n,e,t),i=N("value",n,e,t);return[r.fill(s,i,o)]}case"LinSpace":{const s=N("start",n,e,t),o=N("stop",n,e,t),i=N("num",n,e,t);return[r.linspace(s,o,i)]}case"Multinomial":{const s=N("logits",n,e,t),o=N("numSamples",n,e,t),i=N("seed",n,e,t);return[r.multinomial(s,o,i)]}case"OneHot":{const s=N("indices",n,e,t),o=N("depth",n,e,t),i=N("onValue",n,e,t),a=N("offValue",n,e,t),u=N("dtype",n,e,t);return[r.oneHot(s,o,i,a,u)]}case"Ones":return[r.ones(N("shape",n,e,t),N("dtype",n,e,t))];case"OnesLike":return[r.onesLike(N("x",n,e,t))];case"RandomStandardNormal":return[r.randomStandardNormal(N("shape",n,e,t),N("dtype",n,e,t),N("seed",n,e,t))];case"RandomUniform":return[r.randomUniform(N("shape",n,e,t),N("minval",n,e,t),N("maxval",n,e,t),N("dtype",n,e,t))];case"Range":{const s=N("start",n,e,t),o=N("stop",n,e,t),i=N("step",n,e,t);return[r.range(s,o,i,N("dtype",n,e,t))]}case"TruncatedNormal":{const s=N("shape",n,e,t),o=N("mean",n,e,t),i=N("stdDev",n,e,t),a=N("seed",n,e,t);return[r.truncatedNormal(s,o,i,N("dtype",n,e,t),a)]}case"Zeros":return[r.zeros(N("shape",n,e,t),N("dtype",n,e,t))];case"ZerosLike":return[r.zerosLike(N("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Wu(n,e,t){const r=N("boxes",n,e,t),s=N("scores",n,e,t),o=N("maxOutputSize",n,e,t),i=N("iouThreshold",n,e,t),a=N("scoreThreshold",n,e,t),u=N("softNmsSigma",n,e,t);return{boxes:r,scores:s,maxOutputSize:o,iouThreshold:i,scoreThreshold:a,softNmsSigma:u}}const NA=async(n,e,t,r,s=fn)=>{switch(n.op){case"NonMaxSuppressionV5":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:u,scoreThreshold:c,softNmsSigma:l}=Wu(n,e,t),h=await s.image.nonMaxSuppressionWithScoreAsync(o,i,a,u,c,l);return[h.selectedIndices,h.selectedScores]}case"NonMaxSuppressionV4":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:u,scoreThreshold:c}=Wu(n,e,t),l=N("padToMaxOutputSize",n,e,t),h=await s.image.nonMaxSuppressionPaddedAsync(o,i,a,u,c,l);return[h.selectedIndices,h.validOutputs]}case"NonMaxSuppressionV3":case"NonMaxSuppressionV2":{const{boxes:o,scores:i,maxOutputSize:a,iouThreshold:u,scoreThreshold:c}=Wu(n,e,t);return[await s.image.nonMaxSuppressionAsync(o,i,a,u,c)]}case"Where":{const o=s.cast(N("condition",n,e,t),"bool"),i=[await s.whereAsync(o)];return o.dispose(),i}case"ListDiff":return s.setdiff1dAsync(N("x",n,e,t),N("y",n,e,t));default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const EA=(n,e,t,r=fn)=>{switch(n.op){case"LowerBound":{const s=N("sortedSequence",n,e,t),o=N("values",n,e,t);return[r.lowerBound(s,o)]}case"TopKV2":{const s=N("x",n,e,t),o=N("k",n,e,t),i=N("sorted",n,e,t),a=r.topk(s,o,i);return[a.values,a.indices]}case"UpperBound":{const s=N("sortedSequence",n,e,t),o=N("values",n,e,t);return[r.upperBound(s,o)]}case"Unique":{const s=N("x",n,e,t),o=r.unique(s);return[o.values,o.indices]}case"UniqueV2":{const s=N("x",n,e,t),o=N("axis",n,e,t),i=r.unique(s,o);return[i.values,i.indices]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const kA=(n,e,t,r=fn)=>{switch(n.op){case"Const":return e[n.name];case"PlaceholderWithDefault":const s=N("default",n,e,t);return[Cn(n.name,e,t)||s];case"Placeholder":return[Cn(n.name,e,t)];case"Identity":case"StopGradient":case"FakeQuantWithMinMaxVars":{const l=N("x",n,e,t);return[ps(l)]}case"IdentityN":return N("x",n,e,t).map(l=>ps(l));case"Snapshot":const o=N("x",n,e,t);return[ps(o)];case"Shape":return[r.tensor1d(N("x",n,e,t).shape,"int32")];case"ShapeN":return N("x",n,e,t).map(l=>r.tensor1d(l.shape));case"Size":return[r.scalar(N("x",n,e,t).size,"int32")];case"Rank":return[r.scalar(N("x",n,e,t).rank,"int32")];case"NoOp":return[r.scalar(1)];case"Print":const i=N("x",n,e,t),a=N("data",n,e,t),u=N("message",n,e,t),c=N("summarize",n,e,t);console.warn("The graph has a tf.print() operation,usually used for debugging, which slows down performance."),console.log(u);for(let l=0;l<a.length;l++)console.log(Array.prototype.slice.call(a[l].dataSync()).slice(0,c));return[i];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class IA{constructor(e,t){this.keyDType=e,this.valueDType=t,this.handle=ct(0),this.tensorMap=new Map,Ms(this.handle)}get id(){return this.handle.id}clearAndClose(){this.tensorMap.forEach(e=>e.dispose()),this.tensorMap.clear(),this.handle.dispose()}size(){return this.tensorMap.size}tensorSize(){return ct(this.size(),"int32")}async import(e,t){this.checkKeyAndValueTensor(e,t);const r=await e.data();return this.tensorMap.forEach(s=>s.dispose()),this.tensorMap.clear(),Lt(()=>{const s=Po(t),o=r.length,i=s.length;M(o===i,()=>`The number of elements doesn't match, keys has ${o} elements, the values has ${i} elements.`);for(let a=0;a<o;a++){const u=r[a],c=s[a];Ms(c),this.tensorMap.set(u,c)}return this.handle})}async find(e,t){this.checkKeyAndValueTensor(e,t);const r=await e.data();return Lt(()=>{const s=[];for(let o=0;o<r.length;o++){const i=r[o],a=this.findWithDefault(i,t);s.push(a)}return Ts(s)})}findWithDefault(e,t){const r=this.tensorMap.get(e);return r!=null?r:t}checkKeyAndValueTensor(e,t){if(e.dtype!==this.keyDType)throw new Error(`Expect key dtype ${this.keyDType}, but got ${e.dtype}`);if(t.dtype!==this.valueDType)throw new Error(`Expect value dtype ${this.valueDType}, but got ${t.dtype}`)}}/**
 * @license
 * Copyright 2020 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const _A=async(n,e,t,r)=>{switch(n.op){case"HashTable":case"HashTableV2":{const s=N("keyDType",n,e,t),o=N("valueDType",n,e,t),i=new IA(s,o);return r.addHashTable(n.name,i),[i.handle]}case"LookupTableImport":case"LookupTableImportV2":{const s=N("tableHandle",n,e,t,r),o=N("keys",n,e,t),i=N("values",n,e,t);return[await r.getHashTableById(s.id).import(o,i)]}case"LookupTableFind":case"LookupTableFindV2":{const s=N("tableHandle",n,e,t,r),o=N("keys",n,e,t),i=N("defaultValue",n,e,t);return[await r.getHashTableById(s.id).find(o,i)]}case"LookupTableSize":case"LookupTableSizeV2":{const s=N("tableHandle",n,e,t,r);return[r.getHashTableById(s.id).tensorSize()]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const RA=(n,e,t,r=fn)=>{switch(n.op){case"ResizeBilinear":{const s=N("images",n,e,t),o=N("size",n,e,t),i=N("alignCorners",n,e,t),a=N("halfPixelCenters",n,e,t);return[r.image.resizeBilinear(s,[o[0],o[1]],i,a)]}case"ResizeNearestNeighbor":{const s=N("images",n,e,t),o=N("size",n,e,t),i=N("alignCorners",n,e,t),a=N("halfPixelCenters",n,e,t);return[r.image.resizeNearestNeighbor(s,[o[0],o[1]],i,a)]}case"CropAndResize":{const s=N("image",n,e,t),o=N("boxes",n,e,t),i=N("boxInd",n,e,t),a=N("cropSize",n,e,t),u=N("method",n,e,t),c=N("extrapolationValue",n,e,t);return[r.image.cropAndResize(s,o,i,a,u,c)]}case"ImageProjectiveTransformV3":{const s=N("images",n,e,t),o=N("transforms",n,e,t),i=N("outputShape",n,e,t),a=N("fillValue",n,e,t),u=N("interpolation",n,e,t),c=N("fillMode",n,e,t);return[r.image.transform(s,o,u.toLowerCase(),c.toLowerCase(),a,i)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const AA=(n,e,t,r=fn)=>{switch(n.op){case"Equal":return[r.equal(N("a",n,e,t),N("b",n,e,t))];case"NotEqual":return[r.notEqual(N("a",n,e,t),N("b",n,e,t))];case"Greater":return[r.greater(N("a",n,e,t),N("b",n,e,t))];case"GreaterEqual":return[r.greaterEqual(N("a",n,e,t),N("b",n,e,t))];case"Less":return[r.less(N("a",n,e,t),N("b",n,e,t))];case"LessEqual":return[r.lessEqual(N("a",n,e,t),N("b",n,e,t))];case"LogicalAnd":return[r.logicalAnd(N("a",n,e,t),N("b",n,e,t))];case"LogicalNot":return[r.logicalNot(N("a",n,e,t))];case"LogicalOr":return[r.logicalOr(N("a",n,e,t),N("b",n,e,t))];case"Select":case"SelectV2":return[r.where(N("condition",n,e,t),N("a",n,e,t),N("b",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const OA=(n,e,t,r=fn)=>{switch(n.op){case"BatchMatMul":case"BatchMatMulV2":case"MatMul":return[r.matMul(N("a",n,e,t),N("b",n,e,t),N("transposeA",n,e,t),N("transposeB",n,e,t))];case"Einsum":return[r.einsum(N("equation",n,e,t),...N("tensors",n,e,t))];case"Transpose":return[r.transpose(N("x",n,e,t),N("perm",n,e,t))];case"_FusedMatMul":const[s,o]=N("fusedOps",n,e,t),i=s==="biasadd",a=o==="prelu",u=N("numArgs",n,e,t),c=N("leakyreluAlpha",n,e,t);if(i){if(a&&u!==2)throw new Error("Fused MatMul with BiasAdd and Prelu must have two extra arguments: bias and alpha.");if(!a&&u!==1)throw new Error("Fused MatMul with BiasAdd must have one extra argument: bias.")}const[l,h]=N("args",n,e,t);return[r.fused.matMul({a:N("a",n,e,t),b:N("b",n,e,t),transposeA:N("transposeA",n,e,t),transposeB:N("transposeB",n,e,t),bias:l,activation:o,preluActivationWeights:h,leakyreluAlpha:c})];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const DA=(n,e,t,r=fn)=>{switch(n.op){case"EuclideanNorm":return[r.euclideanNorm(N("x",n,e,t),N("axis",n,e,t),N("keepDims",n,e,t))];case"FusedBatchNorm":case"FusedBatchNormV2":return[r.batchNorm(N("x",n,e,t),N("mean",n,e,t),N("variance",n,e,t),N("offset",n,e,t),N("scale",n,e,t),N("epsilon",n,e,t))];case"FusedBatchNormV3":return[r.batchNorm(N("x",n,e,t),N("mean",n,e,t),N("variance",n,e,t),N("offset",n,e,t),N("scale",n,e,t),N("epsilon",n,e,t))];case"LRN":return[r.localResponseNormalization(N("x",n,e,t),N("radius",n,e,t),N("bias",n,e,t),N("alpha",n,e,t),N("beta",n,e,t))];case"Softmax":return[r.softmax(N("x",n,e,t))];case"LogSoftmax":return[r.logSoftmax(N("x",n,e,t))];case"SparseToDense":return[r.sparseToDense(N("sparseIndices",n,e,t),N("outputShape",n,e,t),N("sparseValues",n,e,t),N("defaultValue",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const FA=(n,e,t,r=fn)=>{switch(n.op){case"Max":{const a=N("axis",n,e,t),u=N("keepDims",n,e,t);return[r.max(N("x",n,e,t),a,u)]}case"Mean":{const a=N("axis",n,e,t),u=N("keepDims",n,e,t);return[r.mean(N("x",n,e,t),a,u)]}case"Min":{const a=N("axis",n,e,t),u=N("keepDims",n,e,t);return[r.min(N("x",n,e,t),a,u)]}case"Sum":{const a=N("axis",n,e,t),u=N("keepDims",n,e,t);return[r.sum(N("x",n,e,t),a,u)]}case"All":{const a=N("axis",n,e,t),u=N("keepDims",n,e,t);return[r.all(N("x",n,e,t),a,u)]}case"Any":{const a=N("axis",n,e,t),u=N("keepDims",n,e,t);return[r.any(N("x",n,e,t),a,u)]}case"ArgMax":{const a=N("axis",n,e,t);return[r.argMax(N("x",n,e,t),a)]}case"ArgMin":{const a=N("axis",n,e,t);return[r.argMin(N("x",n,e,t),a)]}case"Prod":{const a=N("axis",n,e,t),u=N("keepDims",n,e,t);return[r.prod(N("x",n,e,t),a,u)]}case"Cumprod":{const a=N("axis",n,e,t),u=N("exclusive",n,e,t),c=N("reverse",n,e,t);return[r.cumprod(N("x",n,e,t),a,u,c)]}case"Cumsum":{const a=N("axis",n,e,t),u=N("exclusive",n,e,t),c=N("reverse",n,e,t);return[r.cumsum(N("x",n,e,t),a,u,c)]}case"Bincount":const s=N("x",n,e,t),o=N("weights",n,e,t),i=N("size",n,e,t);return[r.bincount(s,o,i)];case"DenseBincount":{const a=N("x",n,e,t),u=N("weights",n,e,t),c=N("size",n,e,t),l=N("binaryOutput",n,e,t);return[r.denseBincount(a,u,c,l)]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const PA=(n,e,t,r=fn)=>{switch(n.op){case"ConcatV2":case"Concat":{const s=N("n",n,e,t),o=N("axis",n,e,t);let i=N("tensors",n,e,t);return i=i.slice(0,s),[r.concat(i,o)]}case"Gather":{const s=N("x",n,e,t),o=N("indices",n,e,t);return[r.gather(s,r.cast(o,"int32"),0)]}case"GatherV2":{const s=N("axis",n,e,t),o=N("batchDims",n,e,t),i=N("x",n,e,t),a=N("indices",n,e,t);return[r.gather(i,r.cast(a,"int32"),s,o)]}case"Reverse":{const s=N("dims",n,e,t),o=[];for(let a=0;a<s.length;a++)s[a]&&o.push(a);const i=N("x",n,e,t);return[r.reverse(i,o)]}case"ReverseV2":{const s=N("axis",n,e,t),o=N("x",n,e,t);return[r.reverse(o,s)]}case"Slice":{const s=N("begin",n,e,t),o=N("size",n,e,t);return[r.slice(N("x",n,e,t),s,o)]}case"StridedSlice":{const s=N("begin",n,e,t),o=N("end",n,e,t),i=N("strides",n,e,t),a=N("beginMask",n,e,t),u=N("endMask",n,e,t),c=N("ellipsisMask",n,e,t),l=N("newAxisMask",n,e,t),h=N("shrinkAxisMask",n,e,t),d=N("x",n,e,t);return[r.stridedSlice(d,s,o,i,a,u,c,l,h)]}case"Pack":return Lt(()=>{const s=N("axis",n,e,t),o=N("tensors",n,e,t),i=o[0].shape,a=r.squeeze(o[0]).shape,u=o.map(c=>{const l=Bt(c.shape,i);if(!l&&!Bt(r.squeeze(c).shape,a))throw new Error("the input tensors shape does not match");return l?c:r.reshape(c,i)});return[r.stack(u,s)]});case"Unpack":{const s=N("axis",n,e,t),o=N("tensor",n,e,t);return r.unstack(o,s)}case"Tile":{const s=N("reps",n,e,t);return[r.tile(N("x",n,e,t),s)]}case"Split":case"SplitV":{const s=N("axis",n,e,t),o=N("numOrSizeSplits",n,e,t),i=N("x",n,e,t);return r.split(i,o,s)}case"ScatterNd":{const s=N("indices",n,e,t),o=N("values",n,e,t),i=N("shape",n,e,t);return[r.scatterND(s,o,i)]}case"GatherNd":{const s=N("x",n,e,t),o=N("indices",n,e,t);return[r.gatherND(s,o)]}case"SparseToDense":{const s=N("sparseIndices",n,e,t),o=N("outputShape",n,e,t),i=N("sparseValues",n,e,t),a=N("defaultValue",n,e,t);return[r.sparseToDense(s,i,o,i.dtype===a.dtype?a:r.cast(a,i.dtype))]}default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const LA=(n,e,t,r=fn)=>{switch(n.op){case"SparseFillEmptyRows":{const{outputIndices:s,outputValues:o,emptyRowIndicator:i,reverseIndexMap:a}=r.sparse.sparseFillEmptyRows(N("indices",n,e,t),N("values",n,e,t),N("denseShape",n,e,t),N("defaultValue",n,e,t));return[s,o,i,a]}case"SparseReshape":{const{outputIndices:s,outputShape:o}=r.sparse.sparseReshape(N("inputIndices",n,e,t),N("inputShape",n,e,t),N("newShape",n,e,t));return[s,o]}case"SparseSegmentMean":return[r.sparse.sparseSegmentMean(N("data",n,e,t),N("indices",n,e,t),N("segmentIds",n,e,t))];case"SparseSegmentSum":return[r.sparse.sparseSegmentSum(N("data",n,e,t),N("indices",n,e,t),N("segmentIds",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const BA=(n,e,t,r=fn)=>{switch(n.op){case"FFT":return[r.fft(N("x",n,e,t))];case"IFFT":return[r.ifft(N("x",n,e,t))];case"RFFT":return[r.rfft(N("x",n,e,t))];case"IRFFT":return[r.irfft(N("x",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2021 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const MA=(n,e,t,r=fn)=>{switch(n.op){case"StringNGrams":{const{nGrams:s,nGramsSplits:o}=r.string.stringNGrams(N("data",n,e,t),N("dataSplits",n,e,t),N("separator",n,e,t),N("nGramWidths",n,e,t),N("leftPad",n,e,t),N("rightPad",n,e,t),N("padWidth",n,e,t),N("preserveShortSequences",n,e,t));return[s,o]}case"StringSplit":{const{indices:s,values:o,shape:i}=r.string.stringSplit(N("input",n,e,t),N("delimiter",n,e,t),N("skipEmpty",n,e,t));return[s,o,i]}case"StringToHashBucketFast":return[r.string.stringToHashBucketFast(N("input",n,e,t),N("numBuckets",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const VA=(n,e,t,r=fn)=>{switch(n.op){case"Cast":return[r.cast(N("x",n,e,t),N("dtype",n,e,t))];case"ExpandDims":{const s=N("axis",n,e,t);return[r.expandDims(N("x",n,e,t),s)]}case"Squeeze":{const s=N("axis",n,e,t);return[r.squeeze(N("x",n,e,t),s)]}case"Reshape":return[r.reshape(N("x",n,e,t),N("shape",n,e,t))];case"MirrorPad":return[r.mirrorPad(N("x",n,e,t),N("padding",n,e,t),N("mode",n,e,t))];case"PadV2":case"Pad":return[r.pad(N("x",n,e,t),N("padding",n,e,t),N("constantValue",n,e,t))];case"SpaceToBatchND":{const s=N("blockShape",n,e,t),o=N("paddings",n,e,t);return[r.spaceToBatchND(N("x",n,e,t),s,o)]}case"BatchToSpaceND":{const s=N("blockShape",n,e,t),o=N("crops",n,e,t);return[r.batchToSpaceND(N("x",n,e,t),s,o)]}case"DepthToSpace":{const s=N("blockSize",n,e,t),o=N("dataFormat",n,e,t).toUpperCase();return[r.depthToSpace(N("x",n,e,t),s,o)]}case"BroadcastTo":return[r.broadcastTo(N("x",n,e,t),N("shape",n,e,t))];case"BroadcastArgs":return[r.broadcastArgs(N("s0",n,e,t),N("s1",n,e,t))];default:throw TypeError(`Node type ${n.op} is not implemented`)}};/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Kh(n,e,t,r,s=Lt){const o=((i,a,u)=>{switch(i.category){case"arithmetic":return s(()=>gA(i,a,u));case"basic_math":return s(()=>yA(i,a,u));case"control":return TA(i,a,u);case"convolution":return s(()=>$A(i,a,u));case"creation":return s(()=>SA(i,a,u));case"dynamic":return NA(i,a,u);case"evaluation":return s(()=>EA(i,a,u));case"image":return s(()=>RA(i,a,u));case"graph":return s(()=>kA(i,a,u));case"logical":return s(()=>AA(i,a,u));case"matrices":return s(()=>OA(i,a,u));case"normalization":return s(()=>DA(i,a,u));case"reduction":return s(()=>FA(i,a,u));case"slice_join":return s(()=>PA(i,a,u));case"sparse":return s(()=>LA(i,a,u));case"spectral":return s(()=>BA(i,a,u));case"string":return s(()=>MA(i,a,u));case"transformation":return s(()=>VA(i,a,u));case"hash_table":return _A(i,a,u,r);case"custom":const c=kg(i.op);if(c&&c.customExecutor)return c.customExecutor(new mA(i,a,u));throw TypeError(`Custom op ${i.op} is not registered.`);default:throw TypeError(`Unknown op '${i.op}'. File an issue at https://github.com/tensorflow/tfjs/issues so we can add it, or register a custom execution with tf.registerOp()`)}})(n,e,t);return li(o)?o.then(i=>[].concat(i)):[].concat(o)}class Yh{constructor(e={},t={},r={},s={}){this.weightMap=e,this.tensorArrayMap=t,this.tensorListMap=r,this.functionMap=s,this.rootContext={id:0,frameName:"",iterationId:0},this.contexts=[this.rootContext],this.lastId=0,this.generateCurrentContextIds()}newFrame(e,t){return{id:e,frameName:t,iterationId:0}}set currentContext(e){this.contexts!==e&&(this.contexts=e,this.generateCurrentContextIds())}get currentContext(){return this.contexts}get currentContextId(){return this._currentContextIds[0]}get currentContextIds(){return this._currentContextIds}generateCurrentContextIds(){const e=[];for(let t=0;t<this.contexts.length-1;t++){const r=this.contexts.slice(0,this.contexts.length-t);e.push(this.contextIdforContexts(r))}e.push(""),this._currentContextIds=e}contextIdforContexts(e){return e?e.map(t=>t.id===0&&t.iterationId===0?"":`${t.frameName}-${t.iterationId}`).join("/"):""}enterFrame(e){this.contexts&&(this.lastId++,this.contexts=this.contexts.slice(),this.contexts.push(this.newFrame(this.lastId,e)),this._currentContextIds.unshift(this.contextIdforContexts(this.contexts)))}exitFrame(){if(this.contexts&&this.contexts.length>1)this.contexts=this.contexts.slice(),this.contexts.splice(-1),this.currentContextIds.shift();else throw new Error("Cannot exit frame, the context is empty")}nextIteration(){if(this.contexts&&this.contexts.length>0){this.contexts=this.contexts.slice(),this.lastId++;const e=Object.assign({},this.contexts[this.contexts.length-1]);e.iterationId+=1,e.id=this.lastId,this.contexts.splice(-1,1,e),this._currentContextIds.splice(0,1,this.contextIdforContexts(this.contexts))}else throw new Error("Cannot increase frame iteration, the context is empty")}getWeight(e){return this.weightMap[e]}addTensorArray(e){this.tensorArrayMap[e.id]=e}getTensorArray(e){return this.tensorArrayMap[e]}addTensorList(e){this.tensorListMap[e.id]=e}getTensorList(e){return this.tensorListMap[e]}dispose(e){for(const t in this.tensorArrayMap)this.tensorArrayMap[t].clearAndClose(e);for(const t in this.tensorListMap)this.tensorListMap[t].clearAndClose(e)}}/**
 * @license
 * Copyright 2019 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */function Qh(n,e,t,r){const s=new Set,o=[];let i=null,a=null;const u=new Set,c=Object.keys(n).map(d=>Dn(d)[0]);let l=[];r!=null&&(l=r.map(d=>Dn(d.name)[0]));const h=[...e];for(;h.length>0;){const d=h.pop();if((Rg(d)||jA(d)||HA(d))&&i==null&&(i=d,a=i.children.map(m=>m.name).filter(m=>s.has(m))),s.add(d.name),t[d.name]==null&&c.indexOf(d.name)===-1&&l.indexOf(d.name)===-1){if(d.inputs.length===0){o.push(d.name);continue}d.inputs.forEach(m=>{u.has(m.name)||(u.add(m.name),h.push(m))})}}return{inputs:n,outputs:e,usedNodes:s,missingInputs:o,dynamicNode:i,syncInputs:a}}function UA(n,e,t){const{usedNodes:r,inputs:s}=t,o=[],i=Object.keys(s).map(l=>Dn(l)[0]).map(l=>n.nodes[l]),a=n.initNodes;i.forEach(l=>{r.has(l.name)&&o.push(l)}),n.weights.forEach(l=>{r.has(l.name)&&o.push(l)}),a!=null&&a.forEach(l=>{r.has(l.name)&&o.push(l)});const u=new Set,c=[];for(;o.length>0;){const l=o.pop();u.add(l.name),e[l.name]||c.push(l),l.children.forEach(h=>{!u.has(h.name)&&r.has(h.name)&&h.inputs.every(d=>u.has(d.name))&&o.push(h)})}return c}const WA=["Switch","Merge","Enter","Exit","NextIteration","StatelessIf","StatelessWhile","if","While"],zA=["NonMaxSuppressionV2","NonMaxSuppressionV3","NonMaxSuppressionV5","Where"],GA=["HashTable","HashTableV2","LookupTableImport","LookupTableImportV2","LookupTableFind","LookupTableFindV2","LookupTableSize","LookupTableSizeV2"];function Rg(n){return WA.indexOf(n.op)>=0}function jA(n){return zA.indexOf(n.op)>=0}function HA(n){return GA.indexOf(n.op)>=0}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */class Qa{constructor(e,t){this.graph=e,this.parent=t,this.compiledMap=new Map,this._weightMap={},this.SEPERATOR=",",this._functions={},this._functionExecutorMap={},this.intermediateTensors={},this.keepTensorForDebug=!1,this._outputs=e.outputs,this._inputs=e.inputs,this._initNodes=e.initNodes,this._signature=e.signature,this._functions=e.functions,e.functions!=null&&Object.keys(e.functions).forEach(r=>{this._functionExecutorMap[r]=new Qa(e.functions[r],this)})}get weightIds(){return this.parent?this.parent.weightIds:this._weightIds}get functionExecutorMap(){return this.parent?this.parent.functionExecutorMap:this._functionExecutorMap}get weightMap(){return this.parent?this.parent.weightMap:this._weightMap}set weightMap(e){const t=Object.keys(e).map(r=>e[r].map(s=>s.id));this._weightIds=[].concat(...t),this._weightMap=e}set resourceManager(e){this._resourceManager=e}get inputs(){return this._inputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get outputs(){return this._outputs.map(e=>({name:e.name,shape:e.attrParams.shape?e.attrParams.shape.value:void 0,dtype:e.attrParams.dtype?e.attrParams.dtype.value:void 0}))}get inputNodes(){return this._inputs.map(e=>e.signatureKey||e.name)}get outputNodes(){return this._outputs.map(e=>{const t=e.signatureKey||e.name;return e.defaultOutput?`${t}:${e.defaultOutput}`:t})}get functions(){return Object.keys(this._functions).reduce((e,t)=>(e[t]=this._functions[t].signature,e),{})}getCompilationKey(e,t){const r=e.map(o=>o.name).sort(),s=t.map(o=>o.name).sort();return r.join(this.SEPERATOR)+"--"+s.join(this.SEPERATOR)}compile(e,t){const r=Qh(e,t,this.weightMap,this._initNodes),{missingInputs:s,dynamicNode:o,syncInputs:i}=r;if(o!=null)throw new Error(`This execution contains the node '${o.name}', which has the dynamic op '${o.op}'. Please use model.executeAsync() instead. Alternatively, to avoid the dynamic ops, specify the inputs [${i}]`);if(s.length>0){const a=t.map(c=>c.name),u=Object.keys(e);throw new Error(`Cannot compute the outputs [${a}] from the provided inputs [${u}]. Missing the following inputs: [${s}]`)}return UA(this.graph,this.weightMap,r)}execute(e,t){e=this.mapInputs(e);const r=Object.keys(e).sort();this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t);const s=r.map(h=>this.graph.nodes[Dn(h)[0]]),o=t.map(h=>Dn(h)[0]);let i=o.map(h=>this.graph.nodes[h]);this.resetIntermediateTensors(),i.length===0&&(i=this._outputs);const a=this.getCompilationKey(s,i);let u=this.compiledMap.get(a);u==null&&(u=this.compile(e,i),this.compiledMap.set(a,u));const c={},l={};return Lt(()=>{const h=new Yh(this.weightMap,c,l,this.functionExecutorMap),d=Object.assign({},this.weightMap);Object.keys(e).forEach(C=>{const[$,T]=Dn(C),A=[];A[T]=e[C],d[$]=A});const m=this.getFrozenTensorIds(d),g={};for(let C=0;C<u.length;C++){const $=u[C];if(!d[$.name]){const T=Kh($,d,h,this._resourceManager);if(li(T))throw new Error(`The execution of the op '${$.op}' returned a promise. Please use model.executeAsync() instead.`);d[$.name]=T,this.checkTensorForDisposal($.name,$,d,h,m,o,g)}}return this.parent==null&&h.dispose(m),t.map(C=>Cn(C,d,h))})}getFrozenTensorIds(e){const t=[].concat.apply([],Object.keys(e).map(r=>e[r]).map(r=>r.map(s=>s.id)));return new Set(t)}checkTensorForDisposal(e,t,r,s,o,i,a){t.category==="control"||i.indexOf(e)!==-1||(r[e].forEach(u=>{u!=null&&(a[u.id]=(a[u.id]||0)+t.children.length)}),t.inputs.forEach(u=>{if(u.category!=="control"){const c=IR(u.name,r,s);c!=null&&c.forEach(l=>{if(l&&!l.kept&&!o.has(l.id)){const h=a[l.id];if(h===1){if(!this.keepTensorForDebug)l.dispose();else{const[d,m]=Jr(t.name,s);this.intermediateTensors[d]?this.intermediateTensors[d][m]=l:(this.intermediateTensors[d]=[],this.intermediateTensors[d][m]=l)}delete a[l.id]}else h!=null&&a[l.id]--}})}}))}async executeAsync(e,t){return this._executeAsync(e,t)}disposeIntermediateTensors(){!this.intermediateTensors||(Object.keys(this.intermediateTensors).forEach(e=>this.intermediateTensors[e].forEach(t=>t.dispose())),this.disposeTensorsMap())}disposeTensorsMap(){!this.tensorsMap||Object.keys(this.tensorsMap).forEach(e=>{this.tensorsMap[e].forEach(r=>{r&&!r.kept&&!r.isDisposed&&!this.keepIds.has(r.id)&&r.dispose()})})}getIntermediateTensors(){return this.tensorsMap}resetIntermediateTensors(){for(const e in this.intermediateTensors)this.intermediateTensors[e].forEach(t=>t.dispose()),delete this.intermediateTensors[e]}async _executeAsync(e,t,r=!1,s={},o={}){r||(e=this.mapInputs(e),this.checkInputs(e),this.checkInputShapeAndType(e),t=this.mapOutputs(t),this.checkOutputs(t));try{this.keepTensorForDebug=ue().getBool("KEEP_INTERMEDIATE_TENSORS")}catch(l){console.warn(l.message)}this.resetIntermediateTensors();const i=new Yh(this.weightMap,s,o,this.functionExecutorMap);this.tensorsMap=await this.executeWithControlFlow(e,i,t,r);const a=t.map(l=>Cn(l,this.tensorsMap,i)),u=a.map(l=>l.id),c=Object.keys(e).map(l=>e[l].id);return this.keepIds=new Set([...u,...c,...this.weightIds]),this.keepTensorForDebug||this.disposeTensorsMap(),this.parent==null&&i.dispose(this.keepIds),a}async executeFunctionAsync(e,t,r){const s=e.reduce((o,i,a)=>(o[this.inputs[a].name]=i,o),{});return this._executeAsync(s,this.outputNodes,!0,t,r)}async executeWithControlFlow(e,t,r,s){const o=Object.keys(e),i=o.map(P=>this.graph.nodes[Dn(P)[0]]),a=r.map(P=>Dn(P)[0]);let u=a.map(P=>this.graph.nodes[P]);u.length===0&&(u=this._outputs);const{usedNodes:c,missingInputs:l,dynamicNode:h,syncInputs:d}=Qh(e,u,this.weightMap,this._initNodes),m=[...i,...this.graph.weights,...this._initNodes||[]].map(P=>({node:P,contexts:t.currentContext})),g=Object.assign({},this.weightMap);Object.keys(e).forEach(P=>{const[B,H]=Dn(P),x=[];x[H]=e[P],g[B]=x});const C={},$=this.getFrozenTensorIds(g),T={};for(;m.length>0;){const P=this.processStack(i,m,t,g,T,$,a,C,c);await Promise.all(P)}h==null&&!s&&console.warn("This model execution did not contain any nodes with control flow or dynamic output shapes. You can use model.execute() instead.");const A=u.filter(P=>!Rg(P)&&!Cn(P.name,g,t)).map(P=>P.name);if(A.length>0){let P="";throw h!=null&&(P=`Alternatively, to avoid the dynamic ops, use model.execute() and specify the inputs [${d}]`),new Error(`Cannot compute the outputs [${A}] from the provided inputs [${o}]. Consider providing the following inputs: [${l}]. ${P}`)}return g}processStack(e,t,r,s,o,i,a,u,c){const l=[];for(;t.length>0;){const h=t.pop();r.currentContext=h.contexts;let d="";if(h.node.op==="Enter"&&N("isConstant",h.node,s,r)&&([d]=Jr(h.node.name,r)),s[h.node.name]==null){const m=Kh(h.node,s,r,this._resourceManager);d||([d]=Jr(h.node.name,r));const g=r.currentContext;li(m)?l.push(m.then(C=>(s[d]=C,r.currentContext=g,this.checkTensorForDisposal(d,h.node,s,r,i,a,u),this.processChildNodes(h.node,t,r,s,o,c),C))):(s[d]=m,this.checkTensorForDisposal(d,h.node,s,r,i,a,u),this.processChildNodes(h.node,t,r,s,o,c))}else this.processChildNodes(h.node,t,r,s,o,c)}return l}processChildNodes(e,t,r,s,o,i){e.children.forEach(a=>{const[u]=Jr(a.name,r);o[u]||!i.has(a.name)||(a.op==="Merge"?a.inputNames.some(c=>!!Cn(c,s,r))&&(o[u]=!0,t.push({contexts:r.currentContext,node:a})):a.inputNames.every(c=>!!Cn(c,s,r))&&(o[u]=!0,t.push({contexts:r.currentContext,node:a})))})}dispose(){Object.keys(this.weightMap).forEach(e=>this.weightMap[e].forEach(t=>t.dispose()))}checkInputShapeAndType(e){Object.keys(e).forEach(t=>{const r=e[t],[s]=Dn(t),o=this.graph.nodes[s];if(o.attrParams.shape&&o.attrParams.shape.value){const i=o.attrParams.shape.value,a=i.length===r.shape.length&&r.shape.every((u,c)=>i[c]===-1||i[c]===u);M(a,()=>`The shape of dict['${o.name}'] provided in model.execute(dict) must be [${i}], but was [${r.shape}]`)}o.attrParams.dtype&&o.attrParams.dtype.value&&M(r.dtype===o.attrParams.dtype.value,()=>`The dtype of dict['${o.name}'] provided in model.execute(dict) must be ${o.attrParams.dtype.value}, but was ${r.dtype}`)})}mapInputs(e){const t={};for(const r in e)if(this._signature!=null&&this._signature.inputs!=null&&this._signature.inputs[r]!=null){const s=this._signature.inputs[r];t[s.name]=e[r]}else t[r]=e[r];return t}checkInputs(e){const t=Object.keys(e).filter(r=>{const[s]=Dn(r);return this.graph.nodes[s]==null});if(t.length>0)throw new Error(`The dict provided in model.execute(dict) has keys: [${t}] that are not part of graph`)}mapOutputs(e){return e.map(t=>this._signature!=null&&this._signature.outputs!=null&&this._signature.outputs[t]!=null?this._signature.outputs[t].name:t,{})}checkOutputs(e){e.forEach(t=>{const[r]=Dn(t);if(!this.graph.nodes[r])throw new Error(`The output '${t}' is not found in the graph`)})}}class qA{constructor(e={},t={}){this.hashTableNameToHandle=e,this.hashTableMap=t}addHashTable(e,t){this.hashTableNameToHandle[e]=t.handle,this.hashTableMap[t.id]=t}getHashTableHandleByName(e){return this.hashTableNameToHandle[e]}getHashTableById(e){return this.hashTableMap[e]}dispose(){for(const e in this.hashTableMap)this.hashTableMap[e].clearAndClose(),delete this.hashTableMap[e];for(const e in this.hashTableNameToHandle)this.hashTableNameToHandle[e].dispose(),delete this.hashTableNameToHandle[e]}}/**
 * @license
 * Copyright 2018 Google LLC. All Rights Reserved.
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 * =============================================================================
 */const XA="?tfjs-format=file",KA="model.json";class YA{constructor(e,t={},r=L1){this.modelUrl=e,this.loadOptions=t,this.version="n/a",this.io=r,t==null&&(this.loadOptions={}),this.resourceManager=new qA}get modelVersion(){return this.version}get inputNodes(){return this.executor.inputNodes}get outputNodes(){return this.executor.outputNodes}get inputs(){return this.executor.inputs}get outputs(){return this.executor.outputs}get weights(){return this.executor.weightMap}get metadata(){return this.artifacts.userDefinedMetadata}get modelSignature(){return this.signature}get modelStructuredOutputKeys(){return this.structuredOutputKeys}findIOHandler(){const e=this.modelUrl;if(e.load!=null)this.handler=e;else if(this.loadOptions.requestInit!=null)this.handler=this.io.browserHTTPRequest(e,this.loadOptions);else{const t=this.io.getLoadHandlers(e,this.loadOptions);if(t.length===0)t.push(this.io.browserHTTPRequest(e,this.loadOptions));else if(t.length>1)throw new Error(`Found more than one (${t.length}) load handlers for URL '${[e]}'`);this.handler=t[0]}}load(){if(this.findIOHandler(),this.handler.load==null)throw new Error("Cannot proceed with model loading because the IOHandler provided does not have the `load` method implemented.");const e=this.handler.load();return li(e)?e.then(t=>this.loadSync(t)):this.loadSync(e)}loadSync(e){this.artifacts=e;const t=this.artifacts.modelTopology;let r=this.artifacts.signature;if(this.artifacts.userDefinedMetadata!=null){const o=this.artifacts.userDefinedMetadata;o.signature!=null&&(r=o.signature),o.structuredOutputKeys!=null&&(this.structuredOutputKeys=o.structuredOutputKeys)}this.signature=r,this.version=`${t.versions.producer}.${t.versions.minConsumer}`;const s=this.io.decodeWeights(this.artifacts.weightData,this.artifacts.weightSpecs);if(this.executor=new Qa(jh.Instance.transformGraph(t,this.signature)),this.executor.weightMap=this.convertTensorMapToTensorsMap(s),this.executor.resourceManager=this.resourceManager,e.modelInitializer!=null&&e.modelInitializer.node!=null){const o=jh.Instance.transformGraph(e.modelInitializer);this.initializer=new Qa(o),this.initializer.weightMap=this.executor.weightMap,this.initializer.resourceManager=this.resourceManager,this.initializer.executeAsync({},[])}return!0}async save(e,t){if(typeof e=="string"){const r=this.io.getSaveHandlers(e);if(r.length===0)throw new Error(`Cannot find any save handlers for URL '${e}'`);if(r.length>1)throw new Error(`Found more than one (${r.length}) save handlers for URL '${e}'`);e=r[0]}if(e.save==null)throw new Error("GraphModel.save() cannot proceed because the IOHandler provided does not have the `save` attribute defined.");return e.save(this.artifacts)}predict(e,t){const r=this.execute(e,this.outputNodes);if(this.structuredOutputKeys){const s=r instanceof Rt?[r]:r,o={};return s.forEach((i,a)=>o[this.structuredOutputKeys[a]]=i),o}return r}normalizeInputs(e){if(!(e instanceof Rt)&&!Array.isArray(e))return e;if(e=Array.isArray(e)?e:[e],e.length!==this.inputNodes.length)throw new Error(`Input tensor count mismatch,the graph model has ${this.inputNodes.length} placeholders, while there are ${e.length} input tensors.`);return this.inputNodes.reduce((t,r,s)=>(t[r]=e[s],t),{})}normalizeOutputs(e){return e=e||this.outputNodes,Array.isArray(e)?e:[e]}execute(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const r=this.executor.execute(e,t);return r.length>1?r:r[0]}async executeAsync(e,t){e=this.normalizeInputs(e),t=this.normalizeOutputs(t);const r=await this.executor.executeAsync(e,t);return r.length>1?r:r[0]}getIntermediateTensors(){return this.executor.getIntermediateTensors()}disposeIntermediateTensors(){this.executor.disposeIntermediateTensors()}convertTensorMapToTensorsMap(e){return Object.keys(e).reduce((t,r)=>(t[r]=[e[r]],t),{})}dispose(){this.executor.dispose(),this.initializer&&this.initializer.dispose(),this.resourceManager.dispose()}}async function Ag(n,e={},t=L1){if(n==null)throw new Error("modelUrl in loadGraphModel() cannot be null. Please provide a url or an IOHandler that loads the model");e==null&&(e={}),e.fromTFHub&&typeof n=="string"&&(n=QA(n));const r=new YA(n,e,t);return await r.load(),r}function QA(n){return n.endsWith("/")||(n=n+"/"),`${n}${KA}${XA}`}/**
    * @license
    * Copyright 2022 Google LLC. All Rights Reserved.
    * Licensed under the Apache License, Version 2.0 (the "License");
    * you may not use this file except in compliance with the License.
    * You may obtain a copy of the License at
    *
    * http://www.apache.org/licenses/LICENSE-2.0
    *
    * Unless required by applicable law or agreed to in writing, software
    * distributed under the License is distributed on an "AS IS" BASIS,
    * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
    * See the License for the specific language governing permissions and
    * limitations under the License.
    * =============================================================================
    */var Lr=function(){return Lr=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var s in e=arguments[t])Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=e[s]);return n},Lr.apply(this,arguments)};function ys(n,e,t,r){return new(t||(t=Promise))(function(s,o){function i(c){try{u(r.next(c))}catch(l){o(l)}}function a(c){try{u(r.throw(c))}catch(l){o(l)}}function u(c){var l;c.done?s(c.value):(l=c.value,l instanceof t?l:new t(function(h){h(l)})).then(i,a)}u((r=r.apply(n,e||[])).next())})}function xs(n,e){var t,r,s,o,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(s=2&l[0]?r.return:l[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,l[1])).done)return s;switch(r=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(s=i.trys,!((s=s.length>0&&s[s.length-1])||l[0]!==6&&l[0]!==2)){i=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){i.label=l[1];break}if(l[0]===6&&i.label<s[1]){i.label=s[1],s=l;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(l);break}s[2]&&i.ops.pop(),i.trys.pop();continue}l=e.call(n,i)}catch(h){l=[6,h],r=0}finally{t=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([u,c])}}}function Ls(n){var e=n.map(function(t){return t[0]});return e.push(n[n.length-1][1]),e}var Og={lips:Ls([[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]]),leftEye:Ls([[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]]),leftEyebrow:Ls([[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]]),leftIris:Ls([[474,475],[475,476],[476,477],[477,474]]),rightEye:Ls([[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]]),rightEyebrow:Ls([[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]]),rightIris:Ls([[469,470],[470,471],[471,472],[472,469]]),faceOval:Ls([[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]])},ZA=[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]],JA=Object.entries(Og).map(function(n){var e=n[0];return n[1].map(function(t){return[t,e]})}).flat(),Dg=new Map(JA);function Gc(n){for(var e={locationData:{relativeKeypoints:[]}},t=Number.MAX_SAFE_INTEGER,r=Number.MIN_SAFE_INTEGER,s=Number.MAX_SAFE_INTEGER,o=Number.MIN_SAFE_INTEGER,i=0;i<n.length;++i){var a=n[i];t=Math.min(t,a.x),r=Math.max(r,a.x),s=Math.min(s,a.y),o=Math.max(o,a.y),e.locationData.relativeKeypoints.push({x:a.x,y:a.y})}return e.locationData.relativeBoundingBox={xMin:t,yMin:s,xMax:r,yMax:o,width:r-t,height:o-s},e}var zu={runtime:"mediapipe",maxFaces:1,refineLandmarks:!1},eO=function(){function n(e){var t=this;this.width=0,this.height=0,this.selfieMode=!1,this.faceMeshSolution=new i0.FaceMesh({locateFile:function(r,s){return e.solutionPath?e.solutionPath.replace(/\/+$/,"")+"/"+r:s+"/"+r}}),this.faceMeshSolution.setOptions({refineLandmarks:e.refineLandmarks,selfieMode:this.selfieMode,maxNumFaces:e.maxFaces}),this.faceMeshSolution.onResults(function(r){if(t.height=r.image.height,t.width=r.image.width,t.faces=[],r.multiFaceLandmarks!==null)for(var s=r.multiFaceLandmarks,o=0;o<s.length;o++){var i=t.translateOutput(s[o]);t.faces.push({keypoints:i,box:Gc(i).locationData.relativeBoundingBox})}})}return n.prototype.translateOutput=function(e){var t=this;return e.map(function(r,s){var o={x:r.x*t.width,y:r.y*t.height,z:r.z*t.width},i=Dg.get(s);return i!=null&&(o.name=i),o})},n.prototype.estimateFaces=function(e,t){return ys(this,void 0,void 0,function(){var r,s;return xs(this,function(o){switch(o.label){case 0:return t&&t.flipHorizontal&&t.flipHorizontal!==this.selfieMode&&(this.selfieMode=t.flipHorizontal,this.faceMeshSolution.setOptions({selfieMode:this.selfieMode})),e instanceof Rt?(s=ImageData.bind,[4,V1(e)]):[3,2];case 1:return r=new(s.apply(ImageData,[void 0,o.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:r=e,o.label=3;case 3:return e=r,[4,this.faceMeshSolution.send({image:e})];case 4:return o.sent(),[2,this.faces]}})})},n.prototype.dispose=function(){this.faceMeshSolution.close()},n.prototype.reset=function(){this.faceMeshSolution.reset(),this.width=0,this.height=0,this.faces=null,this.selfieMode=!1},n.prototype.initialize=function(){return this.faceMeshSolution.initialize()},n}();function tO(n){return ys(this,void 0,void 0,function(){var e,t;return xs(this,function(r){switch(r.label){case 0:return e=function(s){if(s==null)return Lr({},zu);var o=Lr({},s);return o.runtime="mediapipe",o.maxFaces==null&&(o.maxFaces=zu.maxFaces),o.refineLandmarks==null&&(o.refineLandmarks=zu.refineLandmarks),o}(n),[4,(t=new eO(e)).initialize()];case 1:return r.sent(),[2,t]}})})}var Gu=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},nO={};(function(){var n;function e(y){var E=0;return function(){return E<y.length?{done:!1,value:y[E++]}:{done:!0}}}var t=typeof Object.defineProperties=="function"?Object.defineProperty:function(y,E,R){return y==Array.prototype||y==Object.prototype||(y[E]=R.value),y},r=function(y){y=[typeof globalThis=="object"&&globalThis,y,typeof window=="object"&&window,typeof self=="object"&&self,typeof Gu=="object"&&Gu];for(var E=0;E<y.length;++E){var R=y[E];if(R&&R.Math==Math)return R}throw Error("Cannot find global object")}(this);function s(y,E){if(E)e:{var R=r;y=y.split(".");for(var D=0;D<y.length-1;D++){var U=y[D];if(!(U in R))break e;R=R[U]}(E=E(D=R[y=y[y.length-1]]))!=D&&E!=null&&t(R,y,{configurable:!0,writable:!0,value:E})}}function o(y){return(y={next:y})[Symbol.iterator]=function(){return this},y}function i(y){var E=typeof Symbol<"u"&&Symbol.iterator&&y[Symbol.iterator];return E?E.call(y):{next:e(y)}}function a(y){if(!(y instanceof Array)){y=i(y);for(var E,R=[];!(E=y.next()).done;)R.push(E.value);y=R}return y}s("Symbol",function(y){function E(U,V){this.g=U,t(this,"description",{configurable:!0,writable:!0,value:V})}if(y)return y;E.prototype.toString=function(){return this.g};var R="jscomp_symbol_"+(1e9*Math.random()>>>0)+"_",D=0;return function U(V){if(this instanceof U)throw new TypeError("Symbol is not a constructor");return new E(R+(V||"")+"_"+D++,V)}}),s("Symbol.iterator",function(y){if(y)return y;y=Symbol("Symbol.iterator");for(var E="Array Int8Array Uint8Array Uint8ClampedArray Int16Array Uint16Array Int32Array Uint32Array Float32Array Float64Array".split(" "),R=0;R<E.length;R++){var D=r[E[R]];typeof D=="function"&&typeof D.prototype[y]!="function"&&t(D.prototype,y,{configurable:!0,writable:!0,value:function(){return o(e(this))}})}return y});var u,c=typeof Object.create=="function"?Object.create:function(y){function E(){}return E.prototype=y,new E};if(typeof Object.setPrototypeOf=="function")u=Object.setPrototypeOf;else{var l;e:{var h={};try{h.__proto__={a:!0},l=h.a;break e}catch{}l=!1}u=l?function(y,E){if(y.__proto__=E,y.__proto__!==E)throw new TypeError(y+" is not extensible");return y}:null}var d=u;function m(y,E){if(y.prototype=c(E.prototype),y.prototype.constructor=y,d)d(y,E);else for(var R in E)if(R!="prototype")if(Object.defineProperties){var D=Object.getOwnPropertyDescriptor(E,R);D&&Object.defineProperty(y,R,D)}else y[R]=E[R];y.na=E.prototype}function g(){this.l=!1,this.i=null,this.h=void 0,this.g=1,this.u=this.o=0,this.j=null}function C(y){if(y.l)throw new TypeError("Generator is already running");y.l=!0}function $(y,E){y.j={da:E,ea:!0},y.g=y.o||y.u}function T(y,E,R){return y.g=R,{value:E}}function A(y){this.g=new g,this.h=y}function P(y,E,R,D){try{var U=E.call(y.g.i,R);if(!(U instanceof Object))throw new TypeError("Iterator result "+U+" is not an object");if(!U.done)return y.g.l=!1,U;var V=U.value}catch(G){return y.g.i=null,$(y.g,G),B(y)}return y.g.i=null,D.call(y.g,V),B(y)}function B(y){for(;y.g.g;)try{var E=y.h(y.g);if(E)return y.g.l=!1,{value:E.value,done:!1}}catch(R){y.g.h=void 0,$(y.g,R)}if(y.g.l=!1,y.g.j){if(E=y.g.j,y.g.j=null,E.ea)throw E.da;return{value:E.return,done:!0}}return{value:void 0,done:!0}}function H(y){this.next=function(E){return C(y.g),y.g.i?E=P(y,y.g.i.next,E,y.g.s):(y.g.s(E),E=B(y)),E},this.throw=function(E){return C(y.g),y.g.i?E=P(y,y.g.i.throw,E,y.g.s):($(y.g,E),E=B(y)),E},this.return=function(E){return function(R,D){C(R.g);var U=R.g.i;return U?P(R,"return"in U?U.return:function(V){return{value:V,done:!0}},D,R.g.return):(R.g.return(D),B(R))}(y,E)},this[Symbol.iterator]=function(){return this}}function x(y){return function(E){function R(U){return E.next(U)}function D(U){return E.throw(U)}return new Promise(function(U,V){(function G(K){K.done?U(K.value):Promise.resolve(K.value).then(R,D).then(G,V)})(E.next())})}(new H(new A(y)))}g.prototype.s=function(y){this.h=y},g.prototype.return=function(y){this.j={return:y},this.g=this.u},s("Promise",function(y){function E(G){this.h=0,this.i=void 0,this.g=[],this.s=!1;var K=this.j();try{G(K.resolve,K.reject)}catch(te){K.reject(te)}}function R(){this.g=null}function D(G){return G instanceof E?G:new E(function(K){K(G)})}if(y)return y;R.prototype.h=function(G){if(this.g==null){this.g=[];var K=this;this.i(function(){K.l()})}this.g.push(G)};var U=r.setTimeout;R.prototype.i=function(G){U(G,0)},R.prototype.l=function(){for(;this.g&&this.g.length;){var G=this.g;this.g=[];for(var K=0;K<G.length;++K){var te=G[K];G[K]=null;try{te()}catch(fe){this.j(fe)}}}this.g=null},R.prototype.j=function(G){this.i(function(){throw G})},E.prototype.j=function(){function G(fe){return function(ge){te||(te=!0,fe.call(K,ge))}}var K=this,te=!1;return{resolve:G(this.D),reject:G(this.l)}},E.prototype.D=function(G){if(G===this)this.l(new TypeError("A Promise cannot resolve to itself"));else if(G instanceof E)this.H(G);else{e:switch(typeof G){case"object":var K=G!=null;break e;case"function":K=!0;break e;default:K=!1}K?this.A(G):this.o(G)}},E.prototype.A=function(G){var K=void 0;try{K=G.then}catch(te){return void this.l(te)}typeof K=="function"?this.I(K,G):this.o(G)},E.prototype.l=function(G){this.u(2,G)},E.prototype.o=function(G){this.u(1,G)},E.prototype.u=function(G,K){if(this.h!=0)throw Error("Cannot settle("+G+", "+K+"): Promise already settled in state"+this.h);this.h=G,this.i=K,this.h===2&&this.G(),this.B()},E.prototype.G=function(){var G=this;U(function(){if(G.C()){var K=r.console;K!==void 0&&K.error(G.i)}},1)},E.prototype.C=function(){if(this.s)return!1;var G=r.CustomEvent,K=r.Event,te=r.dispatchEvent;return te===void 0||(typeof G=="function"?G=new G("unhandledrejection",{cancelable:!0}):typeof K=="function"?G=new K("unhandledrejection",{cancelable:!0}):(G=r.document.createEvent("CustomEvent")).initCustomEvent("unhandledrejection",!1,!0,G),G.promise=this,G.reason=this.i,te(G))},E.prototype.B=function(){if(this.g!=null){for(var G=0;G<this.g.length;++G)V.h(this.g[G]);this.g=null}};var V=new R;return E.prototype.H=function(G){var K=this.j();G.M(K.resolve,K.reject)},E.prototype.I=function(G,K){var te=this.j();try{G.call(K,te.resolve,te.reject)}catch(fe){te.reject(fe)}},E.prototype.then=function(G,K){function te(Te,Ee){return typeof Te=="function"?function(f){try{fe(Te(f))}catch(p){ge(p)}}:Ee}var fe,ge,we=new E(function(Te,Ee){fe=Te,ge=Ee});return this.M(te(G,fe),te(K,ge)),we},E.prototype.catch=function(G){return this.then(void 0,G)},E.prototype.M=function(G,K){function te(){switch(fe.h){case 1:G(fe.i);break;case 2:K(fe.i);break;default:throw Error("Unexpected state: "+fe.h)}}var fe=this;this.g==null?V.h(te):this.g.push(te),this.s=!0},E.resolve=D,E.reject=function(G){return new E(function(K,te){te(G)})},E.race=function(G){return new E(function(K,te){for(var fe=i(G),ge=fe.next();!ge.done;ge=fe.next())D(ge.value).M(K,te)})},E.all=function(G){var K=i(G),te=K.next();return te.done?D([]):new E(function(fe,ge){function we(f){return function(p){Te[f]=p,--Ee==0&&fe(Te)}}var Te=[],Ee=0;do Te.push(void 0),Ee++,D(te.value).M(we(Te.length-1),ge),te=K.next();while(!te.done)})},E});var re=typeof Object.assign=="function"?Object.assign:function(y,E){for(var R=1;R<arguments.length;R++){var D=arguments[R];if(D)for(var U in D)Object.prototype.hasOwnProperty.call(D,U)&&(y[U]=D[U])}return y};s("Object.assign",function(y){return y||re}),s("Object.is",function(y){return y||function(E,R){return E===R?E!==0||1/E==1/R:E!=E&&R!=R}}),s("Array.prototype.includes",function(y){return y||function(E,R){var D=this;D instanceof String&&(D=String(D));var U=D.length;for(0>(R=R||0)&&(R=Math.max(R+U,0));R<U;R++){var V=D[R];if(V===E||Object.is(V,E))return!0}return!1}}),s("String.prototype.includes",function(y){return y||function(E,R){if(this==null)throw new TypeError("The 'this' value for String.prototype.includes must not be null or undefined");if(E instanceof RegExp)throw new TypeError("First argument to String.prototype.includes must not be a regular expression");return this.indexOf(E,R||0)!==-1}}),s("Array.prototype.keys",function(y){return y||function(){return function(E,R){E instanceof String&&(E+="");var D=0,U=!1,V={next:function(){if(!U&&D<E.length){var G=D++;return{value:R(G,E[G]),done:!1}}return U=!0,{done:!0,value:void 0}}};return V[Symbol.iterator]=function(){return V},V}(this,function(E){return E})}});var oe=this||self;function ie(y,E){y=y.split(".");var R,D=oe;for((y[0]in D)||D.execScript===void 0||D.execScript("var "+y[0]);y.length&&(R=y.shift());)y.length||E===void 0?D=D[R]&&D[R]!==Object.prototype[R]?D[R]:D[R]={}:D[R]=E}function le(){throw Error("Invalid UTF8")}function $e(y,E){return E=String.fromCharCode.apply(null,E),y==null?E:y+E}var Ie,Ae,Ge=typeof TextDecoder<"u",Ye=typeof TextEncoder<"u",at={},ut=null;function lt(y){var E;E===void 0&&(E=0),an(),E=at[E];for(var R=Array(Math.floor(y.length/3)),D=E[64]||"",U=0,V=0;U<y.length-2;U+=3){var G=y[U],K=y[U+1],te=y[U+2],fe=E[G>>2];G=E[(3&G)<<4|K>>4],K=E[(15&K)<<2|te>>6],te=E[63&te],R[V++]=fe+G+K+te}switch(fe=0,te=D,y.length-U){case 2:te=E[(15&(fe=y[U+1]))<<2]||D;case 1:y=y[U],R[V]=E[y>>2]+E[(3&y)<<4|fe>>4]+te+D}return R.join("")}function Dt(y){var E=y.length,R=3*E/4;R%3?R=Math.floor(R):"=.".indexOf(y[E-1])!=-1&&(R="=.".indexOf(y[E-2])!=-1?R-2:R-1);var D=new Uint8Array(R),U=0;return function(V,G){function K(Ee){for(;te<V.length;){var f=V.charAt(te++),p=ut[f];if(p!=null)return p;if(!/^[\s\xa0]*$/.test(f))throw Error("Unknown base64 encoding at char: "+f)}return Ee}an();for(var te=0;;){var fe=K(-1),ge=K(0),we=K(64),Te=K(64);if(Te===64&&fe===-1)break;G(fe<<2|ge>>4),we!=64&&(G(ge<<4&240|we>>2),Te!=64&&G(we<<6&192|Te))}}(y,function(V){D[U++]=V}),U!==R?D.subarray(0,U):D}function an(){if(!ut){ut={};for(var y="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789".split(""),E=["+/=","+/","-_=","-_.","-_"],R=0;5>R;R++){var D=y.concat(E[R].split(""));at[R]=D;for(var U=0;U<D.length;U++){var V=D[U];ut[V]===void 0&&(ut[V]=U)}}}}var gt,vr=typeof Uint8Array=="function";function dn(y){return vr&&y!=null&&y instanceof Uint8Array}function wr(y){if(this.L=y,y!==null&&y.length===0)throw Error("ByteString should be constructed with non-empty values")}var Cr=typeof Uint8Array.prototype.slice=="function",En=0;function os(y,E){return Error("Invalid wire type: "+y+" (at position "+E+")")}function Tr(){return Error("Failed to read varint, encoding is invalid.")}function Vt(y,E){E=(E=E===void 0?{}:E).v!==void 0&&E.v,this.h=null,this.g=this.i=this.j=0,this.v=E,y&&Rn(this,y)}function Rn(y,E){y.h=function(R,D){if(R.constructor===Uint8Array)return R;if(R.constructor===ArrayBuffer)return new Uint8Array(R);if(R.constructor===Array)return new Uint8Array(R);if(R.constructor===String)return Dt(R);if(R.constructor===wr)return!D&&(D=R.L)&&D.constructor===Uint8Array?D:(D=(D=R.L)==null||dn(D)?D:typeof D=="string"?Dt(D):null,(R=R.L=D)?new Uint8Array(R):gt||(gt=new Uint8Array(0)));if(R instanceof Uint8Array)return new Uint8Array(R.buffer,R.byteOffset,R.byteLength);throw Error("Type not convertible to a Uint8Array, expected a Uint8Array, an ArrayBuffer, a base64 encoded string, or Array of numbers")}(E,y.v),y.j=0,y.i=y.h.length,y.g=y.j}function kt(y){if(y.g>y.i)throw Error("Tried to read past the end of the data "+y.g+" > "+y.i)}function Ur(y){var E=y.h,R=E[y.g],D=127&R;if(128>R)return y.g+=1,kt(y),D;if(D|=(127&(R=E[y.g+1]))<<7,128>R)return y.g+=2,kt(y),D;if(D|=(127&(R=E[y.g+2]))<<14,128>R)return y.g+=3,kt(y),D;if(D|=(127&(R=E[y.g+3]))<<21,128>R)return y.g+=4,kt(y),D;if(R=E[y.g+4],y.g+=5,D|=(15&R)<<28,128>R)return kt(y),D;if(128<=E[y.g++]&&128<=E[y.g++]&&128<=E[y.g++]&&128<=E[y.g++]&&128<=E[y.g++])throw Tr();return kt(y),D}Vt.prototype.reset=function(){this.g=this.j};var Jt=[];function tr(){this.g=[]}function en(y,E){for(;127<E;)y.g.push(127&E|128),E>>>=7;y.g.push(E)}function Fe(y){var E={},R=E.W!==void 0&&E.W;this.l={v:E.v!==void 0&&E.v},this.W=R,E=this.l,Jt.length?(R=Jt.pop(),E&&(R.v=E.v),y&&Rn(R,y),y=R):y=new Vt(y,E),this.g=y,this.j=this.g.g,this.h=this.i=-1}function Ft(y){var E=y.g;if(E.g==E.i)return!1;y.j=y.g.g;var R=Ur(y.g)>>>0;if(E=R>>>3,!(0<=(R&=7)&&5>=R))throw os(R,y.j);if(1>E)throw Error("Invalid field number: "+E+" (at position "+y.j+")");return y.i=E,y.h=R,!0}function pn(y){switch(y.h){case 0:if(y.h!=0)pn(y);else e:{for(var E=(y=y.g).g,R=E+10;E<R;)if((128&y.h[E++])==0){y.g=E,kt(y);break e}throw Tr()}break;case 1:(y=y.g).g+=8,kt(y);break;case 2:y.h!=2?pn(y):(E=Ur(y.g)>>>0,(y=y.g).g+=E,kt(y));break;case 5:(y=y.g).g+=4,kt(y);break;case 3:for(E=y.i;;){if(!Ft(y))throw Error("Unmatched start-group tag: stream EOF");if(y.h==4){if(y.i!=E)throw Error("Unmatched end-group tag");break}pn(y)}break;default:throw os(y.h,y.j)}}tr.prototype.length=function(){return this.g.length},tr.prototype.end=function(){var y=this.g;return this.g=[],y},Fe.prototype.reset=function(){this.g.reset(),this.j=this.g.g,this.h=this.i=-1};var Vn=[];function ks(){this.i=[],this.h=0,this.g=new tr}function Ut(y,E){E.length!==0&&(y.i.push(E),y.h+=E.length)}var Wr=typeof Symbol=="function"&&typeof Symbol()=="symbol"?Symbol(void 0):void 0;function $r(y,E){Object.isFrozen(y)||(Wr?y[Wr]|=E:y.N!==void 0?y.N|=E:Object.defineProperties(y,{N:{value:E,configurable:!0,writable:!0,enumerable:!1}}))}function kn(y){var E;return(E=Wr?y[Wr]:y.N)==null?0:E}function un(y){return $r(y,1),y}function Ht(y){return!!Array.isArray(y)&&!!(2&kn(y))}function is(y){if(!Array.isArray(y))throw Error("cannot mark non-array as immutable");$r(y,2)}function qt(y){return y!==null&&typeof y=="object"&&!Array.isArray(y)&&y.constructor===Object}var zr=Object.freeze(un([]));function Is(y){if(Ht(y.m))throw Error("Cannot mutate an immutable Message")}var Qs,Sr=typeof Symbol<"u"&&Symbol.hasInstance!==void 0;function Gr(y){return{value:y,configurable:!1,writable:!1,enumerable:!1}}function Wt(y,E,R){return E===-1?null:E>=y.i?y.g?y.g[E]:void 0:R!==void 0&&R&&y.g&&(R=y.g[E])!=null?R:y.m[E+y.h]}function Et(y,E,R,D){D=D!==void 0&&D,Is(y),E<y.i&&!D?y.m[E+y.h]=R:(y.g||(y.g=y.m[y.i+y.h]={}))[E]=R}function st(y,E,R,D){R=R===void 0||R;var U=Wt(y,E,D=D!==void 0&&D);return U==null&&(U=zr),Ht(y.m)?R&&(is(U),Object.freeze(U)):(U===zr||Ht(U))&&Et(y,E,U=un(U.slice()),D),U}function ht(y,E,R){return(y=(y=Wt(y,E))==null?y:+y)==null?R===void 0?0:R:y}function Nr(y,E,R,D){y.j||(y.j={});var U=Ht(y.m),V=y.j[R];if(!V){D=st(y,R,!0,D!==void 0&&D),V=[],U=U||Ht(D);for(var G=0;G<D.length;G++)V[G]=new E(D[G]),U&&is(V[G].m);U&&(is(V),Object.freeze(V)),y.j[R]=V}return V}function dt(y,E,R,D,U){var V=V!==void 0&&V;return Is(y),V=Nr(y,R,E,V),R=D||new R,y=st(y,E),U!=null?(V.splice(U,0,R),y.splice(U,0,R.m)):(V.push(R),y.push(R.m)),R}function jr(y,E){return(y=Wt(y,E))==null?0:y}function _s(y,E){return(y=Wt(y,E))==null?"":y}function cn(y){var E=Vo;return Qe(y,E=E===void 0?Hr:E)}function zt(y,E){if(y!=null){if(Array.isArray(y))y=Qe(y,E);else if(qt(y)){var R,D={};for(R in y)D[R]=zt(y[R],E);y=D}else y=E(y);return y}}function Qe(y,E){for(var R=y.slice(),D=0;D<R.length;D++)R[D]=zt(R[D],E);return Array.isArray(y)&&1&kn(y)&&un(R),R}function Vo(y){return y&&typeof y=="object"&&y.toJSON?y.toJSON():(y=function(E){switch(typeof E){case"number":return isFinite(E)?E:String(E);case"object":if(E&&!Array.isArray(E)){if(dn(E))return lt(E);if(E instanceof wr){var R=E.L;return R=R==null||typeof R=="string"?R:vr&&R instanceof Uint8Array?lt(R):null,(E.L=R)||""}}}return E}(y),Array.isArray(y)?cn(y):y)}function Hr(y){return dn(y)?new Uint8Array(y):y}function nr(y,E,R){y||(y=Qs),Qs=null;var D=this.constructor.h;if(y||(y=D?[D]:[]),this.h=(D?0:-1)-(this.constructor.g||0),this.j=void 0,this.m=y,y=(D=this.m.length)-1,D&&qt(D=this.m[y])?(this.i=y-this.h,this.g=D):E!==void 0&&-1<E?(this.i=Math.max(E,y+1-this.h),this.g=void 0):this.i=Number.MAX_VALUE,R)for(E=0;E<R.length;E++)if((y=R[E])<this.i)y+=this.h,(D=this.m[y])?Array.isArray(D)&&un(D):this.m[y]=zr;else{var U=(D=this.g||(this.g=this.m[this.i+this.h]={}))[y];U?Array.isArray(U)&&un(U):D[y]=zr}}function as(){nr.apply(this,arguments)}if(nr.prototype.toJSON=function(){return cn(this.m)},nr.prototype.toString=function(){return this.m.toString()},m(as,nr),Sr){var rr={};Object.defineProperties(as,(rr[Symbol.hasInstance]=Gr(function(){throw Error("Cannot perform instanceof checks for MutableMessage")}),rr))}function Rs(y,E,R){if(R){var D,U={};for(D in R){var V=R[D],G=V.ha;G||(U.F=V.la||V.fa.P,V.aa?(U.U=Zs(V.aa),G=function(K){return function(te,fe,ge){return K.F(te,fe,ge,K.U)}}(U)):V.ca?(U.T=qr(V.X.g,V.ca),G=function(K){return function(te,fe,ge){return K.F(te,fe,ge,K.T)}}(U)):G=U.F,V.ha=G),G(E,y,V.X),U={F:U.F,U:U.U,T:U.T}}}(function(K,te){if(te=te.ba){Ut(K,K.g.end());for(var fe=0;fe<te.length;fe++)Ut(K,te[fe])}})(E,y)}var mn=Symbol();function sr(y,E,R){return y[mn]||(y[mn]=function(D,U){return E(D,U,R)})}function Uo(y){var E=y[mn];if(!E){var R=Xo(y);E=function(D,U){return cs(D,U,R)},y[mn]=E}return E}function Wo(y){var E=function(U){var V=U.aa;return V?Uo(V):(V=U.ka)?sr(U.X.g,V,U.ca):void 0}(y),R=y.X,D=y.fa.O;return E?function(U,V){return D(U,V,R,E)}:function(U,V){return D(U,V,R)}}function Gt(y,E,R,D,U,V){var G=0;for((y=y()).length&&typeof y[0]!="number"&&(R(E,y[0]),G++);G<y.length;){R=y[G++];for(var K=G+1;K<y.length&&typeof y[K]!="number";)K++;var te=y[G++];switch(K-=G){case 0:D(E,R,te);break;case 1:D(E,R,te,y[G++]);break;case 2:U(E,R,te,y[G++],y[G++]);break;case 3:K=y[G++];var fe=y[G++],ge=y[G++];Array.isArray(ge)?U(E,R,te,K,fe,ge):V(E,R,te,K,fe,ge);break;case 4:V(E,R,te,y[G++],y[G++],y[G++],y[G++]);break;default:throw Error("unexpected number of binary field arguments: "+K)}}return E}var ln=Symbol();function Zs(y){var E=y[ln];if(!E){var R=jo(y);E=function(D,U){return to(D,U,R)},y[ln]=E}return E}function qr(y,E){var R=y[ln];return R||(R=function(D,U){return Rs(D,U,E)},y[ln]=R),R}var As=Symbol();function Un(y,E){y.push(E)}function zo(y,E,R){y.push(E,R.P)}function Go(y,E,R,D,U){var V=Zs(U),G=R.P;y.push(E,function(K,te,fe){return G(K,te,fe,D,V)})}function Js(y,E,R,D,U,V){var G=qr(D,V),K=R.P;y.push(E,function(te,fe,ge){return K(te,fe,ge,D,G)})}function jo(y){var E=y[As];return E||Gt(y,y[As]=[],Un,zo,Go,Js)}var or=Symbol();function ir(y,E){y[0]=E}function Ho(y,E,R,D){var U=R.O;y[E]=D?function(V,G,K){return U(V,G,K,D)}:U}function qo(y,E,R,D,U,V){var G=R.O,K=Uo(U);y[E]=function(te,fe,ge){return G(te,fe,ge,D,K,V)}}function us(y,E,R,D,U,V,G){var K=R.O,te=sr(D,U,V);y[E]=function(fe,ge,we){return K(fe,ge,we,D,te,G)}}function Xo(y){var E=y[or];return E||Gt(y,y[or]={},ir,Ho,qo,us)}function cs(y,E,R){for(;Ft(E)&&E.h!=4;){var D=E.i,U=R[D];if(!U){var V=R[0];V&&(V=V[D])&&(U=R[D]=Wo(V))}if(!(U&&U(E,y,D)||(U=E,D=y,V=U.j,pn(U),U.W))){var G=U.g.h;U=V===(U=U.g.g)?gt||(gt=new Uint8Array(0)):Cr?G.slice(V,U):new Uint8Array(G.subarray(V,U)),(V=D.ba)?V.push(U):D.ba=[U]}}return y}function eo(y,E,R){if(Vn.length){var D=Vn.pop();y&&(Rn(D.g,y),D.i=-1,D.h=-1),y=D}else y=new Fe(y);try{return cs(new E,y,Xo(R))}finally{(E=y.g).h=null,E.j=0,E.i=0,E.g=0,E.v=!1,y.i=-1,y.h=-1,100>Vn.length&&Vn.push(y)}}function to(y,E,R){for(var D=R.length,U=D%2==1,V=U?1:0;V<D;V+=2)(0,R[V+1])(E,y,R[V]);Rs(y,E,U?R[0]:void 0)}function Xr(y,E){var R=new ks;to(y,R,jo(E)),Ut(R,R.g.end()),y=new Uint8Array(R.h);for(var D=(E=R.i).length,U=0,V=0;V<D;V++){var G=E[V];y.set(G,U),U+=G.length}return R.i=[y],y}function Er(y,E){return{O:y,P:E}}var hn=Er(function(y,E,R){if(y.h!==5)return!1;var D=(y=y.g).h[y.g],U=y.h[y.g+1],V=y.h[y.g+2],G=y.h[y.g+3];return y.g+=4,kt(y),y=2*((U=(D<<0|U<<8|V<<16|G<<24)>>>0)>>31)+1,D=U>>>23&255,U&=8388607,Et(E,R,D==255?U?NaN:1/0*y:D==0?y*Math.pow(2,-149)*U:y*Math.pow(2,D-150)*(U+Math.pow(2,23))),!0},function(y,E,R){if((E=Wt(E,R))!=null){en(y.g,8*R+5),y=y.g;var D=E;(D=(R=0>D?1:0)?-D:D)===0?0<1/D?En=0:En=2147483648:isNaN(D)?En=2147483647:34028234663852886e22<D?En=(R<<31|2139095040)>>>0:11754943508222875e-54>D?(D=Math.round(D/Math.pow(2,-149)),En=(R<<31|D)>>>0):(E=Math.floor(Math.log(D)/Math.LN2),D*=Math.pow(2,-E),16777216<=(D=Math.round(8388608*D))&&++E,En=(R<<31|E+127<<23|8388607&D)>>>0),R=En,y.g.push(R>>>0&255),y.g.push(R>>>8&255),y.g.push(R>>>16&255),y.g.push(R>>>24&255)}}),Ko=Er(function(y,E,R){if(y.h!==0)return!1;for(var D=y.g,U=128,V=0,G=y=0;4>G&&128<=U;G++)U=D.h[D.g++],kt(D),V|=(127&U)<<7*G;if(128<=U&&(U=D.h[D.g++],kt(D),V|=(127&U)<<28,y|=(127&U)>>4),128<=U)for(G=0;5>G&&128<=U;G++)U=D.h[D.g++],kt(D),y|=(127&U)<<7*G+3;if(!(128>U))throw Tr();return D=V>>>0,(y=2147483648&(U=y>>>0))&&(U=~U>>>0,(D=1+~D>>>0)==0&&(U=U+1>>>0)),D=4294967296*U+(D>>>0),Et(E,R,y?-D:D),!0},function(y,E,R){if((E=Wt(E,R))!=null&&E!=null){en(y.g,8*R),y=y.g;var D=E;for(R=0>D,E=(D=Math.abs(D))>>>0,D=Math.floor((D-E)/4294967296),D>>>=0,R&&(D=~D>>>0,4294967295<(E=1+(~E>>>0))&&(E=0,4294967295<++D&&(D=0))),R=En=E,E=D;0<E||127<R;)y.g.push(127&R|128),R=(R>>>7|E<<25)>>>0,E>>>=7;y.g.push(R)}}),tn=Er(function(y,E,R){return y.h===0&&(Et(E,R,Ur(y.g)),!0)},function(y,E,R){if((E=Wt(E,R))!=null&&E!=null)if(en(y.g,8*R),y=y.g,0<=(R=E))en(y,R);else{for(E=0;9>E;E++)y.g.push(127&R|128),R>>=7;y.g.push(1)}}),kr=Er(function(y,E,R){if(y.h!==2)return!1;var D,U=Ur(y.g)>>>0,V=(y=y.g).g;if(y.g+=U,kt(y),y=y.h,Ge)(D=Ie)||(D=Ie=new TextDecoder("utf-8",{fatal:!0})),D=D.decode(y.subarray(V,V+U));else{U=V+U;for(var G,K,te,fe=[],ge=null;V<U;)128>(G=y[V++])?fe.push(G):224>G?V>=U?le():(K=y[V++],194>G||(192&K)!=128?(V--,le()):fe.push((31&G)<<6|63&K)):240>G?V>=U-1?le():(192&(K=y[V++]))!=128||G===224&&160>K||G===237&&160<=K||(192&(D=y[V++]))!=128?(V--,le()):fe.push((15&G)<<12|(63&K)<<6|63&D):244>=G?V>=U-2?le():(192&(K=y[V++]))!=128||K-144+(G<<28)>>30!=0||(192&(D=y[V++]))!=128||(192&(te=y[V++]))!=128?(V--,le()):(G=(7&G)<<18|(63&K)<<12|(63&D)<<6|63&te,G-=65536,fe.push(55296+(G>>10&1023),56320+(1023&G))):le(),8192<=fe.length&&(ge=$e(ge,fe),fe.length=0);D=$e(ge,fe)}return Et(E,R,D),!0},function(y,E,R){if((E=Wt(E,R))!=null){var D=!1;if(D=D!==void 0&&D,Ye){if(D&&/(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])/.test(E))throw Error("Found an unpaired surrogate");E=(Ae||(Ae=new TextEncoder)).encode(E)}else{for(var U=0,V=new Uint8Array(3*E.length),G=0;G<E.length;G++){var K=E.charCodeAt(G);if(128>K)V[U++]=K;else{if(2048>K)V[U++]=K>>6|192;else{if(55296<=K&&57343>=K){if(56319>=K&&G<E.length){var te=E.charCodeAt(++G);if(56320<=te&&57343>=te){K=1024*(K-55296)+te-56320+65536,V[U++]=K>>18|240,V[U++]=K>>12&63|128,V[U++]=K>>6&63|128,V[U++]=63&K|128;continue}G--}if(D)throw Error("Found an unpaired surrogate");K=65533}V[U++]=K>>12|224,V[U++]=K>>6&63|128}V[U++]=63&K|128}}E=V.subarray(0,U)}en(y.g,8*R+2),en(y.g,E.length),Ut(y,y.g.end()),Ut(y,E)}}),Kr=Er(function(y,E,R,D,U){if(y.h!==2)return!1;E=dt(E,R,D),R=y.g.i,D=Ur(y.g)>>>0;var V=y.g.g+D,G=V-R;if(0>=G&&(y.g.i=V,U(E,y),G=V-y.g.g),G)throw Error("Message parsing ended unexpectedly. Expected to read "+D+" bytes, instead read "+(D-G)+" bytes, either the data ended unexpectedly or the message misreported its own length");return y.g.g=V,y.g.i=R,!0},function(y,E,R,D,U){if((E=Nr(E,D,R))!=null)for(D=0;D<E.length;D++){var V=y;en(V.g,8*R+2);var G=V.g.end();Ut(V,G),G.push(V.h),V=G,U(E[D],y),G=y;var K=V.pop();for(K=G.h+G.g.length()-K;127<K;)V.push(127&K|128),K>>>=7,G.h++;V.push(K),G.h++}});function gn(){as.apply(this,arguments)}if(m(gn,as),Sr){var Yo={};Object.defineProperties(gn,(Yo[Symbol.hasInstance]=Gr(Object[Symbol.hasInstance]),Yo))}function Wn(y){gn.call(this,y)}function no(){return[1,tn,2,hn,3,kr,4,kr]}function Yr(y){gn.call(this,y,-1,Ri)}function Qo(){return[1,Kr,Wn,no]}m(Wn,gn),m(Yr,gn),Yr.prototype.addClassification=function(y,E){return dt(this,1,Wn,y,E),this};var Ri=[1];function Qr(y){gn.call(this,y)}function yn(){return[1,hn,2,hn,3,hn,4,hn,5,hn]}function ro(y){gn.call(this,y,-1,Ai)}function ls(){return[1,Kr,Qr,yn]}m(Qr,gn),m(ro,gn);var Ai=[1];function so(y){gn.call(this,y)}function zn(){return[1,hn,2,hn,3,hn,4,hn,5,hn,6,Ko]}m(so,gn);var Gn=[[61,146],[146,91],[91,181],[181,84],[84,17],[17,314],[314,405],[405,321],[321,375],[375,291],[61,185],[185,40],[40,39],[39,37],[37,0],[0,267],[267,269],[269,270],[270,409],[409,291],[78,95],[95,88],[88,178],[178,87],[87,14],[14,317],[317,402],[402,318],[318,324],[324,308],[78,191],[191,80],[80,81],[81,82],[82,13],[13,312],[312,311],[311,310],[310,415],[415,308]],hs=[[263,249],[249,390],[390,373],[373,374],[374,380],[380,381],[381,382],[382,362],[263,466],[466,388],[388,387],[387,386],[386,385],[385,384],[384,398],[398,362]],oo=[[276,283],[283,282],[282,295],[295,285],[300,293],[293,334],[334,296],[296,336]],Os=[[33,7],[7,163],[163,144],[144,145],[145,153],[153,154],[154,155],[155,133],[33,246],[246,161],[161,160],[160,159],[159,158],[158,157],[157,173],[173,133]],Ds=[[46,53],[53,52],[52,65],[65,55],[70,63],[63,105],[105,66],[66,107]],Zr=[[10,338],[338,297],[297,332],[332,284],[284,251],[251,389],[389,356],[356,454],[454,323],[323,361],[361,288],[288,397],[397,365],[365,379],[379,378],[378,400],[400,377],[377,152],[152,148],[148,176],[176,149],[149,150],[150,136],[136,172],[172,58],[58,132],[132,93],[93,234],[234,127],[127,162],[162,21],[21,54],[54,103],[103,67],[67,109],[109,10]],io=[].concat(a(Gn),a(hs),a(oo),a(Os),a(Ds),a(Zr));function v(y,E,R){if(R=y.createShader(R===0?y.VERTEX_SHADER:y.FRAGMENT_SHADER),y.shaderSource(R,E),y.compileShader(R),!y.getShaderParameter(R,y.COMPILE_STATUS))throw Error(`Could not compile WebGL shader.

`+y.getShaderInfoLog(R));return R}function S(y){return Nr(y,Wn,1).map(function(E){return{index:jr(E,1),ga:ht(E,2),label:Wt(E,3)!=null?_s(E,3):void 0,displayName:Wt(E,4)!=null?_s(E,4):void 0}})}function k(y){return{x:ht(y,1),y:ht(y,2),z:ht(y,3),visibility:Wt(y,4)!=null?ht(y,4):void 0}}function W(y,E){this.h=y,this.g=E,this.l=0}function ee(y,E,R){return function(D,U){var V=D.g;if(D.o===void 0){var G=v(V,`
  attribute vec2 aVertex;
  attribute vec2 aTex;
  varying vec2 vTex;
  void main(void) {
    gl_Position = vec4(aVertex, 0.0, 1.0);
    vTex = aTex;
  }`,0),K=v(V,`
  precision mediump float;
  varying vec2 vTex;
  uniform sampler2D sampler0;
  void main(){
    gl_FragColor = texture2D(sampler0, vTex);
  }`,1),te=V.createProgram();if(V.attachShader(te,G),V.attachShader(te,K),V.linkProgram(te),!V.getProgramParameter(te,V.LINK_STATUS))throw Error(`Could not compile WebGL program.

`+V.getProgramInfoLog(te));G=D.o=te,V.useProgram(G),K=V.getUniformLocation(G,"sampler0"),D.j={K:V.getAttribLocation(G,"aVertex"),J:V.getAttribLocation(G,"aTex"),ma:K},D.u=V.createBuffer(),V.bindBuffer(V.ARRAY_BUFFER,D.u),V.enableVertexAttribArray(D.j.K),V.vertexAttribPointer(D.j.K,2,V.FLOAT,!1,0,0),V.bufferData(V.ARRAY_BUFFER,new Float32Array([-1,-1,-1,1,1,1,1,-1]),V.STATIC_DRAW),V.bindBuffer(V.ARRAY_BUFFER,null),D.s=V.createBuffer(),V.bindBuffer(V.ARRAY_BUFFER,D.s),V.enableVertexAttribArray(D.j.J),V.vertexAttribPointer(D.j.J,2,V.FLOAT,!1,0,0),V.bufferData(V.ARRAY_BUFFER,new Float32Array([0,1,0,0,1,0,1,1]),V.STATIC_DRAW),V.bindBuffer(V.ARRAY_BUFFER,null),V.uniform1i(K,0)}G=D.j,V.useProgram(D.o),V.canvas.width=U.width,V.canvas.height=U.height,V.viewport(0,0,U.width,U.height),V.activeTexture(V.TEXTURE0),D.h.bindTexture2d(U.glName),V.enableVertexAttribArray(G.K),V.bindBuffer(V.ARRAY_BUFFER,D.u),V.vertexAttribPointer(G.K,2,V.FLOAT,!1,0,0),V.enableVertexAttribArray(G.J),V.bindBuffer(V.ARRAY_BUFFER,D.s),V.vertexAttribPointer(G.J,2,V.FLOAT,!1,0,0),V.bindFramebuffer(V.DRAW_FRAMEBUFFER?V.DRAW_FRAMEBUFFER:V.FRAMEBUFFER,null),V.clearColor(0,0,0,0),V.clear(V.COLOR_BUFFER_BIT),V.colorMask(!0,!0,!0,!0),V.drawArrays(V.TRIANGLE_FAN,0,4),V.disableVertexAttribArray(G.K),V.disableVertexAttribArray(G.J),V.bindBuffer(V.ARRAY_BUFFER,null),D.h.bindTexture2d(0)}(y,E),typeof y.g.canvas.transferToImageBitmap=="function"?Promise.resolve(y.g.canvas.transferToImageBitmap()):R?Promise.resolve(y.g.canvas):typeof createImageBitmap=="function"?createImageBitmap(y.g.canvas):(y.i===void 0&&(y.i=document.createElement("canvas")),new Promise(function(D){y.i.height=y.g.canvas.height,y.i.width=y.g.canvas.width,y.i.getContext("2d",{}).drawImage(y.g.canvas,0,0,y.g.canvas.width,y.g.canvas.height),D(y.i)}))}function he(y){this.g=y}var se=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,2,1,0,10,9,1,7,0,65,0,253,15,26,11]);function de(y,E){return E+y}function ve(y,E){window[y]=E}function Re(y){if(this.g=y,this.listeners={},this.j={},this.H={},this.o={},this.u={},this.I=this.s=this.Z=!0,this.D=Promise.resolve(),this.Y="",this.C={},this.locateFile=y&&y.locateFile||de,typeof window=="object")var E=window.location.pathname.toString().substring(0,window.location.pathname.toString().lastIndexOf("/"))+"/";else{if(typeof location>"u")throw Error("solutions can only be loaded on a web page or in a web worker");E=location.pathname.toString().substring(0,location.pathname.toString().lastIndexOf("/"))+"/"}if(this.$=E,y.options)for(var R=(E=i(Object.keys(y.options))).next();!R.done;R=E.next()){R=R.value;var D=y.options[R].default;D!==void 0&&(this.j[R]=typeof D=="function"?D():D)}}function je(y){var E,R,D,U,V,G,K,te,fe,ge,we;return x(function(Te){switch(Te.g){case 1:return y.Z?(E=y.g.files===void 0?[]:typeof y.g.files=="function"?y.g.files(y.j):y.g.files,T(Te,x(function(Ee){switch(Ee.g){case 1:return Ee.o=2,T(Ee,WebAssembly.instantiate(se),4);case 4:Ee.g=3,Ee.o=0;break;case 2:return Ee.o=0,Ee.j=null,Ee.return(!1);case 3:return Ee.return(!0)}}),2)):Te.return();case 2:if(R=Te.h,typeof window=="object")return ve("createMediapipeSolutionsWasm",{locateFile:y.locateFile}),ve("createMediapipeSolutionsPackedAssets",{locateFile:y.locateFile}),G=E.filter(function(Ee){return Ee.data!==void 0}),K=E.filter(function(Ee){return Ee.data===void 0}),te=Promise.all(G.map(function(Ee){var f=et(y,Ee.url);if(Ee.path!==void 0){var p=Ee.path;f=f.then(function(b){return y.overrideFile(p,b),Promise.resolve(b)})}return f})),fe=Promise.all(K.map(function(Ee){return Ee.simd===void 0||Ee.simd&&R||!Ee.simd&&!R?function(f){var p=document.createElement("script");return p.setAttribute("src",f),p.setAttribute("crossorigin","anonymous"),new Promise(function(b){p.addEventListener("load",function(){b()},!1),p.addEventListener("error",function(){b()},!1),document.body.appendChild(p)})}(y.locateFile(Ee.url,y.$)):Promise.resolve()})).then(function(){var Ee,f,p;return x(function(b){if(b.g==1)return Ee=window.createMediapipeSolutionsWasm,f=window.createMediapipeSolutionsPackedAssets,p=y,T(b,Ee(f),2);p.h=b.h,b.g=0})}),ge=x(function(Ee){return y.g.graph&&y.g.graph.url?Ee=T(Ee,et(y,y.g.graph.url),0):(Ee.g=0,Ee=void 0),Ee}),T(Te,Promise.all([fe,te,ge]),7);if(typeof importScripts!="function")throw Error("solutions can only be loaded on a web page or in a web worker");return D=E.filter(function(Ee){return Ee.simd===void 0||Ee.simd&&R||!Ee.simd&&!R}).map(function(Ee){return y.locateFile(Ee.url,y.$)}),importScripts.apply(null,a(D)),U=y,T(Te,createMediapipeSolutionsWasm(Module),6);case 6:U.h=Te.h,y.l=new OffscreenCanvas(1,1),y.h.canvas=y.l,V=y.h.GL.createContext(y.l,{antialias:!1,alpha:!1,ja:typeof WebGL2RenderingContext<"u"?2:1}),y.h.GL.makeContextCurrent(V),Te.g=4;break;case 7:if(y.l=document.createElement("canvas"),!(we=y.l.getContext("webgl2",{}))&&!(we=y.l.getContext("webgl",{})))return alert("Failed to create WebGL canvas context when passing video frame."),Te.return();y.G=we,y.h.canvas=y.l,y.h.createContext(y.l,!0,!0,{});case 4:y.i=new y.h.SolutionWasm,y.Z=!1,Te.g=0}})}function et(y,E){var R,D;return x(function(U){return E in y.H?U.return(y.H[E]):(R=y.locateFile(E,""),D=fetch(R).then(function(V){return V.arrayBuffer()}),y.H[E]=D,U.return(D))})}function Ke(y,E,R){var D,U,V,G,K,te,fe,ge,we,Te,Ee,f,p,b;return x(function(w){switch(w.g){case 1:if(!R)return w.return(E);for(D={},U=0,V=i(Object.keys(R)),G=V.next();!G.done;G=V.next())K=G.value,typeof(te=R[K])!="string"&&te.type==="texture"&&E[te.stream]!==void 0&&++U;1<U&&(y.I=!1),fe=i(Object.keys(R)),G=fe.next();case 2:if(G.done){w.g=4;break}if(ge=G.value,typeof(we=R[ge])=="string")return p=D,b=ge,T(w,function(ae,xe,ne){var ce;return x(function(Pe){return typeof ne=="number"||ne instanceof Uint8Array||ne instanceof ae.h.Uint8BlobList?Pe.return(ne):ne instanceof ae.h.Texture2dDataOut?((ce=ae.u[xe])||(ce=new W(ae.h,ae.G),ae.u[xe]=ce),Pe.return(ee(ce,ne,ae.I))):Pe.return(void 0)})}(y,ge,E[we]),14);if(Te=E[we.stream],we.type==="detection_list"){if(Te){for(var I=Te.getRectList(),_=Te.getLandmarksList(),O=Te.getClassificationsList(),j=[],z=0;z<I.size();++z){var Z=eo(I.get(z),so,zn);Z={boundingBox:{xCenter:ht(Z,1),yCenter:ht(Z,2),height:ht(Z,3),width:ht(Z,4),rotation:ht(Z,5,0),rectId:jr(Z,6)},landmarks:Nr(eo(_.get(z),ro,ls),Qr,1).map(k),V:S(eo(O.get(z),Yr,Qo))},j.push(Z)}I=j}else I=[];D[ge]=I,w.g=7;break}if(we.type==="proto_list"){if(Te){for(I=Array(Te.size()),_=0;_<Te.size();_++)I[_]=Te.get(_);Te.delete()}else I=[];D[ge]=I,w.g=7;break}if(Te===void 0){w.g=3;break}if(we.type==="float_list"){D[ge]=Te,w.g=7;break}if(we.type==="proto"){D[ge]=Te,w.g=7;break}if(we.type!=="texture")throw Error("Unknown output config type: '"+we.type+"'");return(Ee=y.u[ge])||(Ee=new W(y.h,y.G),y.u[ge]=Ee),T(w,ee(Ee,Te,y.I),13);case 13:f=w.h,D[ge]=f;case 7:we.transform&&D[ge]&&(D[ge]=we.transform(D[ge])),w.g=3;break;case 14:p[b]=w.h;case 3:G=fe.next(),w.g=2;break;case 4:return w.return(D)}})}function He(y,E){for(var R=E.name||"$",D=[].concat(a(E.wants)),U=new y.h.StringList,V=i(E.wants),G=V.next();!G.done;G=V.next())U.push_back(G.value);V=y.h.PacketListener.implement({onResults:function(K){for(var te={},fe=0;fe<E.wants.length;++fe)te[D[fe]]=K.get(fe);var ge=y.listeners[R];ge&&(y.D=Ke(y,te,E.outs).then(function(we){we=ge(we);for(var Te=0;Te<E.wants.length;++Te){var Ee=te[D[Te]];typeof Ee=="object"&&Ee.hasOwnProperty&&Ee.hasOwnProperty("delete")&&Ee.delete()}we&&(y.D=we)}))}}),y.i.attachMultiListener(U,V),U.delete()}function Oe(y){var E=this;y=y||{};var R={url:"face_detection_short.binarypb"},D={type:1,graphOptionXref:{calculatorType:"TensorsToDetectionsCalculator",calculatorName:"facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator",fieldName:"min_score_thresh"}};this.g=new Re({locateFile:y.locateFile,files:[{data:!0,url:"face_detection_short.binarypb"},{data:!0,url:"face_detection_short_range.tflite"},{simd:!0,url:"face_detection_solution_simd_wasm_bin.js"},{simd:!1,url:"face_detection_solution_wasm_bin.js"}],graph:R,listeners:[{wants:["detections","image_transformed"],outs:{image:"image_transformed",detections:{type:"detection_list",stream:"detections"}}}],inputs:{image:{type:"video",stream:"input_frames_gpu"}},options:{useCpuInference:{type:0,graphOptionXref:{calculatorType:"InferenceCalculator",fieldName:"use_cpu_inference"},default:typeof window=="object"&&window.navigator!==void 0&&("iPad Simulator;iPhone Simulator;iPod Simulator;iPad;iPhone;iPod".split(";").includes(navigator.platform)||navigator.userAgent.includes("Mac")&&"ontouchend"in document)},selfieMode:{type:0,graphOptionXref:{calculatorType:"GlScalerCalculator",calculatorIndex:1,fieldName:"flip_horizontal"}},model:{type:0,onChange:function(U){var V,G,K,te,fe;return x(function(ge){switch(ge.g){case 1:V=i(U==="short"?["face_detection_short_range.tflite"]:["face_detection_full_range_sparse.tflite"]),G=V.next();case 2:if(G.done){ge.g=4;break}return K=G.value,te="third_party/mediapipe/modules/face_detection/"+K,T(ge,et(E.g,K),5);case 5:fe=ge.h,E.g.overrideFile(te,fe),G=V.next(),ge.g=2;break;case 4:return R.url=U==="short"?"face_detection_short.binarypb":"face_detection_full.binarypb",D.graphOptionXref.calculatorName=U==="short"?"facedetectionshortrangegpu__facedetectionshortrangecommon__TensorsToDetectionsCalculator":"facedetectionfullrangegpu__facedetectionfullrangecommon__TensorsToDetectionsCalculator",ge.return(!0)}})}},minDetectionConfidence:D}})}(n=Re.prototype).close=function(){return this.i&&this.i.delete(),Promise.resolve()},n.reset=function(){var y=this;return x(function(E){y.i&&(y.i.reset(),y.o={},y.u={}),E.g=0})},n.setOptions=function(y,E){var R=this;if(E=E||this.g.options){for(var D=[],U=[],V={},G=i(Object.keys(y)),K=G.next();!K.done;V={R:V.R,S:V.S},K=G.next()){var te=K.value;te in this.j&&this.j[te]===y[te]||(this.j[te]=y[te],(K=E[te])!==void 0&&(K.onChange&&(V.R=K.onChange,V.S=y[te],D.push(function(fe){return function(){return x(function(ge){if(ge.g==1)return T(ge,fe.R(fe.S),2);ge.h===!0&&(R.s=!0),ge.g=0})}}(V))),K.graphOptionXref&&(te={valueNumber:K.type===1?y[te]:0,valueBoolean:K.type===0&&y[te],valueString:K.type===2?y[te]:""},K=Object.assign(Object.assign(Object.assign({},{calculatorName:"",calculatorIndex:0}),K.graphOptionXref),te),U.push(K))))}D.length===0&&U.length===0||(this.s=!0,this.B=(this.B===void 0?[]:this.B).concat(U),this.A=(this.A===void 0?[]:this.A).concat(D))}},n.initialize=function(){var y=this;return x(function(E){return E.g==1?T(E,je(y),2):E.g!=3?T(E,function(R){var D,U,V,G,K,te,fe,ge;return x(function(we){if(we.g==1)return R.g.graph&&R.g.graph.url&&R.Y===R.g.graph.url?we.return():(R.s=!0,R.g.graph&&R.g.graph.url?(R.Y=R.g.graph.url,T(we,et(R,R.g.graph.url),3)):void(we.g=2));for(we.g!=2&&(D=we.h,R.i.loadGraph(D)),U=i(Object.keys(R.C)),V=U.next();!V.done;V=U.next())G=V.value,R.i.overrideFile(G,R.C[G]);if(R.C={},R.g.listeners)for(K=i(R.g.listeners),te=K.next();!te.done;te=K.next())fe=te.value,He(R,fe);ge=R.j,R.j={},R.setOptions(ge),we.g=0})}(y),3):T(E,function(R){var D,U,V,G,K,te;return x(function(fe){switch(fe.g){case 1:if(!R.s)return fe.return();if(!R.A){fe.g=2;break}D=i(R.A),U=D.next();case 3:if(U.done){fe.g=5;break}return T(fe,(0,U.value)(),4);case 4:U=D.next(),fe.g=3;break;case 5:R.A=void 0;case 2:if(R.B){for(V=new R.h.GraphOptionChangeRequestList,G=i(R.B),K=G.next();!K.done;K=G.next())te=K.value,V.push_back(te);R.i.changeOptions(V),V.delete(),R.B=void 0}R.s=!1,fe.g=0}})}(y),0)})},n.overrideFile=function(y,E){this.i?this.i.overrideFile(y,E):this.C[y]=E},n.clearOverriddenFiles=function(){this.C={},this.i&&this.i.clearOverriddenFiles()},n.send=function(y,E){var R,D,U,V,G,K,te,fe,ge,we=this;return x(function(Te){switch(Te.g){case 1:return we.g.inputs?(R=1e3*(E==null?performance.now():E),T(Te,we.D,2)):Te.return();case 2:return T(Te,we.initialize(),3);case 3:for(D=new we.h.PacketDataList,U=i(Object.keys(y)),V=U.next();!V.done;V=U.next())if(G=V.value,K=we.g.inputs[G]){e:{var Ee=y[G];switch(K.type){case"video":var f=we.o[K.stream];if(f||(f=new W(we.h,we.G),we.o[K.stream]=f),f.l===0&&(f.l=f.h.createTexture()),typeof HTMLVideoElement<"u"&&Ee instanceof HTMLVideoElement)var p=Ee.videoWidth,b=Ee.videoHeight;else typeof HTMLImageElement<"u"&&Ee instanceof HTMLImageElement?(p=Ee.naturalWidth,b=Ee.naturalHeight):(p=Ee.width,b=Ee.height);b={glName:f.l,width:p,height:b},(p=f.g).canvas.width=b.width,p.canvas.height=b.height,p.activeTexture(p.TEXTURE0),f.h.bindTexture2d(f.l),p.texImage2D(p.TEXTURE_2D,0,p.RGBA,p.RGBA,p.UNSIGNED_BYTE,Ee),f.h.bindTexture2d(0),f=b;break e;case"detections":for((f=we.o[K.stream])||(f=new he(we.h),we.o[K.stream]=f),f.data||(f.data=new f.g.DetectionListData),f.data.reset(Ee.length),b=0;b<Ee.length;++b){p=Ee[b];var w=f.data,I=w.setBoundingBox,_=b,O=p.boundingBox,j=new so;if(Et(j,1,O.xCenter),Et(j,2,O.yCenter),Et(j,3,O.height),Et(j,4,O.width),Et(j,5,O.rotation),Et(j,6,O.rectId),O=Xr(j,zn),I.call(w,_,O),p.landmarks)for(w=0;w<p.landmarks.length;++w){var z=!!(j=p.landmarks[w]).visibility;_=(I=f.data).addNormalizedLandmark,O=b,j=Object.assign(Object.assign({},j),{visibility:z?j.visibility:0}),Et(z=new Qr,1,j.x),Et(z,2,j.y),Et(z,3,j.z),j.visibility&&Et(z,4,j.visibility),j=Xr(z,yn),_.call(I,O,j)}if(p.V)for(w=0;w<p.V.length;++w)_=(I=f.data).addClassification,O=b,j=p.V[w],Et(z=new Wn,2,j.ga),j.index&&Et(z,1,j.index),j.label&&Et(z,3,j.label),j.displayName&&Et(z,4,j.displayName),j=Xr(z,no),_.call(I,O,j)}f=f.data;break e;default:f={}}}switch(te=f,fe=K.stream,K.type){case"video":D.pushTexture2d(Object.assign(Object.assign({},te),{stream:fe,timestamp:R}));break;case"detections":(ge=te).stream=fe,ge.timestamp=R,D.pushDetectionList(ge);break;default:throw Error("Unknown input config type: '"+K.type+"'")}}return we.i.send(D),T(Te,we.D,4);case 4:D.delete(),Te.g=0}})},n.onResults=function(y,E){this.listeners[E||"$"]=y},ie("Solution",Re),ie("OptionType",{BOOL:0,NUMBER:1,ia:2,0:"BOOL",1:"NUMBER",2:"STRING"}),(n=Oe.prototype).close=function(){return this.g.close(),Promise.resolve()},n.onResults=function(y){this.g.onResults(y)},n.initialize=function(){var y=this;return x(function(E){return T(E,y.g.initialize(),0)})},n.reset=function(){this.g.reset()},n.send=function(y){var E=this;return x(function(R){return T(R,E.g.send(y),0)})},n.setOptions=function(y){this.g.setOptions(y)},ie("FaceDetection",Oe),ie("FACEDETECTION_LIPS",Gn),ie("FACEDETECTION_LEFT_EYE",hs),ie("FACEDETECTION_LEFT_EYEBROW",oo),ie("FACEDETECTION_RIGHT_EYE",Os),ie("FACEDETECTION_RIGHT_EYEBROW",Ds),ie("FACEDETECTION_FACE_OVAL",Zr),ie("FACEDETECTION_CONTOURS",io),ie("FACEDETECTION_TESSELATION",[[127,34],[34,139],[139,127],[11,0],[0,37],[37,11],[232,231],[231,120],[120,232],[72,37],[37,39],[39,72],[128,121],[121,47],[47,128],[232,121],[121,128],[128,232],[104,69],[69,67],[67,104],[175,171],[171,148],[148,175],[118,50],[50,101],[101,118],[73,39],[39,40],[40,73],[9,151],[151,108],[108,9],[48,115],[115,131],[131,48],[194,204],[204,211],[211,194],[74,40],[40,185],[185,74],[80,42],[42,183],[183,80],[40,92],[92,186],[186,40],[230,229],[229,118],[118,230],[202,212],[212,214],[214,202],[83,18],[18,17],[17,83],[76,61],[61,146],[146,76],[160,29],[29,30],[30,160],[56,157],[157,173],[173,56],[106,204],[204,194],[194,106],[135,214],[214,192],[192,135],[203,165],[165,98],[98,203],[21,71],[71,68],[68,21],[51,45],[45,4],[4,51],[144,24],[24,23],[23,144],[77,146],[146,91],[91,77],[205,50],[50,187],[187,205],[201,200],[200,18],[18,201],[91,106],[106,182],[182,91],[90,91],[91,181],[181,90],[85,84],[84,17],[17,85],[206,203],[203,36],[36,206],[148,171],[171,140],[140,148],[92,40],[40,39],[39,92],[193,189],[189,244],[244,193],[159,158],[158,28],[28,159],[247,246],[246,161],[161,247],[236,3],[3,196],[196,236],[54,68],[68,104],[104,54],[193,168],[168,8],[8,193],[117,228],[228,31],[31,117],[189,193],[193,55],[55,189],[98,97],[97,99],[99,98],[126,47],[47,100],[100,126],[166,79],[79,218],[218,166],[155,154],[154,26],[26,155],[209,49],[49,131],[131,209],[135,136],[136,150],[150,135],[47,126],[126,217],[217,47],[223,52],[52,53],[53,223],[45,51],[51,134],[134,45],[211,170],[170,140],[140,211],[67,69],[69,108],[108,67],[43,106],[106,91],[91,43],[230,119],[119,120],[120,230],[226,130],[130,247],[247,226],[63,53],[53,52],[52,63],[238,20],[20,242],[242,238],[46,70],[70,156],[156,46],[78,62],[62,96],[96,78],[46,53],[53,63],[63,46],[143,34],[34,227],[227,143],[123,117],[117,111],[111,123],[44,125],[125,19],[19,44],[236,134],[134,51],[51,236],[216,206],[206,205],[205,216],[154,153],[153,22],[22,154],[39,37],[37,167],[167,39],[200,201],[201,208],[208,200],[36,142],[142,100],[100,36],[57,212],[212,202],[202,57],[20,60],[60,99],[99,20],[28,158],[158,157],[157,28],[35,226],[226,113],[113,35],[160,159],[159,27],[27,160],[204,202],[202,210],[210,204],[113,225],[225,46],[46,113],[43,202],[202,204],[204,43],[62,76],[76,77],[77,62],[137,123],[123,116],[116,137],[41,38],[38,72],[72,41],[203,129],[129,142],[142,203],[64,98],[98,240],[240,64],[49,102],[102,64],[64,49],[41,73],[73,74],[74,41],[212,216],[216,207],[207,212],[42,74],[74,184],[184,42],[169,170],[170,211],[211,169],[170,149],[149,176],[176,170],[105,66],[66,69],[69,105],[122,6],[6,168],[168,122],[123,147],[147,187],[187,123],[96,77],[77,90],[90,96],[65,55],[55,107],[107,65],[89,90],[90,180],[180,89],[101,100],[100,120],[120,101],[63,105],[105,104],[104,63],[93,137],[137,227],[227,93],[15,86],[86,85],[85,15],[129,102],[102,49],[49,129],[14,87],[87,86],[86,14],[55,8],[8,9],[9,55],[100,47],[47,121],[121,100],[145,23],[23,22],[22,145],[88,89],[89,179],[179,88],[6,122],[122,196],[196,6],[88,95],[95,96],[96,88],[138,172],[172,136],[136,138],[215,58],[58,172],[172,215],[115,48],[48,219],[219,115],[42,80],[80,81],[81,42],[195,3],[3,51],[51,195],[43,146],[146,61],[61,43],[171,175],[175,199],[199,171],[81,82],[82,38],[38,81],[53,46],[46,225],[225,53],[144,163],[163,110],[110,144],[52,65],[65,66],[66,52],[229,228],[228,117],[117,229],[34,127],[127,234],[234,34],[107,108],[108,69],[69,107],[109,108],[108,151],[151,109],[48,64],[64,235],[235,48],[62,78],[78,191],[191,62],[129,209],[209,126],[126,129],[111,35],[35,143],[143,111],[117,123],[123,50],[50,117],[222,65],[65,52],[52,222],[19,125],[125,141],[141,19],[221,55],[55,65],[65,221],[3,195],[195,197],[197,3],[25,7],[7,33],[33,25],[220,237],[237,44],[44,220],[70,71],[71,139],[139,70],[122,193],[193,245],[245,122],[247,130],[130,33],[33,247],[71,21],[21,162],[162,71],[170,169],[169,150],[150,170],[188,174],[174,196],[196,188],[216,186],[186,92],[92,216],[2,97],[97,167],[167,2],[141,125],[125,241],[241,141],[164,167],[167,37],[37,164],[72,38],[38,12],[12,72],[38,82],[82,13],[13,38],[63,68],[68,71],[71,63],[226,35],[35,111],[111,226],[101,50],[50,205],[205,101],[206,92],[92,165],[165,206],[209,198],[198,217],[217,209],[165,167],[167,97],[97,165],[220,115],[115,218],[218,220],[133,112],[112,243],[243,133],[239,238],[238,241],[241,239],[214,135],[135,169],[169,214],[190,173],[173,133],[133,190],[171,208],[208,32],[32,171],[125,44],[44,237],[237,125],[86,87],[87,178],[178,86],[85,86],[86,179],[179,85],[84,85],[85,180],[180,84],[83,84],[84,181],[181,83],[201,83],[83,182],[182,201],[137,93],[93,132],[132,137],[76,62],[62,183],[183,76],[61,76],[76,184],[184,61],[57,61],[61,185],[185,57],[212,57],[57,186],[186,212],[214,207],[207,187],[187,214],[34,143],[143,156],[156,34],[79,239],[239,237],[237,79],[123,137],[137,177],[177,123],[44,1],[1,4],[4,44],[201,194],[194,32],[32,201],[64,102],[102,129],[129,64],[213,215],[215,138],[138,213],[59,166],[166,219],[219,59],[242,99],[99,97],[97,242],[2,94],[94,141],[141,2],[75,59],[59,235],[235,75],[24,110],[110,228],[228,24],[25,130],[130,226],[226,25],[23,24],[24,229],[229,23],[22,23],[23,230],[230,22],[26,22],[22,231],[231,26],[112,26],[26,232],[232,112],[189,190],[190,243],[243,189],[221,56],[56,190],[190,221],[28,56],[56,221],[221,28],[27,28],[28,222],[222,27],[29,27],[27,223],[223,29],[30,29],[29,224],[224,30],[247,30],[30,225],[225,247],[238,79],[79,20],[20,238],[166,59],[59,75],[75,166],[60,75],[75,240],[240,60],[147,177],[177,215],[215,147],[20,79],[79,166],[166,20],[187,147],[147,213],[213,187],[112,233],[233,244],[244,112],[233,128],[128,245],[245,233],[128,114],[114,188],[188,128],[114,217],[217,174],[174,114],[131,115],[115,220],[220,131],[217,198],[198,236],[236,217],[198,131],[131,134],[134,198],[177,132],[132,58],[58,177],[143,35],[35,124],[124,143],[110,163],[163,7],[7,110],[228,110],[110,25],[25,228],[356,389],[389,368],[368,356],[11,302],[302,267],[267,11],[452,350],[350,349],[349,452],[302,303],[303,269],[269,302],[357,343],[343,277],[277,357],[452,453],[453,357],[357,452],[333,332],[332,297],[297,333],[175,152],[152,377],[377,175],[347,348],[348,330],[330,347],[303,304],[304,270],[270,303],[9,336],[336,337],[337,9],[278,279],[279,360],[360,278],[418,262],[262,431],[431,418],[304,408],[408,409],[409,304],[310,415],[415,407],[407,310],[270,409],[409,410],[410,270],[450,348],[348,347],[347,450],[422,430],[430,434],[434,422],[313,314],[314,17],[17,313],[306,307],[307,375],[375,306],[387,388],[388,260],[260,387],[286,414],[414,398],[398,286],[335,406],[406,418],[418,335],[364,367],[367,416],[416,364],[423,358],[358,327],[327,423],[251,284],[284,298],[298,251],[281,5],[5,4],[4,281],[373,374],[374,253],[253,373],[307,320],[320,321],[321,307],[425,427],[427,411],[411,425],[421,313],[313,18],[18,421],[321,405],[405,406],[406,321],[320,404],[404,405],[405,320],[315,16],[16,17],[17,315],[426,425],[425,266],[266,426],[377,400],[400,369],[369,377],[322,391],[391,269],[269,322],[417,465],[465,464],[464,417],[386,257],[257,258],[258,386],[466,260],[260,388],[388,466],[456,399],[399,419],[419,456],[284,332],[332,333],[333,284],[417,285],[285,8],[8,417],[346,340],[340,261],[261,346],[413,441],[441,285],[285,413],[327,460],[460,328],[328,327],[355,371],[371,329],[329,355],[392,439],[439,438],[438,392],[382,341],[341,256],[256,382],[429,420],[420,360],[360,429],[364,394],[394,379],[379,364],[277,343],[343,437],[437,277],[443,444],[444,283],[283,443],[275,440],[440,363],[363,275],[431,262],[262,369],[369,431],[297,338],[338,337],[337,297],[273,375],[375,321],[321,273],[450,451],[451,349],[349,450],[446,342],[342,467],[467,446],[293,334],[334,282],[282,293],[458,461],[461,462],[462,458],[276,353],[353,383],[383,276],[308,324],[324,325],[325,308],[276,300],[300,293],[293,276],[372,345],[345,447],[447,372],[352,345],[345,340],[340,352],[274,1],[1,19],[19,274],[456,248],[248,281],[281,456],[436,427],[427,425],[425,436],[381,256],[256,252],[252,381],[269,391],[391,393],[393,269],[200,199],[199,428],[428,200],[266,330],[330,329],[329,266],[287,273],[273,422],[422,287],[250,462],[462,328],[328,250],[258,286],[286,384],[384,258],[265,353],[353,342],[342,265],[387,259],[259,257],[257,387],[424,431],[431,430],[430,424],[342,353],[353,276],[276,342],[273,335],[335,424],[424,273],[292,325],[325,307],[307,292],[366,447],[447,345],[345,366],[271,303],[303,302],[302,271],[423,266],[266,371],[371,423],[294,455],[455,460],[460,294],[279,278],[278,294],[294,279],[271,272],[272,304],[304,271],[432,434],[434,427],[427,432],[272,407],[407,408],[408,272],[394,430],[430,431],[431,394],[395,369],[369,400],[400,395],[334,333],[333,299],[299,334],[351,417],[417,168],[168,351],[352,280],[280,411],[411,352],[325,319],[319,320],[320,325],[295,296],[296,336],[336,295],[319,403],[403,404],[404,319],[330,348],[348,349],[349,330],[293,298],[298,333],[333,293],[323,454],[454,447],[447,323],[15,16],[16,315],[315,15],[358,429],[429,279],[279,358],[14,15],[15,316],[316,14],[285,336],[336,9],[9,285],[329,349],[349,350],[350,329],[374,380],[380,252],[252,374],[318,402],[402,403],[403,318],[6,197],[197,419],[419,6],[318,319],[319,325],[325,318],[367,364],[364,365],[365,367],[435,367],[367,397],[397,435],[344,438],[438,439],[439,344],[272,271],[271,311],[311,272],[195,5],[5,281],[281,195],[273,287],[287,291],[291,273],[396,428],[428,199],[199,396],[311,271],[271,268],[268,311],[283,444],[444,445],[445,283],[373,254],[254,339],[339,373],[282,334],[334,296],[296,282],[449,347],[347,346],[346,449],[264,447],[447,454],[454,264],[336,296],[296,299],[299,336],[338,10],[10,151],[151,338],[278,439],[439,455],[455,278],[292,407],[407,415],[415,292],[358,371],[371,355],[355,358],[340,345],[345,372],[372,340],[346,347],[347,280],[280,346],[442,443],[443,282],[282,442],[19,94],[94,370],[370,19],[441,442],[442,295],[295,441],[248,419],[419,197],[197,248],[263,255],[255,359],[359,263],[440,275],[275,274],[274,440],[300,383],[383,368],[368,300],[351,412],[412,465],[465,351],[263,467],[467,466],[466,263],[301,368],[368,389],[389,301],[395,378],[378,379],[379,395],[412,351],[351,419],[419,412],[436,426],[426,322],[322,436],[2,164],[164,393],[393,2],[370,462],[462,461],[461,370],[164,0],[0,267],[267,164],[302,11],[11,12],[12,302],[268,12],[12,13],[13,268],[293,300],[300,301],[301,293],[446,261],[261,340],[340,446],[330,266],[266,425],[425,330],[426,423],[423,391],[391,426],[429,355],[355,437],[437,429],[391,327],[327,326],[326,391],[440,457],[457,438],[438,440],[341,382],[382,362],[362,341],[459,457],[457,461],[461,459],[434,430],[430,394],[394,434],[414,463],[463,362],[362,414],[396,369],[369,262],[262,396],[354,461],[461,457],[457,354],[316,403],[403,402],[402,316],[315,404],[404,403],[403,315],[314,405],[405,404],[404,314],[313,406],[406,405],[405,313],[421,418],[418,406],[406,421],[366,401],[401,361],[361,366],[306,408],[408,407],[407,306],[291,409],[409,408],[408,291],[287,410],[410,409],[409,287],[432,436],[436,410],[410,432],[434,416],[416,411],[411,434],[264,368],[368,383],[383,264],[309,438],[438,457],[457,309],[352,376],[376,401],[401,352],[274,275],[275,4],[4,274],[421,428],[428,262],[262,421],[294,327],[327,358],[358,294],[433,416],[416,367],[367,433],[289,455],[455,439],[439,289],[462,370],[370,326],[326,462],[2,326],[326,370],[370,2],[305,460],[460,455],[455,305],[254,449],[449,448],[448,254],[255,261],[261,446],[446,255],[253,450],[450,449],[449,253],[252,451],[451,450],[450,252],[256,452],[452,451],[451,256],[341,453],[453,452],[452,341],[413,464],[464,463],[463,413],[441,413],[413,414],[414,441],[258,442],[442,441],[441,258],[257,443],[443,442],[442,257],[259,444],[444,443],[443,259],[260,445],[445,444],[444,260],[467,342],[342,445],[445,467],[459,458],[458,250],[250,459],[289,392],[392,290],[290,289],[290,328],[328,460],[460,290],[376,433],[433,435],[435,376],[250,290],[290,392],[392,250],[411,416],[416,433],[433,411],[341,463],[463,464],[464,341],[453,464],[464,465],[465,453],[357,465],[465,412],[412,357],[343,412],[412,399],[399,343],[360,363],[363,440],[440,360],[437,399],[399,456],[456,437],[420,456],[456,363],[363,420],[401,435],[435,288],[288,401],[372,383],[383,353],[353,372],[339,255],[255,249],[249,339],[448,261],[261,255],[255,448],[133,243],[243,190],[190,133],[133,155],[155,112],[112,133],[33,246],[246,247],[247,33],[33,130],[130,25],[25,33],[398,384],[384,286],[286,398],[362,398],[398,414],[414,362],[362,463],[463,341],[341,362],[263,359],[359,467],[467,263],[263,249],[249,255],[255,263],[466,467],[467,260],[260,466],[75,60],[60,166],[166,75],[238,239],[239,79],[79,238],[162,127],[127,139],[139,162],[72,11],[11,37],[37,72],[121,232],[232,120],[120,121],[73,72],[72,39],[39,73],[114,128],[128,47],[47,114],[233,232],[232,128],[128,233],[103,104],[104,67],[67,103],[152,175],[175,148],[148,152],[119,118],[118,101],[101,119],[74,73],[73,40],[40,74],[107,9],[9,108],[108,107],[49,48],[48,131],[131,49],[32,194],[194,211],[211,32],[184,74],[74,185],[185,184],[191,80],[80,183],[183,191],[185,40],[40,186],[186,185],[119,230],[230,118],[118,119],[210,202],[202,214],[214,210],[84,83],[83,17],[17,84],[77,76],[76,146],[146,77],[161,160],[160,30],[30,161],[190,56],[56,173],[173,190],[182,106],[106,194],[194,182],[138,135],[135,192],[192,138],[129,203],[203,98],[98,129],[54,21],[21,68],[68,54],[5,51],[51,4],[4,5],[145,144],[144,23],[23,145],[90,77],[77,91],[91,90],[207,205],[205,187],[187,207],[83,201],[201,18],[18,83],[181,91],[91,182],[182,181],[180,90],[90,181],[181,180],[16,85],[85,17],[17,16],[205,206],[206,36],[36,205],[176,148],[148,140],[140,176],[165,92],[92,39],[39,165],[245,193],[193,244],[244,245],[27,159],[159,28],[28,27],[30,247],[247,161],[161,30],[174,236],[236,196],[196,174],[103,54],[54,104],[104,103],[55,193],[193,8],[8,55],[111,117],[117,31],[31,111],[221,189],[189,55],[55,221],[240,98],[98,99],[99,240],[142,126],[126,100],[100,142],[219,166],[166,218],[218,219],[112,155],[155,26],[26,112],[198,209],[209,131],[131,198],[169,135],[135,150],[150,169],[114,47],[47,217],[217,114],[224,223],[223,53],[53,224],[220,45],[45,134],[134,220],[32,211],[211,140],[140,32],[109,67],[67,108],[108,109],[146,43],[43,91],[91,146],[231,230],[230,120],[120,231],[113,226],[226,247],[247,113],[105,63],[63,52],[52,105],[241,238],[238,242],[242,241],[124,46],[46,156],[156,124],[95,78],[78,96],[96,95],[70,46],[46,63],[63,70],[116,143],[143,227],[227,116],[116,123],[123,111],[111,116],[1,44],[44,19],[19,1],[3,236],[236,51],[51,3],[207,216],[216,205],[205,207],[26,154],[154,22],[22,26],[165,39],[39,167],[167,165],[199,200],[200,208],[208,199],[101,36],[36,100],[100,101],[43,57],[57,202],[202,43],[242,20],[20,99],[99,242],[56,28],[28,157],[157,56],[124,35],[35,113],[113,124],[29,160],[160,27],[27,29],[211,204],[204,210],[210,211],[124,113],[113,46],[46,124],[106,43],[43,204],[204,106],[96,62],[62,77],[77,96],[227,137],[137,116],[116,227],[73,41],[41,72],[72,73],[36,203],[203,142],[142,36],[235,64],[64,240],[240,235],[48,49],[49,64],[64,48],[42,41],[41,74],[74,42],[214,212],[212,207],[207,214],[183,42],[42,184],[184,183],[210,169],[169,211],[211,210],[140,170],[170,176],[176,140],[104,105],[105,69],[69,104],[193,122],[122,168],[168,193],[50,123],[123,187],[187,50],[89,96],[96,90],[90,89],[66,65],[65,107],[107,66],[179,89],[89,180],[180,179],[119,101],[101,120],[120,119],[68,63],[63,104],[104,68],[234,93],[93,227],[227,234],[16,15],[15,85],[85,16],[209,129],[129,49],[49,209],[15,14],[14,86],[86,15],[107,55],[55,9],[9,107],[120,100],[100,121],[121,120],[153,145],[145,22],[22,153],[178,88],[88,179],[179,178],[197,6],[6,196],[196,197],[89,88],[88,96],[96,89],[135,138],[138,136],[136,135],[138,215],[215,172],[172,138],[218,115],[115,219],[219,218],[41,42],[42,81],[81,41],[5,195],[195,51],[51,5],[57,43],[43,61],[61,57],[208,171],[171,199],[199,208],[41,81],[81,38],[38,41],[224,53],[53,225],[225,224],[24,144],[144,110],[110,24],[105,52],[52,66],[66,105],[118,229],[229,117],[117,118],[227,34],[34,234],[234,227],[66,107],[107,69],[69,66],[10,109],[109,151],[151,10],[219,48],[48,235],[235,219],[183,62],[62,191],[191,183],[142,129],[129,126],[126,142],[116,111],[111,143],[143,116],[118,117],[117,50],[50,118],[223,222],[222,52],[52,223],[94,19],[19,141],[141,94],[222,221],[221,65],[65,222],[196,3],[3,197],[197,196],[45,220],[220,44],[44,45],[156,70],[70,139],[139,156],[188,122],[122,245],[245,188],[139,71],[71,162],[162,139],[149,170],[170,150],[150,149],[122,188],[188,196],[196,122],[206,216],[216,92],[92,206],[164,2],[2,167],[167,164],[242,141],[141,241],[241,242],[0,164],[164,37],[37,0],[11,72],[72,12],[12,11],[12,38],[38,13],[13,12],[70,63],[63,71],[71,70],[31,226],[226,111],[111,31],[36,101],[101,205],[205,36],[203,206],[206,165],[165,203],[126,209],[209,217],[217,126],[98,165],[165,97],[97,98],[237,220],[220,218],[218,237],[237,239],[239,241],[241,237],[210,214],[214,169],[169,210],[140,171],[171,32],[32,140],[241,125],[125,237],[237,241],[179,86],[86,178],[178,179],[180,85],[85,179],[179,180],[181,84],[84,180],[180,181],[182,83],[83,181],[181,182],[194,201],[201,182],[182,194],[177,137],[137,132],[132,177],[184,76],[76,183],[183,184],[185,61],[61,184],[184,185],[186,57],[57,185],[185,186],[216,212],[212,186],[186,216],[192,214],[214,187],[187,192],[139,34],[34,156],[156,139],[218,79],[79,237],[237,218],[147,123],[123,177],[177,147],[45,44],[44,4],[4,45],[208,201],[201,32],[32,208],[98,64],[64,129],[129,98],[192,213],[213,138],[138,192],[235,59],[59,219],[219,235],[141,242],[242,97],[97,141],[97,2],[2,141],[141,97],[240,75],[75,235],[235,240],[229,24],[24,228],[228,229],[31,25],[25,226],[226,31],[230,23],[23,229],[229,230],[231,22],[22,230],[230,231],[232,26],[26,231],[231,232],[233,112],[112,232],[232,233],[244,189],[189,243],[243,244],[189,221],[221,190],[190,189],[222,28],[28,221],[221,222],[223,27],[27,222],[222,223],[224,29],[29,223],[223,224],[225,30],[30,224],[224,225],[113,247],[247,225],[225,113],[99,60],[60,240],[240,99],[213,147],[147,215],[215,213],[60,20],[20,166],[166,60],[192,187],[187,213],[213,192],[243,112],[112,244],[244,243],[244,233],[233,245],[245,244],[245,128],[128,188],[188,245],[188,114],[114,174],[174,188],[134,131],[131,220],[220,134],[174,217],[217,236],[236,174],[236,198],[198,134],[134,236],[215,177],[177,58],[58,215],[156,143],[143,124],[124,156],[25,110],[110,7],[7,25],[31,228],[228,25],[25,31],[264,356],[356,368],[368,264],[0,11],[11,267],[267,0],[451,452],[452,349],[349,451],[267,302],[302,269],[269,267],[350,357],[357,277],[277,350],[350,452],[452,357],[357,350],[299,333],[333,297],[297,299],[396,175],[175,377],[377,396],[280,347],[347,330],[330,280],[269,303],[303,270],[270,269],[151,9],[9,337],[337,151],[344,278],[278,360],[360,344],[424,418],[418,431],[431,424],[270,304],[304,409],[409,270],[272,310],[310,407],[407,272],[322,270],[270,410],[410,322],[449,450],[450,347],[347,449],[432,422],[422,434],[434,432],[18,313],[313,17],[17,18],[291,306],[306,375],[375,291],[259,387],[387,260],[260,259],[424,335],[335,418],[418,424],[434,364],[364,416],[416,434],[391,423],[423,327],[327,391],[301,251],[251,298],[298,301],[275,281],[281,4],[4,275],[254,373],[373,253],[253,254],[375,307],[307,321],[321,375],[280,425],[425,411],[411,280],[200,421],[421,18],[18,200],[335,321],[321,406],[406,335],[321,320],[320,405],[405,321],[314,315],[315,17],[17,314],[423,426],[426,266],[266,423],[396,377],[377,369],[369,396],[270,322],[322,269],[269,270],[413,417],[417,464],[464,413],[385,386],[386,258],[258,385],[248,456],[456,419],[419,248],[298,284],[284,333],[333,298],[168,417],[417,8],[8,168],[448,346],[346,261],[261,448],[417,413],[413,285],[285,417],[326,327],[327,328],[328,326],[277,355],[355,329],[329,277],[309,392],[392,438],[438,309],[381,382],[382,256],[256,381],[279,429],[429,360],[360,279],[365,364],[364,379],[379,365],[355,277],[277,437],[437,355],[282,443],[443,283],[283,282],[281,275],[275,363],[363,281],[395,431],[431,369],[369,395],[299,297],[297,337],[337,299],[335,273],[273,321],[321,335],[348,450],[450,349],[349,348],[359,446],[446,467],[467,359],[283,293],[293,282],[282,283],[250,458],[458,462],[462,250],[300,276],[276,383],[383,300],[292,308],[308,325],[325,292],[283,276],[276,293],[293,283],[264,372],[372,447],[447,264],[346,352],[352,340],[340,346],[354,274],[274,19],[19,354],[363,456],[456,281],[281,363],[426,436],[436,425],[425,426],[380,381],[381,252],[252,380],[267,269],[269,393],[393,267],[421,200],[200,428],[428,421],[371,266],[266,329],[329,371],[432,287],[287,422],[422,432],[290,250],[250,328],[328,290],[385,258],[258,384],[384,385],[446,265],[265,342],[342,446],[386,387],[387,257],[257,386],[422,424],[424,430],[430,422],[445,342],[342,276],[276,445],[422,273],[273,424],[424,422],[306,292],[292,307],[307,306],[352,366],[366,345],[345,352],[268,271],[271,302],[302,268],[358,423],[423,371],[371,358],[327,294],[294,460],[460,327],[331,279],[279,294],[294,331],[303,271],[271,304],[304,303],[436,432],[432,427],[427,436],[304,272],[272,408],[408,304],[395,394],[394,431],[431,395],[378,395],[395,400],[400,378],[296,334],[334,299],[299,296],[6,351],[351,168],[168,6],[376,352],[352,411],[411,376],[307,325],[325,320],[320,307],[285,295],[295,336],[336,285],[320,319],[319,404],[404,320],[329,330],[330,349],[349,329],[334,293],[293,333],[333,334],[366,323],[323,447],[447,366],[316,15],[15,315],[315,316],[331,358],[358,279],[279,331],[317,14],[14,316],[316,317],[8,285],[285,9],[9,8],[277,329],[329,350],[350,277],[253,374],[374,252],[252,253],[319,318],[318,403],[403,319],[351,6],[6,419],[419,351],[324,318],[318,325],[325,324],[397,367],[367,365],[365,397],[288,435],[435,397],[397,288],[278,344],[344,439],[439,278],[310,272],[272,311],[311,310],[248,195],[195,281],[281,248],[375,273],[273,291],[291,375],[175,396],[396,199],[199,175],[312,311],[311,268],[268,312],[276,283],[283,445],[445,276],[390,373],[373,339],[339,390],[295,282],[282,296],[296,295],[448,449],[449,346],[346,448],[356,264],[264,454],[454,356],[337,336],[336,299],[299,337],[337,338],[338,151],[151,337],[294,278],[278,455],[455,294],[308,292],[292,415],[415,308],[429,358],[358,355],[355,429],[265,340],[340,372],[372,265],[352,346],[346,280],[280,352],[295,442],[442,282],[282,295],[354,19],[19,370],[370,354],[285,441],[441,295],[295,285],[195,248],[248,197],[197,195],[457,440],[440,274],[274,457],[301,300],[300,368],[368,301],[417,351],[351,465],[465,417],[251,301],[301,389],[389,251],[394,395],[395,379],[379,394],[399,412],[412,419],[419,399],[410,436],[436,322],[322,410],[326,2],[2,393],[393,326],[354,370],[370,461],[461,354],[393,164],[164,267],[267,393],[268,302],[302,12],[12,268],[312,268],[268,13],[13,312],[298,293],[293,301],[301,298],[265,446],[446,340],[340,265],[280,330],[330,425],[425,280],[322,426],[426,391],[391,322],[420,429],[429,437],[437,420],[393,391],[391,326],[326,393],[344,440],[440,438],[438,344],[458,459],[459,461],[461,458],[364,434],[434,394],[394,364],[428,396],[396,262],[262,428],[274,354],[354,457],[457,274],[317,316],[316,402],[402,317],[316,315],[315,403],[403,316],[315,314],[314,404],[404,315],[314,313],[313,405],[405,314],[313,421],[421,406],[406,313],[323,366],[366,361],[361,323],[292,306],[306,407],[407,292],[306,291],[291,408],[408,306],[291,287],[287,409],[409,291],[287,432],[432,410],[410,287],[427,434],[434,411],[411,427],[372,264],[264,383],[383,372],[459,309],[309,457],[457,459],[366,352],[352,401],[401,366],[1,274],[274,4],[4,1],[418,421],[421,262],[262,418],[331,294],[294,358],[358,331],[435,433],[433,367],[367,435],[392,289],[289,439],[439,392],[328,462],[462,326],[326,328],[94,2],[2,370],[370,94],[289,305],[305,455],[455,289],[339,254],[254,448],[448,339],[359,255],[255,446],[446,359],[254,253],[253,449],[449,254],[253,252],[252,450],[450,253],[252,256],[256,451],[451,252],[256,341],[341,452],[452,256],[414,413],[413,463],[463,414],[286,441],[441,414],[414,286],[286,258],[258,441],[441,286],[258,257],[257,442],[442,258],[257,259],[259,443],[443,257],[259,260],[260,444],[444,259],[260,467],[467,445],[445,260],[309,459],[459,250],[250,309],[305,289],[289,290],[290,305],[305,290],[290,460],[460,305],[401,376],[376,435],[435,401],[309,250],[250,392],[392,309],[376,411],[411,433],[433,376],[453,341],[341,464],[464,453],[357,453],[453,465],[465,357],[343,357],[357,412],[412,343],[437,343],[343,399],[399,437],[344,360],[360,440],[440,344],[420,437],[437,456],[456,420],[360,420],[420,363],[363,360],[361,401],[401,288],[288,361],[265,372],[372,353],[353,265],[390,339],[339,249],[249,390],[339,448],[448,255],[255,339]]),ie("VERSION","0.4.1646425229")}).call(Gu);var js=function(){return js=Object.assign||function(n){for(var e,t=1,r=arguments.length;t<r;t++)for(var s in e=arguments[t])Object.prototype.hasOwnProperty.call(e,s)&&(n[s]=e[s]);return n},js.apply(this,arguments)};function $s(n,e,t,r){return new(t||(t=Promise))(function(s,o){function i(c){try{u(r.next(c))}catch(l){o(l)}}function a(c){try{u(r.throw(c))}catch(l){o(l)}}function u(c){var l;c.done?s(c.value):(l=c.value,l instanceof t?l:new t(function(h){h(l)})).then(i,a)}u((r=r.apply(n,e||[])).next())})}function Ss(n,e){var t,r,s,o,i={label:0,sent:function(){if(1&s[0])throw s[1];return s[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol=="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(u){return function(c){return function(l){if(t)throw new TypeError("Generator is already executing.");for(;i;)try{if(t=1,r&&(s=2&l[0]?r.return:l[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,l[1])).done)return s;switch(r=0,s&&(l=[2&l[0],s.value]),l[0]){case 0:case 1:s=l;break;case 4:return i.label++,{value:l[1],done:!1};case 5:i.label++,r=l[1],l=[0];continue;case 7:l=i.ops.pop(),i.trys.pop();continue;default:if(!((s=(s=i.trys).length>0&&s[s.length-1])||l[0]!==6&&l[0]!==2)){i=0;continue}if(l[0]===3&&(!s||l[1]>s[0]&&l[1]<s[3])){i.label=l[1];break}if(l[0]===6&&i.label<s[1]){i.label=s[1],s=l;break}if(s&&i.label<s[2]){i.label=s[2],i.ops.push(l);break}s[2]&&i.ops.pop(),i.trys.pop();continue}l=e.call(n,i)}catch(h){l=[6,h],r=0}finally{t=s=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([u,c])}}}var Fg=["rightEye","leftEye","noseTip","mouthCenter","rightEarTragion","leftEarTragion"],ju={modelType:"short",runtime:"mediapipe",maxFaces:1},rO=function(){function n(e){var t=this;this.width=0,this.height=0,this.selfieMode=!1,this.faceDetectorSolution=new nO.FaceDetection({locateFile:function(r,s){return e.solutionPath?e.solutionPath.replace(/\/+$/,"")+"/"+r:s+"/"+r}}),this.faceDetectorSolution.setOptions({selfieMode:this.selfieMode,model:e.modelType}),this.faceDetectorSolution.onResults(function(r){if(t.height=r.image.height,t.width=r.image.width,t.faces=[],r.detections!==null)for(var s=0,o=r.detections;s<o.length;s++){var i=o[s];t.faces.push(t.normalizedToAbsolute(i.landmarks,{xMin:u=(a=i.boundingBox).xCenter-a.width/2,xMax:u+a.width,yMin:c=a.yCenter-a.height/2,yMax:c+a.height,width:a.width,height:a.height}))}var a,u,c})}return n.prototype.normalizedToAbsolute=function(e,t){var r=this;return{keypoints:e.map(function(s,o){return{x:s.x*r.width,y:s.y*r.height,name:Fg[o]}}),box:{xMin:t.xMin*this.width,yMin:t.yMin*this.height,xMax:t.xMax*this.width,yMax:t.yMax*this.height,width:t.width*this.width,height:t.height*this.height}}},n.prototype.estimateFaces=function(e,t){return $s(this,void 0,void 0,function(){var r,s;return Ss(this,function(o){switch(o.label){case 0:return t&&t.flipHorizontal&&t.flipHorizontal!==this.selfieMode&&(this.selfieMode=t.flipHorizontal,this.faceDetectorSolution.setOptions({selfieMode:this.selfieMode})),e instanceof Rt?(s=ImageData.bind,[4,V1(e)]):[3,2];case 1:return r=new(s.apply(ImageData,[void 0,o.sent(),e.shape[1],e.shape[0]])),[3,3];case 2:r=e,o.label=3;case 3:return e=r,[4,this.faceDetectorSolution.send({image:e})];case 4:return o.sent(),[2,this.faces]}})})},n.prototype.dispose=function(){this.faceDetectorSolution.close()},n.prototype.reset=function(){this.faceDetectorSolution.reset(),this.width=0,this.height=0,this.faces=null,this.selfieMode=!1},n.prototype.initialize=function(){return this.faceDetectorSolution.initialize()},n}();function sO(n){return $s(this,void 0,void 0,function(){var e,t;return Ss(this,function(r){switch(r.label){case 0:return e=function(s){if(s==null)return js({},ju);var o=js({},s);return o.runtime="mediapipe",o.modelType==null&&(o.modelType=ju.modelType),o.maxFaces==null&&(o.maxFaces=ju.maxFaces),o}(n),[4,(t=new rO(e)).initialize()];case 1:return r.sent(),[2,t]}})})}function Pg(n){return n instanceof Rt?{height:n.shape[0],width:n.shape[1]}:{height:n.height,width:n.width}}function Lg(n){return n instanceof Rt?n:U1(n)}function Hu(n,e){M(n.width!==0,function(){return e+" width cannot be 0."}),M(n.height!==0,function(){return e+" height cannot be 0."})}function oO(n,e,t){var r=e.outputTensorSize,s=e.keepAspectRatio,o=e.borderMode,i=e.outputTensorFloatRange,a=Pg(n),u=function(d,m){return m?{xCenter:m.xCenter*d.width,yCenter:m.yCenter*d.height,width:m.width*d.width,height:m.height*d.height,rotation:m.rotation}:{xCenter:.5*d.width,yCenter:.5*d.height,width:d.width,height:d.height,rotation:0}}(a,t),c=function(d,m,g){if(g===void 0&&(g=!1),!g)return{top:0,left:0,right:0,bottom:0};var C=m.height,$=m.width;Hu(m,"targetSize"),Hu(d,"roi");var T,A,P=C/$,B=d.height/d.width,H=0,x=0;return P>B?(T=d.width,A=d.width*P,x=(1-B/P)/2):(T=d.height/P,A=d.height,H=(1-P/B)/2),d.width=T,d.height=A,{top:x,left:H,right:H,bottom:x}}(u,r,s),l=function(d,m,g,C){var $=d.width,T=d.height,A=C?-1:1,P=Math.cos(d.rotation),B=Math.sin(d.rotation),H=d.xCenter,x=d.yCenter,re=1/m,oe=1/g,ie=new Array(16);return ie[0]=$*P*A*re,ie[1]=-T*B*re,ie[2]=0,ie[3]=(-.5*$*P*A+.5*T*B+H)*re,ie[4]=$*B*A*oe,ie[5]=T*P*oe,ie[6]=0,ie[7]=(-.5*T*P-.5*$*B*A+x)*oe,ie[8]=0,ie[9]=0,ie[10]=$*re,ie[11]=0,ie[12]=0,ie[13]=0,ie[14]=0,ie[15]=1,function(le){if(le.length!==16)throw new Error("Array length must be 16 but got "+le.length);return[[le[0],le[1],le[2],le[3]],[le[4],le[5],le[6],le[7]],[le[8],le[9],le[10],le[11]],[le[12],le[13],le[14],le[15]]]}(ie)}(u,a.width,a.height,!1),h=Lt(function(){var d=Lg(n),m=Ws(function($,T,A){return Hu(A,"inputResolution"),[1/A.width*$[0][0]*T.width,1/A.height*$[0][1]*T.width,$[0][3]*T.width,1/A.width*$[1][0]*T.height,1/A.height*$[1][1]*T.height,$[1][3]*T.height,0,0]}(l,a,r),[1,8]),g=o==="zero"?"constant":"nearest",C=Ti.transform(Or(At(d,"float32")),m,"bilinear",g,0,[r.height,r.width]);return i!=null?function($,T){var A=function(P,B,H,x){var re=(x-H)/255;return{scale:re,offset:H-0*re}}(0,0,T[0],T[1]);return Lt(function(){return Ct(We($,A.scale),A.offset)})}(C,i):C});return{imageTensor:h,padding:c,transformationMatrix:l}}function Zh(n){n.reduceBoxesInLowestLayer==null&&(n.reduceBoxesInLowestLayer=!1),n.interpolatedScaleAspectRatio==null&&(n.interpolatedScaleAspectRatio=1),n.fixedAnchorSize==null&&(n.fixedAnchorSize=!1);for(var e=[],t=0;t<n.numLayers;){for(var r=[],s=[],o=[],i=[],a=t;a<n.strides.length&&n.strides[a]===n.strides[t];){var u=Jh(n.minScale,n.maxScale,a,n.strides.length);if(a===0&&n.reduceBoxesInLowestLayer)o.push(1),o.push(2),o.push(.5),i.push(.1),i.push(u),i.push(u);else{for(var c=0;c<n.aspectRatios.length;++c)o.push(n.aspectRatios[c]),i.push(u);if(n.interpolatedScaleAspectRatio>0){var l=a===n.strides.length-1?1:Jh(n.minScale,n.maxScale,a+1,n.strides.length);i.push(Math.sqrt(u*l)),o.push(n.interpolatedScaleAspectRatio)}}a++}for(var h=0;h<o.length;++h){var d=Math.sqrt(o[h]);r.push(i[h]/d),s.push(i[h]*d)}var m=0,g=0;if(n.featureMapHeight.length>0)m=n.featureMapHeight[t],g=n.featureMapWidth[t];else{var C=n.strides[t];m=Math.ceil(n.inputSizeHeight/C),g=Math.ceil(n.inputSizeWidth/C)}for(var $=0;$<m;++$)for(var T=0;T<g;++T)for(var A=0;A<r.length;++A){var P={xCenter:(T+n.anchorOffsetX)/g,yCenter:($+n.anchorOffsetY)/m,width:0,height:0};n.fixedAnchorSize?(P.width=1,P.height=1):(P.width=s[A],P.height=r[A]),e.push(P)}t=a}return e}function Jh(n,e,t,r){return r===1?.5*(n+e):n+(e-n)*t/(r-1)}function ef(n,e){var t=e[0],r=e[1];return[t*n[0]+r*n[1]+n[3],t*n[4]+r*n[5]+n[7]]}function iO(n,e,t,r){return $s(this,void 0,void 0,function(){var s,o,i,a,u;return Ss(this,function(c){switch(c.label){case 0:return n.sort(function(l,h){return Math.max.apply(Math,h.score)-Math.max.apply(Math,l.score)}),s=Ws(n.map(function(l){return[l.locationData.relativeBoundingBox.yMin,l.locationData.relativeBoundingBox.xMin,l.locationData.relativeBoundingBox.yMax,l.locationData.relativeBoundingBox.xMax]})),o=Tn(n.map(function(l){return l.score[0]})),[4,Ti.nonMaxSuppressionAsync(s,o,e,t)];case 1:return[4,(i=c.sent()).array()];case 2:return a=c.sent(),u=n.filter(function(l,h){return a.indexOf(h)>-1}),es([s,o,i]),[2,u]}})})}function aO(n,e,t){return $s(this,void 0,void 0,function(){var r,s,o,i,a;return Ss(this,function(u){switch(u.label){case 0:return r=n[0],s=n[1],o=function(c,l,h){return Lt(function(){var d,m,g,C;h.reverseOutputOrder?(m=Yt(Ze(c,[0,h.boxCoordOffset+0],[-1,1])),d=Yt(Ze(c,[0,h.boxCoordOffset+1],[-1,1])),C=Yt(Ze(c,[0,h.boxCoordOffset+2],[-1,1])),g=Yt(Ze(c,[0,h.boxCoordOffset+3],[-1,1]))):(d=Yt(Ze(c,[0,h.boxCoordOffset+0],[-1,1])),m=Yt(Ze(c,[0,h.boxCoordOffset+1],[-1,1])),g=Yt(Ze(c,[0,h.boxCoordOffset+2],[-1,1])),C=Yt(Ze(c,[0,h.boxCoordOffset+3],[-1,1]))),m=Ct(We(xt(m,h.xScale),l.w),l.x),d=Ct(We(xt(d,h.yScale),l.h),l.y),h.applyExponentialOnBoxSize?(g=We(ws(xt(g,h.hScale)),l.h),C=We(ws(xt(C,h.wScale)),l.w)):(g=We(xt(g,h.hScale),l.h),C=We(xt(C,h.wScale),l.h));var $=nt(d,xt(g,2)),T=nt(m,xt(C,2)),A=Ct(d,xt(g,2)),P=Ct(m,xt(C,2)),B=sn([me($,[h.numBoxes,1]),me(T,[h.numBoxes,1]),me(A,[h.numBoxes,1]),me(P,[h.numBoxes,1])],1);if(h.numKeypoints)for(var H=0;H<h.numKeypoints;++H){var x=h.keypointCoordOffset+H*h.numValuesPerKeypoint,re=void 0,oe=void 0;h.reverseOutputOrder?(re=Yt(Ze(c,[0,x],[-1,1])),oe=Yt(Ze(c,[0,x+1],[-1,1]))):(oe=Yt(Ze(c,[0,x],[-1,1])),re=Yt(Ze(c,[0,x+1],[-1,1])));var ie=Ct(We(xt(re,h.xScale),l.w),l.x),le=Ct(We(xt(oe,h.yScale),l.h),l.y);B=sn([B,me(ie,[h.numBoxes,1]),me(le,[h.numBoxes,1])],1)}return B})}(s,e,t),i=Lt(function(){var c=r;return t.sigmoidScore?(t.scoreClippingThresh!=null&&(c=u2(r,-t.scoreClippingThresh,t.scoreClippingThresh)),c=So(c)):c}),[4,uO(o,i,t)];case 1:return a=u.sent(),es([o,i]),[2,a]}})})}function uO(n,e,t){return $s(this,void 0,void 0,function(){var r,s,o,i,a,u,c,l,h,d,m,g;return Ss(this,function(C){switch(C.label){case 0:return r=[],[4,n.data()];case 1:return s=C.sent(),[4,e.data()];case 2:for(o=C.sent(),i=0;i<t.numBoxes;++i)if(!(t.minScoreThresh!=null&&o[i]<t.minScoreThresh||(a=i*t.numCoords,u=cO(s[a+0],s[a+1],s[a+2],s[a+3],o[i],t.flipVertically,i),(c=u.locationData.relativeBoundingBox).width<0||c.height<0))){if(t.numKeypoints>0)for((l=u.locationData).relativeKeypoints=[],h=t.numKeypoints*t.numValuesPerKeypoint,d=0;d<h;d+=t.numValuesPerKeypoint)m=a+t.keypointCoordOffset+d,g={x:s[m+0],y:t.flipVertically?1-s[m+1]:s[m+1]},l.relativeKeypoints.push(g);r.push(u)}return[2,r]}})})}function cO(n,e,t,r,s,o,i){return{score:[s],ind:i,locationData:{relativeBoundingBox:{xMin:e,yMin:o?1-t:n,xMax:r,yMax:o?1-n:t,width:r-e,height:t-n}}}}var Za,lO={reduceBoxesInLowestLayer:!1,interpolatedScaleAspectRatio:1,featureMapHeight:[],featureMapWidth:[],numLayers:4,minScale:.1484375,maxScale:.75,inputSizeHeight:128,inputSizeWidth:128,anchorOffsetX:.5,anchorOffsetY:.5,strides:[8,16,16,16],aspectRatios:[1],fixedAnchorSize:!0},hO={reduceBoxesInLowestLayer:!1,interpolatedScaleAspectRatio:0,featureMapHeight:[],featureMapWidth:[],numLayers:1,minScale:.1484375,maxScale:.75,inputSizeHeight:192,inputSizeWidth:192,anchorOffsetX:.5,anchorOffsetY:.5,strides:[4],aspectRatios:[1],fixedAnchorSize:!0},qu={runtime:"tfjs",modelType:"short",maxFaces:1,detectorModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/face_detection/short/1"},fO={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:896,numCoords:16,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:6,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:128,yScale:128,hScale:128,wScale:128,minScoreThresh:.5},dO={applyExponentialOnBoxSize:!1,flipVertically:!1,ignoreClasses:[],numClasses:1,numBoxes:2304,numCoords:16,boxCoordOffset:0,keypointCoordOffset:4,numKeypoints:6,numValuesPerKeypoint:2,sigmoidScore:!0,scoreClippingThresh:100,reverseOutputOrder:!0,xScale:192,yScale:192,hScale:192,wScale:192,minScoreThresh:.6},pO={outputTensorSize:{width:128,height:128},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},mO={outputTensorSize:{width:192,height:192},keepAspectRatio:!0,outputTensorFloatRange:[-1,1],borderMode:"zero"},gO=function(){function n(e,t,r){this.detectorModel=t,this.maxFaces=r,e==="full"?(this.imageToTensorConfig=mO,this.tensorsToDetectionConfig=dO,this.anchors=Zh(hO)):(this.imageToTensorConfig=pO,this.tensorsToDetectionConfig=fO,this.anchors=Zh(lO));var s=Tn(this.anchors.map(function(u){return u.width})),o=Tn(this.anchors.map(function(u){return u.height})),i=Tn(this.anchors.map(function(u){return u.xCenter})),a=Tn(this.anchors.map(function(u){return u.yCenter}));this.anchorTensor={x:i,y:a,w:s,h:o}}return n.prototype.dispose=function(){this.detectorModel.dispose(),es([this.anchorTensor.x,this.anchorTensor.y,this.anchorTensor.w,this.anchorTensor.h])},n.prototype.reset=function(){},n.prototype.detectFaces=function(e,t){return t===void 0&&(t=!1),$s(this,void 0,void 0,function(){var r,s,o,i,a,u,c,l,h,d,m;return Ss(this,function(g){switch(g.label){case 0:return e==null?(this.reset(),[2,[]]):(r=Lt(function(){var C=At(Lg(e),"float32");return t&&(C=Yt(Ti.flipLeftRight(Or(C,0)),[0])),C}),s=oO(r,this.imageToTensorConfig),o=s.imageTensor,i=s.transformationMatrix,a=this.detectorModel.execute(o,"Identity:0"),u=function(C){return Lt(function(){var $=function(P){return Lt(function(){return[Ze(P,[0,0,0],[1,-1,1]),Ze(P,[0,0,1],[1,-1,-1])]})}(C),T=$[0],A=$[1];return{boxes:Yt(A),logits:Yt(T)}})}(a),c=u.boxes,[4,aO([l=u.logits,c],this.anchorTensor,this.tensorsToDetectionConfig)]);case 1:return(h=g.sent()).length===0?(es([r,o,a,l,c]),[2,h]):[4,iO(h,this.maxFaces,.3)];case 2:return d=g.sent(),m=function(C,$){C===void 0&&(C=[]);var T,A=(T=$,[].concat.apply([],T));return C.forEach(function(P){var B=P.locationData;B.relativeKeypoints.forEach(function(le){var $e=ef(A,[le.x,le.y]),Ie=$e[0],Ae=$e[1];le.x=Ie,le.y=Ae});var H=B.relativeBoundingBox,x=Number.MAX_VALUE,re=Number.MAX_VALUE,oe=Number.MIN_VALUE,ie=Number.MIN_VALUE;[[H.xMin,H.yMin],[H.xMin+H.width,H.yMin],[H.xMin+H.width,H.yMin+H.height],[H.xMin,H.yMin+H.height]].forEach(function(le){var $e=ef(A,le),Ie=$e[0],Ae=$e[1];x=Math.min(x,Ie),oe=Math.max(oe,Ie),re=Math.min(re,Ae),ie=Math.max(ie,Ae)}),B.relativeBoundingBox={xMin:x,xMax:oe,yMin:re,yMax:ie,width:oe-x,height:ie-re}}),C}(d,i),es([r,o,a,l,c]),[2,m]}})})},n.prototype.estimateFaces=function(e,t){return $s(this,void 0,void 0,function(){var r,s;return Ss(this,function(o){return r=Pg(e),s=!!t&&t.flipHorizontal,[2,this.detectFaces(e,s).then(function(i){return i.map(function(a){for(var u=a.locationData.relativeKeypoints.map(function(g,C){return js(js({},g),{x:g.x*r.width,y:g.y*r.height,name:Fg[C]})}),c=a.locationData.relativeBoundingBox,l=0,h=["width","xMax","xMin"];l<h.length;l++)c[h[l]]*=r.width;for(var d=0,m=["height","yMax","yMin"];d<m.length;d++)c[m[d]]*=r.height;return{keypoints:u,box:c}})})]})})},n}();function yO(n){return $s(this,void 0,void 0,function(){var e,t,r;return Ss(this,function(s){switch(s.label){case 0:return e=function(o){if(o==null)return js({},qu);var i=js({},o);return i.modelType==null&&(i.modelType=qu.modelType),i.maxFaces==null&&(i.maxFaces=qu.maxFaces),i.detectorModelUrl==null&&(i.modelType==="full"?i.detectorModelUrl="https://tfhub.dev/mediapipe/tfjs-model/face_detection/full/1":i.detectorModelUrl="https://tfhub.dev/mediapipe/tfjs-model/face_detection/short/1"),i}(n),t=typeof e.detectorModelUrl=="string"&&e.detectorModelUrl.indexOf("https://tfhub.dev")>-1,[4,Ag(e.detectorModelUrl,{fromTFHub:t})];case 1:return r=s.sent(),[2,new gO(e.modelType,r,e.maxFaces)]}})})}function xO(n,e){return $s(this,void 0,void 0,function(){var t,r;return Ss(this,function(s){if(n===Za.MediaPipeFaceDetector){if(r=void 0,(t=e)!=null){if(t.runtime==="tfjs")return[2,yO(t)];if(t.runtime==="mediapipe")return[2,sO(t)];r=t.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' or 'mediapipe', but got "+r)}throw new Error(n+" is not a supported model name.")})})}function Xu(n){return n.width*n.height}function tf(n){var e=n.xCenter-n.width/2,t=e+n.width,r=n.yCenter-n.height/2;return{xMin:e,xMax:t,yMin:r,yMax:r+n.height,width:n.width,height:n.height}}function bO(n,e){var t=tf(n),r=tf(e);if(!function(i,a){return!(i.xMax<a.xMin||a.xMax<i.xMin||i.yMax<a.yMin||a.yMax<i.yMin)}(t,r))return 0;var s=Xu(function(i,a){var u=Math.max(i.xMin,a.xMin),c=Math.min(i.xMax,a.xMax),l=Math.max(i.yMin,a.yMin),h=Math.min(i.yMax,a.yMax);return{xMin:u,xMax:c,yMin:l,yMax:h,width:Math.max(c-u,0),height:Math.max(h-l,0)}}(t,r)),o=Xu(t)+Xu(r)-s;return o>0?s/o:0}function vO(n,e,t,r){var s=n.width,o=n.height,i=r?-1:1,a=Math.cos(n.rotation),u=Math.sin(n.rotation),c=n.xCenter,l=n.yCenter,h=1/e,d=1/t,m=new Array(16);return m[0]=s*a*i*h,m[1]=-o*u*h,m[2]=0,m[3]=(-.5*s*a*i+.5*o*u+c)*h,m[4]=s*u*i*d,m[5]=o*a*d,m[6]=0,m[7]=(-.5*o*a-.5*s*u*i+l)*d,m[8]=0,m[9]=0,m[10]=s*h,m[11]=0,m[12]=0,m[13]=0,m[14]=0,m[15]=1,function(g){if(g.length!==16)throw new Error("Array length must be 16 but got "+g.length);return[[g[0],g[1],g[2],g[3]],[g[4],g[5],g[6],g[7]],[g[8],g[9],g[10],g[11]],[g[12],g[13],g[14],g[15]]]}(m)}function Bg(n){return n instanceof Rt?{height:n.shape[0],width:n.shape[1]}:{height:n.height,width:n.width}}function Mg(n){return n-2*Math.PI*Math.floor((n+Math.PI)/(2*Math.PI))}function Vg(n){return n instanceof Rt?n:U1(n)}function Ku(n,e){M(n.width!==0,function(){return e+" width cannot be 0."}),M(n.height!==0,function(){return e+" height cannot be 0."})}function wO(n,e){var t=function(r,s,o,i){var a=s-r,u=i-o;if(a===0)throw new Error("Original min and max are both "+r+", range cannot be 0.");var c=u/a;return{scale:c,offset:o-r*c}}(0,255,e[0],e[1]);return Lt(function(){return Ct(We(n,t.scale),t.offset)})}function CO(n,e,t){var r=e.outputTensorSize,s=e.keepAspectRatio,o=e.borderMode,i=e.outputTensorFloatRange,a=Bg(n),u=function(d,m){return m?{xCenter:m.xCenter*d.width,yCenter:m.yCenter*d.height,width:m.width*d.width,height:m.height*d.height,rotation:m.rotation}:{xCenter:.5*d.width,yCenter:.5*d.height,width:d.width,height:d.height,rotation:0}}(a,t),c=function(d,m,g){if(g===void 0&&(g=!1),!g)return{top:0,left:0,right:0,bottom:0};var C=m.height,$=m.width;Ku(m,"targetSize"),Ku(d,"roi");var T,A,P=C/$,B=d.height/d.width,H=0,x=0;return P>B?(T=d.width,A=d.width*P,x=(1-B/P)/2):(T=d.height/P,A=d.height,H=(1-P/B)/2),d.width=T,d.height=A,{top:x,left:H,right:H,bottom:x}}(u,r,s),l=vO(u,a.width,a.height,!1),h=Lt(function(){var d=Vg(n),m=Ws(function($,T,A){return Ku(A,"inputResolution"),[1/A.width*$[0][0]*T.width,1/A.height*$[0][1]*T.width,$[0][3]*T.width,1/A.width*$[1][0]*T.height,1/A.height*$[1][1]*T.height,$[1][3]*T.height,0,0]}(l,a,r),[1,8]),g=o==="zero"?"constant":"nearest",C=Ti.transform(Or(At(d,"float32")),m,"bilinear",g,0,[r.height,r.width]);return i!=null?wO(C,i):C});return{imageTensor:h,padding:c,transformationMatrix:l}}function nf(n){return{xCenter:n.xMin+n.width/2,yCenter:n.yMin+n.height/2,width:n.width,height:n.height}}function rf(n){var e=n.relativeKeypoints;if(e.length<=1)throw new Error("2 or more keypoints required to calculate a rect.");var t=Number.MAX_VALUE,r=Number.MAX_VALUE,s=Number.MIN_VALUE,o=Number.MIN_VALUE;return e.forEach(function(i){t=Math.min(t,i.x),s=Math.max(s,i.x),r=Math.min(r,i.y),o=Math.max(o,i.y)}),{xCenter:(t+s)/2,yCenter:(r+o)/2,width:s-t,height:o-r}}function sf(n,e,t,r,s){var o=t==="rect"?function(i,a,u){var c,l=i.locationData;if(a==="boundingbox")c=nf(l.boundingBox);else{c=rf(l);var h=u.width,d=u.height;c.xCenter=Math.round(c.xCenter*h),c.yCenter=Math.round(c.yCenter*d),c.width=Math.round(c.width*h),c.height=Math.round(c.height*d)}return c}(n,e,r):function(i,a){var u=i.locationData;return a==="boundingbox"?nf(u.relativeBoundingBox):rf(u)}(n,e);return s&&(o.rotation=function(i,a,u){var c,l=i.locationData,h=u.rotationVectorStartKeypointIndex,d=u.rotationVectorEndKeypointIndex;c=u.rotationVectorTargetAngle?u.rotationVectorTargetAngle:Math.PI*u.rotationVectorTargetAngleDegree/180;var m=l.relativeKeypoints[h].x*a.width,g=l.relativeKeypoints[h].y*a.height,C=l.relativeKeypoints[d].x*a.width,$=l.relativeKeypoints[d].y*a.height;return Mg(c-Math.atan2(-($-g),C-m))}(n,r,s)),o}function TO(n,e,t){for(var r=0;r<e.length;++r){var s=e[r],o=t[n[r]];o.x=s.x,o.y=s.y}}function $O(n,e,t,r){if(typeof e=="string"){if(e==="copy")for(var s=0;s<t.length;++s)r[n[s]].z=t[s].z}else{var o=function(i,a){for(var u=0,c=0;c<a.length;++c)u+=i[a[c]].z;return u/a.length}(r,e);for(s=0;s<n.length;++s)r[n[s]].z=o}}function SO(n,e){for(var t=function(a){var u=[].concat.apply([],a.map(function(m){return m.indexesMapping}));if(u.length===0)throw new Error("There should be at least one landmark in indexes mapping");var c=u[0],l=u[0],h=new Set(u);h.forEach(function(m){c=Math.min(c,m),l=Math.max(l,m)});var d=h.size;if(c!==0)throw new Error("Indexes are expected to start with 0 instead of "+c);if(l+1!==d)throw new Error("Indexes should have no gaps but "+(l-d+1)+" indexes are missing");return d}(e),r=new Array(t).fill(null).map(Object),s=0;s<n.length;++s){var o=n[s],i=e[s];if(o.length!==i.indexesMapping.length)throw new Error("There are "+o.length+" refinement landmarks while mapping has "+i.indexesMapping.length);TO(i.indexesMapping,o,r),$O(i.indexesMapping,i.zRefinement,o,r)}return r}function NO(n,e){return n.map(function(t){var r=Lr(Lr({},t),{x:t.x*e.width,y:t.y*e.height});return t.z!=null&&(r.z=t.z*e.width),r})}function EO(n,e){return n==="none"?e:function(t){return 1/(1+Math.exp(-t))}(e)}function mo(n,e,t,r){return ys(this,void 0,void 0,function(){var s,o,i,a,u,c,l,h;return xs(this,function(d){switch(d.label){case 0:return t=t||e.flipHorizontally||!1,r=r||e.flipVertically||!1,s=n.size,o=s/e.numLandmarks,[4,n.data()];case 1:for(i=d.sent(),a=[],u=0;u<e.numLandmarks;++u)c=u*o,(h={x:0,y:0}).x=t?e.inputImageWidth-i[c]:i[c],o>1&&(h.y=r?e.inputImageHeight-i[c+1]:i[c+1]),o>2&&(h.z=i[c+2]),o>3&&(h.score=EO(e.visibilityActivation,i[c+3])),a.push(h);for(l=0;l<a.length;++l)(h=a[l]).x=h.x/e.inputImageWidth,h.y=h.y/e.inputImageHeight,h.z=h.z/e.inputImageWidth/(e.normalizeZ||1);return[2,a]}})})}function of(n,e,t){var r=n.width,s=n.height,o=n.rotation;if(t.rotation==null&&t.rotationDegree==null||(o=function(l,h){return h.rotation!=null?l+=h.rotation:h.rotationDegree!=null&&(l+=Math.PI*h.rotationDegree/180),Mg(l)}(o,t)),o===0)n.xCenter=n.xCenter+r*t.shiftX,n.yCenter=n.yCenter+s*t.shiftY;else{var i=(e.width*r*t.shiftX*Math.cos(o)-e.height*s*t.shiftY*Math.sin(o))/e.width,a=(e.width*r*t.shiftX*Math.sin(o)+e.height*s*t.shiftY*Math.cos(o))/e.height;n.xCenter=n.xCenter+i,n.yCenter=n.yCenter+a}if(t.squareLong){var u=Math.max(r*e.width,s*e.height);r=u/e.width,s=u/e.height}else if(t.squareShort){var c=Math.min(r*e.width,s*e.height);r=c/e.width,s=c/e.height}return n.width=r*t.scaleX,n.height=s*t.scaleY,n}(Za||(Za={})).MediaPipeFaceDetector="MediaPipeFaceDetector";var Yu={runtime:"tfjs",maxFaces:1,refineLandmarks:!1,landmarkModelUrl:"https://tfhub.dev/mediapipe/tfjs-model/face_landmarks_detection/face_mesh/1"},Qu={flipHorizontal:!1,staticImageMode:!1},af={shiftX:0,shiftY:0,scaleX:1.5,scaleY:1.5,squareLong:!0},kO={outputTensorSize:{width:192,height:192},outputTensorFloatRange:[0,1],borderMode:"replicate"},uf={numLandmarks:468,inputImageWidth:192,inputImageHeight:192,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},IO={numLandmarks:80,inputImageWidth:192,inputImageHeight:192,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},cf={numLandmarks:71,inputImageWidth:192,inputImageHeight:192,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},lf={numLandmarks:5,inputImageWidth:192,inputImageHeight:192,visibilityActivation:"none",flipHorizontally:!1,flipVertically:!1},_O={indexesMapping:Array.from(Array(468).keys()),zRefinement:"copy"},RO={indexesMapping:[61,146,91,181,84,17,314,405,321,375,291,185,40,39,37,0,267,269,270,409,78,95,88,178,87,14,317,402,318,324,308,191,80,81,82,13,312,311,310,415,76,77,90,180,85,16,315,404,320,307,306,184,74,73,72,11,302,303,304,408,62,96,89,179,86,15,316,403,319,325,292,183,42,41,38,12,268,271,272,407],zRefinement:"none"},AO={indexesMapping:[33,7,163,144,145,153,154,155,133,246,161,160,159,158,157,173,130,25,110,24,23,22,26,112,243,247,30,29,27,28,56,190,226,31,228,229,230,231,232,233,244,113,225,224,223,222,221,189,35,124,46,53,52,65,143,111,117,118,119,120,121,128,245,156,70,63,105,66,107,55,193],zRefinement:"none"},OO={indexesMapping:[263,249,390,373,374,380,381,382,362,466,388,387,386,385,384,398,359,255,339,254,253,252,256,341,463,467,260,259,257,258,286,414,446,261,448,449,450,451,452,453,464,342,445,444,443,442,441,413,265,353,276,283,282,295,372,340,346,347,348,349,350,357,465,383,300,293,334,296,336,285,417],zRefinement:"none"},DO={indexesMapping:[468,469,470,471,472],zRefinement:[33,7,163,144,145,153,154,155,133,246,161,160,159,158,157,173]},FO={indexesMapping:[473,474,475,476,477],zRefinement:[263,249,390,373,374,380,381,382,362,466,388,387,386,385,384,398]},xi,PO=function(){function n(e,t,r,s){this.detector=e,this.landmarkModel=t,this.maxFaces=r,this.withAttention=s,this.prevFaceRectsFromLandmarks=null}return n.prototype.estimateFaces=function(e,t){return ys(this,void 0,void 0,function(){var r,s,o,i,a,u,c,l,h,d,m,g,C,$=this;return xs(this,function(T){switch(T.label){case 0:return r=function(B){if(B==null)return Lr({},Qu);var H=Lr({},B);return H.flipHorizontal==null&&(H.flipHorizontal=Qu.flipHorizontal),H.staticImageMode==null&&(H.staticImageMode=Qu.staticImageMode),H}(t),e==null?(this.reset(),[2,[]]):(s=Bg(e),o=Lt(function(){var B=At(Vg(e),"float32");return r.flipHorizontal&&(B=Yt(Ti.flipLeftRight(Or(B,0)),[0])),B}),i=this.prevFaceRectsFromLandmarks,r.staticImageMode||i==null||i.length<this.maxFaces?[4,this.detector.detectFaces(o,!1)]:[3,2]);case 1:return(u=T.sent()).length===0?(this.reset(),o.dispose(),[2,[]]):(a=u.map(function(B){return $.faceDetectionFrontDetectionToRoi(B,s)}),[3,3]);case 2:a=[],T.label=3;case 3:return A=.5,P=[],[a,i||[]].forEach(function(B){return B.forEach(function(H){(P=P.filter(function(x){return bO(H,x)<=A})).push(H)})}),c=P,[4,Promise.all(c.map(function(B){return $.faceLandmark(B,o)}))];case 4:for(l=T.sent(),h=[],this.prevFaceRectsFromLandmarks=[],d=0;d<l.length;++d)(m=l[d])!=null&&(this.prevFaceRectsFromLandmarks.push(this.faceLandmarksToRoi(m,s)),(g=NO(m,s))!=null&&g.forEach(function(B,H){var x=Dg.get(H);x!=null&&(B.name=x)}),C=Gc(g),h.push({keypoints:g,box:C.locationData.relativeBoundingBox}));return o.dispose(),[2,h]}var A,P})})},n.prototype.dispose=function(){this.detector.dispose(),this.landmarkModel.dispose()},n.prototype.reset=function(){this.detector.reset(),this.prevFaceRectsFromLandmarks=null},n.prototype.faceDetectionFrontDetectionToRoi=function(e,t){return of(sf(e,"boundingbox","normRect",t,{rotationVectorStartKeypointIndex:0,rotationVectorEndKeypointIndex:1,rotationVectorTargetAngleDegree:0}),t,af)},n.prototype.faceLandmark=function(e,t){return ys(this,void 0,void 0,function(){var r,s,o,i,a,u,c;return xs(this,function(l){switch(l.label){case 0:return r=CO(t,kO,e).imageTensor,s=["output_faceflag"].concat(this.withAttention?["output_mesh_identity","output_lips","Identity_6:0","Identity_1:0","Identity_2:0","Identity_5:0"]:["output_mesh"]),o=this.landmarkModel.execute(r,s),i=o[0],a=o.slice(1),[4,i.data()];case 1:return l.sent()[0]<.5?(es(o),es(r),[2,null]):this.withAttention?[4,this.tensorsToFaceLandmarksWithAttention(a)]:[3,3];case 2:return u=l.sent(),[3,5];case 3:return[4,this.tensorsToFaceLandmarks(a)];case 4:u=l.sent(),l.label=5;case 5:return c=function(h,d,m){m===void 0&&(m={ignoreRotation:!1});for(var g=[],C=0,$=h;C<$.length;C++){var T=$[C],A=T.x-.5,P=T.y-.5,B=m.ignoreRotation?0:d.rotation,H=Math.cos(B)*A-Math.sin(B)*P,x=Math.sin(B)*A+Math.cos(B)*P;H=H*d.width+d.xCenter,x=x*d.height+d.yCenter;var re=T.z*d.width,oe=Lr({},T);oe.x=H,oe.y=x,oe.z=re,g.push(oe)}return g}(u,e),es(o),es(r),[2,c]}})})},n.prototype.tensorsToFaceLandmarks=function(e){return ys(this,void 0,void 0,function(){return xs(this,function(t){return[2,mo(e[0],uf)]})})},n.prototype.tensorsToFaceLandmarksWithAttention=function(e){return ys(this,void 0,void 0,function(){var t,r,s,o,i,a;return xs(this,function(u){switch(u.label){case 0:return[4,mo(e[0],uf)];case 1:return t=u.sent(),[4,mo(e[1],IO)];case 2:return r=u.sent(),[4,mo(e[3],cf)];case 3:return s=u.sent(),[4,mo(e[5],cf)];case 4:return o=u.sent(),[4,mo(e[4],lf)];case 5:return i=u.sent(),[4,mo(e[2],lf)];case 6:return a=u.sent(),[2,SO([t,r,s,o,i,a],[_O,RO,AO,OO,DO,FO])]}})})},n.prototype.faceLandmarksToRoi=function(e,t){return of(sf(Gc(e),"boundingbox","normRect",t,{rotationVectorStartKeypointIndex:33,rotationVectorEndKeypointIndex:263,rotationVectorTargetAngleDegree:0}),t,af)},n}();function LO(n){return ys(this,void 0,void 0,function(){var e,t,r,s;return xs(this,function(o){switch(o.label){case 0:return e=function(i){if(i==null)return Lr({},Yu);var a=Lr({},i);return a.runtime="tfjs",a.maxFaces==null&&(a.maxFaces=Yu.maxFaces),a.refineLandmarks==null&&(a.refineLandmarks=Yu.refineLandmarks),a.landmarkModelUrl==null&&(a.landmarkModelUrl=a.refineLandmarks?"https://tfhub.dev/mediapipe/tfjs-model/face_landmarks_detection/attention_mesh/1":"https://tfhub.dev/mediapipe/tfjs-model/face_landmarks_detection/face_mesh/1"),a}(n),t=typeof e.landmarkModelUrl=="string"&&e.landmarkModelUrl.indexOf("https://tfhub.dev")>-1,[4,Ag(e.landmarkModelUrl,{fromTFHub:t})];case 1:return r=o.sent(),[4,xO(Za.MediaPipeFaceDetector,{modelType:"short",maxFaces:e.maxFaces,detectorModelUrl:e.detectorModelUrl,runtime:e.runtime})];case 2:return s=o.sent(),[2,new PO(s,r,e.maxFaces,e.refineLandmarks)]}})})}function BO(n,e){return ys(this,void 0,void 0,function(){var t,r;return xs(this,function(s){if(n===xi.MediaPipeFaceMesh){if(r=void 0,(t=e)!=null){if(t.runtime==="tfjs")return[2,LO(t)];if(t.runtime==="mediapipe")return[2,tO(t)];r=t.runtime}throw new Error("Expect modelConfig.runtime to be either 'tfjs' or 'mediapipe', but got "+r)}throw new Error(n+" is not a supported model name.")})})}(function(n){n.MediaPipeFaceMesh="MediaPipeFaceMesh"})(xi||(xi={}));Object.freeze({__proto__:null,getKeypointIndexByContour:function(n){if(n===xi.MediaPipeFaceMesh)return Og;throw new Error("Model "+n+" is not supported.")},getAdjacentPairs:function(n){if(n===xi.MediaPipeFaceMesh)return ZA;throw new Error("Model "+n+" is not supported.")}});class pt{constructor(e,t){tt(this,"x");tt(this,"y");this.x=e,this.y=t}add(e){return new pt(this.x+e.x,this.y+e.y)}subtract(e){return new pt(this.x-e.x,this.y-e.y)}scale(e){return new pt(this.x*e,this.y*e)}length(){return Math.sqrt(this.x*this.x+this.y*this.y)}normalize(){return this.scale(1/this.length())}dot(e){return this.x*e.x+this.y*e.y}cross(e){return this.x*e.y-this.y*e.x}angle(){return Math.atan2(this.y,this.x)}angleTo(e){return Math.acos(this.dot(e)/(this.length()*e.length()))}distanceTo(e){return this.subtract(e).length()}rotate(e){let t=Math.cos(e),r=Math.sin(e);return new pt(this.x*t-this.y*r,this.x*r+this.y*t)}reflect(e){return this.subtract(e.scale(2*this.dot(e)))}lerp(e,t){return this.add(e.subtract(this).scale(t))}equals(e){return this.x===e.x&&this.y===e.y}toString(){return`(${this.x}, ${this.y})`}static zero(){return new pt(0,0)}static one(){return new pt(1,1)}static up(){return new pt(1,0)}static down(){return new pt(-1,0)}static left(){return new pt(0,-1)}static right(){return new pt(0,1)}static fromAngle(e){return new pt(Math.cos(e),Math.sin(e))}static distance(e,t){return e.subtract(t).length()}static reflect(e,t){return e.subtract(t.scale(2*e.dot(t)))}}class Fl{constructor(e){tt(this,"position");tt(this,"velocity");tt(this,"_width");tt(this,"_height");this.position=e,this.velocity=pt.zero()}get width(){return this._width}get height(){return this._height}collidesWithBall(e){const t=Math.abs(e.position.x-this.position.x-this.width/2),r=Math.abs(e.position.y-this.position.y-this.height/2);if(t>this.width/2+e.radius||r>this.height/2+e.radius)return!1;if(t<=this.width/2||r<=this.height/2)return!0;const s=t-this.width/2,o=r-this.height/2;return s*s+o*o<=e.radius*e.radius}collisionNormal(e){const t=Math.max(this.position.x,Math.min(e.position.x,this.position.x+this.width)),r=Math.max(this.position.y,Math.min(e.position.y,this.position.y+this.height)),s=new pt(e.position.x-t,e.position.y-r);return e.velocity.dot(s)<0?s.normalize():pt.zero()}}class hf extends Fl{constructor(t,r){super(t);tt(this,"_radius");if(r<=0)throw new Error("Radius must be greater than 0");this._radius=r,this._width=r*2,this._height=r*2}get radius(){return this._radius}draw(t){t.fillStyle="white",t.strokeStyle="black",t.beginPath(),t.arc(this.position.x,this.position.y,this.radius,0,2*Math.PI),t.fill(),t.arc(this.position.x,this.position.y,this.radius,0,2*Math.PI),t.stroke()}collidesWithBall(t){return this.position.distanceTo(t.position)<this.radius+t.radius}collisionNormal(t){return this.position.subtract(t.position).normalize()}collision(t){this.velocity=this.velocity.reflect(t)}update(t,r,s,o){return this.position.x+this.radius>r&&(this.position.x=r-this.radius,this.velocity.x=-this.velocity.x),this.position.x-this.radius<0&&(this.position.x=this.radius,this.velocity.x=-this.velocity.x),this.position.y+this.radius>s&&(this.position.y=s-this.radius,this.velocity.y=-this.velocity.y),this.position.y-this.radius<0&&(this.position.y=this.radius,this.velocity.y=-this.velocity.y),this.position=this.position.add(this.velocity.scale(t)),this.position.y>o}}class ff extends Fl{constructor(e,t,r){super(e),this._width=t,this._height=r}draw(e){e.fillStyle="white",e.strokeStyle="black",e.fillRect(this.position.x,this.position.y,this.width,this.height),e.strokeRect(this.position.x,this.position.y,this.width,this.height)}collisionNormal(e){let t=super.collisionNormal(e);if(e.position.y<this.position.y&&t.length()>0){const r=(this.position.x+this.width/2-e.position.x)/(this.width/2);t.x=-r*.2,t=t.normalize()}return t}}class df extends Fl{constructor(t,r,s,o){super(t);tt(this,"color");tt(this,"_destroyed");this.color=o,this._width=r,this._height=s,this._destroyed=!1}get destroyed(){return this._destroyed}destroy(){this._destroyed=!0}reset(){this._destroyed=!1}draw(t){this._destroyed||(t.fillStyle=this.color,t.strokeStyle="black",t.fillRect(this.position.x,this.position.y,this.width,this.height),t.strokeRect(this.position.x,this.position.y,this.width,this.height))}resize(t,r){this._height=r,this._width=t}}class MO{constructor(e,t,r,s,o=10,i=10,a=10){tt(this,"_board");tt(this,"_padding");this._padding=a,this._board=new Array(e);for(let l=0;l<e;l++)this._board[l]=new Array(t);const u=(r-(e-1)*this._padding-2*o)/e,c=(s-(t-1)*this._padding-i)/t;for(let l=0;l<e;l++)for(let h=0;h<t;h++){let d=o+l*(u+this._padding),m=i+h*(c+this._padding);this._board[l][h]=new df(new pt(d,m),u,c,"white")}}get board(){return this._board}get length(){return this._board.length*this._board[0].length}collision(e){let t=0;for(let r=0;r<this._board.length;r++)for(let s=0;s<this._board[r].length;s++)if(!this._board[r][s].destroyed&&this._board[r][s].collidesWithBall(e)){let o=this._board[r][s].collisionNormal(e);e.collision(o),this._board[r][s].destroy(),t++}return t}draw(e){for(let t=0;t<this._board.length;t++)for(let r=0;r<this._board[t].length;r++)this._board[t][r].draw(e)}reset(){for(let e=0;e<this._board.length;e++)for(let t=0;t<this._board[e].length;t++)this._board[e][t].reset()}resize(e,t,r=10,s=10,o=10){this._padding=o;let i=this._board.length,a=this._board[0].length;const u=(e-(i-1)*this._padding-2*r)/i,c=(t-(a-1)*this._padding-s)/a;for(let l=0;l<i;l++)for(let h=0;h<a;h++){let d=r+l*(u+this._padding),m=s+h*(c+this._padding);this._board[l][h]=new df(new pt(d,m),u,c,"white")}}}class VO{constructor(){tt(this,"constraints",{audio:!1,video:!0,facingMode:"user"});tt(this,"stopped",!0);tt(this,"paused",!1);tt(this,"video");tt(this,"gameCanvas");tt(this,"gameCTX");tt(this,"livesText");tt(this,"scoreText");tt(this,"lastFrameTime",0);tt(this,"model",xi.MediaPipeFaceMesh);tt(this,"detectorConfig",{runtime:"mediapipe",solutionPath:"node_modules/@mediapipe/face_mesh",refineLandmarks:!1,maxFaces:1});tt(this,"detector");tt(this,"windowRatio",0);tt(this,"webcamRatio",0);tt(this,"flipHorizontal",!1);tt(this,"Ball");tt(this,"Paddle");tt(this,"wallWidth",10);tt(this,"wallHeight",5);tt(this,"score",0);tt(this,"lives",3);tt(this,"gameBoard");tt(this,"deathHeight",0);var e;document.querySelector("#start").onclick=this.start.bind(this),document.querySelector("#pause").onclick=this.pause.bind(this),document.querySelector("#stop").onclick=this.reset.bind(this),document.querySelector("#flip").onclick=this.flipVideo.bind(this),window.addEventListener("resize",this.resize.bind(this)),this.gameCanvas=document.querySelector("#gameBoard"),this.gameCanvas.width=window.innerWidth,this.gameCanvas.height=window.innerHeight,this.gameCTX=this.gameCanvas.getContext("2d"),this.livesText=document.querySelector("#lives"),this.scoreText=document.querySelector("#score"),this.livesText.innerText="Lives: "+this.lives,this.scoreText.innerText="Score: "+this.score,(e=navigator.mediaDevices)!=null&&e.getUserMedia?navigator.mediaDevices.getUserMedia(this.constraints).then(t=>{this.video=document.querySelector("#video"),this.video.srcObject=t,this.video.play()}).catch(t=>{throw alert("Error getting video stream: "+t),t}):alert("getUserMedia not supported"),BO(this.model,this.detectorConfig).then(t=>{this.detector=t}),this.Ball=new hf(pt.zero(),25),this.Paddle=new ff(pt.zero(),130,40),this.gameBoard=new MO(this.wallWidth,this.wallHeight,this.gameCanvas.width,this.gameCanvas.height/4),this.resize()}async start(){if(!!this.stopped){for(;!this.detector;)await new Promise(e=>setTimeout(e,100));console.log("starting"),this.Ball.velocity=pt.left().scale(.4),this.Ball.position=new pt(this.gameCanvas.width/2,this.gameCanvas.height/2),this.webcamRatio=this.video.videoWidth/this.video.videoHeight,this.stopped=!1,this.paused=!1,window.requestAnimationFrame(this.draw.bind(this))}}pause(){this.stopped||(console.log(this.stopped?"unpausing":"pausing"),this.paused=!this.paused,this.paused||window.requestAnimationFrame(this.draw.bind(this)))}reset(){this.stopped||(console.log("stopping"),this.lastFrameTime=0,this.gameCTX.clearRect(0,0,this.gameCanvas.width,this.gameCanvas.height),this.stopped=!0,this.paused=!1,this.score=0,this.lives=3,this.scoreText.innerText="Score: "+this.score,this.livesText.innerText="Lives: "+this.lives,this.Ball=new hf(pt.zero(),25),this.Paddle=new ff(pt.zero(),130,40),this.gameBoard.reset())}draw(e){if(this.stopped)return;this.lastFrameTime===0&&(this.lastFrameTime=e);const t=e-this.lastFrameTime;if(this.detector.estimateFaces(this.video,{flipHorizontal:!1}).then(r=>{if(r){const o=r[0].keypoints,i=new pt(o[76].x,o[76].y),a=new pt(o[306].x,o[306].y),u=i.lerp(a,.5);this.Paddle.position=this.translatePosition(u).subtract(new pt(this.Paddle.width/2,this.Paddle.height/2))}}).catch(r=>{console.log(r)}),this.paused||(this.Ball.update(t,this.gameCanvas.width,this.gameCanvas.height,this.deathHeight)&&(this.lives--,this.Ball.position=new pt(this.gameCanvas.width/2,this.gameCanvas.height/2)),this.score+=this.gameBoard.collision(this.Ball),this.Paddle.collidesWithBall(this.Ball)&&this.Ball.collision(this.Paddle.collisionNormal(this.Ball))),this.gameCTX.clearRect(0,0,this.gameCanvas.width,this.gameCanvas.height),this.Paddle.draw(this.gameCTX),this.Paddle.draw(this.gameCTX),this.Ball.draw(this.gameCTX),this.gameBoard.draw(this.gameCTX),this.gameCTX.strokeStyle="red",this.gameCTX.beginPath(),this.gameCTX.moveTo(0,this.deathHeight),this.gameCTX.lineTo(this.gameCanvas.width,this.deathHeight),this.gameCTX.stroke(),this.livesText.innerText="Lives: "+this.lives,this.scoreText.innerText="Score: "+this.score,this.lives<=0){this.reset(),window.alert("Game Over");return}if(this.score>=this.gameBoard.length){this.reset(),window.alert("You Win!");return}this.lastFrameTime=e,window.requestAnimationFrame(this.draw.bind(this))}resize(){this.gameCanvas.width=window.innerWidth,this.gameCanvas.height=window.innerHeight,this.gameBoard.resize(this.gameCanvas.width,this.gameCanvas.height/3),this.deathHeight=this.gameCanvas.height*.9,this.windowRatio=window.innerWidth/window.innerHeight}translatePosition(e){if(this.flipHorizontal&&(e.x=this.video.videoWidth-e.x),this.windowRatio<this.webcamRatio){const t=this.video.videoHeight/this.gameCanvas.height,r=this.video.videoWidth/2-this.gameCanvas.width*t/2,s=0,o=this.video.videoWidth/2+this.gameCanvas.width*t/2,i=this.video.videoHeight,a=(e.x-r)/(o-r)*this.gameCanvas.width,u=(e.y-s)/(i-s)*this.gameCanvas.height;return new pt(a,u)}else{const t=this.video.videoWidth/this.gameCanvas.width,r=0,s=this.video.videoHeight/2-this.gameCanvas.height*t/2,o=this.video.videoWidth,i=this.video.videoHeight/2+this.gameCanvas.height*t/2,a=(e.x-r)/(o-r)*this.gameCanvas.width,u=(e.y-s)/(i-s)*this.gameCanvas.height;return new pt(a,u)}}flipVideo(){this.flipHorizontal=!this.flipHorizontal,this.video.style.transform=this.flipHorizontal?"scaleX(-1) translate(50%,-50%)":""}}var Ug={exports:{}};/*!
 * jQuery JavaScript Library v3.6.1
 * https://jquery.com/
 *
 * Includes Sizzle.js
 * https://sizzlejs.com/
 *
 * Copyright OpenJS Foundation and other contributors
 * Released under the MIT license
 * https://jquery.org/license
 *
 * Date: 2022-08-26T17:52Z
 */(function(n){(function(e,t){n.exports=e.document?t(e,!0):function(r){if(!r.document)throw new Error("jQuery requires a window with a document");return t(r)}})(typeof window<"u"?window:Pr,function(e,t){var r=[],s=Object.getPrototypeOf,o=r.slice,i=r.flat?function(f){return r.flat.call(f)}:function(f){return r.concat.apply([],f)},a=r.push,u=r.indexOf,c={},l=c.toString,h=c.hasOwnProperty,d=h.toString,m=d.call(Object),g={},C=function(p){return typeof p=="function"&&typeof p.nodeType!="number"&&typeof p.item!="function"},$=function(p){return p!=null&&p===p.window},T=e.document,A={type:!0,src:!0,nonce:!0,noModule:!0};function P(f,p,b){b=b||T;var w,I,_=b.createElement("script");if(_.text=f,p)for(w in A)I=p[w]||p.getAttribute&&p.getAttribute(w),I&&_.setAttribute(w,I);b.head.appendChild(_).parentNode.removeChild(_)}function B(f){return f==null?f+"":typeof f=="object"||typeof f=="function"?c[l.call(f)]||"object":typeof f}var H="3.6.1",x=function(f,p){return new x.fn.init(f,p)};x.fn=x.prototype={jquery:H,constructor:x,length:0,toArray:function(){return o.call(this)},get:function(f){return f==null?o.call(this):f<0?this[f+this.length]:this[f]},pushStack:function(f){var p=x.merge(this.constructor(),f);return p.prevObject=this,p},each:function(f){return x.each(this,f)},map:function(f){return this.pushStack(x.map(this,function(p,b){return f.call(p,b,p)}))},slice:function(){return this.pushStack(o.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},even:function(){return this.pushStack(x.grep(this,function(f,p){return(p+1)%2}))},odd:function(){return this.pushStack(x.grep(this,function(f,p){return p%2}))},eq:function(f){var p=this.length,b=+f+(f<0?p:0);return this.pushStack(b>=0&&b<p?[this[b]]:[])},end:function(){return this.prevObject||this.constructor()},push:a,sort:r.sort,splice:r.splice},x.extend=x.fn.extend=function(){var f,p,b,w,I,_,O=arguments[0]||{},j=1,z=arguments.length,Z=!1;for(typeof O=="boolean"&&(Z=O,O=arguments[j]||{},j++),typeof O!="object"&&!C(O)&&(O={}),j===z&&(O=this,j--);j<z;j++)if((f=arguments[j])!=null)for(p in f)w=f[p],!(p==="__proto__"||O===w)&&(Z&&w&&(x.isPlainObject(w)||(I=Array.isArray(w)))?(b=O[p],I&&!Array.isArray(b)?_=[]:!I&&!x.isPlainObject(b)?_={}:_=b,I=!1,O[p]=x.extend(Z,_,w)):w!==void 0&&(O[p]=w));return O},x.extend({expando:"jQuery"+(H+Math.random()).replace(/\D/g,""),isReady:!0,error:function(f){throw new Error(f)},noop:function(){},isPlainObject:function(f){var p,b;return!f||l.call(f)!=="[object Object]"?!1:(p=s(f),p?(b=h.call(p,"constructor")&&p.constructor,typeof b=="function"&&d.call(b)===m):!0)},isEmptyObject:function(f){var p;for(p in f)return!1;return!0},globalEval:function(f,p,b){P(f,{nonce:p&&p.nonce},b)},each:function(f,p){var b,w=0;if(re(f))for(b=f.length;w<b&&p.call(f[w],w,f[w])!==!1;w++);else for(w in f)if(p.call(f[w],w,f[w])===!1)break;return f},makeArray:function(f,p){var b=p||[];return f!=null&&(re(Object(f))?x.merge(b,typeof f=="string"?[f]:f):a.call(b,f)),b},inArray:function(f,p,b){return p==null?-1:u.call(p,f,b)},merge:function(f,p){for(var b=+p.length,w=0,I=f.length;w<b;w++)f[I++]=p[w];return f.length=I,f},grep:function(f,p,b){for(var w,I=[],_=0,O=f.length,j=!b;_<O;_++)w=!p(f[_],_),w!==j&&I.push(f[_]);return I},map:function(f,p,b){var w,I,_=0,O=[];if(re(f))for(w=f.length;_<w;_++)I=p(f[_],_,b),I!=null&&O.push(I);else for(_ in f)I=p(f[_],_,b),I!=null&&O.push(I);return i(O)},guid:1,support:g}),typeof Symbol=="function"&&(x.fn[Symbol.iterator]=r[Symbol.iterator]),x.each("Boolean Number String Function Array Date RegExp Object Error Symbol".split(" "),function(f,p){c["[object "+p+"]"]=p.toLowerCase()});function re(f){var p=!!f&&"length"in f&&f.length,b=B(f);return C(f)||$(f)?!1:b==="array"||p===0||typeof p=="number"&&p>0&&p-1 in f}var oe=function(f){var p,b,w,I,_,O,j,z,Z,ae,xe,ne,ce,Pe,Xe,Be,Xt,jt,jn,yt="sizzle"+1*new Date,qe=f.document,An=0,it=0,Pt=ya(),Oi=ya(),pa=ya(),Hn=ya(),ao=function(F,q){return F===q&&(xe=!0),0},uo={}.hasOwnProperty,On=[],Fs=On.pop,ar=On.push,Ps=On.push,Pl=On.slice,co=function(F,q){for(var Y=0,pe=F.length;Y<pe;Y++)if(F[Y]===q)return Y;return-1},wu="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",ft="[\\x20\\t\\r\\n\\f]",lo="(?:\\\\[\\da-fA-F]{1,6}"+ft+"?|\\\\[^\\r\\n\\f]|[\\w-]|[^\0-\\x7f])+",Ll="\\["+ft+"*("+lo+")(?:"+ft+"*([*^$|!~]?=)"+ft+`*(?:'((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)"|(`+lo+"))|)"+ft+"*\\]",Cu=":("+lo+`)(?:\\((('((?:\\\\.|[^\\\\'])*)'|"((?:\\\\.|[^\\\\"])*)")|((?:\\\\.|[^\\\\()[\\]]|`+Ll+")*)|.*)\\)|)",Wg=new RegExp(ft+"+","g"),ma=new RegExp("^"+ft+"+|((?:^|[^\\\\])(?:\\\\.)*)"+ft+"+$","g"),zg=new RegExp("^"+ft+"*,"+ft+"*"),Bl=new RegExp("^"+ft+"*([>+~]|"+ft+")"+ft+"*"),Gg=new RegExp(ft+"|>"),jg=new RegExp(Cu),Hg=new RegExp("^"+lo+"$"),ga={ID:new RegExp("^#("+lo+")"),CLASS:new RegExp("^\\.("+lo+")"),TAG:new RegExp("^("+lo+"|[*])"),ATTR:new RegExp("^"+Ll),PSEUDO:new RegExp("^"+Cu),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+ft+"*(even|odd|(([+-]|)(\\d*)n|)"+ft+"*(?:([+-]|)"+ft+"*(\\d+)|))"+ft+"*\\)|)","i"),bool:new RegExp("^(?:"+wu+")$","i"),needsContext:new RegExp("^"+ft+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+ft+"*((?:-\\d)?\\d*)"+ft+"*\\)|)(?=[^-]|$)","i")},qg=/HTML$/i,Xg=/^(?:input|select|textarea|button)$/i,Kg=/^h\d$/i,Di=/^[^{]+\{\s*\[native \w/,Yg=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Tu=/[+~]/,fs=new RegExp("\\\\[\\da-fA-F]{1,6}"+ft+"?|\\\\([^\\r\\n\\f])","g"),ds=function(F,q){var Y="0x"+F.slice(1)-65536;return q||(Y<0?String.fromCharCode(Y+65536):String.fromCharCode(Y>>10|55296,Y&1023|56320))},Ml=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,Vl=function(F,q){return q?F==="\0"?"\uFFFD":F.slice(0,-1)+"\\"+F.charCodeAt(F.length-1).toString(16)+" ":"\\"+F},Ul=function(){ne()},Qg=ba(function(F){return F.disabled===!0&&F.nodeName.toLowerCase()==="fieldset"},{dir:"parentNode",next:"legend"});try{Ps.apply(On=Pl.call(qe.childNodes),qe.childNodes),On[qe.childNodes.length].nodeType}catch{Ps={apply:On.length?function(q,Y){ar.apply(q,Pl.call(Y))}:function(q,Y){for(var pe=q.length,J=0;q[pe++]=Y[J++];);q.length=pe-1}}}function bt(F,q,Y,pe){var J,ye,be,Se,_e,Ve,Me,ze=q&&q.ownerDocument,Je=q?q.nodeType:9;if(Y=Y||[],typeof F!="string"||!F||Je!==1&&Je!==9&&Je!==11)return Y;if(!pe&&(ne(q),q=q||ce,Xe)){if(Je!==11&&(_e=Yg.exec(F)))if(J=_e[1]){if(Je===9)if(be=q.getElementById(J)){if(be.id===J)return Y.push(be),Y}else return Y;else if(ze&&(be=ze.getElementById(J))&&jn(q,be)&&be.id===J)return Y.push(be),Y}else{if(_e[2])return Ps.apply(Y,q.getElementsByTagName(F)),Y;if((J=_e[3])&&b.getElementsByClassName&&q.getElementsByClassName)return Ps.apply(Y,q.getElementsByClassName(J)),Y}if(b.qsa&&!Hn[F+" "]&&(!Be||!Be.test(F))&&(Je!==1||q.nodeName.toLowerCase()!=="object")){if(Me=F,ze=q,Je===1&&(Gg.test(F)||Bl.test(F))){for(ze=Tu.test(F)&&Su(q.parentNode)||q,(ze!==q||!b.scope)&&((Se=q.getAttribute("id"))?Se=Se.replace(Ml,Vl):q.setAttribute("id",Se=yt)),Ve=O(F),ye=Ve.length;ye--;)Ve[ye]=(Se?"#"+Se:":scope")+" "+xa(Ve[ye]);Me=Ve.join(",")}try{return Ps.apply(Y,ze.querySelectorAll(Me)),Y}catch{Hn(F,!0)}finally{Se===yt&&q.removeAttribute("id")}}}return z(F.replace(ma,"$1"),q,Y,pe)}function ya(){var F=[];function q(Y,pe){return F.push(Y+" ")>w.cacheLength&&delete q[F.shift()],q[Y+" "]=pe}return q}function Ir(F){return F[yt]=!0,F}function _r(F){var q=ce.createElement("fieldset");try{return!!F(q)}catch{return!1}finally{q.parentNode&&q.parentNode.removeChild(q),q=null}}function $u(F,q){for(var Y=F.split("|"),pe=Y.length;pe--;)w.attrHandle[Y[pe]]=q}function Wl(F,q){var Y=q&&F,pe=Y&&F.nodeType===1&&q.nodeType===1&&F.sourceIndex-q.sourceIndex;if(pe)return pe;if(Y){for(;Y=Y.nextSibling;)if(Y===q)return-1}return F?1:-1}function Zg(F){return function(q){var Y=q.nodeName.toLowerCase();return Y==="input"&&q.type===F}}function Jg(F){return function(q){var Y=q.nodeName.toLowerCase();return(Y==="input"||Y==="button")&&q.type===F}}function zl(F){return function(q){return"form"in q?q.parentNode&&q.disabled===!1?"label"in q?"label"in q.parentNode?q.parentNode.disabled===F:q.disabled===F:q.isDisabled===F||q.isDisabled!==!F&&Qg(q)===F:q.disabled===F:"label"in q?q.disabled===F:!1}}function ho(F){return Ir(function(q){return q=+q,Ir(function(Y,pe){for(var J,ye=F([],Y.length,q),be=ye.length;be--;)Y[J=ye[be]]&&(Y[J]=!(pe[J]=Y[J]))})})}function Su(F){return F&&typeof F.getElementsByTagName<"u"&&F}b=bt.support={},_=bt.isXML=function(F){var q=F&&F.namespaceURI,Y=F&&(F.ownerDocument||F).documentElement;return!qg.test(q||Y&&Y.nodeName||"HTML")},ne=bt.setDocument=function(F){var q,Y,pe=F?F.ownerDocument||F:qe;return pe==ce||pe.nodeType!==9||!pe.documentElement||(ce=pe,Pe=ce.documentElement,Xe=!_(ce),qe!=ce&&(Y=ce.defaultView)&&Y.top!==Y&&(Y.addEventListener?Y.addEventListener("unload",Ul,!1):Y.attachEvent&&Y.attachEvent("onunload",Ul)),b.scope=_r(function(J){return Pe.appendChild(J).appendChild(ce.createElement("div")),typeof J.querySelectorAll<"u"&&!J.querySelectorAll(":scope fieldset div").length}),b.attributes=_r(function(J){return J.className="i",!J.getAttribute("className")}),b.getElementsByTagName=_r(function(J){return J.appendChild(ce.createComment("")),!J.getElementsByTagName("*").length}),b.getElementsByClassName=Di.test(ce.getElementsByClassName),b.getById=_r(function(J){return Pe.appendChild(J).id=yt,!ce.getElementsByName||!ce.getElementsByName(yt).length}),b.getById?(w.filter.ID=function(J){var ye=J.replace(fs,ds);return function(be){return be.getAttribute("id")===ye}},w.find.ID=function(J,ye){if(typeof ye.getElementById<"u"&&Xe){var be=ye.getElementById(J);return be?[be]:[]}}):(w.filter.ID=function(J){var ye=J.replace(fs,ds);return function(be){var Se=typeof be.getAttributeNode<"u"&&be.getAttributeNode("id");return Se&&Se.value===ye}},w.find.ID=function(J,ye){if(typeof ye.getElementById<"u"&&Xe){var be,Se,_e,Ve=ye.getElementById(J);if(Ve){if(be=Ve.getAttributeNode("id"),be&&be.value===J)return[Ve];for(_e=ye.getElementsByName(J),Se=0;Ve=_e[Se++];)if(be=Ve.getAttributeNode("id"),be&&be.value===J)return[Ve]}return[]}}),w.find.TAG=b.getElementsByTagName?function(J,ye){if(typeof ye.getElementsByTagName<"u")return ye.getElementsByTagName(J);if(b.qsa)return ye.querySelectorAll(J)}:function(J,ye){var be,Se=[],_e=0,Ve=ye.getElementsByTagName(J);if(J==="*"){for(;be=Ve[_e++];)be.nodeType===1&&Se.push(be);return Se}return Ve},w.find.CLASS=b.getElementsByClassName&&function(J,ye){if(typeof ye.getElementsByClassName<"u"&&Xe)return ye.getElementsByClassName(J)},Xt=[],Be=[],(b.qsa=Di.test(ce.querySelectorAll))&&(_r(function(J){var ye;Pe.appendChild(J).innerHTML="<a id='"+yt+"'></a><select id='"+yt+"-\r\\' msallowcapture=''><option selected=''></option></select>",J.querySelectorAll("[msallowcapture^='']").length&&Be.push("[*^$]="+ft+`*(?:''|"")`),J.querySelectorAll("[selected]").length||Be.push("\\["+ft+"*(?:value|"+wu+")"),J.querySelectorAll("[id~="+yt+"-]").length||Be.push("~="),ye=ce.createElement("input"),ye.setAttribute("name",""),J.appendChild(ye),J.querySelectorAll("[name='']").length||Be.push("\\["+ft+"*name"+ft+"*="+ft+`*(?:''|"")`),J.querySelectorAll(":checked").length||Be.push(":checked"),J.querySelectorAll("a#"+yt+"+*").length||Be.push(".#.+[+~]"),J.querySelectorAll("\\\f"),Be.push("[\\r\\n\\f]")}),_r(function(J){J.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var ye=ce.createElement("input");ye.setAttribute("type","hidden"),J.appendChild(ye).setAttribute("name","D"),J.querySelectorAll("[name=d]").length&&Be.push("name"+ft+"*[*^$|!~]?="),J.querySelectorAll(":enabled").length!==2&&Be.push(":enabled",":disabled"),Pe.appendChild(J).disabled=!0,J.querySelectorAll(":disabled").length!==2&&Be.push(":enabled",":disabled"),J.querySelectorAll("*,:x"),Be.push(",.*:")})),(b.matchesSelector=Di.test(jt=Pe.matches||Pe.webkitMatchesSelector||Pe.mozMatchesSelector||Pe.oMatchesSelector||Pe.msMatchesSelector))&&_r(function(J){b.disconnectedMatch=jt.call(J,"*"),jt.call(J,"[s!='']:x"),Xt.push("!=",Cu)}),Be=Be.length&&new RegExp(Be.join("|")),Xt=Xt.length&&new RegExp(Xt.join("|")),q=Di.test(Pe.compareDocumentPosition),jn=q||Di.test(Pe.contains)?function(J,ye){var be=J.nodeType===9?J.documentElement:J,Se=ye&&ye.parentNode;return J===Se||!!(Se&&Se.nodeType===1&&(be.contains?be.contains(Se):J.compareDocumentPosition&&J.compareDocumentPosition(Se)&16))}:function(J,ye){if(ye){for(;ye=ye.parentNode;)if(ye===J)return!0}return!1},ao=q?function(J,ye){if(J===ye)return xe=!0,0;var be=!J.compareDocumentPosition-!ye.compareDocumentPosition;return be||(be=(J.ownerDocument||J)==(ye.ownerDocument||ye)?J.compareDocumentPosition(ye):1,be&1||!b.sortDetached&&ye.compareDocumentPosition(J)===be?J==ce||J.ownerDocument==qe&&jn(qe,J)?-1:ye==ce||ye.ownerDocument==qe&&jn(qe,ye)?1:ae?co(ae,J)-co(ae,ye):0:be&4?-1:1)}:function(J,ye){if(J===ye)return xe=!0,0;var be,Se=0,_e=J.parentNode,Ve=ye.parentNode,Me=[J],ze=[ye];if(!_e||!Ve)return J==ce?-1:ye==ce?1:_e?-1:Ve?1:ae?co(ae,J)-co(ae,ye):0;if(_e===Ve)return Wl(J,ye);for(be=J;be=be.parentNode;)Me.unshift(be);for(be=ye;be=be.parentNode;)ze.unshift(be);for(;Me[Se]===ze[Se];)Se++;return Se?Wl(Me[Se],ze[Se]):Me[Se]==qe?-1:ze[Se]==qe?1:0}),ce},bt.matches=function(F,q){return bt(F,null,null,q)},bt.matchesSelector=function(F,q){if(ne(F),b.matchesSelector&&Xe&&!Hn[q+" "]&&(!Xt||!Xt.test(q))&&(!Be||!Be.test(q)))try{var Y=jt.call(F,q);if(Y||b.disconnectedMatch||F.document&&F.document.nodeType!==11)return Y}catch{Hn(q,!0)}return bt(q,ce,null,[F]).length>0},bt.contains=function(F,q){return(F.ownerDocument||F)!=ce&&ne(F),jn(F,q)},bt.attr=function(F,q){(F.ownerDocument||F)!=ce&&ne(F);var Y=w.attrHandle[q.toLowerCase()],pe=Y&&uo.call(w.attrHandle,q.toLowerCase())?Y(F,q,!Xe):void 0;return pe!==void 0?pe:b.attributes||!Xe?F.getAttribute(q):(pe=F.getAttributeNode(q))&&pe.specified?pe.value:null},bt.escape=function(F){return(F+"").replace(Ml,Vl)},bt.error=function(F){throw new Error("Syntax error, unrecognized expression: "+F)},bt.uniqueSort=function(F){var q,Y=[],pe=0,J=0;if(xe=!b.detectDuplicates,ae=!b.sortStable&&F.slice(0),F.sort(ao),xe){for(;q=F[J++];)q===F[J]&&(pe=Y.push(J));for(;pe--;)F.splice(Y[pe],1)}return ae=null,F},I=bt.getText=function(F){var q,Y="",pe=0,J=F.nodeType;if(J){if(J===1||J===9||J===11){if(typeof F.textContent=="string")return F.textContent;for(F=F.firstChild;F;F=F.nextSibling)Y+=I(F)}else if(J===3||J===4)return F.nodeValue}else for(;q=F[pe++];)Y+=I(q);return Y},w=bt.selectors={cacheLength:50,createPseudo:Ir,match:ga,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(F){return F[1]=F[1].replace(fs,ds),F[3]=(F[3]||F[4]||F[5]||"").replace(fs,ds),F[2]==="~="&&(F[3]=" "+F[3]+" "),F.slice(0,4)},CHILD:function(F){return F[1]=F[1].toLowerCase(),F[1].slice(0,3)==="nth"?(F[3]||bt.error(F[0]),F[4]=+(F[4]?F[5]+(F[6]||1):2*(F[3]==="even"||F[3]==="odd")),F[5]=+(F[7]+F[8]||F[3]==="odd")):F[3]&&bt.error(F[0]),F},PSEUDO:function(F){var q,Y=!F[6]&&F[2];return ga.CHILD.test(F[0])?null:(F[3]?F[2]=F[4]||F[5]||"":Y&&jg.test(Y)&&(q=O(Y,!0))&&(q=Y.indexOf(")",Y.length-q)-Y.length)&&(F[0]=F[0].slice(0,q),F[2]=Y.slice(0,q)),F.slice(0,3))}},filter:{TAG:function(F){var q=F.replace(fs,ds).toLowerCase();return F==="*"?function(){return!0}:function(Y){return Y.nodeName&&Y.nodeName.toLowerCase()===q}},CLASS:function(F){var q=Pt[F+" "];return q||(q=new RegExp("(^|"+ft+")"+F+"("+ft+"|$)"))&&Pt(F,function(Y){return q.test(typeof Y.className=="string"&&Y.className||typeof Y.getAttribute<"u"&&Y.getAttribute("class")||"")})},ATTR:function(F,q,Y){return function(pe){var J=bt.attr(pe,F);return J==null?q==="!=":q?(J+="",q==="="?J===Y:q==="!="?J!==Y:q==="^="?Y&&J.indexOf(Y)===0:q==="*="?Y&&J.indexOf(Y)>-1:q==="$="?Y&&J.slice(-Y.length)===Y:q==="~="?(" "+J.replace(Wg," ")+" ").indexOf(Y)>-1:q==="|="?J===Y||J.slice(0,Y.length+1)===Y+"-":!1):!0}},CHILD:function(F,q,Y,pe,J){var ye=F.slice(0,3)!=="nth",be=F.slice(-4)!=="last",Se=q==="of-type";return pe===1&&J===0?function(_e){return!!_e.parentNode}:function(_e,Ve,Me){var ze,Je,vt,Ue,Kt,xn,qn=ye!==be?"nextSibling":"previousSibling",It=_e.parentNode,Fi=Se&&_e.nodeName.toLowerCase(),Pi=!Me&&!Se,Xn=!1;if(It){if(ye){for(;qn;){for(Ue=_e;Ue=Ue[qn];)if(Se?Ue.nodeName.toLowerCase()===Fi:Ue.nodeType===1)return!1;xn=qn=F==="only"&&!xn&&"nextSibling"}return!0}if(xn=[be?It.firstChild:It.lastChild],be&&Pi){for(Ue=It,vt=Ue[yt]||(Ue[yt]={}),Je=vt[Ue.uniqueID]||(vt[Ue.uniqueID]={}),ze=Je[F]||[],Kt=ze[0]===An&&ze[1],Xn=Kt&&ze[2],Ue=Kt&&It.childNodes[Kt];Ue=++Kt&&Ue&&Ue[qn]||(Xn=Kt=0)||xn.pop();)if(Ue.nodeType===1&&++Xn&&Ue===_e){Je[F]=[An,Kt,Xn];break}}else if(Pi&&(Ue=_e,vt=Ue[yt]||(Ue[yt]={}),Je=vt[Ue.uniqueID]||(vt[Ue.uniqueID]={}),ze=Je[F]||[],Kt=ze[0]===An&&ze[1],Xn=Kt),Xn===!1)for(;(Ue=++Kt&&Ue&&Ue[qn]||(Xn=Kt=0)||xn.pop())&&!((Se?Ue.nodeName.toLowerCase()===Fi:Ue.nodeType===1)&&++Xn&&(Pi&&(vt=Ue[yt]||(Ue[yt]={}),Je=vt[Ue.uniqueID]||(vt[Ue.uniqueID]={}),Je[F]=[An,Xn]),Ue===_e)););return Xn-=J,Xn===pe||Xn%pe===0&&Xn/pe>=0}}},PSEUDO:function(F,q){var Y,pe=w.pseudos[F]||w.setFilters[F.toLowerCase()]||bt.error("unsupported pseudo: "+F);return pe[yt]?pe(q):pe.length>1?(Y=[F,F,"",q],w.setFilters.hasOwnProperty(F.toLowerCase())?Ir(function(J,ye){for(var be,Se=pe(J,q),_e=Se.length;_e--;)be=co(J,Se[_e]),J[be]=!(ye[be]=Se[_e])}):function(J){return pe(J,0,Y)}):pe}},pseudos:{not:Ir(function(F){var q=[],Y=[],pe=j(F.replace(ma,"$1"));return pe[yt]?Ir(function(J,ye,be,Se){for(var _e,Ve=pe(J,null,Se,[]),Me=J.length;Me--;)(_e=Ve[Me])&&(J[Me]=!(ye[Me]=_e))}):function(J,ye,be){return q[0]=J,pe(q,null,be,Y),q[0]=null,!Y.pop()}}),has:Ir(function(F){return function(q){return bt(F,q).length>0}}),contains:Ir(function(F){return F=F.replace(fs,ds),function(q){return(q.textContent||I(q)).indexOf(F)>-1}}),lang:Ir(function(F){return Hg.test(F||"")||bt.error("unsupported lang: "+F),F=F.replace(fs,ds).toLowerCase(),function(q){var Y;do if(Y=Xe?q.lang:q.getAttribute("xml:lang")||q.getAttribute("lang"))return Y=Y.toLowerCase(),Y===F||Y.indexOf(F+"-")===0;while((q=q.parentNode)&&q.nodeType===1);return!1}}),target:function(F){var q=f.location&&f.location.hash;return q&&q.slice(1)===F.id},root:function(F){return F===Pe},focus:function(F){return F===ce.activeElement&&(!ce.hasFocus||ce.hasFocus())&&!!(F.type||F.href||~F.tabIndex)},enabled:zl(!1),disabled:zl(!0),checked:function(F){var q=F.nodeName.toLowerCase();return q==="input"&&!!F.checked||q==="option"&&!!F.selected},selected:function(F){return F.parentNode&&F.parentNode.selectedIndex,F.selected===!0},empty:function(F){for(F=F.firstChild;F;F=F.nextSibling)if(F.nodeType<6)return!1;return!0},parent:function(F){return!w.pseudos.empty(F)},header:function(F){return Kg.test(F.nodeName)},input:function(F){return Xg.test(F.nodeName)},button:function(F){var q=F.nodeName.toLowerCase();return q==="input"&&F.type==="button"||q==="button"},text:function(F){var q;return F.nodeName.toLowerCase()==="input"&&F.type==="text"&&((q=F.getAttribute("type"))==null||q.toLowerCase()==="text")},first:ho(function(){return[0]}),last:ho(function(F,q){return[q-1]}),eq:ho(function(F,q,Y){return[Y<0?Y+q:Y]}),even:ho(function(F,q){for(var Y=0;Y<q;Y+=2)F.push(Y);return F}),odd:ho(function(F,q){for(var Y=1;Y<q;Y+=2)F.push(Y);return F}),lt:ho(function(F,q,Y){for(var pe=Y<0?Y+q:Y>q?q:Y;--pe>=0;)F.push(pe);return F}),gt:ho(function(F,q,Y){for(var pe=Y<0?Y+q:Y;++pe<q;)F.push(pe);return F})}},w.pseudos.nth=w.pseudos.eq;for(p in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})w.pseudos[p]=Zg(p);for(p in{submit:!0,reset:!0})w.pseudos[p]=Jg(p);function Gl(){}Gl.prototype=w.filters=w.pseudos,w.setFilters=new Gl,O=bt.tokenize=function(F,q){var Y,pe,J,ye,be,Se,_e,Ve=Oi[F+" "];if(Ve)return q?0:Ve.slice(0);for(be=F,Se=[],_e=w.preFilter;be;){(!Y||(pe=zg.exec(be)))&&(pe&&(be=be.slice(pe[0].length)||be),Se.push(J=[])),Y=!1,(pe=Bl.exec(be))&&(Y=pe.shift(),J.push({value:Y,type:pe[0].replace(ma," ")}),be=be.slice(Y.length));for(ye in w.filter)(pe=ga[ye].exec(be))&&(!_e[ye]||(pe=_e[ye](pe)))&&(Y=pe.shift(),J.push({value:Y,type:ye,matches:pe}),be=be.slice(Y.length));if(!Y)break}return q?be.length:be?bt.error(F):Oi(F,Se).slice(0)};function xa(F){for(var q=0,Y=F.length,pe="";q<Y;q++)pe+=F[q].value;return pe}function ba(F,q,Y){var pe=q.dir,J=q.next,ye=J||pe,be=Y&&ye==="parentNode",Se=it++;return q.first?function(_e,Ve,Me){for(;_e=_e[pe];)if(_e.nodeType===1||be)return F(_e,Ve,Me);return!1}:function(_e,Ve,Me){var ze,Je,vt,Ue=[An,Se];if(Me){for(;_e=_e[pe];)if((_e.nodeType===1||be)&&F(_e,Ve,Me))return!0}else for(;_e=_e[pe];)if(_e.nodeType===1||be)if(vt=_e[yt]||(_e[yt]={}),Je=vt[_e.uniqueID]||(vt[_e.uniqueID]={}),J&&J===_e.nodeName.toLowerCase())_e=_e[pe]||_e;else{if((ze=Je[ye])&&ze[0]===An&&ze[1]===Se)return Ue[2]=ze[2];if(Je[ye]=Ue,Ue[2]=F(_e,Ve,Me))return!0}return!1}}function Nu(F){return F.length>1?function(q,Y,pe){for(var J=F.length;J--;)if(!F[J](q,Y,pe))return!1;return!0}:F[0]}function e0(F,q,Y){for(var pe=0,J=q.length;pe<J;pe++)bt(F,q[pe],Y);return Y}function va(F,q,Y,pe,J){for(var ye,be=[],Se=0,_e=F.length,Ve=q!=null;Se<_e;Se++)(ye=F[Se])&&(!Y||Y(ye,pe,J))&&(be.push(ye),Ve&&q.push(Se));return be}function Eu(F,q,Y,pe,J,ye){return pe&&!pe[yt]&&(pe=Eu(pe)),J&&!J[yt]&&(J=Eu(J,ye)),Ir(function(be,Se,_e,Ve){var Me,ze,Je,vt=[],Ue=[],Kt=Se.length,xn=be||e0(q||"*",_e.nodeType?[_e]:_e,[]),qn=F&&(be||!q)?va(xn,vt,F,_e,Ve):xn,It=Y?J||(be?F:Kt||pe)?[]:Se:qn;if(Y&&Y(qn,It,_e,Ve),pe)for(Me=va(It,Ue),pe(Me,[],_e,Ve),ze=Me.length;ze--;)(Je=Me[ze])&&(It[Ue[ze]]=!(qn[Ue[ze]]=Je));if(be){if(J||F){if(J){for(Me=[],ze=It.length;ze--;)(Je=It[ze])&&Me.push(qn[ze]=Je);J(null,It=[],Me,Ve)}for(ze=It.length;ze--;)(Je=It[ze])&&(Me=J?co(be,Je):vt[ze])>-1&&(be[Me]=!(Se[Me]=Je))}}else It=va(It===Se?It.splice(Kt,It.length):It),J?J(null,Se,It,Ve):Ps.apply(Se,It)})}function ku(F){for(var q,Y,pe,J=F.length,ye=w.relative[F[0].type],be=ye||w.relative[" "],Se=ye?1:0,_e=ba(function(ze){return ze===q},be,!0),Ve=ba(function(ze){return co(q,ze)>-1},be,!0),Me=[function(ze,Je,vt){var Ue=!ye&&(vt||Je!==Z)||((q=Je).nodeType?_e(ze,Je,vt):Ve(ze,Je,vt));return q=null,Ue}];Se<J;Se++)if(Y=w.relative[F[Se].type])Me=[ba(Nu(Me),Y)];else{if(Y=w.filter[F[Se].type].apply(null,F[Se].matches),Y[yt]){for(pe=++Se;pe<J&&!w.relative[F[pe].type];pe++);return Eu(Se>1&&Nu(Me),Se>1&&xa(F.slice(0,Se-1).concat({value:F[Se-2].type===" "?"*":""})).replace(ma,"$1"),Y,Se<pe&&ku(F.slice(Se,pe)),pe<J&&ku(F=F.slice(pe)),pe<J&&xa(F))}Me.push(Y)}return Nu(Me)}function t0(F,q){var Y=q.length>0,pe=F.length>0,J=function(ye,be,Se,_e,Ve){var Me,ze,Je,vt=0,Ue="0",Kt=ye&&[],xn=[],qn=Z,It=ye||pe&&w.find.TAG("*",Ve),Fi=An+=qn==null?1:Math.random()||.1,Pi=It.length;for(Ve&&(Z=be==ce||be||Ve);Ue!==Pi&&(Me=It[Ue])!=null;Ue++){if(pe&&Me){for(ze=0,!be&&Me.ownerDocument!=ce&&(ne(Me),Se=!Xe);Je=F[ze++];)if(Je(Me,be||ce,Se)){_e.push(Me);break}Ve&&(An=Fi)}Y&&((Me=!Je&&Me)&&vt--,ye&&Kt.push(Me))}if(vt+=Ue,Y&&Ue!==vt){for(ze=0;Je=q[ze++];)Je(Kt,xn,be,Se);if(ye){if(vt>0)for(;Ue--;)Kt[Ue]||xn[Ue]||(xn[Ue]=Fs.call(_e));xn=va(xn)}Ps.apply(_e,xn),Ve&&!ye&&xn.length>0&&vt+q.length>1&&bt.uniqueSort(_e)}return Ve&&(An=Fi,Z=qn),Kt};return Y?Ir(J):J}return j=bt.compile=function(F,q){var Y,pe=[],J=[],ye=pa[F+" "];if(!ye){for(q||(q=O(F)),Y=q.length;Y--;)ye=ku(q[Y]),ye[yt]?pe.push(ye):J.push(ye);ye=pa(F,t0(J,pe)),ye.selector=F}return ye},z=bt.select=function(F,q,Y,pe){var J,ye,be,Se,_e,Ve=typeof F=="function"&&F,Me=!pe&&O(F=Ve.selector||F);if(Y=Y||[],Me.length===1){if(ye=Me[0]=Me[0].slice(0),ye.length>2&&(be=ye[0]).type==="ID"&&q.nodeType===9&&Xe&&w.relative[ye[1].type]){if(q=(w.find.ID(be.matches[0].replace(fs,ds),q)||[])[0],q)Ve&&(q=q.parentNode);else return Y;F=F.slice(ye.shift().value.length)}for(J=ga.needsContext.test(F)?0:ye.length;J--&&(be=ye[J],!w.relative[Se=be.type]);)if((_e=w.find[Se])&&(pe=_e(be.matches[0].replace(fs,ds),Tu.test(ye[0].type)&&Su(q.parentNode)||q))){if(ye.splice(J,1),F=pe.length&&xa(ye),!F)return Ps.apply(Y,pe),Y;break}}return(Ve||j(F,Me))(pe,q,!Xe,Y,!q||Tu.test(F)&&Su(q.parentNode)||q),Y},b.sortStable=yt.split("").sort(ao).join("")===yt,b.detectDuplicates=!!xe,ne(),b.sortDetached=_r(function(F){return F.compareDocumentPosition(ce.createElement("fieldset"))&1}),_r(function(F){return F.innerHTML="<a href='#'></a>",F.firstChild.getAttribute("href")==="#"})||$u("type|href|height|width",function(F,q,Y){if(!Y)return F.getAttribute(q,q.toLowerCase()==="type"?1:2)}),(!b.attributes||!_r(function(F){return F.innerHTML="<input/>",F.firstChild.setAttribute("value",""),F.firstChild.getAttribute("value")===""}))&&$u("value",function(F,q,Y){if(!Y&&F.nodeName.toLowerCase()==="input")return F.defaultValue}),_r(function(F){return F.getAttribute("disabled")==null})||$u(wu,function(F,q,Y){var pe;if(!Y)return F[q]===!0?q.toLowerCase():(pe=F.getAttributeNode(q))&&pe.specified?pe.value:null}),bt}(e);x.find=oe,x.expr=oe.selectors,x.expr[":"]=x.expr.pseudos,x.uniqueSort=x.unique=oe.uniqueSort,x.text=oe.getText,x.isXMLDoc=oe.isXML,x.contains=oe.contains,x.escapeSelector=oe.escape;var ie=function(f,p,b){for(var w=[],I=b!==void 0;(f=f[p])&&f.nodeType!==9;)if(f.nodeType===1){if(I&&x(f).is(b))break;w.push(f)}return w},le=function(f,p){for(var b=[];f;f=f.nextSibling)f.nodeType===1&&f!==p&&b.push(f);return b},$e=x.expr.match.needsContext;function Ie(f,p){return f.nodeName&&f.nodeName.toLowerCase()===p.toLowerCase()}var Ae=/^<([a-z][^\/\0>:\x20\t\r\n\f]*)[\x20\t\r\n\f]*\/?>(?:<\/\1>|)$/i;function Ge(f,p,b){return C(p)?x.grep(f,function(w,I){return!!p.call(w,I,w)!==b}):p.nodeType?x.grep(f,function(w){return w===p!==b}):typeof p!="string"?x.grep(f,function(w){return u.call(p,w)>-1!==b}):x.filter(p,f,b)}x.filter=function(f,p,b){var w=p[0];return b&&(f=":not("+f+")"),p.length===1&&w.nodeType===1?x.find.matchesSelector(w,f)?[w]:[]:x.find.matches(f,x.grep(p,function(I){return I.nodeType===1}))},x.fn.extend({find:function(f){var p,b,w=this.length,I=this;if(typeof f!="string")return this.pushStack(x(f).filter(function(){for(p=0;p<w;p++)if(x.contains(I[p],this))return!0}));for(b=this.pushStack([]),p=0;p<w;p++)x.find(f,I[p],b);return w>1?x.uniqueSort(b):b},filter:function(f){return this.pushStack(Ge(this,f||[],!1))},not:function(f){return this.pushStack(Ge(this,f||[],!0))},is:function(f){return!!Ge(this,typeof f=="string"&&$e.test(f)?x(f):f||[],!1).length}});var Ye,at=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]+))$/,ut=x.fn.init=function(f,p,b){var w,I;if(!f)return this;if(b=b||Ye,typeof f=="string")if(f[0]==="<"&&f[f.length-1]===">"&&f.length>=3?w=[null,f,null]:w=at.exec(f),w&&(w[1]||!p))if(w[1]){if(p=p instanceof x?p[0]:p,x.merge(this,x.parseHTML(w[1],p&&p.nodeType?p.ownerDocument||p:T,!0)),Ae.test(w[1])&&x.isPlainObject(p))for(w in p)C(this[w])?this[w](p[w]):this.attr(w,p[w]);return this}else return I=T.getElementById(w[2]),I&&(this[0]=I,this.length=1),this;else return!p||p.jquery?(p||b).find(f):this.constructor(p).find(f);else{if(f.nodeType)return this[0]=f,this.length=1,this;if(C(f))return b.ready!==void 0?b.ready(f):f(x)}return x.makeArray(f,this)};ut.prototype=x.fn,Ye=x(T);var lt=/^(?:parents|prev(?:Until|All))/,Dt={children:!0,contents:!0,next:!0,prev:!0};x.fn.extend({has:function(f){var p=x(f,this),b=p.length;return this.filter(function(){for(var w=0;w<b;w++)if(x.contains(this,p[w]))return!0})},closest:function(f,p){var b,w=0,I=this.length,_=[],O=typeof f!="string"&&x(f);if(!$e.test(f)){for(;w<I;w++)for(b=this[w];b&&b!==p;b=b.parentNode)if(b.nodeType<11&&(O?O.index(b)>-1:b.nodeType===1&&x.find.matchesSelector(b,f))){_.push(b);break}}return this.pushStack(_.length>1?x.uniqueSort(_):_)},index:function(f){return f?typeof f=="string"?u.call(x(f),this[0]):u.call(this,f.jquery?f[0]:f):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(f,p){return this.pushStack(x.uniqueSort(x.merge(this.get(),x(f,p))))},addBack:function(f){return this.add(f==null?this.prevObject:this.prevObject.filter(f))}});function an(f,p){for(;(f=f[p])&&f.nodeType!==1;);return f}x.each({parent:function(f){var p=f.parentNode;return p&&p.nodeType!==11?p:null},parents:function(f){return ie(f,"parentNode")},parentsUntil:function(f,p,b){return ie(f,"parentNode",b)},next:function(f){return an(f,"nextSibling")},prev:function(f){return an(f,"previousSibling")},nextAll:function(f){return ie(f,"nextSibling")},prevAll:function(f){return ie(f,"previousSibling")},nextUntil:function(f,p,b){return ie(f,"nextSibling",b)},prevUntil:function(f,p,b){return ie(f,"previousSibling",b)},siblings:function(f){return le((f.parentNode||{}).firstChild,f)},children:function(f){return le(f.firstChild)},contents:function(f){return f.contentDocument!=null&&s(f.contentDocument)?f.contentDocument:(Ie(f,"template")&&(f=f.content||f),x.merge([],f.childNodes))}},function(f,p){x.fn[f]=function(b,w){var I=x.map(this,p,b);return f.slice(-5)!=="Until"&&(w=b),w&&typeof w=="string"&&(I=x.filter(w,I)),this.length>1&&(Dt[f]||x.uniqueSort(I),lt.test(f)&&I.reverse()),this.pushStack(I)}});var gt=/[^\x20\t\r\n\f]+/g;function vr(f){var p={};return x.each(f.match(gt)||[],function(b,w){p[w]=!0}),p}x.Callbacks=function(f){f=typeof f=="string"?vr(f):x.extend({},f);var p,b,w,I,_=[],O=[],j=-1,z=function(){for(I=I||f.once,w=p=!0;O.length;j=-1)for(b=O.shift();++j<_.length;)_[j].apply(b[0],b[1])===!1&&f.stopOnFalse&&(j=_.length,b=!1);f.memory||(b=!1),p=!1,I&&(b?_=[]:_="")},Z={add:function(){return _&&(b&&!p&&(j=_.length-1,O.push(b)),function ae(xe){x.each(xe,function(ne,ce){C(ce)?(!f.unique||!Z.has(ce))&&_.push(ce):ce&&ce.length&&B(ce)!=="string"&&ae(ce)})}(arguments),b&&!p&&z()),this},remove:function(){return x.each(arguments,function(ae,xe){for(var ne;(ne=x.inArray(xe,_,ne))>-1;)_.splice(ne,1),ne<=j&&j--}),this},has:function(ae){return ae?x.inArray(ae,_)>-1:_.length>0},empty:function(){return _&&(_=[]),this},disable:function(){return I=O=[],_=b="",this},disabled:function(){return!_},lock:function(){return I=O=[],!b&&!p&&(_=b=""),this},locked:function(){return!!I},fireWith:function(ae,xe){return I||(xe=xe||[],xe=[ae,xe.slice?xe.slice():xe],O.push(xe),p||z()),this},fire:function(){return Z.fireWith(this,arguments),this},fired:function(){return!!w}};return Z};function dn(f){return f}function wr(f){throw f}function Cr(f,p,b,w){var I;try{f&&C(I=f.promise)?I.call(f).done(p).fail(b):f&&C(I=f.then)?I.call(f,p,b):p.apply(void 0,[f].slice(w))}catch(_){b.apply(void 0,[_])}}x.extend({Deferred:function(f){var p=[["notify","progress",x.Callbacks("memory"),x.Callbacks("memory"),2],["resolve","done",x.Callbacks("once memory"),x.Callbacks("once memory"),0,"resolved"],["reject","fail",x.Callbacks("once memory"),x.Callbacks("once memory"),1,"rejected"]],b="pending",w={state:function(){return b},always:function(){return I.done(arguments).fail(arguments),this},catch:function(_){return w.then(null,_)},pipe:function(){var _=arguments;return x.Deferred(function(O){x.each(p,function(j,z){var Z=C(_[z[4]])&&_[z[4]];I[z[1]](function(){var ae=Z&&Z.apply(this,arguments);ae&&C(ae.promise)?ae.promise().progress(O.notify).done(O.resolve).fail(O.reject):O[z[0]+"With"](this,Z?[ae]:arguments)})}),_=null}).promise()},then:function(_,O,j){var z=0;function Z(ae,xe,ne,ce){return function(){var Pe=this,Xe=arguments,Be=function(){var jt,jn;if(!(ae<z)){if(jt=ne.apply(Pe,Xe),jt===xe.promise())throw new TypeError("Thenable self-resolution");jn=jt&&(typeof jt=="object"||typeof jt=="function")&&jt.then,C(jn)?ce?jn.call(jt,Z(z,xe,dn,ce),Z(z,xe,wr,ce)):(z++,jn.call(jt,Z(z,xe,dn,ce),Z(z,xe,wr,ce),Z(z,xe,dn,xe.notifyWith))):(ne!==dn&&(Pe=void 0,Xe=[jt]),(ce||xe.resolveWith)(Pe,Xe))}},Xt=ce?Be:function(){try{Be()}catch(jt){x.Deferred.exceptionHook&&x.Deferred.exceptionHook(jt,Xt.stackTrace),ae+1>=z&&(ne!==wr&&(Pe=void 0,Xe=[jt]),xe.rejectWith(Pe,Xe))}};ae?Xt():(x.Deferred.getStackHook&&(Xt.stackTrace=x.Deferred.getStackHook()),e.setTimeout(Xt))}}return x.Deferred(function(ae){p[0][3].add(Z(0,ae,C(j)?j:dn,ae.notifyWith)),p[1][3].add(Z(0,ae,C(_)?_:dn)),p[2][3].add(Z(0,ae,C(O)?O:wr))}).promise()},promise:function(_){return _!=null?x.extend(_,w):w}},I={};return x.each(p,function(_,O){var j=O[2],z=O[5];w[O[1]]=j.add,z&&j.add(function(){b=z},p[3-_][2].disable,p[3-_][3].disable,p[0][2].lock,p[0][3].lock),j.add(O[3].fire),I[O[0]]=function(){return I[O[0]+"With"](this===I?void 0:this,arguments),this},I[O[0]+"With"]=j.fireWith}),w.promise(I),f&&f.call(I,I),I},when:function(f){var p=arguments.length,b=p,w=Array(b),I=o.call(arguments),_=x.Deferred(),O=function(j){return function(z){w[j]=this,I[j]=arguments.length>1?o.call(arguments):z,--p||_.resolveWith(w,I)}};if(p<=1&&(Cr(f,_.done(O(b)).resolve,_.reject,!p),_.state()==="pending"||C(I[b]&&I[b].then)))return _.then();for(;b--;)Cr(I[b],O(b),_.reject);return _.promise()}});var En=/^(Eval|Internal|Range|Reference|Syntax|Type|URI)Error$/;x.Deferred.exceptionHook=function(f,p){e.console&&e.console.warn&&f&&En.test(f.name)&&e.console.warn("jQuery.Deferred exception: "+f.message,f.stack,p)},x.readyException=function(f){e.setTimeout(function(){throw f})};var os=x.Deferred();x.fn.ready=function(f){return os.then(f).catch(function(p){x.readyException(p)}),this},x.extend({isReady:!1,readyWait:1,ready:function(f){(f===!0?--x.readyWait:x.isReady)||(x.isReady=!0,!(f!==!0&&--x.readyWait>0)&&os.resolveWith(T,[x]))}}),x.ready.then=os.then;function Tr(){T.removeEventListener("DOMContentLoaded",Tr),e.removeEventListener("load",Tr),x.ready()}T.readyState==="complete"||T.readyState!=="loading"&&!T.documentElement.doScroll?e.setTimeout(x.ready):(T.addEventListener("DOMContentLoaded",Tr),e.addEventListener("load",Tr));var Vt=function(f,p,b,w,I,_,O){var j=0,z=f.length,Z=b==null;if(B(b)==="object"){I=!0;for(j in b)Vt(f,p,j,b[j],!0,_,O)}else if(w!==void 0&&(I=!0,C(w)||(O=!0),Z&&(O?(p.call(f,w),p=null):(Z=p,p=function(ae,xe,ne){return Z.call(x(ae),ne)})),p))for(;j<z;j++)p(f[j],b,O?w:w.call(f[j],j,p(f[j],b)));return I?f:Z?p.call(f):z?p(f[0],b):_},Rn=/^-ms-/,kt=/-([a-z])/g;function Ur(f,p){return p.toUpperCase()}function Jt(f){return f.replace(Rn,"ms-").replace(kt,Ur)}var tr=function(f){return f.nodeType===1||f.nodeType===9||!+f.nodeType};function en(){this.expando=x.expando+en.uid++}en.uid=1,en.prototype={cache:function(f){var p=f[this.expando];return p||(p={},tr(f)&&(f.nodeType?f[this.expando]=p:Object.defineProperty(f,this.expando,{value:p,configurable:!0}))),p},set:function(f,p,b){var w,I=this.cache(f);if(typeof p=="string")I[Jt(p)]=b;else for(w in p)I[Jt(w)]=p[w];return I},get:function(f,p){return p===void 0?this.cache(f):f[this.expando]&&f[this.expando][Jt(p)]},access:function(f,p,b){return p===void 0||p&&typeof p=="string"&&b===void 0?this.get(f,p):(this.set(f,p,b),b!==void 0?b:p)},remove:function(f,p){var b,w=f[this.expando];if(w!==void 0){if(p!==void 0)for(Array.isArray(p)?p=p.map(Jt):(p=Jt(p),p=p in w?[p]:p.match(gt)||[]),b=p.length;b--;)delete w[p[b]];(p===void 0||x.isEmptyObject(w))&&(f.nodeType?f[this.expando]=void 0:delete f[this.expando])}},hasData:function(f){var p=f[this.expando];return p!==void 0&&!x.isEmptyObject(p)}};var Fe=new en,Ft=new en,pn=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,Vn=/[A-Z]/g;function ks(f){return f==="true"?!0:f==="false"?!1:f==="null"?null:f===+f+""?+f:pn.test(f)?JSON.parse(f):f}function Ut(f,p,b){var w;if(b===void 0&&f.nodeType===1)if(w="data-"+p.replace(Vn,"-$&").toLowerCase(),b=f.getAttribute(w),typeof b=="string"){try{b=ks(b)}catch{}Ft.set(f,p,b)}else b=void 0;return b}x.extend({hasData:function(f){return Ft.hasData(f)||Fe.hasData(f)},data:function(f,p,b){return Ft.access(f,p,b)},removeData:function(f,p){Ft.remove(f,p)},_data:function(f,p,b){return Fe.access(f,p,b)},_removeData:function(f,p){Fe.remove(f,p)}}),x.fn.extend({data:function(f,p){var b,w,I,_=this[0],O=_&&_.attributes;if(f===void 0){if(this.length&&(I=Ft.get(_),_.nodeType===1&&!Fe.get(_,"hasDataAttrs"))){for(b=O.length;b--;)O[b]&&(w=O[b].name,w.indexOf("data-")===0&&(w=Jt(w.slice(5)),Ut(_,w,I[w])));Fe.set(_,"hasDataAttrs",!0)}return I}return typeof f=="object"?this.each(function(){Ft.set(this,f)}):Vt(this,function(j){var z;if(_&&j===void 0)return z=Ft.get(_,f),z!==void 0||(z=Ut(_,f),z!==void 0)?z:void 0;this.each(function(){Ft.set(this,f,j)})},null,p,arguments.length>1,null,!0)},removeData:function(f){return this.each(function(){Ft.remove(this,f)})}}),x.extend({queue:function(f,p,b){var w;if(f)return p=(p||"fx")+"queue",w=Fe.get(f,p),b&&(!w||Array.isArray(b)?w=Fe.access(f,p,x.makeArray(b)):w.push(b)),w||[]},dequeue:function(f,p){p=p||"fx";var b=x.queue(f,p),w=b.length,I=b.shift(),_=x._queueHooks(f,p),O=function(){x.dequeue(f,p)};I==="inprogress"&&(I=b.shift(),w--),I&&(p==="fx"&&b.unshift("inprogress"),delete _.stop,I.call(f,O,_)),!w&&_&&_.empty.fire()},_queueHooks:function(f,p){var b=p+"queueHooks";return Fe.get(f,b)||Fe.access(f,b,{empty:x.Callbacks("once memory").add(function(){Fe.remove(f,[p+"queue",b])})})}}),x.fn.extend({queue:function(f,p){var b=2;return typeof f!="string"&&(p=f,f="fx",b--),arguments.length<b?x.queue(this[0],f):p===void 0?this:this.each(function(){var w=x.queue(this,f,p);x._queueHooks(this,f),f==="fx"&&w[0]!=="inprogress"&&x.dequeue(this,f)})},dequeue:function(f){return this.each(function(){x.dequeue(this,f)})},clearQueue:function(f){return this.queue(f||"fx",[])},promise:function(f,p){var b,w=1,I=x.Deferred(),_=this,O=this.length,j=function(){--w||I.resolveWith(_,[_])};for(typeof f!="string"&&(p=f,f=void 0),f=f||"fx";O--;)b=Fe.get(_[O],f+"queueHooks"),b&&b.empty&&(w++,b.empty.add(j));return j(),I.promise(p)}});var Wr=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,$r=new RegExp("^(?:([+-])=|)("+Wr+")([a-z%]*)$","i"),kn=["Top","Right","Bottom","Left"],un=T.documentElement,Ht=function(f){return x.contains(f.ownerDocument,f)},is={composed:!0};un.getRootNode&&(Ht=function(f){return x.contains(f.ownerDocument,f)||f.getRootNode(is)===f.ownerDocument});var qt=function(f,p){return f=p||f,f.style.display==="none"||f.style.display===""&&Ht(f)&&x.css(f,"display")==="none"};function zr(f,p,b,w){var I,_,O=20,j=w?function(){return w.cur()}:function(){return x.css(f,p,"")},z=j(),Z=b&&b[3]||(x.cssNumber[p]?"":"px"),ae=f.nodeType&&(x.cssNumber[p]||Z!=="px"&&+z)&&$r.exec(x.css(f,p));if(ae&&ae[3]!==Z){for(z=z/2,Z=Z||ae[3],ae=+z||1;O--;)x.style(f,p,ae+Z),(1-_)*(1-(_=j()/z||.5))<=0&&(O=0),ae=ae/_;ae=ae*2,x.style(f,p,ae+Z),b=b||[]}return b&&(ae=+ae||+z||0,I=b[1]?ae+(b[1]+1)*b[2]:+b[2],w&&(w.unit=Z,w.start=ae,w.end=I)),I}var Is={};function Qs(f){var p,b=f.ownerDocument,w=f.nodeName,I=Is[w];return I||(p=b.body.appendChild(b.createElement(w)),I=x.css(p,"display"),p.parentNode.removeChild(p),I==="none"&&(I="block"),Is[w]=I,I)}function Sr(f,p){for(var b,w,I=[],_=0,O=f.length;_<O;_++)w=f[_],w.style&&(b=w.style.display,p?(b==="none"&&(I[_]=Fe.get(w,"display")||null,I[_]||(w.style.display="")),w.style.display===""&&qt(w)&&(I[_]=Qs(w))):b!=="none"&&(I[_]="none",Fe.set(w,"display",b)));for(_=0;_<O;_++)I[_]!=null&&(f[_].style.display=I[_]);return f}x.fn.extend({show:function(){return Sr(this,!0)},hide:function(){return Sr(this)},toggle:function(f){return typeof f=="boolean"?f?this.show():this.hide():this.each(function(){qt(this)?x(this).show():x(this).hide()})}});var Gr=/^(?:checkbox|radio)$/i,Wt=/<([a-z][^\/\0>\x20\t\r\n\f]*)/i,Et=/^$|^module$|\/(?:java|ecma)script/i;(function(){var f=T.createDocumentFragment(),p=f.appendChild(T.createElement("div")),b=T.createElement("input");b.setAttribute("type","radio"),b.setAttribute("checked","checked"),b.setAttribute("name","t"),p.appendChild(b),g.checkClone=p.cloneNode(!0).cloneNode(!0).lastChild.checked,p.innerHTML="<textarea>x</textarea>",g.noCloneChecked=!!p.cloneNode(!0).lastChild.defaultValue,p.innerHTML="<option></option>",g.option=!!p.lastChild})();var st={thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};st.tbody=st.tfoot=st.colgroup=st.caption=st.thead,st.th=st.td,g.option||(st.optgroup=st.option=[1,"<select multiple='multiple'>","</select>"]);function ht(f,p){var b;return typeof f.getElementsByTagName<"u"?b=f.getElementsByTagName(p||"*"):typeof f.querySelectorAll<"u"?b=f.querySelectorAll(p||"*"):b=[],p===void 0||p&&Ie(f,p)?x.merge([f],b):b}function Nr(f,p){for(var b=0,w=f.length;b<w;b++)Fe.set(f[b],"globalEval",!p||Fe.get(p[b],"globalEval"))}var dt=/<|&#?\w+;/;function jr(f,p,b,w,I){for(var _,O,j,z,Z,ae,xe=p.createDocumentFragment(),ne=[],ce=0,Pe=f.length;ce<Pe;ce++)if(_=f[ce],_||_===0)if(B(_)==="object")x.merge(ne,_.nodeType?[_]:_);else if(!dt.test(_))ne.push(p.createTextNode(_));else{for(O=O||xe.appendChild(p.createElement("div")),j=(Wt.exec(_)||["",""])[1].toLowerCase(),z=st[j]||st._default,O.innerHTML=z[1]+x.htmlPrefilter(_)+z[2],ae=z[0];ae--;)O=O.lastChild;x.merge(ne,O.childNodes),O=xe.firstChild,O.textContent=""}for(xe.textContent="",ce=0;_=ne[ce++];){if(w&&x.inArray(_,w)>-1){I&&I.push(_);continue}if(Z=Ht(_),O=ht(xe.appendChild(_),"script"),Z&&Nr(O),b)for(ae=0;_=O[ae++];)Et.test(_.type||"")&&b.push(_)}return xe}var _s=/^([^.]*)(?:\.(.+)|)/;function cn(){return!0}function zt(){return!1}function Qe(f,p){return f===Vo()==(p==="focus")}function Vo(){try{return T.activeElement}catch{}}function Hr(f,p,b,w,I,_){var O,j;if(typeof p=="object"){typeof b!="string"&&(w=w||b,b=void 0);for(j in p)Hr(f,j,b,w,p[j],_);return f}if(w==null&&I==null?(I=b,w=b=void 0):I==null&&(typeof b=="string"?(I=w,w=void 0):(I=w,w=b,b=void 0)),I===!1)I=zt;else if(!I)return f;return _===1&&(O=I,I=function(z){return x().off(z),O.apply(this,arguments)},I.guid=O.guid||(O.guid=x.guid++)),f.each(function(){x.event.add(this,p,I,w,b)})}x.event={global:{},add:function(f,p,b,w,I){var _,O,j,z,Z,ae,xe,ne,ce,Pe,Xe,Be=Fe.get(f);if(!!tr(f))for(b.handler&&(_=b,b=_.handler,I=_.selector),I&&x.find.matchesSelector(un,I),b.guid||(b.guid=x.guid++),(z=Be.events)||(z=Be.events=Object.create(null)),(O=Be.handle)||(O=Be.handle=function(Xt){return typeof x<"u"&&x.event.triggered!==Xt.type?x.event.dispatch.apply(f,arguments):void 0}),p=(p||"").match(gt)||[""],Z=p.length;Z--;)j=_s.exec(p[Z])||[],ce=Xe=j[1],Pe=(j[2]||"").split(".").sort(),ce&&(xe=x.event.special[ce]||{},ce=(I?xe.delegateType:xe.bindType)||ce,xe=x.event.special[ce]||{},ae=x.extend({type:ce,origType:Xe,data:w,handler:b,guid:b.guid,selector:I,needsContext:I&&x.expr.match.needsContext.test(I),namespace:Pe.join(".")},_),(ne=z[ce])||(ne=z[ce]=[],ne.delegateCount=0,(!xe.setup||xe.setup.call(f,w,Pe,O)===!1)&&f.addEventListener&&f.addEventListener(ce,O)),xe.add&&(xe.add.call(f,ae),ae.handler.guid||(ae.handler.guid=b.guid)),I?ne.splice(ne.delegateCount++,0,ae):ne.push(ae),x.event.global[ce]=!0)},remove:function(f,p,b,w,I){var _,O,j,z,Z,ae,xe,ne,ce,Pe,Xe,Be=Fe.hasData(f)&&Fe.get(f);if(!(!Be||!(z=Be.events))){for(p=(p||"").match(gt)||[""],Z=p.length;Z--;){if(j=_s.exec(p[Z])||[],ce=Xe=j[1],Pe=(j[2]||"").split(".").sort(),!ce){for(ce in z)x.event.remove(f,ce+p[Z],b,w,!0);continue}for(xe=x.event.special[ce]||{},ce=(w?xe.delegateType:xe.bindType)||ce,ne=z[ce]||[],j=j[2]&&new RegExp("(^|\\.)"+Pe.join("\\.(?:.*\\.|)")+"(\\.|$)"),O=_=ne.length;_--;)ae=ne[_],(I||Xe===ae.origType)&&(!b||b.guid===ae.guid)&&(!j||j.test(ae.namespace))&&(!w||w===ae.selector||w==="**"&&ae.selector)&&(ne.splice(_,1),ae.selector&&ne.delegateCount--,xe.remove&&xe.remove.call(f,ae));O&&!ne.length&&((!xe.teardown||xe.teardown.call(f,Pe,Be.handle)===!1)&&x.removeEvent(f,ce,Be.handle),delete z[ce])}x.isEmptyObject(z)&&Fe.remove(f,"handle events")}},dispatch:function(f){var p,b,w,I,_,O,j=new Array(arguments.length),z=x.event.fix(f),Z=(Fe.get(this,"events")||Object.create(null))[z.type]||[],ae=x.event.special[z.type]||{};for(j[0]=z,p=1;p<arguments.length;p++)j[p]=arguments[p];if(z.delegateTarget=this,!(ae.preDispatch&&ae.preDispatch.call(this,z)===!1)){for(O=x.event.handlers.call(this,z,Z),p=0;(I=O[p++])&&!z.isPropagationStopped();)for(z.currentTarget=I.elem,b=0;(_=I.handlers[b++])&&!z.isImmediatePropagationStopped();)(!z.rnamespace||_.namespace===!1||z.rnamespace.test(_.namespace))&&(z.handleObj=_,z.data=_.data,w=((x.event.special[_.origType]||{}).handle||_.handler).apply(I.elem,j),w!==void 0&&(z.result=w)===!1&&(z.preventDefault(),z.stopPropagation()));return ae.postDispatch&&ae.postDispatch.call(this,z),z.result}},handlers:function(f,p){var b,w,I,_,O,j=[],z=p.delegateCount,Z=f.target;if(z&&Z.nodeType&&!(f.type==="click"&&f.button>=1)){for(;Z!==this;Z=Z.parentNode||this)if(Z.nodeType===1&&!(f.type==="click"&&Z.disabled===!0)){for(_=[],O={},b=0;b<z;b++)w=p[b],I=w.selector+" ",O[I]===void 0&&(O[I]=w.needsContext?x(I,this).index(Z)>-1:x.find(I,this,null,[Z]).length),O[I]&&_.push(w);_.length&&j.push({elem:Z,handlers:_})}}return Z=this,z<p.length&&j.push({elem:Z,handlers:p.slice(z)}),j},addProp:function(f,p){Object.defineProperty(x.Event.prototype,f,{enumerable:!0,configurable:!0,get:C(p)?function(){if(this.originalEvent)return p(this.originalEvent)}:function(){if(this.originalEvent)return this.originalEvent[f]},set:function(b){Object.defineProperty(this,f,{enumerable:!0,configurable:!0,writable:!0,value:b})}})},fix:function(f){return f[x.expando]?f:new x.Event(f)},special:{load:{noBubble:!0},click:{setup:function(f){var p=this||f;return Gr.test(p.type)&&p.click&&Ie(p,"input")&&nr(p,"click",cn),!1},trigger:function(f){var p=this||f;return Gr.test(p.type)&&p.click&&Ie(p,"input")&&nr(p,"click"),!0},_default:function(f){var p=f.target;return Gr.test(p.type)&&p.click&&Ie(p,"input")&&Fe.get(p,"click")||Ie(p,"a")}},beforeunload:{postDispatch:function(f){f.result!==void 0&&f.originalEvent&&(f.originalEvent.returnValue=f.result)}}}};function nr(f,p,b){if(!b){Fe.get(f,p)===void 0&&x.event.add(f,p,cn);return}Fe.set(f,p,!1),x.event.add(f,p,{namespace:!1,handler:function(w){var I,_,O=Fe.get(this,p);if(w.isTrigger&1&&this[p]){if(O.length)(x.event.special[p]||{}).delegateType&&w.stopPropagation();else if(O=o.call(arguments),Fe.set(this,p,O),I=b(this,p),this[p](),_=Fe.get(this,p),O!==_||I?Fe.set(this,p,!1):_={},O!==_)return w.stopImmediatePropagation(),w.preventDefault(),_&&_.value}else O.length&&(Fe.set(this,p,{value:x.event.trigger(x.extend(O[0],x.Event.prototype),O.slice(1),this)}),w.stopImmediatePropagation())}})}x.removeEvent=function(f,p,b){f.removeEventListener&&f.removeEventListener(p,b)},x.Event=function(f,p){if(!(this instanceof x.Event))return new x.Event(f,p);f&&f.type?(this.originalEvent=f,this.type=f.type,this.isDefaultPrevented=f.defaultPrevented||f.defaultPrevented===void 0&&f.returnValue===!1?cn:zt,this.target=f.target&&f.target.nodeType===3?f.target.parentNode:f.target,this.currentTarget=f.currentTarget,this.relatedTarget=f.relatedTarget):this.type=f,p&&x.extend(this,p),this.timeStamp=f&&f.timeStamp||Date.now(),this[x.expando]=!0},x.Event.prototype={constructor:x.Event,isDefaultPrevented:zt,isPropagationStopped:zt,isImmediatePropagationStopped:zt,isSimulated:!1,preventDefault:function(){var f=this.originalEvent;this.isDefaultPrevented=cn,f&&!this.isSimulated&&f.preventDefault()},stopPropagation:function(){var f=this.originalEvent;this.isPropagationStopped=cn,f&&!this.isSimulated&&f.stopPropagation()},stopImmediatePropagation:function(){var f=this.originalEvent;this.isImmediatePropagationStopped=cn,f&&!this.isSimulated&&f.stopImmediatePropagation(),this.stopPropagation()}},x.each({altKey:!0,bubbles:!0,cancelable:!0,changedTouches:!0,ctrlKey:!0,detail:!0,eventPhase:!0,metaKey:!0,pageX:!0,pageY:!0,shiftKey:!0,view:!0,char:!0,code:!0,charCode:!0,key:!0,keyCode:!0,button:!0,buttons:!0,clientX:!0,clientY:!0,offsetX:!0,offsetY:!0,pointerId:!0,pointerType:!0,screenX:!0,screenY:!0,targetTouches:!0,toElement:!0,touches:!0,which:!0},x.event.addProp),x.each({focus:"focusin",blur:"focusout"},function(f,p){x.event.special[f]={setup:function(){return nr(this,f,Qe),!1},trigger:function(){return nr(this,f),!0},_default:function(b){return Fe.get(b.target,f)},delegateType:p}}),x.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(f,p){x.event.special[f]={delegateType:p,bindType:p,handle:function(b){var w,I=this,_=b.relatedTarget,O=b.handleObj;return(!_||_!==I&&!x.contains(I,_))&&(b.type=O.origType,w=O.handler.apply(this,arguments),b.type=p),w}}}),x.fn.extend({on:function(f,p,b,w){return Hr(this,f,p,b,w)},one:function(f,p,b,w){return Hr(this,f,p,b,w,1)},off:function(f,p,b){var w,I;if(f&&f.preventDefault&&f.handleObj)return w=f.handleObj,x(f.delegateTarget).off(w.namespace?w.origType+"."+w.namespace:w.origType,w.selector,w.handler),this;if(typeof f=="object"){for(I in f)this.off(I,p,f[I]);return this}return(p===!1||typeof p=="function")&&(b=p,p=void 0),b===!1&&(b=zt),this.each(function(){x.event.remove(this,f,b,p)})}});var as=/<script|<style|<link/i,rr=/checked\s*(?:[^=]|=\s*.checked.)/i,Rs=/^\s*<!\[CDATA\[|\]\]>\s*$/g;function mn(f,p){return Ie(f,"table")&&Ie(p.nodeType!==11?p:p.firstChild,"tr")&&x(f).children("tbody")[0]||f}function sr(f){return f.type=(f.getAttribute("type")!==null)+"/"+f.type,f}function Uo(f){return(f.type||"").slice(0,5)==="true/"?f.type=f.type.slice(5):f.removeAttribute("type"),f}function Wo(f,p){var b,w,I,_,O,j,z;if(p.nodeType===1){if(Fe.hasData(f)&&(_=Fe.get(f),z=_.events,z)){Fe.remove(p,"handle events");for(I in z)for(b=0,w=z[I].length;b<w;b++)x.event.add(p,I,z[I][b])}Ft.hasData(f)&&(O=Ft.access(f),j=x.extend({},O),Ft.set(p,j))}}function Gt(f,p){var b=p.nodeName.toLowerCase();b==="input"&&Gr.test(f.type)?p.checked=f.checked:(b==="input"||b==="textarea")&&(p.defaultValue=f.defaultValue)}function ln(f,p,b,w){p=i(p);var I,_,O,j,z,Z,ae=0,xe=f.length,ne=xe-1,ce=p[0],Pe=C(ce);if(Pe||xe>1&&typeof ce=="string"&&!g.checkClone&&rr.test(ce))return f.each(function(Xe){var Be=f.eq(Xe);Pe&&(p[0]=ce.call(this,Xe,Be.html())),ln(Be,p,b,w)});if(xe&&(I=jr(p,f[0].ownerDocument,!1,f,w),_=I.firstChild,I.childNodes.length===1&&(I=_),_||w)){for(O=x.map(ht(I,"script"),sr),j=O.length;ae<xe;ae++)z=I,ae!==ne&&(z=x.clone(z,!0,!0),j&&x.merge(O,ht(z,"script"))),b.call(f[ae],z,ae);if(j)for(Z=O[O.length-1].ownerDocument,x.map(O,Uo),ae=0;ae<j;ae++)z=O[ae],Et.test(z.type||"")&&!Fe.access(z,"globalEval")&&x.contains(Z,z)&&(z.src&&(z.type||"").toLowerCase()!=="module"?x._evalUrl&&!z.noModule&&x._evalUrl(z.src,{nonce:z.nonce||z.getAttribute("nonce")},Z):P(z.textContent.replace(Rs,""),z,Z))}return f}function Zs(f,p,b){for(var w,I=p?x.filter(p,f):f,_=0;(w=I[_])!=null;_++)!b&&w.nodeType===1&&x.cleanData(ht(w)),w.parentNode&&(b&&Ht(w)&&Nr(ht(w,"script")),w.parentNode.removeChild(w));return f}x.extend({htmlPrefilter:function(f){return f},clone:function(f,p,b){var w,I,_,O,j=f.cloneNode(!0),z=Ht(f);if(!g.noCloneChecked&&(f.nodeType===1||f.nodeType===11)&&!x.isXMLDoc(f))for(O=ht(j),_=ht(f),w=0,I=_.length;w<I;w++)Gt(_[w],O[w]);if(p)if(b)for(_=_||ht(f),O=O||ht(j),w=0,I=_.length;w<I;w++)Wo(_[w],O[w]);else Wo(f,j);return O=ht(j,"script"),O.length>0&&Nr(O,!z&&ht(f,"script")),j},cleanData:function(f){for(var p,b,w,I=x.event.special,_=0;(b=f[_])!==void 0;_++)if(tr(b)){if(p=b[Fe.expando]){if(p.events)for(w in p.events)I[w]?x.event.remove(b,w):x.removeEvent(b,w,p.handle);b[Fe.expando]=void 0}b[Ft.expando]&&(b[Ft.expando]=void 0)}}}),x.fn.extend({detach:function(f){return Zs(this,f,!0)},remove:function(f){return Zs(this,f)},text:function(f){return Vt(this,function(p){return p===void 0?x.text(this):this.empty().each(function(){(this.nodeType===1||this.nodeType===11||this.nodeType===9)&&(this.textContent=p)})},null,f,arguments.length)},append:function(){return ln(this,arguments,function(f){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var p=mn(this,f);p.appendChild(f)}})},prepend:function(){return ln(this,arguments,function(f){if(this.nodeType===1||this.nodeType===11||this.nodeType===9){var p=mn(this,f);p.insertBefore(f,p.firstChild)}})},before:function(){return ln(this,arguments,function(f){this.parentNode&&this.parentNode.insertBefore(f,this)})},after:function(){return ln(this,arguments,function(f){this.parentNode&&this.parentNode.insertBefore(f,this.nextSibling)})},empty:function(){for(var f,p=0;(f=this[p])!=null;p++)f.nodeType===1&&(x.cleanData(ht(f,!1)),f.textContent="");return this},clone:function(f,p){return f=f==null?!1:f,p=p==null?f:p,this.map(function(){return x.clone(this,f,p)})},html:function(f){return Vt(this,function(p){var b=this[0]||{},w=0,I=this.length;if(p===void 0&&b.nodeType===1)return b.innerHTML;if(typeof p=="string"&&!as.test(p)&&!st[(Wt.exec(p)||["",""])[1].toLowerCase()]){p=x.htmlPrefilter(p);try{for(;w<I;w++)b=this[w]||{},b.nodeType===1&&(x.cleanData(ht(b,!1)),b.innerHTML=p);b=0}catch{}}b&&this.empty().append(p)},null,f,arguments.length)},replaceWith:function(){var f=[];return ln(this,arguments,function(p){var b=this.parentNode;x.inArray(this,f)<0&&(x.cleanData(ht(this)),b&&b.replaceChild(p,this))},f)}}),x.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(f,p){x.fn[f]=function(b){for(var w,I=[],_=x(b),O=_.length-1,j=0;j<=O;j++)w=j===O?this:this.clone(!0),x(_[j])[p](w),a.apply(I,w.get());return this.pushStack(I)}});var qr=new RegExp("^("+Wr+")(?!px)[a-z%]+$","i"),As=/^--/,Un=function(f){var p=f.ownerDocument.defaultView;return(!p||!p.opener)&&(p=e),p.getComputedStyle(f)},zo=function(f,p,b){var w,I,_={};for(I in p)_[I]=f.style[I],f.style[I]=p[I];w=b.call(f);for(I in p)f.style[I]=_[I];return w},Go=new RegExp(kn.join("|"),"i"),Js="[\\x20\\t\\r\\n\\f]",jo=new RegExp("^"+Js+"+|((?:^|[^\\\\])(?:\\\\.)*)"+Js+"+$","g");(function(){function f(){if(!!Z){z.style.cssText="position:absolute;left:-11111px;width:60px;margin-top:1px;padding:0;border:0",Z.style.cssText="position:relative;display:block;box-sizing:border-box;overflow:scroll;margin:auto;border:1px;padding:1px;width:60%;top:1%",un.appendChild(z).appendChild(Z);var ae=e.getComputedStyle(Z);b=ae.top!=="1%",j=p(ae.marginLeft)===12,Z.style.right="60%",_=p(ae.right)===36,w=p(ae.width)===36,Z.style.position="absolute",I=p(Z.offsetWidth/3)===12,un.removeChild(z),Z=null}}function p(ae){return Math.round(parseFloat(ae))}var b,w,I,_,O,j,z=T.createElement("div"),Z=T.createElement("div");!Z.style||(Z.style.backgroundClip="content-box",Z.cloneNode(!0).style.backgroundClip="",g.clearCloneStyle=Z.style.backgroundClip==="content-box",x.extend(g,{boxSizingReliable:function(){return f(),w},pixelBoxStyles:function(){return f(),_},pixelPosition:function(){return f(),b},reliableMarginLeft:function(){return f(),j},scrollboxSize:function(){return f(),I},reliableTrDimensions:function(){var ae,xe,ne,ce;return O==null&&(ae=T.createElement("table"),xe=T.createElement("tr"),ne=T.createElement("div"),ae.style.cssText="position:absolute;left:-11111px;border-collapse:separate",xe.style.cssText="border:1px solid",xe.style.height="1px",ne.style.height="9px",ne.style.display="block",un.appendChild(ae).appendChild(xe).appendChild(ne),ce=e.getComputedStyle(xe),O=parseInt(ce.height,10)+parseInt(ce.borderTopWidth,10)+parseInt(ce.borderBottomWidth,10)===xe.offsetHeight,un.removeChild(ae)),O}}))})();function or(f,p,b){var w,I,_,O,j=As.test(p),z=f.style;return b=b||Un(f),b&&(O=b.getPropertyValue(p)||b[p],j&&(O=O.replace(jo,"$1")),O===""&&!Ht(f)&&(O=x.style(f,p)),!g.pixelBoxStyles()&&qr.test(O)&&Go.test(p)&&(w=z.width,I=z.minWidth,_=z.maxWidth,z.minWidth=z.maxWidth=z.width=O,O=b.width,z.width=w,z.minWidth=I,z.maxWidth=_)),O!==void 0?O+"":O}function ir(f,p){return{get:function(){if(f()){delete this.get;return}return(this.get=p).apply(this,arguments)}}}var Ho=["Webkit","Moz","ms"],qo=T.createElement("div").style,us={};function Xo(f){for(var p=f[0].toUpperCase()+f.slice(1),b=Ho.length;b--;)if(f=Ho[b]+p,f in qo)return f}function cs(f){var p=x.cssProps[f]||us[f];return p||(f in qo?f:us[f]=Xo(f)||f)}var eo=/^(none|table(?!-c[ea]).+)/,to={position:"absolute",visibility:"hidden",display:"block"},Xr={letterSpacing:"0",fontWeight:"400"};function Er(f,p,b){var w=$r.exec(p);return w?Math.max(0,w[2]-(b||0))+(w[3]||"px"):p}function hn(f,p,b,w,I,_){var O=p==="width"?1:0,j=0,z=0;if(b===(w?"border":"content"))return 0;for(;O<4;O+=2)b==="margin"&&(z+=x.css(f,b+kn[O],!0,I)),w?(b==="content"&&(z-=x.css(f,"padding"+kn[O],!0,I)),b!=="margin"&&(z-=x.css(f,"border"+kn[O]+"Width",!0,I))):(z+=x.css(f,"padding"+kn[O],!0,I),b!=="padding"?z+=x.css(f,"border"+kn[O]+"Width",!0,I):j+=x.css(f,"border"+kn[O]+"Width",!0,I));return!w&&_>=0&&(z+=Math.max(0,Math.ceil(f["offset"+p[0].toUpperCase()+p.slice(1)]-_-z-j-.5))||0),z}function Ko(f,p,b){var w=Un(f),I=!g.boxSizingReliable()||b,_=I&&x.css(f,"boxSizing",!1,w)==="border-box",O=_,j=or(f,p,w),z="offset"+p[0].toUpperCase()+p.slice(1);if(qr.test(j)){if(!b)return j;j="auto"}return(!g.boxSizingReliable()&&_||!g.reliableTrDimensions()&&Ie(f,"tr")||j==="auto"||!parseFloat(j)&&x.css(f,"display",!1,w)==="inline")&&f.getClientRects().length&&(_=x.css(f,"boxSizing",!1,w)==="border-box",O=z in f,O&&(j=f[z])),j=parseFloat(j)||0,j+hn(f,p,b||(_?"border":"content"),O,w,j)+"px"}x.extend({cssHooks:{opacity:{get:function(f,p){if(p){var b=or(f,"opacity");return b===""?"1":b}}}},cssNumber:{animationIterationCount:!0,columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,gridArea:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnStart:!0,gridRow:!0,gridRowEnd:!0,gridRowStart:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{},style:function(f,p,b,w){if(!(!f||f.nodeType===3||f.nodeType===8||!f.style)){var I,_,O,j=Jt(p),z=As.test(p),Z=f.style;if(z||(p=cs(j)),O=x.cssHooks[p]||x.cssHooks[j],b!==void 0){if(_=typeof b,_==="string"&&(I=$r.exec(b))&&I[1]&&(b=zr(f,p,I),_="number"),b==null||b!==b)return;_==="number"&&!z&&(b+=I&&I[3]||(x.cssNumber[j]?"":"px")),!g.clearCloneStyle&&b===""&&p.indexOf("background")===0&&(Z[p]="inherit"),(!O||!("set"in O)||(b=O.set(f,b,w))!==void 0)&&(z?Z.setProperty(p,b):Z[p]=b)}else return O&&"get"in O&&(I=O.get(f,!1,w))!==void 0?I:Z[p]}},css:function(f,p,b,w){var I,_,O,j=Jt(p),z=As.test(p);return z||(p=cs(j)),O=x.cssHooks[p]||x.cssHooks[j],O&&"get"in O&&(I=O.get(f,!0,b)),I===void 0&&(I=or(f,p,w)),I==="normal"&&p in Xr&&(I=Xr[p]),b===""||b?(_=parseFloat(I),b===!0||isFinite(_)?_||0:I):I}}),x.each(["height","width"],function(f,p){x.cssHooks[p]={get:function(b,w,I){if(w)return eo.test(x.css(b,"display"))&&(!b.getClientRects().length||!b.getBoundingClientRect().width)?zo(b,to,function(){return Ko(b,p,I)}):Ko(b,p,I)},set:function(b,w,I){var _,O=Un(b),j=!g.scrollboxSize()&&O.position==="absolute",z=j||I,Z=z&&x.css(b,"boxSizing",!1,O)==="border-box",ae=I?hn(b,p,I,Z,O):0;return Z&&j&&(ae-=Math.ceil(b["offset"+p[0].toUpperCase()+p.slice(1)]-parseFloat(O[p])-hn(b,p,"border",!1,O)-.5)),ae&&(_=$r.exec(w))&&(_[3]||"px")!=="px"&&(b.style[p]=w,w=x.css(b,p)),Er(b,w,ae)}}}),x.cssHooks.marginLeft=ir(g.reliableMarginLeft,function(f,p){if(p)return(parseFloat(or(f,"marginLeft"))||f.getBoundingClientRect().left-zo(f,{marginLeft:0},function(){return f.getBoundingClientRect().left}))+"px"}),x.each({margin:"",padding:"",border:"Width"},function(f,p){x.cssHooks[f+p]={expand:function(b){for(var w=0,I={},_=typeof b=="string"?b.split(" "):[b];w<4;w++)I[f+kn[w]+p]=_[w]||_[w-2]||_[0];return I}},f!=="margin"&&(x.cssHooks[f+p].set=Er)}),x.fn.extend({css:function(f,p){return Vt(this,function(b,w,I){var _,O,j={},z=0;if(Array.isArray(w)){for(_=Un(b),O=w.length;z<O;z++)j[w[z]]=x.css(b,w[z],!1,_);return j}return I!==void 0?x.style(b,w,I):x.css(b,w)},f,p,arguments.length>1)}});function tn(f,p,b,w,I){return new tn.prototype.init(f,p,b,w,I)}x.Tween=tn,tn.prototype={constructor:tn,init:function(f,p,b,w,I,_){this.elem=f,this.prop=b,this.easing=I||x.easing._default,this.options=p,this.start=this.now=this.cur(),this.end=w,this.unit=_||(x.cssNumber[b]?"":"px")},cur:function(){var f=tn.propHooks[this.prop];return f&&f.get?f.get(this):tn.propHooks._default.get(this)},run:function(f){var p,b=tn.propHooks[this.prop];return this.options.duration?this.pos=p=x.easing[this.easing](f,this.options.duration*f,0,1,this.options.duration):this.pos=p=f,this.now=(this.end-this.start)*p+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),b&&b.set?b.set(this):tn.propHooks._default.set(this),this}},tn.prototype.init.prototype=tn.prototype,tn.propHooks={_default:{get:function(f){var p;return f.elem.nodeType!==1||f.elem[f.prop]!=null&&f.elem.style[f.prop]==null?f.elem[f.prop]:(p=x.css(f.elem,f.prop,""),!p||p==="auto"?0:p)},set:function(f){x.fx.step[f.prop]?x.fx.step[f.prop](f):f.elem.nodeType===1&&(x.cssHooks[f.prop]||f.elem.style[cs(f.prop)]!=null)?x.style(f.elem,f.prop,f.now+f.unit):f.elem[f.prop]=f.now}}},tn.propHooks.scrollTop=tn.propHooks.scrollLeft={set:function(f){f.elem.nodeType&&f.elem.parentNode&&(f.elem[f.prop]=f.now)}},x.easing={linear:function(f){return f},swing:function(f){return .5-Math.cos(f*Math.PI)/2},_default:"swing"},x.fx=tn.prototype.init,x.fx.step={};var kr,Kr,gn=/^(?:toggle|show|hide)$/,Yo=/queueHooks$/;function Wn(){Kr&&(T.hidden===!1&&e.requestAnimationFrame?e.requestAnimationFrame(Wn):e.setTimeout(Wn,x.fx.interval),x.fx.tick())}function no(){return e.setTimeout(function(){kr=void 0}),kr=Date.now()}function Yr(f,p){var b,w=0,I={height:f};for(p=p?1:0;w<4;w+=2-p)b=kn[w],I["margin"+b]=I["padding"+b]=f;return p&&(I.opacity=I.width=f),I}function Qo(f,p,b){for(var w,I=(yn.tweeners[p]||[]).concat(yn.tweeners["*"]),_=0,O=I.length;_<O;_++)if(w=I[_].call(b,p,f))return w}function Ri(f,p,b){var w,I,_,O,j,z,Z,ae,xe="width"in p||"height"in p,ne=this,ce={},Pe=f.style,Xe=f.nodeType&&qt(f),Be=Fe.get(f,"fxshow");b.queue||(O=x._queueHooks(f,"fx"),O.unqueued==null&&(O.unqueued=0,j=O.empty.fire,O.empty.fire=function(){O.unqueued||j()}),O.unqueued++,ne.always(function(){ne.always(function(){O.unqueued--,x.queue(f,"fx").length||O.empty.fire()})}));for(w in p)if(I=p[w],gn.test(I)){if(delete p[w],_=_||I==="toggle",I===(Xe?"hide":"show"))if(I==="show"&&Be&&Be[w]!==void 0)Xe=!0;else continue;ce[w]=Be&&Be[w]||x.style(f,w)}if(z=!x.isEmptyObject(p),!(!z&&x.isEmptyObject(ce))){xe&&f.nodeType===1&&(b.overflow=[Pe.overflow,Pe.overflowX,Pe.overflowY],Z=Be&&Be.display,Z==null&&(Z=Fe.get(f,"display")),ae=x.css(f,"display"),ae==="none"&&(Z?ae=Z:(Sr([f],!0),Z=f.style.display||Z,ae=x.css(f,"display"),Sr([f]))),(ae==="inline"||ae==="inline-block"&&Z!=null)&&x.css(f,"float")==="none"&&(z||(ne.done(function(){Pe.display=Z}),Z==null&&(ae=Pe.display,Z=ae==="none"?"":ae)),Pe.display="inline-block")),b.overflow&&(Pe.overflow="hidden",ne.always(function(){Pe.overflow=b.overflow[0],Pe.overflowX=b.overflow[1],Pe.overflowY=b.overflow[2]})),z=!1;for(w in ce)z||(Be?"hidden"in Be&&(Xe=Be.hidden):Be=Fe.access(f,"fxshow",{display:Z}),_&&(Be.hidden=!Xe),Xe&&Sr([f],!0),ne.done(function(){Xe||Sr([f]),Fe.remove(f,"fxshow");for(w in ce)x.style(f,w,ce[w])})),z=Qo(Xe?Be[w]:0,w,ne),w in Be||(Be[w]=z.start,Xe&&(z.end=z.start,z.start=0))}}function Qr(f,p){var b,w,I,_,O;for(b in f)if(w=Jt(b),I=p[w],_=f[b],Array.isArray(_)&&(I=_[1],_=f[b]=_[0]),b!==w&&(f[w]=_,delete f[b]),O=x.cssHooks[w],O&&"expand"in O){_=O.expand(_),delete f[w];for(b in _)b in f||(f[b]=_[b],p[b]=I)}else p[w]=I}function yn(f,p,b){var w,I,_=0,O=yn.prefilters.length,j=x.Deferred().always(function(){delete z.elem}),z=function(){if(I)return!1;for(var xe=kr||no(),ne=Math.max(0,Z.startTime+Z.duration-xe),ce=ne/Z.duration||0,Pe=1-ce,Xe=0,Be=Z.tweens.length;Xe<Be;Xe++)Z.tweens[Xe].run(Pe);return j.notifyWith(f,[Z,Pe,ne]),Pe<1&&Be?ne:(Be||j.notifyWith(f,[Z,1,0]),j.resolveWith(f,[Z]),!1)},Z=j.promise({elem:f,props:x.extend({},p),opts:x.extend(!0,{specialEasing:{},easing:x.easing._default},b),originalProperties:p,originalOptions:b,startTime:kr||no(),duration:b.duration,tweens:[],createTween:function(xe,ne){var ce=x.Tween(f,Z.opts,xe,ne,Z.opts.specialEasing[xe]||Z.opts.easing);return Z.tweens.push(ce),ce},stop:function(xe){var ne=0,ce=xe?Z.tweens.length:0;if(I)return this;for(I=!0;ne<ce;ne++)Z.tweens[ne].run(1);return xe?(j.notifyWith(f,[Z,1,0]),j.resolveWith(f,[Z,xe])):j.rejectWith(f,[Z,xe]),this}}),ae=Z.props;for(Qr(ae,Z.opts.specialEasing);_<O;_++)if(w=yn.prefilters[_].call(Z,f,ae,Z.opts),w)return C(w.stop)&&(x._queueHooks(Z.elem,Z.opts.queue).stop=w.stop.bind(w)),w;return x.map(ae,Qo,Z),C(Z.opts.start)&&Z.opts.start.call(f,Z),Z.progress(Z.opts.progress).done(Z.opts.done,Z.opts.complete).fail(Z.opts.fail).always(Z.opts.always),x.fx.timer(x.extend(z,{elem:f,anim:Z,queue:Z.opts.queue})),Z}x.Animation=x.extend(yn,{tweeners:{"*":[function(f,p){var b=this.createTween(f,p);return zr(b.elem,f,$r.exec(p),b),b}]},tweener:function(f,p){C(f)?(p=f,f=["*"]):f=f.match(gt);for(var b,w=0,I=f.length;w<I;w++)b=f[w],yn.tweeners[b]=yn.tweeners[b]||[],yn.tweeners[b].unshift(p)},prefilters:[Ri],prefilter:function(f,p){p?yn.prefilters.unshift(f):yn.prefilters.push(f)}}),x.speed=function(f,p,b){var w=f&&typeof f=="object"?x.extend({},f):{complete:b||!b&&p||C(f)&&f,duration:f,easing:b&&p||p&&!C(p)&&p};return x.fx.off?w.duration=0:typeof w.duration!="number"&&(w.duration in x.fx.speeds?w.duration=x.fx.speeds[w.duration]:w.duration=x.fx.speeds._default),(w.queue==null||w.queue===!0)&&(w.queue="fx"),w.old=w.complete,w.complete=function(){C(w.old)&&w.old.call(this),w.queue&&x.dequeue(this,w.queue)},w},x.fn.extend({fadeTo:function(f,p,b,w){return this.filter(qt).css("opacity",0).show().end().animate({opacity:p},f,b,w)},animate:function(f,p,b,w){var I=x.isEmptyObject(f),_=x.speed(p,b,w),O=function(){var j=yn(this,x.extend({},f),_);(I||Fe.get(this,"finish"))&&j.stop(!0)};return O.finish=O,I||_.queue===!1?this.each(O):this.queue(_.queue,O)},stop:function(f,p,b){var w=function(I){var _=I.stop;delete I.stop,_(b)};return typeof f!="string"&&(b=p,p=f,f=void 0),p&&this.queue(f||"fx",[]),this.each(function(){var I=!0,_=f!=null&&f+"queueHooks",O=x.timers,j=Fe.get(this);if(_)j[_]&&j[_].stop&&w(j[_]);else for(_ in j)j[_]&&j[_].stop&&Yo.test(_)&&w(j[_]);for(_=O.length;_--;)O[_].elem===this&&(f==null||O[_].queue===f)&&(O[_].anim.stop(b),I=!1,O.splice(_,1));(I||!b)&&x.dequeue(this,f)})},finish:function(f){return f!==!1&&(f=f||"fx"),this.each(function(){var p,b=Fe.get(this),w=b[f+"queue"],I=b[f+"queueHooks"],_=x.timers,O=w?w.length:0;for(b.finish=!0,x.queue(this,f,[]),I&&I.stop&&I.stop.call(this,!0),p=_.length;p--;)_[p].elem===this&&_[p].queue===f&&(_[p].anim.stop(!0),_.splice(p,1));for(p=0;p<O;p++)w[p]&&w[p].finish&&w[p].finish.call(this);delete b.finish})}}),x.each(["toggle","show","hide"],function(f,p){var b=x.fn[p];x.fn[p]=function(w,I,_){return w==null||typeof w=="boolean"?b.apply(this,arguments):this.animate(Yr(p,!0),w,I,_)}}),x.each({slideDown:Yr("show"),slideUp:Yr("hide"),slideToggle:Yr("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(f,p){x.fn[f]=function(b,w,I){return this.animate(p,b,w,I)}}),x.timers=[],x.fx.tick=function(){var f,p=0,b=x.timers;for(kr=Date.now();p<b.length;p++)f=b[p],!f()&&b[p]===f&&b.splice(p--,1);b.length||x.fx.stop(),kr=void 0},x.fx.timer=function(f){x.timers.push(f),x.fx.start()},x.fx.interval=13,x.fx.start=function(){Kr||(Kr=!0,Wn())},x.fx.stop=function(){Kr=null},x.fx.speeds={slow:600,fast:200,_default:400},x.fn.delay=function(f,p){return f=x.fx&&x.fx.speeds[f]||f,p=p||"fx",this.queue(p,function(b,w){var I=e.setTimeout(b,f);w.stop=function(){e.clearTimeout(I)}})},function(){var f=T.createElement("input"),p=T.createElement("select"),b=p.appendChild(T.createElement("option"));f.type="checkbox",g.checkOn=f.value!=="",g.optSelected=b.selected,f=T.createElement("input"),f.value="t",f.type="radio",g.radioValue=f.value==="t"}();var ro,ls=x.expr.attrHandle;x.fn.extend({attr:function(f,p){return Vt(this,x.attr,f,p,arguments.length>1)},removeAttr:function(f){return this.each(function(){x.removeAttr(this,f)})}}),x.extend({attr:function(f,p,b){var w,I,_=f.nodeType;if(!(_===3||_===8||_===2)){if(typeof f.getAttribute>"u")return x.prop(f,p,b);if((_!==1||!x.isXMLDoc(f))&&(I=x.attrHooks[p.toLowerCase()]||(x.expr.match.bool.test(p)?ro:void 0)),b!==void 0){if(b===null){x.removeAttr(f,p);return}return I&&"set"in I&&(w=I.set(f,b,p))!==void 0?w:(f.setAttribute(p,b+""),b)}return I&&"get"in I&&(w=I.get(f,p))!==null?w:(w=x.find.attr(f,p),w==null?void 0:w)}},attrHooks:{type:{set:function(f,p){if(!g.radioValue&&p==="radio"&&Ie(f,"input")){var b=f.value;return f.setAttribute("type",p),b&&(f.value=b),p}}}},removeAttr:function(f,p){var b,w=0,I=p&&p.match(gt);if(I&&f.nodeType===1)for(;b=I[w++];)f.removeAttribute(b)}}),ro={set:function(f,p,b){return p===!1?x.removeAttr(f,b):f.setAttribute(b,b),b}},x.each(x.expr.match.bool.source.match(/\w+/g),function(f,p){var b=ls[p]||x.find.attr;ls[p]=function(w,I,_){var O,j,z=I.toLowerCase();return _||(j=ls[z],ls[z]=O,O=b(w,I,_)!=null?z:null,ls[z]=j),O}});var Ai=/^(?:input|select|textarea|button)$/i,so=/^(?:a|area)$/i;x.fn.extend({prop:function(f,p){return Vt(this,x.prop,f,p,arguments.length>1)},removeProp:function(f){return this.each(function(){delete this[x.propFix[f]||f]})}}),x.extend({prop:function(f,p,b){var w,I,_=f.nodeType;if(!(_===3||_===8||_===2))return(_!==1||!x.isXMLDoc(f))&&(p=x.propFix[p]||p,I=x.propHooks[p]),b!==void 0?I&&"set"in I&&(w=I.set(f,b,p))!==void 0?w:f[p]=b:I&&"get"in I&&(w=I.get(f,p))!==null?w:f[p]},propHooks:{tabIndex:{get:function(f){var p=x.find.attr(f,"tabindex");return p?parseInt(p,10):Ai.test(f.nodeName)||so.test(f.nodeName)&&f.href?0:-1}}},propFix:{for:"htmlFor",class:"className"}}),g.optSelected||(x.propHooks.selected={get:function(f){var p=f.parentNode;return p&&p.parentNode&&p.parentNode.selectedIndex,null},set:function(f){var p=f.parentNode;p&&(p.selectedIndex,p.parentNode&&p.parentNode.selectedIndex)}}),x.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){x.propFix[this.toLowerCase()]=this});function zn(f){var p=f.match(gt)||[];return p.join(" ")}function Gn(f){return f.getAttribute&&f.getAttribute("class")||""}function hs(f){return Array.isArray(f)?f:typeof f=="string"?f.match(gt)||[]:[]}x.fn.extend({addClass:function(f){var p,b,w,I,_,O;return C(f)?this.each(function(j){x(this).addClass(f.call(this,j,Gn(this)))}):(p=hs(f),p.length?this.each(function(){if(w=Gn(this),b=this.nodeType===1&&" "+zn(w)+" ",b){for(_=0;_<p.length;_++)I=p[_],b.indexOf(" "+I+" ")<0&&(b+=I+" ");O=zn(b),w!==O&&this.setAttribute("class",O)}}):this)},removeClass:function(f){var p,b,w,I,_,O;return C(f)?this.each(function(j){x(this).removeClass(f.call(this,j,Gn(this)))}):arguments.length?(p=hs(f),p.length?this.each(function(){if(w=Gn(this),b=this.nodeType===1&&" "+zn(w)+" ",b){for(_=0;_<p.length;_++)for(I=p[_];b.indexOf(" "+I+" ")>-1;)b=b.replace(" "+I+" "," ");O=zn(b),w!==O&&this.setAttribute("class",O)}}):this):this.attr("class","")},toggleClass:function(f,p){var b,w,I,_,O=typeof f,j=O==="string"||Array.isArray(f);return C(f)?this.each(function(z){x(this).toggleClass(f.call(this,z,Gn(this),p),p)}):typeof p=="boolean"&&j?p?this.addClass(f):this.removeClass(f):(b=hs(f),this.each(function(){if(j)for(_=x(this),I=0;I<b.length;I++)w=b[I],_.hasClass(w)?_.removeClass(w):_.addClass(w);else(f===void 0||O==="boolean")&&(w=Gn(this),w&&Fe.set(this,"__className__",w),this.setAttribute&&this.setAttribute("class",w||f===!1?"":Fe.get(this,"__className__")||""))}))},hasClass:function(f){var p,b,w=0;for(p=" "+f+" ";b=this[w++];)if(b.nodeType===1&&(" "+zn(Gn(b))+" ").indexOf(p)>-1)return!0;return!1}});var oo=/\r/g;x.fn.extend({val:function(f){var p,b,w,I=this[0];return arguments.length?(w=C(f),this.each(function(_){var O;this.nodeType===1&&(w?O=f.call(this,_,x(this).val()):O=f,O==null?O="":typeof O=="number"?O+="":Array.isArray(O)&&(O=x.map(O,function(j){return j==null?"":j+""})),p=x.valHooks[this.type]||x.valHooks[this.nodeName.toLowerCase()],(!p||!("set"in p)||p.set(this,O,"value")===void 0)&&(this.value=O))})):I?(p=x.valHooks[I.type]||x.valHooks[I.nodeName.toLowerCase()],p&&"get"in p&&(b=p.get(I,"value"))!==void 0?b:(b=I.value,typeof b=="string"?b.replace(oo,""):b==null?"":b)):void 0}}),x.extend({valHooks:{option:{get:function(f){var p=x.find.attr(f,"value");return p!=null?p:zn(x.text(f))}},select:{get:function(f){var p,b,w,I=f.options,_=f.selectedIndex,O=f.type==="select-one",j=O?null:[],z=O?_+1:I.length;for(_<0?w=z:w=O?_:0;w<z;w++)if(b=I[w],(b.selected||w===_)&&!b.disabled&&(!b.parentNode.disabled||!Ie(b.parentNode,"optgroup"))){if(p=x(b).val(),O)return p;j.push(p)}return j},set:function(f,p){for(var b,w,I=f.options,_=x.makeArray(p),O=I.length;O--;)w=I[O],(w.selected=x.inArray(x.valHooks.option.get(w),_)>-1)&&(b=!0);return b||(f.selectedIndex=-1),_}}}}),x.each(["radio","checkbox"],function(){x.valHooks[this]={set:function(f,p){if(Array.isArray(p))return f.checked=x.inArray(x(f).val(),p)>-1}},g.checkOn||(x.valHooks[this].get=function(f){return f.getAttribute("value")===null?"on":f.value})}),g.focusin="onfocusin"in e;var Os=/^(?:focusinfocus|focusoutblur)$/,Ds=function(f){f.stopPropagation()};x.extend(x.event,{trigger:function(f,p,b,w){var I,_,O,j,z,Z,ae,xe,ne=[b||T],ce=h.call(f,"type")?f.type:f,Pe=h.call(f,"namespace")?f.namespace.split("."):[];if(_=xe=O=b=b||T,!(b.nodeType===3||b.nodeType===8)&&!Os.test(ce+x.event.triggered)&&(ce.indexOf(".")>-1&&(Pe=ce.split("."),ce=Pe.shift(),Pe.sort()),z=ce.indexOf(":")<0&&"on"+ce,f=f[x.expando]?f:new x.Event(ce,typeof f=="object"&&f),f.isTrigger=w?2:3,f.namespace=Pe.join("."),f.rnamespace=f.namespace?new RegExp("(^|\\.)"+Pe.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,f.result=void 0,f.target||(f.target=b),p=p==null?[f]:x.makeArray(p,[f]),ae=x.event.special[ce]||{},!(!w&&ae.trigger&&ae.trigger.apply(b,p)===!1))){if(!w&&!ae.noBubble&&!$(b)){for(j=ae.delegateType||ce,Os.test(j+ce)||(_=_.parentNode);_;_=_.parentNode)ne.push(_),O=_;O===(b.ownerDocument||T)&&ne.push(O.defaultView||O.parentWindow||e)}for(I=0;(_=ne[I++])&&!f.isPropagationStopped();)xe=_,f.type=I>1?j:ae.bindType||ce,Z=(Fe.get(_,"events")||Object.create(null))[f.type]&&Fe.get(_,"handle"),Z&&Z.apply(_,p),Z=z&&_[z],Z&&Z.apply&&tr(_)&&(f.result=Z.apply(_,p),f.result===!1&&f.preventDefault());return f.type=ce,!w&&!f.isDefaultPrevented()&&(!ae._default||ae._default.apply(ne.pop(),p)===!1)&&tr(b)&&z&&C(b[ce])&&!$(b)&&(O=b[z],O&&(b[z]=null),x.event.triggered=ce,f.isPropagationStopped()&&xe.addEventListener(ce,Ds),b[ce](),f.isPropagationStopped()&&xe.removeEventListener(ce,Ds),x.event.triggered=void 0,O&&(b[z]=O)),f.result}},simulate:function(f,p,b){var w=x.extend(new x.Event,b,{type:f,isSimulated:!0});x.event.trigger(w,null,p)}}),x.fn.extend({trigger:function(f,p){return this.each(function(){x.event.trigger(f,p,this)})},triggerHandler:function(f,p){var b=this[0];if(b)return x.event.trigger(f,p,b,!0)}}),g.focusin||x.each({focus:"focusin",blur:"focusout"},function(f,p){var b=function(w){x.event.simulate(p,w.target,x.event.fix(w))};x.event.special[p]={setup:function(){var w=this.ownerDocument||this.document||this,I=Fe.access(w,p);I||w.addEventListener(f,b,!0),Fe.access(w,p,(I||0)+1)},teardown:function(){var w=this.ownerDocument||this.document||this,I=Fe.access(w,p)-1;I?Fe.access(w,p,I):(w.removeEventListener(f,b,!0),Fe.remove(w,p))}}});var Zr=e.location,io={guid:Date.now()},v=/\?/;x.parseXML=function(f){var p,b;if(!f||typeof f!="string")return null;try{p=new e.DOMParser().parseFromString(f,"text/xml")}catch{}return b=p&&p.getElementsByTagName("parsererror")[0],(!p||b)&&x.error("Invalid XML: "+(b?x.map(b.childNodes,function(w){return w.textContent}).join(`
`):f)),p};var S=/\[\]$/,k=/\r?\n/g,W=/^(?:submit|button|image|reset|file)$/i,ee=/^(?:input|select|textarea|keygen)/i;function he(f,p,b,w){var I;if(Array.isArray(p))x.each(p,function(_,O){b||S.test(f)?w(f,O):he(f+"["+(typeof O=="object"&&O!=null?_:"")+"]",O,b,w)});else if(!b&&B(p)==="object")for(I in p)he(f+"["+I+"]",p[I],b,w);else w(f,p)}x.param=function(f,p){var b,w=[],I=function(_,O){var j=C(O)?O():O;w[w.length]=encodeURIComponent(_)+"="+encodeURIComponent(j==null?"":j)};if(f==null)return"";if(Array.isArray(f)||f.jquery&&!x.isPlainObject(f))x.each(f,function(){I(this.name,this.value)});else for(b in f)he(b,f[b],p,I);return w.join("&")},x.fn.extend({serialize:function(){return x.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var f=x.prop(this,"elements");return f?x.makeArray(f):this}).filter(function(){var f=this.type;return this.name&&!x(this).is(":disabled")&&ee.test(this.nodeName)&&!W.test(f)&&(this.checked||!Gr.test(f))}).map(function(f,p){var b=x(this).val();return b==null?null:Array.isArray(b)?x.map(b,function(w){return{name:p.name,value:w.replace(k,`\r
`)}}):{name:p.name,value:b.replace(k,`\r
`)}}).get()}});var se=/%20/g,de=/#.*$/,ve=/([?&])_=[^&]*/,Re=/^(.*?):[ \t]*([^\r\n]*)$/mg,je=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,et=/^(?:GET|HEAD)$/,Ke=/^\/\//,He={},Oe={},y="*/".concat("*"),E=T.createElement("a");E.href=Zr.href;function R(f){return function(p,b){typeof p!="string"&&(b=p,p="*");var w,I=0,_=p.toLowerCase().match(gt)||[];if(C(b))for(;w=_[I++];)w[0]==="+"?(w=w.slice(1)||"*",(f[w]=f[w]||[]).unshift(b)):(f[w]=f[w]||[]).push(b)}}function D(f,p,b,w){var I={},_=f===Oe;function O(j){var z;return I[j]=!0,x.each(f[j]||[],function(Z,ae){var xe=ae(p,b,w);if(typeof xe=="string"&&!_&&!I[xe])return p.dataTypes.unshift(xe),O(xe),!1;if(_)return!(z=xe)}),z}return O(p.dataTypes[0])||!I["*"]&&O("*")}function U(f,p){var b,w,I=x.ajaxSettings.flatOptions||{};for(b in p)p[b]!==void 0&&((I[b]?f:w||(w={}))[b]=p[b]);return w&&x.extend(!0,f,w),f}function V(f,p,b){for(var w,I,_,O,j=f.contents,z=f.dataTypes;z[0]==="*";)z.shift(),w===void 0&&(w=f.mimeType||p.getResponseHeader("Content-Type"));if(w){for(I in j)if(j[I]&&j[I].test(w)){z.unshift(I);break}}if(z[0]in b)_=z[0];else{for(I in b){if(!z[0]||f.converters[I+" "+z[0]]){_=I;break}O||(O=I)}_=_||O}if(_)return _!==z[0]&&z.unshift(_),b[_]}function G(f,p,b,w){var I,_,O,j,z,Z={},ae=f.dataTypes.slice();if(ae[1])for(O in f.converters)Z[O.toLowerCase()]=f.converters[O];for(_=ae.shift();_;)if(f.responseFields[_]&&(b[f.responseFields[_]]=p),!z&&w&&f.dataFilter&&(p=f.dataFilter(p,f.dataType)),z=_,_=ae.shift(),_){if(_==="*")_=z;else if(z!=="*"&&z!==_){if(O=Z[z+" "+_]||Z["* "+_],!O){for(I in Z)if(j=I.split(" "),j[1]===_&&(O=Z[z+" "+j[0]]||Z["* "+j[0]],O)){O===!0?O=Z[I]:Z[I]!==!0&&(_=j[0],ae.unshift(j[1]));break}}if(O!==!0)if(O&&f.throws)p=O(p);else try{p=O(p)}catch(xe){return{state:"parsererror",error:O?xe:"No conversion from "+z+" to "+_}}}}return{state:"success",data:p}}x.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:Zr.href,type:"GET",isLocal:je.test(Zr.protocol),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":y,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/\bxml\b/,html:/\bhtml/,json:/\bjson\b/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":JSON.parse,"text xml":x.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(f,p){return p?U(U(f,x.ajaxSettings),p):U(x.ajaxSettings,f)},ajaxPrefilter:R(He),ajaxTransport:R(Oe),ajax:function(f,p){typeof f=="object"&&(p=f,f=void 0),p=p||{};var b,w,I,_,O,j,z,Z,ae,xe,ne=x.ajaxSetup({},p),ce=ne.context||ne,Pe=ne.context&&(ce.nodeType||ce.jquery)?x(ce):x.event,Xe=x.Deferred(),Be=x.Callbacks("once memory"),Xt=ne.statusCode||{},jt={},jn={},yt="canceled",qe={readyState:0,getResponseHeader:function(it){var Pt;if(z){if(!_)for(_={};Pt=Re.exec(I);)_[Pt[1].toLowerCase()+" "]=(_[Pt[1].toLowerCase()+" "]||[]).concat(Pt[2]);Pt=_[it.toLowerCase()+" "]}return Pt==null?null:Pt.join(", ")},getAllResponseHeaders:function(){return z?I:null},setRequestHeader:function(it,Pt){return z==null&&(it=jn[it.toLowerCase()]=jn[it.toLowerCase()]||it,jt[it]=Pt),this},overrideMimeType:function(it){return z==null&&(ne.mimeType=it),this},statusCode:function(it){var Pt;if(it)if(z)qe.always(it[qe.status]);else for(Pt in it)Xt[Pt]=[Xt[Pt],it[Pt]];return this},abort:function(it){var Pt=it||yt;return b&&b.abort(Pt),An(0,Pt),this}};if(Xe.promise(qe),ne.url=((f||ne.url||Zr.href)+"").replace(Ke,Zr.protocol+"//"),ne.type=p.method||p.type||ne.method||ne.type,ne.dataTypes=(ne.dataType||"*").toLowerCase().match(gt)||[""],ne.crossDomain==null){j=T.createElement("a");try{j.href=ne.url,j.href=j.href,ne.crossDomain=E.protocol+"//"+E.host!=j.protocol+"//"+j.host}catch{ne.crossDomain=!0}}if(ne.data&&ne.processData&&typeof ne.data!="string"&&(ne.data=x.param(ne.data,ne.traditional)),D(He,ne,p,qe),z)return qe;Z=x.event&&ne.global,Z&&x.active++===0&&x.event.trigger("ajaxStart"),ne.type=ne.type.toUpperCase(),ne.hasContent=!et.test(ne.type),w=ne.url.replace(de,""),ne.hasContent?ne.data&&ne.processData&&(ne.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&(ne.data=ne.data.replace(se,"+")):(xe=ne.url.slice(w.length),ne.data&&(ne.processData||typeof ne.data=="string")&&(w+=(v.test(w)?"&":"?")+ne.data,delete ne.data),ne.cache===!1&&(w=w.replace(ve,"$1"),xe=(v.test(w)?"&":"?")+"_="+io.guid+++xe),ne.url=w+xe),ne.ifModified&&(x.lastModified[w]&&qe.setRequestHeader("If-Modified-Since",x.lastModified[w]),x.etag[w]&&qe.setRequestHeader("If-None-Match",x.etag[w])),(ne.data&&ne.hasContent&&ne.contentType!==!1||p.contentType)&&qe.setRequestHeader("Content-Type",ne.contentType),qe.setRequestHeader("Accept",ne.dataTypes[0]&&ne.accepts[ne.dataTypes[0]]?ne.accepts[ne.dataTypes[0]]+(ne.dataTypes[0]!=="*"?", "+y+"; q=0.01":""):ne.accepts["*"]);for(ae in ne.headers)qe.setRequestHeader(ae,ne.headers[ae]);if(ne.beforeSend&&(ne.beforeSend.call(ce,qe,ne)===!1||z))return qe.abort();if(yt="abort",Be.add(ne.complete),qe.done(ne.success),qe.fail(ne.error),b=D(Oe,ne,p,qe),!b)An(-1,"No Transport");else{if(qe.readyState=1,Z&&Pe.trigger("ajaxSend",[qe,ne]),z)return qe;ne.async&&ne.timeout>0&&(O=e.setTimeout(function(){qe.abort("timeout")},ne.timeout));try{z=!1,b.send(jt,An)}catch(it){if(z)throw it;An(-1,it)}}function An(it,Pt,Oi,pa){var Hn,ao,uo,On,Fs,ar=Pt;z||(z=!0,O&&e.clearTimeout(O),b=void 0,I=pa||"",qe.readyState=it>0?4:0,Hn=it>=200&&it<300||it===304,Oi&&(On=V(ne,qe,Oi)),!Hn&&x.inArray("script",ne.dataTypes)>-1&&x.inArray("json",ne.dataTypes)<0&&(ne.converters["text script"]=function(){}),On=G(ne,On,qe,Hn),Hn?(ne.ifModified&&(Fs=qe.getResponseHeader("Last-Modified"),Fs&&(x.lastModified[w]=Fs),Fs=qe.getResponseHeader("etag"),Fs&&(x.etag[w]=Fs)),it===204||ne.type==="HEAD"?ar="nocontent":it===304?ar="notmodified":(ar=On.state,ao=On.data,uo=On.error,Hn=!uo)):(uo=ar,(it||!ar)&&(ar="error",it<0&&(it=0))),qe.status=it,qe.statusText=(Pt||ar)+"",Hn?Xe.resolveWith(ce,[ao,ar,qe]):Xe.rejectWith(ce,[qe,ar,uo]),qe.statusCode(Xt),Xt=void 0,Z&&Pe.trigger(Hn?"ajaxSuccess":"ajaxError",[qe,ne,Hn?ao:uo]),Be.fireWith(ce,[qe,ar]),Z&&(Pe.trigger("ajaxComplete",[qe,ne]),--x.active||x.event.trigger("ajaxStop")))}return qe},getJSON:function(f,p,b){return x.get(f,p,b,"json")},getScript:function(f,p){return x.get(f,void 0,p,"script")}}),x.each(["get","post"],function(f,p){x[p]=function(b,w,I,_){return C(w)&&(_=_||I,I=w,w=void 0),x.ajax(x.extend({url:b,type:p,dataType:_,data:w,success:I},x.isPlainObject(b)&&b))}}),x.ajaxPrefilter(function(f){var p;for(p in f.headers)p.toLowerCase()==="content-type"&&(f.contentType=f.headers[p]||"")}),x._evalUrl=function(f,p,b){return x.ajax({url:f,type:"GET",dataType:"script",cache:!0,async:!1,global:!1,converters:{"text script":function(){}},dataFilter:function(w){x.globalEval(w,p,b)}})},x.fn.extend({wrapAll:function(f){var p;return this[0]&&(C(f)&&(f=f.call(this[0])),p=x(f,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&p.insertBefore(this[0]),p.map(function(){for(var b=this;b.firstElementChild;)b=b.firstElementChild;return b}).append(this)),this},wrapInner:function(f){return C(f)?this.each(function(p){x(this).wrapInner(f.call(this,p))}):this.each(function(){var p=x(this),b=p.contents();b.length?b.wrapAll(f):p.append(f)})},wrap:function(f){var p=C(f);return this.each(function(b){x(this).wrapAll(p?f.call(this,b):f)})},unwrap:function(f){return this.parent(f).not("body").each(function(){x(this).replaceWith(this.childNodes)}),this}}),x.expr.pseudos.hidden=function(f){return!x.expr.pseudos.visible(f)},x.expr.pseudos.visible=function(f){return!!(f.offsetWidth||f.offsetHeight||f.getClientRects().length)},x.ajaxSettings.xhr=function(){try{return new e.XMLHttpRequest}catch{}};var K={0:200,1223:204},te=x.ajaxSettings.xhr();g.cors=!!te&&"withCredentials"in te,g.ajax=te=!!te,x.ajaxTransport(function(f){var p,b;if(g.cors||te&&!f.crossDomain)return{send:function(w,I){var _,O=f.xhr();if(O.open(f.type,f.url,f.async,f.username,f.password),f.xhrFields)for(_ in f.xhrFields)O[_]=f.xhrFields[_];f.mimeType&&O.overrideMimeType&&O.overrideMimeType(f.mimeType),!f.crossDomain&&!w["X-Requested-With"]&&(w["X-Requested-With"]="XMLHttpRequest");for(_ in w)O.setRequestHeader(_,w[_]);p=function(j){return function(){p&&(p=b=O.onload=O.onerror=O.onabort=O.ontimeout=O.onreadystatechange=null,j==="abort"?O.abort():j==="error"?typeof O.status!="number"?I(0,"error"):I(O.status,O.statusText):I(K[O.status]||O.status,O.statusText,(O.responseType||"text")!=="text"||typeof O.responseText!="string"?{binary:O.response}:{text:O.responseText},O.getAllResponseHeaders()))}},O.onload=p(),b=O.onerror=O.ontimeout=p("error"),O.onabort!==void 0?O.onabort=b:O.onreadystatechange=function(){O.readyState===4&&e.setTimeout(function(){p&&b()})},p=p("abort");try{O.send(f.hasContent&&f.data||null)}catch(j){if(p)throw j}},abort:function(){p&&p()}}}),x.ajaxPrefilter(function(f){f.crossDomain&&(f.contents.script=!1)}),x.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/\b(?:java|ecma)script\b/},converters:{"text script":function(f){return x.globalEval(f),f}}}),x.ajaxPrefilter("script",function(f){f.cache===void 0&&(f.cache=!1),f.crossDomain&&(f.type="GET")}),x.ajaxTransport("script",function(f){if(f.crossDomain||f.scriptAttrs){var p,b;return{send:function(w,I){p=x("<script>").attr(f.scriptAttrs||{}).prop({charset:f.scriptCharset,src:f.url}).on("load error",b=function(_){p.remove(),b=null,_&&I(_.type==="error"?404:200,_.type)}),T.head.appendChild(p[0])},abort:function(){b&&b()}}}});var fe=[],ge=/(=)\?(?=&|$)|\?\?/;x.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var f=fe.pop()||x.expando+"_"+io.guid++;return this[f]=!0,f}}),x.ajaxPrefilter("json jsonp",function(f,p,b){var w,I,_,O=f.jsonp!==!1&&(ge.test(f.url)?"url":typeof f.data=="string"&&(f.contentType||"").indexOf("application/x-www-form-urlencoded")===0&&ge.test(f.data)&&"data");if(O||f.dataTypes[0]==="jsonp")return w=f.jsonpCallback=C(f.jsonpCallback)?f.jsonpCallback():f.jsonpCallback,O?f[O]=f[O].replace(ge,"$1"+w):f.jsonp!==!1&&(f.url+=(v.test(f.url)?"&":"?")+f.jsonp+"="+w),f.converters["script json"]=function(){return _||x.error(w+" was not called"),_[0]},f.dataTypes[0]="json",I=e[w],e[w]=function(){_=arguments},b.always(function(){I===void 0?x(e).removeProp(w):e[w]=I,f[w]&&(f.jsonpCallback=p.jsonpCallback,fe.push(w)),_&&C(I)&&I(_[0]),_=I=void 0}),"script"}),g.createHTMLDocument=function(){var f=T.implementation.createHTMLDocument("").body;return f.innerHTML="<form></form><form></form>",f.childNodes.length===2}(),x.parseHTML=function(f,p,b){if(typeof f!="string")return[];typeof p=="boolean"&&(b=p,p=!1);var w,I,_;return p||(g.createHTMLDocument?(p=T.implementation.createHTMLDocument(""),w=p.createElement("base"),w.href=T.location.href,p.head.appendChild(w)):p=T),I=Ae.exec(f),_=!b&&[],I?[p.createElement(I[1])]:(I=jr([f],p,_),_&&_.length&&x(_).remove(),x.merge([],I.childNodes))},x.fn.load=function(f,p,b){var w,I,_,O=this,j=f.indexOf(" ");return j>-1&&(w=zn(f.slice(j)),f=f.slice(0,j)),C(p)?(b=p,p=void 0):p&&typeof p=="object"&&(I="POST"),O.length>0&&x.ajax({url:f,type:I||"GET",dataType:"html",data:p}).done(function(z){_=arguments,O.html(w?x("<div>").append(x.parseHTML(z)).find(w):z)}).always(b&&function(z,Z){O.each(function(){b.apply(this,_||[z.responseText,Z,z])})}),this},x.expr.pseudos.animated=function(f){return x.grep(x.timers,function(p){return f===p.elem}).length},x.offset={setOffset:function(f,p,b){var w,I,_,O,j,z,Z,ae=x.css(f,"position"),xe=x(f),ne={};ae==="static"&&(f.style.position="relative"),j=xe.offset(),_=x.css(f,"top"),z=x.css(f,"left"),Z=(ae==="absolute"||ae==="fixed")&&(_+z).indexOf("auto")>-1,Z?(w=xe.position(),O=w.top,I=w.left):(O=parseFloat(_)||0,I=parseFloat(z)||0),C(p)&&(p=p.call(f,b,x.extend({},j))),p.top!=null&&(ne.top=p.top-j.top+O),p.left!=null&&(ne.left=p.left-j.left+I),"using"in p?p.using.call(f,ne):xe.css(ne)}},x.fn.extend({offset:function(f){if(arguments.length)return f===void 0?this:this.each(function(I){x.offset.setOffset(this,f,I)});var p,b,w=this[0];if(!!w)return w.getClientRects().length?(p=w.getBoundingClientRect(),b=w.ownerDocument.defaultView,{top:p.top+b.pageYOffset,left:p.left+b.pageXOffset}):{top:0,left:0}},position:function(){if(!!this[0]){var f,p,b,w=this[0],I={top:0,left:0};if(x.css(w,"position")==="fixed")p=w.getBoundingClientRect();else{for(p=this.offset(),b=w.ownerDocument,f=w.offsetParent||b.documentElement;f&&(f===b.body||f===b.documentElement)&&x.css(f,"position")==="static";)f=f.parentNode;f&&f!==w&&f.nodeType===1&&(I=x(f).offset(),I.top+=x.css(f,"borderTopWidth",!0),I.left+=x.css(f,"borderLeftWidth",!0))}return{top:p.top-I.top-x.css(w,"marginTop",!0),left:p.left-I.left-x.css(w,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var f=this.offsetParent;f&&x.css(f,"position")==="static";)f=f.offsetParent;return f||un})}}),x.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(f,p){var b=p==="pageYOffset";x.fn[f]=function(w){return Vt(this,function(I,_,O){var j;if($(I)?j=I:I.nodeType===9&&(j=I.defaultView),O===void 0)return j?j[p]:I[_];j?j.scrollTo(b?j.pageXOffset:O,b?O:j.pageYOffset):I[_]=O},f,w,arguments.length)}}),x.each(["top","left"],function(f,p){x.cssHooks[p]=ir(g.pixelPosition,function(b,w){if(w)return w=or(b,p),qr.test(w)?x(b).position()[p]+"px":w})}),x.each({Height:"height",Width:"width"},function(f,p){x.each({padding:"inner"+f,content:p,"":"outer"+f},function(b,w){x.fn[w]=function(I,_){var O=arguments.length&&(b||typeof I!="boolean"),j=b||(I===!0||_===!0?"margin":"border");return Vt(this,function(z,Z,ae){var xe;return $(z)?w.indexOf("outer")===0?z["inner"+f]:z.document.documentElement["client"+f]:z.nodeType===9?(xe=z.documentElement,Math.max(z.body["scroll"+f],xe["scroll"+f],z.body["offset"+f],xe["offset"+f],xe["client"+f])):ae===void 0?x.css(z,Z,j):x.style(z,Z,ae,j)},p,O?I:void 0,O)}})}),x.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(f,p){x.fn[p]=function(b){return this.on(p,b)}}),x.fn.extend({bind:function(f,p,b){return this.on(f,null,p,b)},unbind:function(f,p){return this.off(f,null,p)},delegate:function(f,p,b,w){return this.on(p,f,b,w)},undelegate:function(f,p,b){return arguments.length===1?this.off(f,"**"):this.off(p,f||"**",b)},hover:function(f,p){return this.mouseenter(f).mouseleave(p||f)}}),x.each("blur focus focusin focusout resize scroll click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup contextmenu".split(" "),function(f,p){x.fn[p]=function(b,w){return arguments.length>0?this.on(p,null,b,w):this.trigger(p)}});var we=/^[\s\uFEFF\xA0]+|([^\s\uFEFF\xA0])[\s\uFEFF\xA0]+$/g;x.proxy=function(f,p){var b,w,I;if(typeof p=="string"&&(b=f[p],p=f,f=b),!!C(f))return w=o.call(arguments,2),I=function(){return f.apply(p||this,w.concat(o.call(arguments)))},I.guid=f.guid=f.guid||x.guid++,I},x.holdReady=function(f){f?x.readyWait++:x.ready(!0)},x.isArray=Array.isArray,x.parseJSON=JSON.parse,x.nodeName=Ie,x.isFunction=C,x.isWindow=$,x.camelCase=Jt,x.type=B,x.now=Date.now,x.isNumeric=function(f){var p=x.type(f);return(p==="number"||p==="string")&&!isNaN(f-parseFloat(f))},x.trim=function(f){return f==null?"":(f+"").replace(we,"$1")};var Te=e.jQuery,Ee=e.$;return x.noConflict=function(f){return e.$===x&&(e.$=Ee),f&&e.jQuery===x&&(e.jQuery=Te),x},typeof t>"u"&&(e.jQuery=e.$=x),x})})(Ug);const UO=Ug.exports;UO(()=>{new VO});
